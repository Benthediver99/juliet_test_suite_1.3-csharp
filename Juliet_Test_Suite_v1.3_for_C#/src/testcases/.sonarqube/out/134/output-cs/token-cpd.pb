ò#
ÀC:\Users\CyberDiver\Documents\SAST Benchmarking\Juliet_Test_Suite_v1.3_for_C#\src\testcases\CWE404_Improper_Resource_Shutdown\CWE404_Improper_Resource_Shutdown__console_InputStreamReader_01.cs
	namespace 	
	testcases
 
. -
!CWE404_Improper_Resource_Shutdown 5
{ 
class 	K
?CWE404_Improper_Resource_Shutdown__console_InputStreamReader_01
 I
:J K
AbstractTestCaseL \
{ 
public 
override 
void 
Bad  
(  !
)! "
{ 	
StreamReader 
sr 
= 
null "
;" #
try 
{ 
sr 
= 
new 
StreamReader %
(% &
Console& -
.- .
OpenStandardInput. ?
(? @
)@ A
,A B
EncodingC K
.K L
UTF8L P
)P Q
;Q R
string 

readString !
=" #
sr$ &
.& '
ReadLine' /
(/ 0
)0 1
;1 2
IO 
. 
	WriteLine 
( 

readString '
)' (
;( )
try 
{   
if!! 
(!! 
sr!! 
!=!! 
null!! "
)!!" #
{"" 
sr## 
.## 
Close##  
(##  !
)##! "
;##" #
}$$ 
}%% 
catch&& 
(&& 
IOException&& "
exceptIO&&# +
)&&+ ,
{'' 
IO(( 
.(( 
Logger(( 
.(( 
Log(( !
(((! "
NLog((" &
.((& '
LogLevel((' /
.((/ 0
Warn((0 4
,((4 5
$str((6 R
,((R S
exceptIO((T \
)((\ ]
;((] ^
})) 
}** 
catch++ 
(++ 
IOException++ 
exceptIO++ '
)++' (
{,, 
IO-- 
.-- 
Logger-- 
.-- 
Log-- 
(-- 
NLog-- "
.--" #
LogLevel--# +
.--+ ,
Warn--, 0
,--0 1
$str--2 M
,--M N
exceptIO--O W
)--W X
;--X Y
}.. 
}// 	
public22 
override22 
void22 
Good22 !
(22! "
)22" #
{33 	
Good144 
(44 
)44 
;44 
}55 	
private88 
void88 
Good188 
(88 
)88 
{99 	
StreamReader:: 
sr:: 
=:: 
null:: "
;::" #
try<< 
{== 
sr>> 
=>> 
new>> 
StreamReader>> %
(>>% &
Console>>& -
.>>- .
OpenStandardInput>>. ?
(>>? @
)>>@ A
,>>A B
Encoding>>C K
.>>K L
UTF8>>L P
)>>P Q
;>>Q R
string?? 

readString?? !
=??" #
sr??$ &
.??& '
ReadLine??' /
(??/ 0
)??0 1
;??1 2
IOAA 
.AA 
	WriteLineAA 
(AA 

readStringAA '
)AA' (
;AA( )
}BB 
catchCC 
(CC 
IOExceptionCC 
exceptIOCC '
)CC' (
{DD 
IOEE 
.EE 
LoggerEE 
.EE 
LogEE 
(EE 
NLogEE "
.EE" #
LogLevelEE# +
.EE+ ,
WarnEE, 0
,EE0 1
$strEE2 M
,EEM N
exceptIOEEO W
)EEW X
;EEX Y
}FF 
finallyII 
{JJ 
tryKK 
{LL 
ifMM 
(MM 
srMM 
!=MM 
nullMM "
)MM" #
{NN 
srOO 
.OO 
CloseOO  
(OO  !
)OO! "
;OO" #
}PP 
}QQ 
catchRR 
(RR 
IOExceptionRR "
exceptIORR# +
)RR+ ,
{SS 
IOTT 
.TT 
LoggerTT 
.TT 
LogTT !
(TT! "
NLogTT" &
.TT& '
LogLevelTT' /
.TT/ 0
WarnTT0 4
,TT4 5
$strTT6 R
,TTR S
exceptIOTTT \
)TT\ ]
;TT] ^
}UU 
}VV 
}WW 	
}YY 
}ZZ úA
´C:\Users\CyberDiver\Documents\SAST Benchmarking\Juliet_Test_Suite_v1.3_for_C#\src\testcases\CWE404_Improper_Resource_Shutdown\CWE404_Improper_Resource_Shutdown__db_Connection_01.cs
	namespace 	
	testcases
 
. -
!CWE404_Improper_Resource_Shutdown 5
{ 
class 	?
3CWE404_Improper_Resource_Shutdown__db_Connection_01
 =
:> ?
AbstractTestCase@ P
{ 
public 
override 
void 
Bad  
(  !
)! "
{ 	
SqlConnection 
dBConnection &
=' (
null) -
;- .

SqlCommand 
command 
=  
null! %
;% &
try 
{ 
int 
intId 
= 
( 
new  
Random! '
(' (
)( )
)) *
.* +
Next+ /
(/ 0
$num0 3
)3 4
;4 5
dBConnection 
= 
IO !
.! "
GetDBConnection" 1
(1 2
)2 3
;3 4
command 
= 
new 

SqlCommand (
(( )
null) -
,- .
dBConnection/ ;
); <
;< =
command 
. 
CommandText #
=$ %
$str& H
;H I
SqlParameter 
idParam $
=% &
new' *
SqlParameter+ 7
(7 8
$str8 =
,= >
	SqlDbType? H
.H I
IntI L
,L M
$numN O
)O P
;P Q
idParam 
. 
Value 
= 
$num  !
;! "
command   
.   
Prepare   
(    
)    !
;  ! "
int!! 
affectedRows!!  
=!!! "
command!!# *
.!!* +
ExecuteNonQuery!!+ :
(!!: ;
)!!; <
;!!< =
if## 
(## 
affectedRows##  
!=##! #
$num##$ %
)##% &
{$$ 
IO%% 
.%% 
WriteString%% "
(%%" #
affectedRows%%# /
.%%/ 0
ToString%%0 8
(%%8 9
)%%9 :
)%%: ;
;%%; <
}&& 
try)) 
{** 
if++ 
(++ 
command++ 
!=++  "
null++# '
)++' (
{,, 
command-- 
.--  
Dispose--  '
(--' (
)--( )
;--) *
}.. 
}// 
catch00 
(00 
SqlException00 #
	exceptSql00$ -
)00- .
{11 
IO22 
.22 
Logger22 
.22 
Log22 !
(22! "
NLog22" &
.22& '
LogLevel22' /
.22/ 0
Warn220 4
,224 5
$str226 R
,22R S
	exceptSql22T ]
)22] ^
;22^ _
}33 
try55 
{66 
if77 
(77 
dBConnection77 $
!=77% '
null77( ,
)77, -
{88 
dBConnection99 $
.99$ %
Close99% *
(99* +
)99+ ,
;99, -
}:: 
};; 
catch<< 
(<< 
SqlException<< #
	exceptSql<<$ -
)<<- .
{== 
IO>> 
.>> 
Logger>> 
.>> 
Log>> !
(>>! "
NLog>>" &
.>>& '
LogLevel>>' /
.>>/ 0
Warn>>0 4
,>>4 5
$str>>6 P
,>>P Q
	exceptSql>>R [
)>>[ \
;>>\ ]
}?? 
}AA 
catchBB 
(BB 
SqlExceptionBB 
	exceptSqlBB  )
)BB) *
{CC 
IODD 
.DD 
LoggerDD 
.DD 
LogDD 
(DD 
NLogDD "
.DD" #
LogLevelDD# +
.DD+ ,
WarnDD, 0
,DD0 1
$strDD2 =
,DD= >
	exceptSqlDD? H
)DDH I
;DDI J
}EE 
}FF 	
publicII 
overrideII 
voidII 
GoodII !
(II! "
)II" #
{JJ 	
Good1KK 
(KK 
)KK 
;KK 
}LL 	
privateOO 
voidOO 
Good1OO 
(OO 
)OO 
{PP 	
SqlConnectionQQ 
dBConnectionQQ &
=QQ' (
nullQQ) -
;QQ- .

SqlCommandRR 
commandRR 
=RR  
nullRR! %
;RR% &
tryTT 
{UU 
intVV 
intIdVV 
=VV 
(VV 
newVV  
RandomVV! '
(VV' (
)VV( )
)VV) *
.VV* +
NextVV+ /
(VV/ 0
$numVV0 3
)VV3 4
;VV4 5
dBConnectionXX 
=XX 
IOXX !
.XX! "
GetDBConnectionXX" 1
(XX1 2
)XX2 3
;XX3 4
commandYY 
=YY 
newYY 

SqlCommandYY (
(YY( )
nullYY) -
,YY- .
dBConnectionYY/ ;
)YY; <
;YY< =
commandZZ 
.ZZ 
CommandTextZZ #
=ZZ$ %
$strZZ& H
;ZZH I
SqlParameter[[ 
idParam[[ $
=[[% &
new[[' *
SqlParameter[[+ 7
([[7 8
$str[[8 =
,[[= >
	SqlDbType[[? H
.[[H I
Int[[I L
,[[L M
$num[[N O
)[[O P
;[[P Q
idParam\\ 
.\\ 
Value\\ 
=\\ 
$num\\  !
;\\! "
command]] 
.]] 
Prepare]] 
(]]  
)]]  !
;]]! "
int^^ 
affectedRows^^  
=^^! "
command^^# *
.^^* +
ExecuteNonQuery^^+ :
(^^: ;
)^^; <
;^^< =
if`` 
(`` 
affectedRows``  
!=``! #
$num``$ %
)``% &
{aa 
IObb 
.bb 
WriteStringbb "
(bb" #
affectedRowsbb# /
.bb/ 0
ToStringbb0 8
(bb8 9
)bb9 :
)bb: ;
;bb; <
}cc 
}dd 
catchee 
(ee 
SqlExceptionee 
	exceptSqlee  )
)ee) *
{ff 
IOgg 
.gg 
Loggergg 
.gg 
Loggg 
(gg 
NLoggg "
.gg" #
LogLevelgg# +
.gg+ ,
Warngg, 0
,gg0 1
$strgg2 =
,gg= >
	exceptSqlgg? H
)ggH I
;ggI J
}hh 
finallyjj 
{kk 
tryll 
{mm 
ifnn 
(nn 
commandnn 
!=nn  "
nullnn# '
)nn' (
{oo 
commandpp 
.pp  
Disposepp  '
(pp' (
)pp( )
;pp) *
}qq 
}rr 
catchss 
(ss 
SqlExceptionss #
	exceptSqlss$ -
)ss- .
{tt 
IOuu 
.uu 
Loggeruu 
.uu 
Loguu !
(uu! "
NLoguu" &
.uu& '
LogLeveluu' /
.uu/ 0
Warnuu0 4
,uu4 5
$struu6 P
,uuP Q
	exceptSqluuR [
)uu[ \
;uu\ ]
}vv 
tryxx 
{yy 
ifzz 
(zz 
dBConnectionzz $
!=zz% '
nullzz( ,
)zz, -
{{{ 
dBConnection|| $
.||$ %
Close||% *
(||* +
)||+ ,
;||, -
}}} 
}~~ 
catch 
( 
SqlException #
	exceptSql$ -
)- .
{
 
IO
 
.
 
Logger
 
.
 
Log
 !
(
! "
NLog
" &
.
& '
LogLevel
' /
.
/ 0
Warn
0 4
,
4 5
$str
6 P
,
P Q
	exceptSql
R [
)
[ \
;
\ ]
}
 
}
 
}
 	
} 
} ª!
±C:\Users\CyberDiver\Documents\SAST Benchmarking\Juliet_Test_Suite_v1.3_for_C#\src\testcases\CWE404_Improper_Resource_Shutdown\CWE404_Improper_Resource_Shutdown__FileReader_01.cs
	namespace

 	
	testcases


 
.

 -
!CWE404_Improper_Resource_Shutdown

 5
{ 
class 	<
0CWE404_Improper_Resource_Shutdown__FileReader_01
 :
:; <
AbstractTestCase= M
{ 
public 
override 
void 
Bad  
(  !
)! "
{ 	
StreamReader 
sr 
= 
null "
;" #
try 
{ 
sr 
= 
new 
StreamReader %
(% &
$str& 4
)4 5
;5 6
string 

readString !
=" #
sr$ &
.& '
ReadLine' /
(/ 0
)0 1
;1 2
IO 
. 
	WriteLine 
( 

readString '
)' (
;( )
try 
{ 
if 
( 
sr 
!= 
null "
)" #
{   
sr!! 
.!! 
Close!!  
(!!  !
)!!! "
;!!" #
}"" 
}## 
catch$$ 
($$ 
IOException$$ "
exceptIO$$# +
)$$+ ,
{%% 
IO&& 
.&& 
Logger&& 
.&& 
Log&& !
(&&! "
NLog&&" &
.&&& '
LogLevel&&' /
.&&/ 0
Warn&&0 4
,&&4 5
$str&&6 R
,&&R S
exceptIO&&T \
)&&\ ]
;&&] ^
}'' 
}(( 
catch)) 
()) 
IOException)) 
exceptIO)) '
)))' (
{** 
IO++ 
.++ 
Logger++ 
.++ 
Log++ 
(++ 
NLog++ "
.++" #
LogLevel++# +
.+++ ,
Warn++, 0
,++0 1
$str++2 M
,++M N
exceptIO++O W
)++W X
;++X Y
},, 
}-- 	
public00 
override00 
void00 
Good00 !
(00! "
)00" #
{11 	
Good122 
(22 
)22 
;22 
}33 	
private66 
void66 
Good166 
(66 
)66 
{77 	
StreamReader88 
sr88 
=88 
null88 "
;88" #
try:: 
{;; 
sr<< 
=<< 
new<< 
StreamReader<< %
(<<% &
$str<<& 4
)<<4 5
;<<5 6
string== 

readString== !
===" #
sr==$ &
.==& '
ReadLine==' /
(==/ 0
)==0 1
;==1 2
IO?? 
.?? 
	WriteLine?? 
(?? 

readString?? '
)??' (
;??( )
}@@ 
catchAA 
(AA 
IOExceptionAA 
exceptIOAA '
)AA' (
{BB 
IOCC 
.CC 
LoggerCC 
.CC 
LogCC 
(CC 
NLogCC "
.CC" #
LogLevelCC# +
.CC+ ,
WarnCC, 0
,CC0 1
$strCC2 M
,CCM N
exceptIOCCO W
)CCW X
;CCX Y
}DD 
finallyFF 
{GG 
tryHH 
{II 
ifJJ 
(JJ 
srJJ 
!=JJ 
nullJJ "
)JJ" #
{KK 
srLL 
.LL 
CloseLL  
(LL  !
)LL! "
;LL" #
}MM 
}NN 
catchOO 
(OO 
IOExceptionOO "
exceptIOOO# +
)OO+ ,
{PP 
IOQQ 
.QQ 
LoggerQQ 
.QQ 
LogQQ !
(QQ! "
NLogQQ" &
.QQ& '
LogLevelQQ' /
.QQ/ 0
WarnQQ0 4
,QQ4 5
$strQQ6 P
,QQP Q
exceptIOQQR Z
)QQZ [
;QQ[ \
}RR 
}SS 
}TT 	
}VV 
}WW ÷
¹C:\Users\CyberDiver\Documents\SAST Benchmarking\Juliet_Test_Suite_v1.3_for_C#\src\testcases\CWE404_Improper_Resource_Shutdown\CWE404_Improper_Resource_Shutdown__Object_Lock_Thread_01.cs
	namespace

 	
	testcases


 
.

 -
!CWE404_Improper_Resource_Shutdown

 5
{ 
class 	D
8CWE404_Improper_Resource_Shutdown__Object_Lock_Thread_01
 B
:C D
AbstractTestCaseE U
{ 
static 
private 
object 
badLock %
=& '
new( +
object, 2
(2 3
)3 4
;4 5
static 
private 
int 
intBadNumber '
=( )
$num* +
;+ ,
static 
public 
void 
	helperBad $
($ %
)% &
{ 	
Monitor 
. 
Enter 
( 
badLock !
)! "
;" #
intBadNumber 
++ 
; 
IO 
. 
	WriteLine 
( 
intBadNumber %
)% &
;& '
Monitor 
. 
Exit 
( 
badLock  
)  !
;! "
} 	
public 
override 
void 
Bad  
(  !
)! "
{ 	
	helperBad 
( 
) 
; 
}   	
static"" 
private"" 
int"" 
intGood1Number"" )
=""* +
$num"", -
;""- .
static## 
private## 
object## 
goodLock## &
=##' (
new##) ,
object##- 3
(##3 4
)##4 5
;##5 6
static%% 
public%% 
void%% 
helperGood1%% &
(%%& '
)%%' (
{&& 	
Monitor'' 
.'' 
Enter'' 
('' 
goodLock'' "
)''" #
;''# $
try)) 
{** 
intGood1Number++ 
++++  
;++  !
IO-- 
.-- 
	WriteLine-- 
(-- 
intGood1Number-- +
)--+ ,
;--, -
}.. 
finally// 
{00 
Monitor22 
.22 
Exit22 
(22 
goodLock22 %
)22% &
;22& '
}33 
}44 	
public66 
void66 
Good166 
(66 
)66 
{77 	
helperGood188 
(88 
)88 
;88 
}99 	
public;; 
override;; 
void;; 
Good;; !
(;;! "
);;" #
{<< 	
Good1== 
(== 
)== 
;== 
}>> 	
}@@ 
}AA á0
C:\Users\CyberDiver\Documents\SAST Benchmarking\Juliet_Test_Suite_v1.3_for_C#\src\testcases\CWE404_Improper_Resource_Shutdown\Program.cs
	namespace		 	
	testcases		
 
.		 -
!CWE404_Improper_Resource_Shutdown		 5
{

 
class 
Program 
{ 
static 
void	 
Main 
( 
string 
[ 
] 
args  
)  !
{" #
if 
( 
args 

.
 
Any 
( 
) 
) 
{ 
if 
( 
args 
[ 
$num 
] 
. 
Equals 
( 
$str 
, 
StringComparison ,
., -
OrdinalIgnoreCase- >
)> ?
||@ B
args 
[ 
$num 
] 
. 
Equals !
(! "
$str" *
,* +
StringComparison, <
.< =
OrdinalIgnoreCase= N
)N O
)O P
{Q R
Console 
. 
	WriteLine 
( 
$str R
+S T
$str b
)b c
;c d
System 
. 
Environment 
. 
Exit 
( 
$num 
) 
;  
} 
foreach"" 
("" 
string"" 
	className"" 
in""  
args""! %
)""% &
{""' (
try$$ 
{$$	 

Type** 

myClass** 
=** 
Type** 
.** 
GetType** !
(**! "
	className**" +
)**+ ,
;**, -
object++ 
myObject++ 
=++ 
	Activator++ !
.++! "
CreateInstance++" 0
(++0 1
myClass++1 8
)++8 9
;++9 :
myClass,, 
.,, 
InvokeMember,, 
(,, 
$str,, $
,,,$ %
BindingFlags-- 
.-- 
InvokeMethod--  
|--! "
BindingFlags--# /
.--/ 0
Instance--0 8
|--9 :
BindingFlags--; G
.--G H
Public--H N
,--N O
null.. 
,.. 
myObject// 
,// 
new00 

object00 
[00 
]00 
{00 
	className00 
}00  !
)00! "
;00" #
}22 
catch22 
(22 
	Exception22 
ex22 
)22 
{22 
Console44 
.44 
	WriteLine44 
(44 
$str44 7
+448 9
	className44: C
)44C D
;44D E
Console55 
.55 
	WriteLine55 
(55 
ex55 
.55 

StackTrace55 %
)55% &
;55& '
}77 
Console99 
.99 
	WriteLine99 
(99 
$str99 
)99 
;99 
};; 
}== 
else== 	
{==
 
RunTestCWE1CC 
(CC 
)CC 
;CC 
RunTestCWE2DD 
(DD 
)DD 
;DD 
RunTestCWE3EE 
(EE 
)EE 
;EE 
RunTestCWE4FF 
(FF 
)FF 
;FF 
RunTestCWE5GG 
(GG 
)GG 
;GG 
RunTestCWE6HH 
(HH 
)HH 
;HH 
RunTestCWE7II 
(II 
)II 
;II 
RunTestCWE8JJ 
(JJ 
)JJ 
;JJ 
RunTestCWE9KK 
(KK 
)KK 
;KK 
}LL 
}MM 
privateOO 
staticOO	 
voidOO 
RunTestCWE1OO  
(OO  !
)OO! "
{OO# $
}SS 
privateUU 
staticUU	 
voidUU 
RunTestCWE2UU  
(UU  !
)UU! "
{UU# $
}YY 
private[[ 
static[[	 
void[[ 
RunTestCWE3[[  
([[  !
)[[! "
{[[# $
}__ 
privateaa 
staticaa	 
voidaa 
RunTestCWE4aa  
(aa  !
)aa! "
{aa# $
(cc 
newcc K
?CWE404_Improper_Resource_Shutdown__console_InputStreamReader_01cc G
(ccG H
)ccH I
)ccI J
.ccJ K
RunTestccK R
(ccR S
$str	ccS 
)
cc 
;
cc 
(dd 
newdd ?
3CWE404_Improper_Resource_Shutdown__db_Connection_01dd ;
(dd; <
)dd< =
)dd= >
.dd> ?
RunTestdd? F
(ddF G
$strddG |
)dd| }
;dd} ~
(ee 
newee <
0CWE404_Improper_Resource_Shutdown__FileReader_01ee 8
(ee8 9
)ee9 :
)ee: ;
.ee; <
RunTestee< C
(eeC D
$streeD v
)eev w
;eew x
(ff 
newff D
8CWE404_Improper_Resource_Shutdown__Object_Lock_Thread_01ff @
(ff@ A
)ffA B
)ffB C
.ffC D
RunTestffD K
(ffK L
$str	ffL 
)
ff 
;
ff 
}hh 
privatejj 
staticjj	 
voidjj 
RunTestCWE5jj  
(jj  !
)jj! "
{jj# $
}nn 
privatepp 
staticpp	 
voidpp 
RunTestCWE6pp  
(pp  !
)pp! "
{pp# $
}tt 
privatevv 
staticvv	 
voidvv 
RunTestCWE7vv  
(vv  !
)vv! "
{vv# $
}zz 
private|| 
static||	 
void|| 
RunTestCWE8||  
(||  !
)||! "
{||# $
}
 
private
 
static
	 
void
 
RunTestCWE9
  
(
  !
)
! "
{
# $
}
 
} 
} Ä
C:\Users\CyberDiver\Documents\SAST Benchmarking\Juliet_Test_Suite_v1.3_for_C#\src\testcases\CWE404_Improper_Resource_Shutdown\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str <
)< =
]= >
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str >
)> ?
]? @
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *