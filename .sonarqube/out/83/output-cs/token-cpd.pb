˜X
ñC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__hostname_based_logic_01.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 4
(CWE510_Trapdoor__hostname_based_logic_01 .
:/ 0
AbstractTestCase1 A
{ 
public 

override 
void 
Bad 
( 
) 
{ 
TcpListener 
listener 
= 
null #
;# $
	TcpClient   
tcpConn   
=   
null    
;    !
Stream!! 
streamOutput!! 
=!! 
null!! "
;!!" #
int"" 
port"" 
="" 
$num"" 
;"" 
try## 
{$$ 	
listener%% 
=%% 
new%% 
TcpListener%% &
(%%& '
	IPAddress%%' 0
.%%0 1
Parse%%1 6
(%%6 7
$str%%7 C
)%%C D
,%%D E
port%%F J
)%%J K
;%%K L
listener&& 
.&& 
Start&& 
(&& 
)&& 
;&& 
tcpConn'' 
='' 
listener'' 
.'' 
AcceptTcpClient'' .
(''. /
)''/ 0
;''0 1

IPEndPoint)) 
endPoint)) 
=))  !
())" #

IPEndPoint))# -
)))- .
tcpConn)). 5
.))5 6
Client))6 <
.))< =
RemoteEndPoint))= K
;))K L
	IPAddress** 
	ipAddress** 
=**  !
endPoint**" *
.*** +
Address**+ 2
;**2 3
IPHostEntry++ 
	hostEntry++ !
=++" #
Dns++$ '
.++' (
GetHostEntry++( 4
(++4 5
	ipAddress++5 >
)++> ?
;++? @
if,, 
(,, 
	hostEntry,, 
.,, 
HostName,, "
.,," #
Equals,,# )
(,,) *
$str,,* <
),,< =
),,= >
{-- 
streamOutput.. 
=.. 
tcpConn.. &
...& '
	GetStream..' 0
(..0 1
)..1 2
;..2 3
streamOutput// 
.// 
Write// "
(//" #
Encoding//# +
.//+ ,
UTF8//, 0
.//0 1
GetBytes//1 9
(//9 :
$str//: K
)//K L
,//L M
$num//N O
,//O P
$str//Q b
.//b c
Length//c i
)//i j
;//j k
}00 
else11 
{22 
streamOutput33 
=33 
tcpConn33 &
.33& '
	GetStream33' 0
(330 1
)331 2
;332 3
streamOutput44 
.44 
Write44 "
(44" #
Encoding44# +
.44+ ,
UTF844, 0
.440 1
GetBytes441 9
(449 :
$str44: J
)44J K
,44K L
$num44M N
,44N O
$str44P `
.44` a
Length44a g
)44g h
;44h i
}55 
}66 	
catch77 
(77 
IOException77 
exceptIO77 #
)77# $
{88 	
IO99 
.99 
Logger99 
.99 
Log99 
(99 
NLog99 
.99 
LogLevel99 '
.99' (
Warn99( ,
,99, -
exceptIO99. 6
,996 7
$str998 T
+99U V
port99W [
.99[ \
ToString99\ d
(99d e
)99e f
)99f g
;99g h
}:: 	
finally;; 
{<< 	
try== 
{>> 
if?? 
(?? 
streamOutput??  
!=??! #
null??$ (
)??( )
{@@ 
streamOutputAA  
.AA  !
CloseAA! &
(AA& '
)AA' (
;AA( )
}BB 
}CC 
catchDD 
(DD 
IOExceptionDD 
exceptIODD '
)DD' (
{EE 
IOFF 
.FF 
LoggerFF 
.FF 
LogFF 
(FF 
NLogFF "
.FF" #
LogLevelFF# +
.FF+ ,
WarnFF, 0
,FF0 1
exceptIOFF2 :
,FF: ;
$strFF< S
)FFS T
;FFT U
}GG 
tryII 
{JJ 
ifKK 
(KK 
tcpConnKK 
!=KK 
nullKK #
)KK# $
{LL 
tcpConnMM 
.MM 
CloseMM !
(MM! "
)MM" #
;MM# $
}NN 
}OO 
catchPP 
(PP 
IOExceptionPP 
exceptIOPP '
)PP' (
{QQ 
IORR 
.RR 
LoggerRR 
.RR 
LogRR 
(RR 
NLogRR "
.RR" #
LogLevelRR# +
.RR+ ,
WarnRR, 0
,RR0 1
exceptIORR2 :
,RR: ;
$strRR< S
)RRS T
;RRT U
}SS 
tryUU 
{VV 
ifWW 
(WW 
listenerWW 
!=WW 
nullWW  $
)WW$ %
{XX 
listenerYY 
.YY 
StopYY !
(YY! "
)YY" #
;YY# $
}ZZ 
}[[ 
catch\\ 
(\\ 
IOException\\ 
exceptIO\\ '
)\\' (
{]] 
IO^^ 
.^^ 
Logger^^ 
.^^ 
Log^^ 
(^^ 
NLog^^ "
.^^" #
LogLevel^^# +
.^^+ ,
Warn^^, 0
,^^0 1
exceptIO^^2 :
,^^: ;
$str^^< S
)^^S T
;^^T U
}__ 
}aa 	
}bb 
publicee 

overrideee 
voidee 
Goodee 
(ee 
)ee 
{ff 
Good1gg 
(gg 
)gg 
;gg 
}hh 
privatejj 
voidjj 
Good1jj 
(jj 
)jj 
{kk 
TcpListenerll 
listenerll 
=ll 
nullll #
;ll# $
	TcpClientmm 
tcpConnmm 
=mm 
nullmm  
;mm  !
Streamnn 
streamOutputnn 
=nn 
nullnn "
;nn" #
intoo 
portoo 
=oo 
$numoo 
;oo 
trypp 
{qq 	
listenerrr 
=rr 
newrr 
TcpListenerrr &
(rr& '
	IPAddressrr' 0
.rr0 1
Parserr1 6
(rr6 7
$strrr7 C
)rrC D
,rrD E
portrrF J
)rrJ K
;rrK L
listenerss 
.ss 
Startss 
(ss 
)ss 
;ss 
tcpConntt 
=tt 
listenertt 
.tt 
AcceptTcpClienttt .
(tt. /
)tt/ 0
;tt0 1
streamOutputuu 
=uu 
tcpConnuu "
.uu" #
	GetStreamuu# ,
(uu, -
)uu- .
;uu. /

IPEndPointvv 
endPointvv 
=vv  !
(vv" #

IPEndPointvv# -
)vv- .
tcpConnvv. 5
.vv5 6
Clientvv6 <
.vv< =
RemoteEndPointvv= K
;vvK L
	IPAddressww 
	ipAddressww 
=ww  !
endPointww" *
.ww* +
Addressww+ 2
;ww2 3
IPHostEntryxx 
	hostEntryxx !
=xx" #
Dnsxx$ '
.xx' (
GetHostEntryxx( 4
(xx4 5
	ipAddressxx5 >
)xx> ?
;xx? @
streamOutputzz 
.zz 
Writezz 
(zz 
Encodingzz '
.zz' (
UTF8zz( ,
.zz, -
GetByteszz- 5
(zz5 6
(zz6 7
$strzz7 B
+zzC D
	hostEntryzzE N
.zzN O
ToStringzzO W
(zzW X
)zzX Y
)zzY Z
)zzZ [
,zz[ \
$numzz] ^
,zz^ _
(zz` a
$strzza l
+zzm n
	hostEntryzzo x
.zzx y
ToString	zzy Å
(
zzÅ Ç
)
zzÇ É
)
zzÉ Ñ
.
zzÑ Ö
Length
zzÖ ã
)
zzã å
;
zzå ç
}{{ 	
catch|| 
(|| 
IOException|| 
exceptIO|| #
)||# $
{}} 	
IO~~ 
.~~ 
Logger~~ 
.~~ 
Log~~ 
(~~ 
NLog~~ 
.~~ 
LogLevel~~ '
.~~' (
Warn~~( ,
,~~, -
exceptIO~~. 6
,~~6 7
$str~~8 T
+~~U V
port~~W [
.~~[ \
ToString~~\ d
(~~d e
)~~e f
)~~f g
;~~g h
} 	
finally
ÄÄ 
{
ÅÅ 	
try
ÇÇ 
{
ÉÉ 
if
ÑÑ 
(
ÑÑ 
streamOutput
ÑÑ  
!=
ÑÑ! #
null
ÑÑ$ (
)
ÑÑ( )
{
ÖÖ 
streamOutput
ÜÜ  
.
ÜÜ  !
Close
ÜÜ! &
(
ÜÜ& '
)
ÜÜ' (
;
ÜÜ( )
}
áá 
}
àà 
catch
ââ 
(
ââ 
IOException
ââ 
exceptIO
ââ '
)
ââ' (
{
ää 
IO
ãã 
.
ãã 
Logger
ãã 
.
ãã 
Log
ãã 
(
ãã 
NLog
ãã "
.
ãã" #
LogLevel
ãã# +
.
ãã+ ,
Warn
ãã, 0
,
ãã0 1
exceptIO
ãã2 :
,
ãã: ;
$str
ãã< S
)
ããS T
;
ããT U
}
åå 
try
éé 
{
èè 
if
êê 
(
êê 
tcpConn
êê 
!=
êê 
null
êê #
)
êê# $
{
ëë 
tcpConn
íí 
.
íí 
Close
íí !
(
íí! "
)
íí" #
;
íí# $
}
ìì 
}
îî 
catch
ïï 
(
ïï 
IOException
ïï 
exceptIO
ïï '
)
ïï' (
{
ññ 
IO
óó 
.
óó 
Logger
óó 
.
óó 
Log
óó 
(
óó 
NLog
óó "
.
óó" #
LogLevel
óó# +
.
óó+ ,
Warn
óó, 0
,
óó0 1
exceptIO
óó2 :
,
óó: ;
$str
óó< S
)
óóS T
;
óóT U
}
òò 
try
öö 
{
õõ 
if
úú 
(
úú 
listener
úú 
!=
úú 
null
úú  $
)
úú$ %
{
ùù 
listener
ûû 
.
ûû 
Stop
ûû !
(
ûû! "
)
ûû" #
;
ûû# $
}
üü 
}
†† 
catch
°° 
(
°° 
IOException
°° 
exceptIO
°° '
)
°°' (
{
¢¢ 
IO
££ 
.
££ 
Logger
££ 
.
££ 
Log
££ 
(
££ 
NLog
££ "
.
££" #
LogLevel
££# +
.
££+ ,
Warn
££, 0
,
££0 1
exceptIO
££2 :
,
££: ;
$str
££< S
)
££S T
;
££T U
}
§§ 
}
¶¶ 	
}
ßß 
}©© 
}™™ ˛â
ñC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__hostname_based_logic_02.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 4
(CWE510_Trapdoor__hostname_based_logic_02 .
:/ 0
AbstractTestCase1 A
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
true 
) 
{   	
TcpListener!! 
listener!!  
=!!! "
null!!# '
;!!' (
	TcpClient"" 
tcpConn"" 
="" 
null""  $
;""$ %
Stream## 
streamOutput## 
=##  !
null##" &
;##& '
int$$ 
port$$ 
=$$ 
$num$$ 
;$$ 
try%% 
{&& 
listener'' 
='' 
new'' 
TcpListener'' *
(''* +
	IPAddress''+ 4
.''4 5
Parse''5 :
('': ;
$str''; G
)''G H
,''H I
port''J N
)''N O
;''O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
tcpConn)) 
=)) 
listener)) "
.))" #
AcceptTcpClient))# 2
())2 3
)))3 4
;))4 5

IPEndPoint++ 
endPoint++ #
=++$ %
(++& '

IPEndPoint++' 1
)++1 2
tcpConn++2 9
.++9 :
Client++: @
.++@ A
RemoteEndPoint++A O
;++O P
	IPAddress,, 
	ipAddress,, #
=,,$ %
endPoint,,& .
.,,. /
Address,,/ 6
;,,6 7
IPHostEntry-- 
	hostEntry-- %
=--& '
Dns--( +
.--+ ,
GetHostEntry--, 8
(--8 9
	ipAddress--9 B
)--B C
;--C D
if.. 
(.. 
	hostEntry.. 
... 
HostName.. &
...& '
Equals..' -
(..- .
$str... @
)..@ A
)..A B
{// 
streamOutput00  
=00! "
tcpConn00# *
.00* +
	GetStream00+ 4
(004 5
)005 6
;006 7
streamOutput11  
.11  !
Write11! &
(11& '
Encoding11' /
.11/ 0
UTF8110 4
.114 5
GetBytes115 =
(11= >
$str11> O
)11O P
,11P Q
$num11R S
,11S T
$str11U f
.11f g
Length11g m
)11m n
;11n o
}22 
else33 
{44 
streamOutput55  
=55! "
tcpConn55# *
.55* +
	GetStream55+ 4
(554 5
)555 6
;556 7
streamOutput66  
.66  !
Write66! &
(66& '
Encoding66' /
.66/ 0
UTF8660 4
.664 5
GetBytes665 =
(66= >
$str66> N
)66N O
,66O P
$num66Q R
,66R S
$str66T d
.66d e
Length66e k
)66k l
;66l m
}77 
}88 
catch99 
(99 
IOException99 
exceptIO99 '
)99' (
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; 
(;; 
NLog;; "
.;;" #
LogLevel;;# +
.;;+ ,
Warn;;, 0
,;;0 1
exceptIO;;2 :
,;;: ;
$str;;< X
+;;Y Z
port;;[ _
.;;_ `
ToString;;` h
(;;h i
);;i j
);;j k
;;;k l
}<< 
finally== 
{>> 
try?? 
{@@ 
ifAA 
(AA 
streamOutputAA $
!=AA% '
nullAA( ,
)AA, -
{BB 
streamOutputCC $
.CC$ %
CloseCC% *
(CC* +
)CC+ ,
;CC, -
}DD 
}EE 
catchFF 
(FF 
IOExceptionFF "
exceptIOFF# +
)FF+ ,
{GG 
IOHH 
.HH 
LoggerHH 
.HH 
LogHH !
(HH! "
NLogHH" &
.HH& '
LogLevelHH' /
.HH/ 0
WarnHH0 4
,HH4 5
exceptIOHH6 >
,HH> ?
$strHH@ W
)HHW X
;HHX Y
}II 
tryKK 
{LL 
ifMM 
(MM 
tcpConnMM 
!=MM  "
nullMM# '
)MM' (
{NN 
tcpConnOO 
.OO  
CloseOO  %
(OO% &
)OO& '
;OO' (
}PP 
}QQ 
catchRR 
(RR 
IOExceptionRR "
exceptIORR# +
)RR+ ,
{SS 
IOTT 
.TT 
LoggerTT 
.TT 
LogTT !
(TT! "
NLogTT" &
.TT& '
LogLevelTT' /
.TT/ 0
WarnTT0 4
,TT4 5
exceptIOTT6 >
,TT> ?
$strTT@ W
)TTW X
;TTX Y
}UU 
tryWW 
{XX 
ifYY 
(YY 
listenerYY  
!=YY! #
nullYY$ (
)YY( )
{ZZ 
listener[[  
.[[  !
Stop[[! %
([[% &
)[[& '
;[[' (
}\\ 
}]] 
catch^^ 
(^^ 
IOException^^ "
exceptIO^^# +
)^^+ ,
{__ 
IO`` 
.`` 
Logger`` 
.`` 
Log`` !
(``! "
NLog``" &
.``& '
LogLevel``' /
.``/ 0
Warn``0 4
,``4 5
exceptIO``6 >
,``> ?
$str``@ W
)``W X
;``X Y
}aa 
}cc 
}dd 	
}ee 
privateii 
voidii 
Good1ii 
(ii 
)ii 
{jj 
ifkk 

(kk 
falsekk 
)kk 
{ll 	
IOnn 
.nn 
	WriteLinenn 
(nn 
$strnn /
)nn/ 0
;nn0 1
}oo 	
elsepp 
{qq 	
TcpListenerrr 
listenerrr  
=rr! "
nullrr# '
;rr' (
	TcpClientss 
tcpConnss 
=ss 
nullss  $
;ss$ %
Streamtt 
streamOutputtt 
=tt  !
nulltt" &
;tt& '
intuu 
portuu 
=uu 
$numuu 
;uu 
tryvv 
{ww 
listenerxx 
=xx 
newxx 
TcpListenerxx *
(xx* +
	IPAddressxx+ 4
.xx4 5
Parsexx5 :
(xx: ;
$strxx; G
)xxG H
,xxH I
portxxJ N
)xxN O
;xxO P
listeneryy 
.yy 
Startyy 
(yy 
)yy  
;yy  !
tcpConnzz 
=zz 
listenerzz "
.zz" #
AcceptTcpClientzz# 2
(zz2 3
)zz3 4
;zz4 5
streamOutput{{ 
={{ 
tcpConn{{ &
.{{& '
	GetStream{{' 0
({{0 1
){{1 2
;{{2 3

IPEndPoint|| 
endPoint|| #
=||$ %
(||& '

IPEndPoint||' 1
)||1 2
tcpConn||2 9
.||9 :
Client||: @
.||@ A
RemoteEndPoint||A O
;||O P
	IPAddress}} 
	ipAddress}} #
=}}$ %
endPoint}}& .
.}}. /
Address}}/ 6
;}}6 7
IPHostEntry~~ 
	hostEntry~~ %
=~~& '
Dns~~( +
.~~+ ,
GetHostEntry~~, 8
(~~8 9
	ipAddress~~9 B
)~~B C
;~~C D
streamOutput
ÄÄ 
.
ÄÄ 
Write
ÄÄ "
(
ÄÄ" #
Encoding
ÄÄ# +
.
ÄÄ+ ,
UTF8
ÄÄ, 0
.
ÄÄ0 1
GetBytes
ÄÄ1 9
(
ÄÄ9 :
(
ÄÄ: ;
$str
ÄÄ; F
+
ÄÄG H
	hostEntry
ÄÄI R
.
ÄÄR S
ToString
ÄÄS [
(
ÄÄ[ \
)
ÄÄ\ ]
)
ÄÄ] ^
)
ÄÄ^ _
,
ÄÄ_ `
$num
ÄÄa b
,
ÄÄb c
(
ÄÄd e
$str
ÄÄe p
+
ÄÄq r
	hostEntry
ÄÄs |
.
ÄÄ| }
ToStringÄÄ} Ö
(ÄÄÖ Ü
)ÄÄÜ á
)ÄÄá à
.ÄÄà â
LengthÄÄâ è
)ÄÄè ê
;ÄÄê ë
}
ÅÅ 
catch
ÇÇ 
(
ÇÇ 
IOException
ÇÇ 
exceptIO
ÇÇ '
)
ÇÇ' (
{
ÉÉ 
IO
ÑÑ 
.
ÑÑ 
Logger
ÑÑ 
.
ÑÑ 
Log
ÑÑ 
(
ÑÑ 
NLog
ÑÑ "
.
ÑÑ" #
LogLevel
ÑÑ# +
.
ÑÑ+ ,
Warn
ÑÑ, 0
,
ÑÑ0 1
exceptIO
ÑÑ2 :
,
ÑÑ: ;
$str
ÑÑ< X
+
ÑÑY Z
port
ÑÑ[ _
.
ÑÑ_ `
ToString
ÑÑ` h
(
ÑÑh i
)
ÑÑi j
)
ÑÑj k
;
ÑÑk l
}
ÖÖ 
finally
ÜÜ 
{
áá 
try
àà 
{
ââ 
if
ää 
(
ää 
streamOutput
ää $
!=
ää% '
null
ää( ,
)
ää, -
{
ãã 
streamOutput
åå $
.
åå$ %
Close
åå% *
(
åå* +
)
åå+ ,
;
åå, -
}
çç 
}
éé 
catch
èè 
(
èè 
IOException
èè "
exceptIO
èè# +
)
èè+ ,
{
êê 
IO
ëë 
.
ëë 
Logger
ëë 
.
ëë 
Log
ëë !
(
ëë! "
NLog
ëë" &
.
ëë& '
LogLevel
ëë' /
.
ëë/ 0
Warn
ëë0 4
,
ëë4 5
exceptIO
ëë6 >
,
ëë> ?
$str
ëë@ W
)
ëëW X
;
ëëX Y
}
íí 
try
îî 
{
ïï 
if
ññ 
(
ññ 
tcpConn
ññ 
!=
ññ  "
null
ññ# '
)
ññ' (
{
óó 
tcpConn
òò 
.
òò  
Close
òò  %
(
òò% &
)
òò& '
;
òò' (
}
ôô 
}
öö 
catch
õõ 
(
õõ 
IOException
õõ "
exceptIO
õõ# +
)
õõ+ ,
{
úú 
IO
ùù 
.
ùù 
Logger
ùù 
.
ùù 
Log
ùù !
(
ùù! "
NLog
ùù" &
.
ùù& '
LogLevel
ùù' /
.
ùù/ 0
Warn
ùù0 4
,
ùù4 5
exceptIO
ùù6 >
,
ùù> ?
$str
ùù@ W
)
ùùW X
;
ùùX Y
}
ûû 
try
†† 
{
°° 
if
¢¢ 
(
¢¢ 
listener
¢¢  
!=
¢¢! #
null
¢¢$ (
)
¢¢( )
{
££ 
listener
§§  
.
§§  !
Stop
§§! %
(
§§% &
)
§§& '
;
§§' (
}
•• 
}
¶¶ 
catch
ßß 
(
ßß 
IOException
ßß "
exceptIO
ßß# +
)
ßß+ ,
{
®® 
IO
©© 
.
©© 
Logger
©© 
.
©© 
Log
©© !
(
©©! "
NLog
©©" &
.
©©& '
LogLevel
©©' /
.
©©/ 0
Warn
©©0 4
,
©©4 5
exceptIO
©©6 >
,
©©> ?
$str
©©@ W
)
©©W X
;
©©X Y
}
™™ 
}
¨¨ 
}
≠≠ 	
}
ÆÆ 
private
±± 
void
±± 
Good2
±± 
(
±± 
)
±± 
{
≤≤ 
if
≥≥ 

(
≥≥ 
true
≥≥ 
)
≥≥ 
{
¥¥ 	
TcpListener
µµ 
listener
µµ  
=
µµ! "
null
µµ# '
;
µµ' (
	TcpClient
∂∂ 
tcpConn
∂∂ 
=
∂∂ 
null
∂∂  $
;
∂∂$ %
Stream
∑∑ 
streamOutput
∑∑ 
=
∑∑  !
null
∑∑" &
;
∑∑& '
int
∏∏ 
port
∏∏ 
=
∏∏ 
$num
∏∏ 
;
∏∏ 
try
ππ 
{
∫∫ 
listener
ªª 
=
ªª 
new
ªª 
TcpListener
ªª *
(
ªª* +
	IPAddress
ªª+ 4
.
ªª4 5
Parse
ªª5 :
(
ªª: ;
$str
ªª; G
)
ªªG H
,
ªªH I
port
ªªJ N
)
ªªN O
;
ªªO P
listener
ºº 
.
ºº 
Start
ºº 
(
ºº 
)
ºº  
;
ºº  !
tcpConn
ΩΩ 
=
ΩΩ 
listener
ΩΩ "
.
ΩΩ" #
AcceptTcpClient
ΩΩ# 2
(
ΩΩ2 3
)
ΩΩ3 4
;
ΩΩ4 5
streamOutput
ææ 
=
ææ 
tcpConn
ææ &
.
ææ& '
	GetStream
ææ' 0
(
ææ0 1
)
ææ1 2
;
ææ2 3

IPEndPoint
øø 
endPoint
øø #
=
øø$ %
(
øø& '

IPEndPoint
øø' 1
)
øø1 2
tcpConn
øø2 9
.
øø9 :
Client
øø: @
.
øø@ A
RemoteEndPoint
øøA O
;
øøO P
	IPAddress
¿¿ 
	ipAddress
¿¿ #
=
¿¿$ %
endPoint
¿¿& .
.
¿¿. /
Address
¿¿/ 6
;
¿¿6 7
IPHostEntry
¡¡ 
	hostEntry
¡¡ %
=
¡¡& '
Dns
¡¡( +
.
¡¡+ ,
GetHostEntry
¡¡, 8
(
¡¡8 9
	ipAddress
¡¡9 B
)
¡¡B C
;
¡¡C D
streamOutput
√√ 
.
√√ 
Write
√√ "
(
√√" #
Encoding
√√# +
.
√√+ ,
UTF8
√√, 0
.
√√0 1
GetBytes
√√1 9
(
√√9 :
(
√√: ;
$str
√√; F
+
√√G H
	hostEntry
√√I R
.
√√R S
ToString
√√S [
(
√√[ \
)
√√\ ]
)
√√] ^
)
√√^ _
,
√√_ `
$num
√√a b
,
√√b c
(
√√d e
$str
√√e p
+
√√q r
	hostEntry
√√s |
.
√√| }
ToString√√} Ö
(√√Ö Ü
)√√Ü á
)√√á à
.√√à â
Length√√â è
)√√è ê
;√√ê ë
}
ƒƒ 
catch
≈≈ 
(
≈≈ 
IOException
≈≈ 
exceptIO
≈≈ '
)
≈≈' (
{
∆∆ 
IO
«« 
.
«« 
Logger
«« 
.
«« 
Log
«« 
(
«« 
NLog
«« "
.
««" #
LogLevel
««# +
.
««+ ,
Warn
««, 0
,
««0 1
exceptIO
««2 :
,
««: ;
$str
««< X
+
««Y Z
port
««[ _
.
««_ `
ToString
««` h
(
««h i
)
««i j
)
««j k
;
««k l
}
»» 
finally
…… 
{
   
try
ÀÀ 
{
ÃÃ 
if
ÕÕ 
(
ÕÕ 
streamOutput
ÕÕ $
!=
ÕÕ% '
null
ÕÕ( ,
)
ÕÕ, -
{
ŒŒ 
streamOutput
œœ $
.
œœ$ %
Close
œœ% *
(
œœ* +
)
œœ+ ,
;
œœ, -
}
–– 
}
—— 
catch
““ 
(
““ 
IOException
““ "
exceptIO
““# +
)
““+ ,
{
”” 
IO
‘‘ 
.
‘‘ 
Logger
‘‘ 
.
‘‘ 
Log
‘‘ !
(
‘‘! "
NLog
‘‘" &
.
‘‘& '
LogLevel
‘‘' /
.
‘‘/ 0
Warn
‘‘0 4
,
‘‘4 5
exceptIO
‘‘6 >
,
‘‘> ?
$str
‘‘@ W
)
‘‘W X
;
‘‘X Y
}
’’ 
try
◊◊ 
{
ÿÿ 
if
ŸŸ 
(
ŸŸ 
tcpConn
ŸŸ 
!=
ŸŸ  "
null
ŸŸ# '
)
ŸŸ' (
{
⁄⁄ 
tcpConn
€€ 
.
€€  
Close
€€  %
(
€€% &
)
€€& '
;
€€' (
}
‹‹ 
}
›› 
catch
ﬁﬁ 
(
ﬁﬁ 
IOException
ﬁﬁ "
exceptIO
ﬁﬁ# +
)
ﬁﬁ+ ,
{
ﬂﬂ 
IO
‡‡ 
.
‡‡ 
Logger
‡‡ 
.
‡‡ 
Log
‡‡ !
(
‡‡! "
NLog
‡‡" &
.
‡‡& '
LogLevel
‡‡' /
.
‡‡/ 0
Warn
‡‡0 4
,
‡‡4 5
exceptIO
‡‡6 >
,
‡‡> ?
$str
‡‡@ W
)
‡‡W X
;
‡‡X Y
}
·· 
try
„„ 
{
‰‰ 
if
ÂÂ 
(
ÂÂ 
listener
ÂÂ  
!=
ÂÂ! #
null
ÂÂ$ (
)
ÂÂ( )
{
ÊÊ 
listener
ÁÁ  
.
ÁÁ  !
Stop
ÁÁ! %
(
ÁÁ% &
)
ÁÁ& '
;
ÁÁ' (
}
ËË 
}
ÈÈ 
catch
ÍÍ 
(
ÍÍ 
IOException
ÍÍ "
exceptIO
ÍÍ# +
)
ÍÍ+ ,
{
ÎÎ 
IO
ÏÏ 
.
ÏÏ 
Logger
ÏÏ 
.
ÏÏ 
Log
ÏÏ !
(
ÏÏ! "
NLog
ÏÏ" &
.
ÏÏ& '
LogLevel
ÏÏ' /
.
ÏÏ/ 0
Warn
ÏÏ0 4
,
ÏÏ4 5
exceptIO
ÏÏ6 >
,
ÏÏ> ?
$str
ÏÏ@ W
)
ÏÏW X
;
ÏÏX Y
}
ÌÌ 
}
ÔÔ 
}
 	
}
ÒÒ 
public
ÛÛ 

override
ÛÛ 
void
ÛÛ 
Good
ÛÛ 
(
ÛÛ 
)
ÛÛ 
{
ÙÙ 
Good1
ıı 
(
ıı 
)
ıı 
;
ıı 
Good2
ˆˆ 
(
ˆˆ 
)
ˆˆ 
;
ˆˆ 
}
˜˜ 
}˘˘ 
}˙˙ Áä
ñC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__hostname_based_logic_03.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 4
(CWE510_Trapdoor__hostname_based_logic_03 .
:/ 0
AbstractTestCase1 A
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
$num 
== 
$num 
) 
{   	
TcpListener!! 
listener!!  
=!!! "
null!!# '
;!!' (
	TcpClient"" 
tcpConn"" 
="" 
null""  $
;""$ %
Stream## 
streamOutput## 
=##  !
null##" &
;##& '
int$$ 
port$$ 
=$$ 
$num$$ 
;$$ 
try%% 
{&& 
listener'' 
='' 
new'' 
TcpListener'' *
(''* +
	IPAddress''+ 4
.''4 5
Parse''5 :
('': ;
$str''; G
)''G H
,''H I
port''J N
)''N O
;''O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
tcpConn)) 
=)) 
listener)) "
.))" #
AcceptTcpClient))# 2
())2 3
)))3 4
;))4 5

IPEndPoint++ 
endPoint++ #
=++$ %
(++& '

IPEndPoint++' 1
)++1 2
tcpConn++2 9
.++9 :
Client++: @
.++@ A
RemoteEndPoint++A O
;++O P
	IPAddress,, 
	ipAddress,, #
=,,$ %
endPoint,,& .
.,,. /
Address,,/ 6
;,,6 7
IPHostEntry-- 
	hostEntry-- %
=--& '
Dns--( +
.--+ ,
GetHostEntry--, 8
(--8 9
	ipAddress--9 B
)--B C
;--C D
if.. 
(.. 
	hostEntry.. 
... 
HostName.. &
...& '
Equals..' -
(..- .
$str... @
)..@ A
)..A B
{// 
streamOutput00  
=00! "
tcpConn00# *
.00* +
	GetStream00+ 4
(004 5
)005 6
;006 7
streamOutput11  
.11  !
Write11! &
(11& '
Encoding11' /
.11/ 0
UTF8110 4
.114 5
GetBytes115 =
(11= >
$str11> O
)11O P
,11P Q
$num11R S
,11S T
$str11U f
.11f g
Length11g m
)11m n
;11n o
}22 
else33 
{44 
streamOutput55  
=55! "
tcpConn55# *
.55* +
	GetStream55+ 4
(554 5
)555 6
;556 7
streamOutput66  
.66  !
Write66! &
(66& '
Encoding66' /
.66/ 0
UTF8660 4
.664 5
GetBytes665 =
(66= >
$str66> N
)66N O
,66O P
$num66Q R
,66R S
$str66T d
.66d e
Length66e k
)66k l
;66l m
}77 
}88 
catch99 
(99 
IOException99 
exceptIO99 '
)99' (
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; 
(;; 
NLog;; "
.;;" #
LogLevel;;# +
.;;+ ,
Warn;;, 0
,;;0 1
exceptIO;;2 :
,;;: ;
$str;;< X
+;;Y Z
port;;[ _
.;;_ `
ToString;;` h
(;;h i
);;i j
);;j k
;;;k l
}<< 
finally== 
{>> 
try?? 
{@@ 
ifAA 
(AA 
streamOutputAA $
!=AA% '
nullAA( ,
)AA, -
{BB 
streamOutputCC $
.CC$ %
CloseCC% *
(CC* +
)CC+ ,
;CC, -
}DD 
}EE 
catchFF 
(FF 
IOExceptionFF "
exceptIOFF# +
)FF+ ,
{GG 
IOHH 
.HH 
LoggerHH 
.HH 
LogHH !
(HH! "
NLogHH" &
.HH& '
LogLevelHH' /
.HH/ 0
WarnHH0 4
,HH4 5
exceptIOHH6 >
,HH> ?
$strHH@ W
)HHW X
;HHX Y
}II 
tryKK 
{LL 
ifMM 
(MM 
tcpConnMM 
!=MM  "
nullMM# '
)MM' (
{NN 
tcpConnOO 
.OO  
CloseOO  %
(OO% &
)OO& '
;OO' (
}PP 
}QQ 
catchRR 
(RR 
IOExceptionRR "
exceptIORR# +
)RR+ ,
{SS 
IOTT 
.TT 
LoggerTT 
.TT 
LogTT !
(TT! "
NLogTT" &
.TT& '
LogLevelTT' /
.TT/ 0
WarnTT0 4
,TT4 5
exceptIOTT6 >
,TT> ?
$strTT@ W
)TTW X
;TTX Y
}UU 
tryWW 
{XX 
ifYY 
(YY 
listenerYY  
!=YY! #
nullYY$ (
)YY( )
{ZZ 
listener[[  
.[[  !
Stop[[! %
([[% &
)[[& '
;[[' (
}\\ 
}]] 
catch^^ 
(^^ 
IOException^^ "
exceptIO^^# +
)^^+ ,
{__ 
IO`` 
.`` 
Logger`` 
.`` 
Log`` !
(``! "
NLog``" &
.``& '
LogLevel``' /
.``/ 0
Warn``0 4
,``4 5
exceptIO``6 >
,``> ?
$str``@ W
)``W X
;``X Y
}aa 
}cc 
}dd 	
}ee 
privateii 
voidii 
Good1ii 
(ii 
)ii 
{jj 
ifkk 

(kk 
$numkk 
!=kk 
$numkk 
)kk 
{ll 	
IOnn 
.nn 
	WriteLinenn 
(nn 
$strnn /
)nn/ 0
;nn0 1
}oo 	
elsepp 
{qq 	
TcpListenerrr 
listenerrr  
=rr! "
nullrr# '
;rr' (
	TcpClientss 
tcpConnss 
=ss 
nullss  $
;ss$ %
Streamtt 
streamOutputtt 
=tt  !
nulltt" &
;tt& '
intuu 
portuu 
=uu 
$numuu 
;uu 
tryvv 
{ww 
listenerxx 
=xx 
newxx 
TcpListenerxx *
(xx* +
	IPAddressxx+ 4
.xx4 5
Parsexx5 :
(xx: ;
$strxx; G
)xxG H
,xxH I
portxxJ N
)xxN O
;xxO P
listeneryy 
.yy 
Startyy 
(yy 
)yy  
;yy  !
tcpConnzz 
=zz 
listenerzz "
.zz" #
AcceptTcpClientzz# 2
(zz2 3
)zz3 4
;zz4 5
streamOutput{{ 
={{ 
tcpConn{{ &
.{{& '
	GetStream{{' 0
({{0 1
){{1 2
;{{2 3

IPEndPoint|| 
endPoint|| #
=||$ %
(||& '

IPEndPoint||' 1
)||1 2
tcpConn||2 9
.||9 :
Client||: @
.||@ A
RemoteEndPoint||A O
;||O P
	IPAddress}} 
	ipAddress}} #
=}}$ %
endPoint}}& .
.}}. /
Address}}/ 6
;}}6 7
IPHostEntry~~ 
	hostEntry~~ %
=~~& '
Dns~~( +
.~~+ ,
GetHostEntry~~, 8
(~~8 9
	ipAddress~~9 B
)~~B C
;~~C D
streamOutput
ÄÄ 
.
ÄÄ 
Write
ÄÄ "
(
ÄÄ" #
Encoding
ÄÄ# +
.
ÄÄ+ ,
UTF8
ÄÄ, 0
.
ÄÄ0 1
GetBytes
ÄÄ1 9
(
ÄÄ9 :
(
ÄÄ: ;
$str
ÄÄ; F
+
ÄÄG H
	hostEntry
ÄÄI R
.
ÄÄR S
ToString
ÄÄS [
(
ÄÄ[ \
)
ÄÄ\ ]
)
ÄÄ] ^
)
ÄÄ^ _
,
ÄÄ_ `
$num
ÄÄa b
,
ÄÄb c
(
ÄÄd e
$str
ÄÄe p
+
ÄÄq r
	hostEntry
ÄÄs |
.
ÄÄ| }
ToStringÄÄ} Ö
(ÄÄÖ Ü
)ÄÄÜ á
)ÄÄá à
.ÄÄà â
LengthÄÄâ è
)ÄÄè ê
;ÄÄê ë
}
ÅÅ 
catch
ÇÇ 
(
ÇÇ 
IOException
ÇÇ 
exceptIO
ÇÇ '
)
ÇÇ' (
{
ÉÉ 
IO
ÑÑ 
.
ÑÑ 
Logger
ÑÑ 
.
ÑÑ 
Log
ÑÑ 
(
ÑÑ 
NLog
ÑÑ "
.
ÑÑ" #
LogLevel
ÑÑ# +
.
ÑÑ+ ,
Warn
ÑÑ, 0
,
ÑÑ0 1
exceptIO
ÑÑ2 :
,
ÑÑ: ;
$str
ÑÑ< X
+
ÑÑY Z
port
ÑÑ[ _
.
ÑÑ_ `
ToString
ÑÑ` h
(
ÑÑh i
)
ÑÑi j
)
ÑÑj k
;
ÑÑk l
}
ÖÖ 
finally
ÜÜ 
{
áá 
try
àà 
{
ââ 
if
ää 
(
ää 
streamOutput
ää $
!=
ää% '
null
ää( ,
)
ää, -
{
ãã 
streamOutput
åå $
.
åå$ %
Close
åå% *
(
åå* +
)
åå+ ,
;
åå, -
}
çç 
}
éé 
catch
èè 
(
èè 
IOException
èè "
exceptIO
èè# +
)
èè+ ,
{
êê 
IO
ëë 
.
ëë 
Logger
ëë 
.
ëë 
Log
ëë !
(
ëë! "
NLog
ëë" &
.
ëë& '
LogLevel
ëë' /
.
ëë/ 0
Warn
ëë0 4
,
ëë4 5
exceptIO
ëë6 >
,
ëë> ?
$str
ëë@ W
)
ëëW X
;
ëëX Y
}
íí 
try
îî 
{
ïï 
if
ññ 
(
ññ 
tcpConn
ññ 
!=
ññ  "
null
ññ# '
)
ññ' (
{
óó 
tcpConn
òò 
.
òò  
Close
òò  %
(
òò% &
)
òò& '
;
òò' (
}
ôô 
}
öö 
catch
õõ 
(
õõ 
IOException
õõ "
exceptIO
õõ# +
)
õõ+ ,
{
úú 
IO
ùù 
.
ùù 
Logger
ùù 
.
ùù 
Log
ùù !
(
ùù! "
NLog
ùù" &
.
ùù& '
LogLevel
ùù' /
.
ùù/ 0
Warn
ùù0 4
,
ùù4 5
exceptIO
ùù6 >
,
ùù> ?
$str
ùù@ W
)
ùùW X
;
ùùX Y
}
ûû 
try
†† 
{
°° 
if
¢¢ 
(
¢¢ 
listener
¢¢  
!=
¢¢! #
null
¢¢$ (
)
¢¢( )
{
££ 
listener
§§  
.
§§  !
Stop
§§! %
(
§§% &
)
§§& '
;
§§' (
}
•• 
}
¶¶ 
catch
ßß 
(
ßß 
IOException
ßß "
exceptIO
ßß# +
)
ßß+ ,
{
®® 
IO
©© 
.
©© 
Logger
©© 
.
©© 
Log
©© !
(
©©! "
NLog
©©" &
.
©©& '
LogLevel
©©' /
.
©©/ 0
Warn
©©0 4
,
©©4 5
exceptIO
©©6 >
,
©©> ?
$str
©©@ W
)
©©W X
;
©©X Y
}
™™ 
}
¨¨ 
}
≠≠ 	
}
ÆÆ 
private
±± 
void
±± 
Good2
±± 
(
±± 
)
±± 
{
≤≤ 
if
≥≥ 

(
≥≥ 
$num
≥≥ 
==
≥≥ 
$num
≥≥ 
)
≥≥ 
{
¥¥ 	
TcpListener
µµ 
listener
µµ  
=
µµ! "
null
µµ# '
;
µµ' (
	TcpClient
∂∂ 
tcpConn
∂∂ 
=
∂∂ 
null
∂∂  $
;
∂∂$ %
Stream
∑∑ 
streamOutput
∑∑ 
=
∑∑  !
null
∑∑" &
;
∑∑& '
int
∏∏ 
port
∏∏ 
=
∏∏ 
$num
∏∏ 
;
∏∏ 
try
ππ 
{
∫∫ 
listener
ªª 
=
ªª 
new
ªª 
TcpListener
ªª *
(
ªª* +
	IPAddress
ªª+ 4
.
ªª4 5
Parse
ªª5 :
(
ªª: ;
$str
ªª; G
)
ªªG H
,
ªªH I
port
ªªJ N
)
ªªN O
;
ªªO P
listener
ºº 
.
ºº 
Start
ºº 
(
ºº 
)
ºº  
;
ºº  !
tcpConn
ΩΩ 
=
ΩΩ 
listener
ΩΩ "
.
ΩΩ" #
AcceptTcpClient
ΩΩ# 2
(
ΩΩ2 3
)
ΩΩ3 4
;
ΩΩ4 5
streamOutput
ææ 
=
ææ 
tcpConn
ææ &
.
ææ& '
	GetStream
ææ' 0
(
ææ0 1
)
ææ1 2
;
ææ2 3

IPEndPoint
øø 
endPoint
øø #
=
øø$ %
(
øø& '

IPEndPoint
øø' 1
)
øø1 2
tcpConn
øø2 9
.
øø9 :
Client
øø: @
.
øø@ A
RemoteEndPoint
øøA O
;
øøO P
	IPAddress
¿¿ 
	ipAddress
¿¿ #
=
¿¿$ %
endPoint
¿¿& .
.
¿¿. /
Address
¿¿/ 6
;
¿¿6 7
IPHostEntry
¡¡ 
	hostEntry
¡¡ %
=
¡¡& '
Dns
¡¡( +
.
¡¡+ ,
GetHostEntry
¡¡, 8
(
¡¡8 9
	ipAddress
¡¡9 B
)
¡¡B C
;
¡¡C D
streamOutput
√√ 
.
√√ 
Write
√√ "
(
√√" #
Encoding
√√# +
.
√√+ ,
UTF8
√√, 0
.
√√0 1
GetBytes
√√1 9
(
√√9 :
(
√√: ;
$str
√√; F
+
√√G H
	hostEntry
√√I R
.
√√R S
ToString
√√S [
(
√√[ \
)
√√\ ]
)
√√] ^
)
√√^ _
,
√√_ `
$num
√√a b
,
√√b c
(
√√d e
$str
√√e p
+
√√q r
	hostEntry
√√s |
.
√√| }
ToString√√} Ö
(√√Ö Ü
)√√Ü á
)√√á à
.√√à â
Length√√â è
)√√è ê
;√√ê ë
}
ƒƒ 
catch
≈≈ 
(
≈≈ 
IOException
≈≈ 
exceptIO
≈≈ '
)
≈≈' (
{
∆∆ 
IO
«« 
.
«« 
Logger
«« 
.
«« 
Log
«« 
(
«« 
NLog
«« "
.
««" #
LogLevel
««# +
.
««+ ,
Warn
««, 0
,
««0 1
exceptIO
««2 :
,
««: ;
$str
««< X
+
««Y Z
port
««[ _
.
««_ `
ToString
««` h
(
««h i
)
««i j
)
««j k
;
««k l
}
»» 
finally
…… 
{
   
try
ÀÀ 
{
ÃÃ 
if
ÕÕ 
(
ÕÕ 
streamOutput
ÕÕ $
!=
ÕÕ% '
null
ÕÕ( ,
)
ÕÕ, -
{
ŒŒ 
streamOutput
œœ $
.
œœ$ %
Close
œœ% *
(
œœ* +
)
œœ+ ,
;
œœ, -
}
–– 
}
—— 
catch
““ 
(
““ 
IOException
““ "
exceptIO
““# +
)
““+ ,
{
”” 
IO
‘‘ 
.
‘‘ 
Logger
‘‘ 
.
‘‘ 
Log
‘‘ !
(
‘‘! "
NLog
‘‘" &
.
‘‘& '
LogLevel
‘‘' /
.
‘‘/ 0
Warn
‘‘0 4
,
‘‘4 5
exceptIO
‘‘6 >
,
‘‘> ?
$str
‘‘@ W
)
‘‘W X
;
‘‘X Y
}
’’ 
try
◊◊ 
{
ÿÿ 
if
ŸŸ 
(
ŸŸ 
tcpConn
ŸŸ 
!=
ŸŸ  "
null
ŸŸ# '
)
ŸŸ' (
{
⁄⁄ 
tcpConn
€€ 
.
€€  
Close
€€  %
(
€€% &
)
€€& '
;
€€' (
}
‹‹ 
}
›› 
catch
ﬁﬁ 
(
ﬁﬁ 
IOException
ﬁﬁ "
exceptIO
ﬁﬁ# +
)
ﬁﬁ+ ,
{
ﬂﬂ 
IO
‡‡ 
.
‡‡ 
Logger
‡‡ 
.
‡‡ 
Log
‡‡ !
(
‡‡! "
NLog
‡‡" &
.
‡‡& '
LogLevel
‡‡' /
.
‡‡/ 0
Warn
‡‡0 4
,
‡‡4 5
exceptIO
‡‡6 >
,
‡‡> ?
$str
‡‡@ W
)
‡‡W X
;
‡‡X Y
}
·· 
try
„„ 
{
‰‰ 
if
ÂÂ 
(
ÂÂ 
listener
ÂÂ  
!=
ÂÂ! #
null
ÂÂ$ (
)
ÂÂ( )
{
ÊÊ 
listener
ÁÁ  
.
ÁÁ  !
Stop
ÁÁ! %
(
ÁÁ% &
)
ÁÁ& '
;
ÁÁ' (
}
ËË 
}
ÈÈ 
catch
ÍÍ 
(
ÍÍ 
IOException
ÍÍ "
exceptIO
ÍÍ# +
)
ÍÍ+ ,
{
ÎÎ 
IO
ÏÏ 
.
ÏÏ 
Logger
ÏÏ 
.
ÏÏ 
Log
ÏÏ !
(
ÏÏ! "
NLog
ÏÏ" &
.
ÏÏ& '
LogLevel
ÏÏ' /
.
ÏÏ/ 0
Warn
ÏÏ0 4
,
ÏÏ4 5
exceptIO
ÏÏ6 >
,
ÏÏ> ?
$str
ÏÏ@ W
)
ÏÏW X
;
ÏÏX Y
}
ÌÌ 
}
ÔÔ 
}
 	
}
ÒÒ 
public
ÛÛ 

override
ÛÛ 
void
ÛÛ 
Good
ÛÛ 
(
ÛÛ 
)
ÛÛ 
{
ÙÙ 
Good1
ıı 
(
ıı 
)
ıı 
;
ıı 
Good2
ˆˆ 
(
ˆˆ 
)
ˆˆ 
;
ˆˆ 
}
˜˜ 
}˘˘ 
}˙˙ òç
ñC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__hostname_based_logic_04.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 4
(CWE510_Trapdoor__hostname_based_logic_04 .
:/ 0
AbstractTestCase1 A
{ 
private   
const   
bool   
PRIVATE_CONST_TRUE   )
=  * +
true  , 0
;  0 1
private!! 
const!! 
bool!! 
PRIVATE_CONST_FALSE!! *
=!!+ ,
false!!- 2
;!!2 3
public## 

override## 
void## 
Bad## 
(## 
)## 
{$$ 
if%% 

(%% 
PRIVATE_CONST_TRUE%% 
)%% 
{&& 	
TcpListener'' 
listener''  
=''! "
null''# '
;''' (
	TcpClient(( 
tcpConn(( 
=(( 
null((  $
;(($ %
Stream)) 
streamOutput)) 
=))  !
null))" &
;))& '
int** 
port** 
=** 
$num** 
;** 
try++ 
{,, 
listener-- 
=-- 
new-- 
TcpListener-- *
(--* +
	IPAddress--+ 4
.--4 5
Parse--5 :
(--: ;
$str--; G
)--G H
,--H I
port--J N
)--N O
;--O P
listener.. 
... 
Start.. 
(.. 
)..  
;..  !
tcpConn// 
=// 
listener// "
.//" #
AcceptTcpClient//# 2
(//2 3
)//3 4
;//4 5

IPEndPoint11 
endPoint11 #
=11$ %
(11& '

IPEndPoint11' 1
)111 2
tcpConn112 9
.119 :
Client11: @
.11@ A
RemoteEndPoint11A O
;11O P
	IPAddress22 
	ipAddress22 #
=22$ %
endPoint22& .
.22. /
Address22/ 6
;226 7
IPHostEntry33 
	hostEntry33 %
=33& '
Dns33( +
.33+ ,
GetHostEntry33, 8
(338 9
	ipAddress339 B
)33B C
;33C D
if44 
(44 
	hostEntry44 
.44 
HostName44 &
.44& '
Equals44' -
(44- .
$str44. @
)44@ A
)44A B
{55 
streamOutput66  
=66! "
tcpConn66# *
.66* +
	GetStream66+ 4
(664 5
)665 6
;666 7
streamOutput77  
.77  !
Write77! &
(77& '
Encoding77' /
.77/ 0
UTF8770 4
.774 5
GetBytes775 =
(77= >
$str77> O
)77O P
,77P Q
$num77R S
,77S T
$str77U f
.77f g
Length77g m
)77m n
;77n o
}88 
else99 
{:: 
streamOutput;;  
=;;! "
tcpConn;;# *
.;;* +
	GetStream;;+ 4
(;;4 5
);;5 6
;;;6 7
streamOutput<<  
.<<  !
Write<<! &
(<<& '
Encoding<<' /
.<</ 0
UTF8<<0 4
.<<4 5
GetBytes<<5 =
(<<= >
$str<<> N
)<<N O
,<<O P
$num<<Q R
,<<R S
$str<<T d
.<<d e
Length<<e k
)<<k l
;<<l m
}== 
}>> 
catch?? 
(?? 
IOException?? 
exceptIO?? '
)??' (
{@@ 
IOAA 
.AA 
LoggerAA 
.AA 
LogAA 
(AA 
NLogAA "
.AA" #
LogLevelAA# +
.AA+ ,
WarnAA, 0
,AA0 1
exceptIOAA2 :
,AA: ;
$strAA< X
+AAY Z
portAA[ _
.AA_ `
ToStringAA` h
(AAh i
)AAi j
)AAj k
;AAk l
}BB 
finallyCC 
{DD 
tryEE 
{FF 
ifGG 
(GG 
streamOutputGG $
!=GG% '
nullGG( ,
)GG, -
{HH 
streamOutputII $
.II$ %
CloseII% *
(II* +
)II+ ,
;II, -
}JJ 
}KK 
catchLL 
(LL 
IOExceptionLL "
exceptIOLL# +
)LL+ ,
{MM 
IONN 
.NN 
LoggerNN 
.NN 
LogNN !
(NN! "
NLogNN" &
.NN& '
LogLevelNN' /
.NN/ 0
WarnNN0 4
,NN4 5
exceptIONN6 >
,NN> ?
$strNN@ W
)NNW X
;NNX Y
}OO 
tryQQ 
{RR 
ifSS 
(SS 
tcpConnSS 
!=SS  "
nullSS# '
)SS' (
{TT 
tcpConnUU 
.UU  
CloseUU  %
(UU% &
)UU& '
;UU' (
}VV 
}WW 
catchXX 
(XX 
IOExceptionXX "
exceptIOXX# +
)XX+ ,
{YY 
IOZZ 
.ZZ 
LoggerZZ 
.ZZ 
LogZZ !
(ZZ! "
NLogZZ" &
.ZZ& '
LogLevelZZ' /
.ZZ/ 0
WarnZZ0 4
,ZZ4 5
exceptIOZZ6 >
,ZZ> ?
$strZZ@ W
)ZZW X
;ZZX Y
}[[ 
try]] 
{^^ 
if__ 
(__ 
listener__  
!=__! #
null__$ (
)__( )
{`` 
listeneraa  
.aa  !
Stopaa! %
(aa% &
)aa& '
;aa' (
}bb 
}cc 
catchdd 
(dd 
IOExceptiondd "
exceptIOdd# +
)dd+ ,
{ee 
IOff 
.ff 
Loggerff 
.ff 
Logff !
(ff! "
NLogff" &
.ff& '
LogLevelff' /
.ff/ 0
Warnff0 4
,ff4 5
exceptIOff6 >
,ff> ?
$strff@ W
)ffW X
;ffX Y
}gg 
}ii 
}jj 	
}kk 
privateoo 
voidoo 
Good1oo 
(oo 
)oo 
{pp 
ifqq 

(qq 
PRIVATE_CONST_FALSEqq 
)qq  
{rr 	
IOtt 
.tt 
	WriteLinett 
(tt 
$strtt /
)tt/ 0
;tt0 1
}uu 	
elsevv 
{ww 	
TcpListenerxx 
listenerxx  
=xx! "
nullxx# '
;xx' (
	TcpClientyy 
tcpConnyy 
=yy 
nullyy  $
;yy$ %
Streamzz 
streamOutputzz 
=zz  !
nullzz" &
;zz& '
int{{ 
port{{ 
={{ 
$num{{ 
;{{ 
try|| 
{}} 
listener~~ 
=~~ 
new~~ 
TcpListener~~ *
(~~* +
	IPAddress~~+ 4
.~~4 5
Parse~~5 :
(~~: ;
$str~~; G
)~~G H
,~~H I
port~~J N
)~~N O
;~~O P
listener 
. 
Start 
( 
)  
;  !
tcpConn
ÄÄ 
=
ÄÄ 
listener
ÄÄ "
.
ÄÄ" #
AcceptTcpClient
ÄÄ# 2
(
ÄÄ2 3
)
ÄÄ3 4
;
ÄÄ4 5
streamOutput
ÅÅ 
=
ÅÅ 
tcpConn
ÅÅ &
.
ÅÅ& '
	GetStream
ÅÅ' 0
(
ÅÅ0 1
)
ÅÅ1 2
;
ÅÅ2 3

IPEndPoint
ÇÇ 
endPoint
ÇÇ #
=
ÇÇ$ %
(
ÇÇ& '

IPEndPoint
ÇÇ' 1
)
ÇÇ1 2
tcpConn
ÇÇ2 9
.
ÇÇ9 :
Client
ÇÇ: @
.
ÇÇ@ A
RemoteEndPoint
ÇÇA O
;
ÇÇO P
	IPAddress
ÉÉ 
	ipAddress
ÉÉ #
=
ÉÉ$ %
endPoint
ÉÉ& .
.
ÉÉ. /
Address
ÉÉ/ 6
;
ÉÉ6 7
IPHostEntry
ÑÑ 
	hostEntry
ÑÑ %
=
ÑÑ& '
Dns
ÑÑ( +
.
ÑÑ+ ,
GetHostEntry
ÑÑ, 8
(
ÑÑ8 9
	ipAddress
ÑÑ9 B
)
ÑÑB C
;
ÑÑC D
streamOutput
ÜÜ 
.
ÜÜ 
Write
ÜÜ "
(
ÜÜ" #
Encoding
ÜÜ# +
.
ÜÜ+ ,
UTF8
ÜÜ, 0
.
ÜÜ0 1
GetBytes
ÜÜ1 9
(
ÜÜ9 :
(
ÜÜ: ;
$str
ÜÜ; F
+
ÜÜG H
	hostEntry
ÜÜI R
.
ÜÜR S
ToString
ÜÜS [
(
ÜÜ[ \
)
ÜÜ\ ]
)
ÜÜ] ^
)
ÜÜ^ _
,
ÜÜ_ `
$num
ÜÜa b
,
ÜÜb c
(
ÜÜd e
$str
ÜÜe p
+
ÜÜq r
	hostEntry
ÜÜs |
.
ÜÜ| }
ToStringÜÜ} Ö
(ÜÜÖ Ü
)ÜÜÜ á
)ÜÜá à
.ÜÜà â
LengthÜÜâ è
)ÜÜè ê
;ÜÜê ë
}
áá 
catch
àà 
(
àà 
IOException
àà 
exceptIO
àà '
)
àà' (
{
ââ 
IO
ää 
.
ää 
Logger
ää 
.
ää 
Log
ää 
(
ää 
NLog
ää "
.
ää" #
LogLevel
ää# +
.
ää+ ,
Warn
ää, 0
,
ää0 1
exceptIO
ää2 :
,
ää: ;
$str
ää< X
+
ääY Z
port
ää[ _
.
ää_ `
ToString
ää` h
(
ääh i
)
ääi j
)
ääj k
;
ääk l
}
ãã 
finally
åå 
{
çç 
try
éé 
{
èè 
if
êê 
(
êê 
streamOutput
êê $
!=
êê% '
null
êê( ,
)
êê, -
{
ëë 
streamOutput
íí $
.
íí$ %
Close
íí% *
(
íí* +
)
íí+ ,
;
íí, -
}
ìì 
}
îî 
catch
ïï 
(
ïï 
IOException
ïï "
exceptIO
ïï# +
)
ïï+ ,
{
ññ 
IO
óó 
.
óó 
Logger
óó 
.
óó 
Log
óó !
(
óó! "
NLog
óó" &
.
óó& '
LogLevel
óó' /
.
óó/ 0
Warn
óó0 4
,
óó4 5
exceptIO
óó6 >
,
óó> ?
$str
óó@ W
)
óóW X
;
óóX Y
}
òò 
try
öö 
{
õõ 
if
úú 
(
úú 
tcpConn
úú 
!=
úú  "
null
úú# '
)
úú' (
{
ùù 
tcpConn
ûû 
.
ûû  
Close
ûû  %
(
ûû% &
)
ûû& '
;
ûû' (
}
üü 
}
†† 
catch
°° 
(
°° 
IOException
°° "
exceptIO
°°# +
)
°°+ ,
{
¢¢ 
IO
££ 
.
££ 
Logger
££ 
.
££ 
Log
££ !
(
££! "
NLog
££" &
.
££& '
LogLevel
££' /
.
££/ 0
Warn
££0 4
,
££4 5
exceptIO
££6 >
,
££> ?
$str
££@ W
)
££W X
;
££X Y
}
§§ 
try
¶¶ 
{
ßß 
if
®® 
(
®® 
listener
®®  
!=
®®! #
null
®®$ (
)
®®( )
{
©© 
listener
™™  
.
™™  !
Stop
™™! %
(
™™% &
)
™™& '
;
™™' (
}
´´ 
}
¨¨ 
catch
≠≠ 
(
≠≠ 
IOException
≠≠ "
exceptIO
≠≠# +
)
≠≠+ ,
{
ÆÆ 
IO
ØØ 
.
ØØ 
Logger
ØØ 
.
ØØ 
Log
ØØ !
(
ØØ! "
NLog
ØØ" &
.
ØØ& '
LogLevel
ØØ' /
.
ØØ/ 0
Warn
ØØ0 4
,
ØØ4 5
exceptIO
ØØ6 >
,
ØØ> ?
$str
ØØ@ W
)
ØØW X
;
ØØX Y
}
∞∞ 
}
≤≤ 
}
≥≥ 	
}
¥¥ 
private
∑∑ 
void
∑∑ 
Good2
∑∑ 
(
∑∑ 
)
∑∑ 
{
∏∏ 
if
ππ 

(
ππ  
PRIVATE_CONST_TRUE
ππ 
)
ππ 
{
∫∫ 	
TcpListener
ªª 
listener
ªª  
=
ªª! "
null
ªª# '
;
ªª' (
	TcpClient
ºº 
tcpConn
ºº 
=
ºº 
null
ºº  $
;
ºº$ %
Stream
ΩΩ 
streamOutput
ΩΩ 
=
ΩΩ  !
null
ΩΩ" &
;
ΩΩ& '
int
ææ 
port
ææ 
=
ææ 
$num
ææ 
;
ææ 
try
øø 
{
¿¿ 
listener
¡¡ 
=
¡¡ 
new
¡¡ 
TcpListener
¡¡ *
(
¡¡* +
	IPAddress
¡¡+ 4
.
¡¡4 5
Parse
¡¡5 :
(
¡¡: ;
$str
¡¡; G
)
¡¡G H
,
¡¡H I
port
¡¡J N
)
¡¡N O
;
¡¡O P
listener
¬¬ 
.
¬¬ 
Start
¬¬ 
(
¬¬ 
)
¬¬  
;
¬¬  !
tcpConn
√√ 
=
√√ 
listener
√√ "
.
√√" #
AcceptTcpClient
√√# 2
(
√√2 3
)
√√3 4
;
√√4 5
streamOutput
ƒƒ 
=
ƒƒ 
tcpConn
ƒƒ &
.
ƒƒ& '
	GetStream
ƒƒ' 0
(
ƒƒ0 1
)
ƒƒ1 2
;
ƒƒ2 3

IPEndPoint
≈≈ 
endPoint
≈≈ #
=
≈≈$ %
(
≈≈& '

IPEndPoint
≈≈' 1
)
≈≈1 2
tcpConn
≈≈2 9
.
≈≈9 :
Client
≈≈: @
.
≈≈@ A
RemoteEndPoint
≈≈A O
;
≈≈O P
	IPAddress
∆∆ 
	ipAddress
∆∆ #
=
∆∆$ %
endPoint
∆∆& .
.
∆∆. /
Address
∆∆/ 6
;
∆∆6 7
IPHostEntry
«« 
	hostEntry
«« %
=
««& '
Dns
««( +
.
««+ ,
GetHostEntry
««, 8
(
««8 9
	ipAddress
««9 B
)
««B C
;
««C D
streamOutput
…… 
.
…… 
Write
…… "
(
……" #
Encoding
……# +
.
……+ ,
UTF8
……, 0
.
……0 1
GetBytes
……1 9
(
……9 :
(
……: ;
$str
……; F
+
……G H
	hostEntry
……I R
.
……R S
ToString
……S [
(
……[ \
)
……\ ]
)
……] ^
)
……^ _
,
……_ `
$num
……a b
,
……b c
(
……d e
$str
……e p
+
……q r
	hostEntry
……s |
.
……| }
ToString……} Ö
(……Ö Ü
)……Ü á
)……á à
.……à â
Length……â è
)……è ê
;……ê ë
}
   
catch
ÀÀ 
(
ÀÀ 
IOException
ÀÀ 
exceptIO
ÀÀ '
)
ÀÀ' (
{
ÃÃ 
IO
ÕÕ 
.
ÕÕ 
Logger
ÕÕ 
.
ÕÕ 
Log
ÕÕ 
(
ÕÕ 
NLog
ÕÕ "
.
ÕÕ" #
LogLevel
ÕÕ# +
.
ÕÕ+ ,
Warn
ÕÕ, 0
,
ÕÕ0 1
exceptIO
ÕÕ2 :
,
ÕÕ: ;
$str
ÕÕ< X
+
ÕÕY Z
port
ÕÕ[ _
.
ÕÕ_ `
ToString
ÕÕ` h
(
ÕÕh i
)
ÕÕi j
)
ÕÕj k
;
ÕÕk l
}
ŒŒ 
finally
œœ 
{
–– 
try
—— 
{
““ 
if
”” 
(
”” 
streamOutput
”” $
!=
””% '
null
””( ,
)
””, -
{
‘‘ 
streamOutput
’’ $
.
’’$ %
Close
’’% *
(
’’* +
)
’’+ ,
;
’’, -
}
÷÷ 
}
◊◊ 
catch
ÿÿ 
(
ÿÿ 
IOException
ÿÿ "
exceptIO
ÿÿ# +
)
ÿÿ+ ,
{
ŸŸ 
IO
⁄⁄ 
.
⁄⁄ 
Logger
⁄⁄ 
.
⁄⁄ 
Log
⁄⁄ !
(
⁄⁄! "
NLog
⁄⁄" &
.
⁄⁄& '
LogLevel
⁄⁄' /
.
⁄⁄/ 0
Warn
⁄⁄0 4
,
⁄⁄4 5
exceptIO
⁄⁄6 >
,
⁄⁄> ?
$str
⁄⁄@ W
)
⁄⁄W X
;
⁄⁄X Y
}
€€ 
try
›› 
{
ﬁﬁ 
if
ﬂﬂ 
(
ﬂﬂ 
tcpConn
ﬂﬂ 
!=
ﬂﬂ  "
null
ﬂﬂ# '
)
ﬂﬂ' (
{
‡‡ 
tcpConn
·· 
.
··  
Close
··  %
(
··% &
)
··& '
;
··' (
}
‚‚ 
}
„„ 
catch
‰‰ 
(
‰‰ 
IOException
‰‰ "
exceptIO
‰‰# +
)
‰‰+ ,
{
ÂÂ 
IO
ÊÊ 
.
ÊÊ 
Logger
ÊÊ 
.
ÊÊ 
Log
ÊÊ !
(
ÊÊ! "
NLog
ÊÊ" &
.
ÊÊ& '
LogLevel
ÊÊ' /
.
ÊÊ/ 0
Warn
ÊÊ0 4
,
ÊÊ4 5
exceptIO
ÊÊ6 >
,
ÊÊ> ?
$str
ÊÊ@ W
)
ÊÊW X
;
ÊÊX Y
}
ÁÁ 
try
ÈÈ 
{
ÍÍ 
if
ÎÎ 
(
ÎÎ 
listener
ÎÎ  
!=
ÎÎ! #
null
ÎÎ$ (
)
ÎÎ( )
{
ÏÏ 
listener
ÌÌ  
.
ÌÌ  !
Stop
ÌÌ! %
(
ÌÌ% &
)
ÌÌ& '
;
ÌÌ' (
}
ÓÓ 
}
ÔÔ 
catch
 
(
 
IOException
 "
exceptIO
# +
)
+ ,
{
ÒÒ 
IO
ÚÚ 
.
ÚÚ 
Logger
ÚÚ 
.
ÚÚ 
Log
ÚÚ !
(
ÚÚ! "
NLog
ÚÚ" &
.
ÚÚ& '
LogLevel
ÚÚ' /
.
ÚÚ/ 0
Warn
ÚÚ0 4
,
ÚÚ4 5
exceptIO
ÚÚ6 >
,
ÚÚ> ?
$str
ÚÚ@ W
)
ÚÚW X
;
ÚÚX Y
}
ÛÛ 
}
ıı 
}
ˆˆ 	
}
˜˜ 
public
˘˘ 

override
˘˘ 
void
˘˘ 
Good
˘˘ 
(
˘˘ 
)
˘˘ 
{
˙˙ 
Good1
˚˚ 
(
˚˚ 
)
˚˚ 
;
˚˚ 
Good2
¸¸ 
(
¸¸ 
)
¸¸ 
;
¸¸ 
}
˝˝ 
}ˇˇ 
}ÄÄ œå
ñC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__hostname_based_logic_05.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 4
(CWE510_Trapdoor__hostname_based_logic_05 .
:/ 0
AbstractTestCase1 A
{ 
private   
bool   
privateTrue   
=   
true   #
;  # $
private!! 
bool!! 
privateFalse!! 
=!! 
false!!  %
;!!% &
public## 

override## 
void## 
Bad## 
(## 
)## 
{$$ 
if%% 

(%% 
privateTrue%% 
)%% 
{&& 	
TcpListener'' 
listener''  
=''! "
null''# '
;''' (
	TcpClient(( 
tcpConn(( 
=(( 
null((  $
;(($ %
Stream)) 
streamOutput)) 
=))  !
null))" &
;))& '
int** 
port** 
=** 
$num** 
;** 
try++ 
{,, 
listener-- 
=-- 
new-- 
TcpListener-- *
(--* +
	IPAddress--+ 4
.--4 5
Parse--5 :
(--: ;
$str--; G
)--G H
,--H I
port--J N
)--N O
;--O P
listener.. 
... 
Start.. 
(.. 
)..  
;..  !
tcpConn// 
=// 
listener// "
.//" #
AcceptTcpClient//# 2
(//2 3
)//3 4
;//4 5

IPEndPoint11 
endPoint11 #
=11$ %
(11& '

IPEndPoint11' 1
)111 2
tcpConn112 9
.119 :
Client11: @
.11@ A
RemoteEndPoint11A O
;11O P
	IPAddress22 
	ipAddress22 #
=22$ %
endPoint22& .
.22. /
Address22/ 6
;226 7
IPHostEntry33 
	hostEntry33 %
=33& '
Dns33( +
.33+ ,
GetHostEntry33, 8
(338 9
	ipAddress339 B
)33B C
;33C D
if44 
(44 
	hostEntry44 
.44 
HostName44 &
.44& '
Equals44' -
(44- .
$str44. @
)44@ A
)44A B
{55 
streamOutput66  
=66! "
tcpConn66# *
.66* +
	GetStream66+ 4
(664 5
)665 6
;666 7
streamOutput77  
.77  !
Write77! &
(77& '
Encoding77' /
.77/ 0
UTF8770 4
.774 5
GetBytes775 =
(77= >
$str77> O
)77O P
,77P Q
$num77R S
,77S T
$str77U f
.77f g
Length77g m
)77m n
;77n o
}88 
else99 
{:: 
streamOutput;;  
=;;! "
tcpConn;;# *
.;;* +
	GetStream;;+ 4
(;;4 5
);;5 6
;;;6 7
streamOutput<<  
.<<  !
Write<<! &
(<<& '
Encoding<<' /
.<</ 0
UTF8<<0 4
.<<4 5
GetBytes<<5 =
(<<= >
$str<<> N
)<<N O
,<<O P
$num<<Q R
,<<R S
$str<<T d
.<<d e
Length<<e k
)<<k l
;<<l m
}== 
}>> 
catch?? 
(?? 
IOException?? 
exceptIO?? '
)??' (
{@@ 
IOAA 
.AA 
LoggerAA 
.AA 
LogAA 
(AA 
NLogAA "
.AA" #
LogLevelAA# +
.AA+ ,
WarnAA, 0
,AA0 1
exceptIOAA2 :
,AA: ;
$strAA< X
+AAY Z
portAA[ _
.AA_ `
ToStringAA` h
(AAh i
)AAi j
)AAj k
;AAk l
}BB 
finallyCC 
{DD 
tryEE 
{FF 
ifGG 
(GG 
streamOutputGG $
!=GG% '
nullGG( ,
)GG, -
{HH 
streamOutputII $
.II$ %
CloseII% *
(II* +
)II+ ,
;II, -
}JJ 
}KK 
catchLL 
(LL 
IOExceptionLL "
exceptIOLL# +
)LL+ ,
{MM 
IONN 
.NN 
LoggerNN 
.NN 
LogNN !
(NN! "
NLogNN" &
.NN& '
LogLevelNN' /
.NN/ 0
WarnNN0 4
,NN4 5
exceptIONN6 >
,NN> ?
$strNN@ W
)NNW X
;NNX Y
}OO 
tryQQ 
{RR 
ifSS 
(SS 
tcpConnSS 
!=SS  "
nullSS# '
)SS' (
{TT 
tcpConnUU 
.UU  
CloseUU  %
(UU% &
)UU& '
;UU' (
}VV 
}WW 
catchXX 
(XX 
IOExceptionXX "
exceptIOXX# +
)XX+ ,
{YY 
IOZZ 
.ZZ 
LoggerZZ 
.ZZ 
LogZZ !
(ZZ! "
NLogZZ" &
.ZZ& '
LogLevelZZ' /
.ZZ/ 0
WarnZZ0 4
,ZZ4 5
exceptIOZZ6 >
,ZZ> ?
$strZZ@ W
)ZZW X
;ZZX Y
}[[ 
try]] 
{^^ 
if__ 
(__ 
listener__  
!=__! #
null__$ (
)__( )
{`` 
listeneraa  
.aa  !
Stopaa! %
(aa% &
)aa& '
;aa' (
}bb 
}cc 
catchdd 
(dd 
IOExceptiondd "
exceptIOdd# +
)dd+ ,
{ee 
IOff 
.ff 
Loggerff 
.ff 
Logff !
(ff! "
NLogff" &
.ff& '
LogLevelff' /
.ff/ 0
Warnff0 4
,ff4 5
exceptIOff6 >
,ff> ?
$strff@ W
)ffW X
;ffX Y
}gg 
}ii 
}jj 	
}kk 
privateoo 
voidoo 
Good1oo 
(oo 
)oo 
{pp 
ifqq 

(qq 
privateFalseqq 
)qq 
{rr 	
IOtt 
.tt 
	WriteLinett 
(tt 
$strtt /
)tt/ 0
;tt0 1
}uu 	
elsevv 
{ww 	
TcpListenerxx 
listenerxx  
=xx! "
nullxx# '
;xx' (
	TcpClientyy 
tcpConnyy 
=yy 
nullyy  $
;yy$ %
Streamzz 
streamOutputzz 
=zz  !
nullzz" &
;zz& '
int{{ 
port{{ 
={{ 
$num{{ 
;{{ 
try|| 
{}} 
listener~~ 
=~~ 
new~~ 
TcpListener~~ *
(~~* +
	IPAddress~~+ 4
.~~4 5
Parse~~5 :
(~~: ;
$str~~; G
)~~G H
,~~H I
port~~J N
)~~N O
;~~O P
listener 
. 
Start 
( 
)  
;  !
tcpConn
ÄÄ 
=
ÄÄ 
listener
ÄÄ "
.
ÄÄ" #
AcceptTcpClient
ÄÄ# 2
(
ÄÄ2 3
)
ÄÄ3 4
;
ÄÄ4 5
streamOutput
ÅÅ 
=
ÅÅ 
tcpConn
ÅÅ &
.
ÅÅ& '
	GetStream
ÅÅ' 0
(
ÅÅ0 1
)
ÅÅ1 2
;
ÅÅ2 3

IPEndPoint
ÇÇ 
endPoint
ÇÇ #
=
ÇÇ$ %
(
ÇÇ& '

IPEndPoint
ÇÇ' 1
)
ÇÇ1 2
tcpConn
ÇÇ2 9
.
ÇÇ9 :
Client
ÇÇ: @
.
ÇÇ@ A
RemoteEndPoint
ÇÇA O
;
ÇÇO P
	IPAddress
ÉÉ 
	ipAddress
ÉÉ #
=
ÉÉ$ %
endPoint
ÉÉ& .
.
ÉÉ. /
Address
ÉÉ/ 6
;
ÉÉ6 7
IPHostEntry
ÑÑ 
	hostEntry
ÑÑ %
=
ÑÑ& '
Dns
ÑÑ( +
.
ÑÑ+ ,
GetHostEntry
ÑÑ, 8
(
ÑÑ8 9
	ipAddress
ÑÑ9 B
)
ÑÑB C
;
ÑÑC D
streamOutput
ÜÜ 
.
ÜÜ 
Write
ÜÜ "
(
ÜÜ" #
Encoding
ÜÜ# +
.
ÜÜ+ ,
UTF8
ÜÜ, 0
.
ÜÜ0 1
GetBytes
ÜÜ1 9
(
ÜÜ9 :
(
ÜÜ: ;
$str
ÜÜ; F
+
ÜÜG H
	hostEntry
ÜÜI R
.
ÜÜR S
ToString
ÜÜS [
(
ÜÜ[ \
)
ÜÜ\ ]
)
ÜÜ] ^
)
ÜÜ^ _
,
ÜÜ_ `
$num
ÜÜa b
,
ÜÜb c
(
ÜÜd e
$str
ÜÜe p
+
ÜÜq r
	hostEntry
ÜÜs |
.
ÜÜ| }
ToStringÜÜ} Ö
(ÜÜÖ Ü
)ÜÜÜ á
)ÜÜá à
.ÜÜà â
LengthÜÜâ è
)ÜÜè ê
;ÜÜê ë
}
áá 
catch
àà 
(
àà 
IOException
àà 
exceptIO
àà '
)
àà' (
{
ââ 
IO
ää 
.
ää 
Logger
ää 
.
ää 
Log
ää 
(
ää 
NLog
ää "
.
ää" #
LogLevel
ää# +
.
ää+ ,
Warn
ää, 0
,
ää0 1
exceptIO
ää2 :
,
ää: ;
$str
ää< X
+
ääY Z
port
ää[ _
.
ää_ `
ToString
ää` h
(
ääh i
)
ääi j
)
ääj k
;
ääk l
}
ãã 
finally
åå 
{
çç 
try
éé 
{
èè 
if
êê 
(
êê 
streamOutput
êê $
!=
êê% '
null
êê( ,
)
êê, -
{
ëë 
streamOutput
íí $
.
íí$ %
Close
íí% *
(
íí* +
)
íí+ ,
;
íí, -
}
ìì 
}
îî 
catch
ïï 
(
ïï 
IOException
ïï "
exceptIO
ïï# +
)
ïï+ ,
{
ññ 
IO
óó 
.
óó 
Logger
óó 
.
óó 
Log
óó !
(
óó! "
NLog
óó" &
.
óó& '
LogLevel
óó' /
.
óó/ 0
Warn
óó0 4
,
óó4 5
exceptIO
óó6 >
,
óó> ?
$str
óó@ W
)
óóW X
;
óóX Y
}
òò 
try
öö 
{
õõ 
if
úú 
(
úú 
tcpConn
úú 
!=
úú  "
null
úú# '
)
úú' (
{
ùù 
tcpConn
ûû 
.
ûû  
Close
ûû  %
(
ûû% &
)
ûû& '
;
ûû' (
}
üü 
}
†† 
catch
°° 
(
°° 
IOException
°° "
exceptIO
°°# +
)
°°+ ,
{
¢¢ 
IO
££ 
.
££ 
Logger
££ 
.
££ 
Log
££ !
(
££! "
NLog
££" &
.
££& '
LogLevel
££' /
.
££/ 0
Warn
££0 4
,
££4 5
exceptIO
££6 >
,
££> ?
$str
££@ W
)
££W X
;
££X Y
}
§§ 
try
¶¶ 
{
ßß 
if
®® 
(
®® 
listener
®®  
!=
®®! #
null
®®$ (
)
®®( )
{
©© 
listener
™™  
.
™™  !
Stop
™™! %
(
™™% &
)
™™& '
;
™™' (
}
´´ 
}
¨¨ 
catch
≠≠ 
(
≠≠ 
IOException
≠≠ "
exceptIO
≠≠# +
)
≠≠+ ,
{
ÆÆ 
IO
ØØ 
.
ØØ 
Logger
ØØ 
.
ØØ 
Log
ØØ !
(
ØØ! "
NLog
ØØ" &
.
ØØ& '
LogLevel
ØØ' /
.
ØØ/ 0
Warn
ØØ0 4
,
ØØ4 5
exceptIO
ØØ6 >
,
ØØ> ?
$str
ØØ@ W
)
ØØW X
;
ØØX Y
}
∞∞ 
}
≤≤ 
}
≥≥ 	
}
¥¥ 
private
∑∑ 
void
∑∑ 
Good2
∑∑ 
(
∑∑ 
)
∑∑ 
{
∏∏ 
if
ππ 

(
ππ 
privateTrue
ππ 
)
ππ 
{
∫∫ 	
TcpListener
ªª 
listener
ªª  
=
ªª! "
null
ªª# '
;
ªª' (
	TcpClient
ºº 
tcpConn
ºº 
=
ºº 
null
ºº  $
;
ºº$ %
Stream
ΩΩ 
streamOutput
ΩΩ 
=
ΩΩ  !
null
ΩΩ" &
;
ΩΩ& '
int
ææ 
port
ææ 
=
ææ 
$num
ææ 
;
ææ 
try
øø 
{
¿¿ 
listener
¡¡ 
=
¡¡ 
new
¡¡ 
TcpListener
¡¡ *
(
¡¡* +
	IPAddress
¡¡+ 4
.
¡¡4 5
Parse
¡¡5 :
(
¡¡: ;
$str
¡¡; G
)
¡¡G H
,
¡¡H I
port
¡¡J N
)
¡¡N O
;
¡¡O P
listener
¬¬ 
.
¬¬ 
Start
¬¬ 
(
¬¬ 
)
¬¬  
;
¬¬  !
tcpConn
√√ 
=
√√ 
listener
√√ "
.
√√" #
AcceptTcpClient
√√# 2
(
√√2 3
)
√√3 4
;
√√4 5
streamOutput
ƒƒ 
=
ƒƒ 
tcpConn
ƒƒ &
.
ƒƒ& '
	GetStream
ƒƒ' 0
(
ƒƒ0 1
)
ƒƒ1 2
;
ƒƒ2 3

IPEndPoint
≈≈ 
endPoint
≈≈ #
=
≈≈$ %
(
≈≈& '

IPEndPoint
≈≈' 1
)
≈≈1 2
tcpConn
≈≈2 9
.
≈≈9 :
Client
≈≈: @
.
≈≈@ A
RemoteEndPoint
≈≈A O
;
≈≈O P
	IPAddress
∆∆ 
	ipAddress
∆∆ #
=
∆∆$ %
endPoint
∆∆& .
.
∆∆. /
Address
∆∆/ 6
;
∆∆6 7
IPHostEntry
«« 
	hostEntry
«« %
=
««& '
Dns
««( +
.
««+ ,
GetHostEntry
««, 8
(
««8 9
	ipAddress
««9 B
)
««B C
;
««C D
streamOutput
…… 
.
…… 
Write
…… "
(
……" #
Encoding
……# +
.
……+ ,
UTF8
……, 0
.
……0 1
GetBytes
……1 9
(
……9 :
(
……: ;
$str
……; F
+
……G H
	hostEntry
……I R
.
……R S
ToString
……S [
(
……[ \
)
……\ ]
)
……] ^
)
……^ _
,
……_ `
$num
……a b
,
……b c
(
……d e
$str
……e p
+
……q r
	hostEntry
……s |
.
……| }
ToString……} Ö
(……Ö Ü
)……Ü á
)……á à
.……à â
Length……â è
)……è ê
;……ê ë
}
   
catch
ÀÀ 
(
ÀÀ 
IOException
ÀÀ 
exceptIO
ÀÀ '
)
ÀÀ' (
{
ÃÃ 
IO
ÕÕ 
.
ÕÕ 
Logger
ÕÕ 
.
ÕÕ 
Log
ÕÕ 
(
ÕÕ 
NLog
ÕÕ "
.
ÕÕ" #
LogLevel
ÕÕ# +
.
ÕÕ+ ,
Warn
ÕÕ, 0
,
ÕÕ0 1
exceptIO
ÕÕ2 :
,
ÕÕ: ;
$str
ÕÕ< X
+
ÕÕY Z
port
ÕÕ[ _
.
ÕÕ_ `
ToString
ÕÕ` h
(
ÕÕh i
)
ÕÕi j
)
ÕÕj k
;
ÕÕk l
}
ŒŒ 
finally
œœ 
{
–– 
try
—— 
{
““ 
if
”” 
(
”” 
streamOutput
”” $
!=
””% '
null
””( ,
)
””, -
{
‘‘ 
streamOutput
’’ $
.
’’$ %
Close
’’% *
(
’’* +
)
’’+ ,
;
’’, -
}
÷÷ 
}
◊◊ 
catch
ÿÿ 
(
ÿÿ 
IOException
ÿÿ "
exceptIO
ÿÿ# +
)
ÿÿ+ ,
{
ŸŸ 
IO
⁄⁄ 
.
⁄⁄ 
Logger
⁄⁄ 
.
⁄⁄ 
Log
⁄⁄ !
(
⁄⁄! "
NLog
⁄⁄" &
.
⁄⁄& '
LogLevel
⁄⁄' /
.
⁄⁄/ 0
Warn
⁄⁄0 4
,
⁄⁄4 5
exceptIO
⁄⁄6 >
,
⁄⁄> ?
$str
⁄⁄@ W
)
⁄⁄W X
;
⁄⁄X Y
}
€€ 
try
›› 
{
ﬁﬁ 
if
ﬂﬂ 
(
ﬂﬂ 
tcpConn
ﬂﬂ 
!=
ﬂﬂ  "
null
ﬂﬂ# '
)
ﬂﬂ' (
{
‡‡ 
tcpConn
·· 
.
··  
Close
··  %
(
··% &
)
··& '
;
··' (
}
‚‚ 
}
„„ 
catch
‰‰ 
(
‰‰ 
IOException
‰‰ "
exceptIO
‰‰# +
)
‰‰+ ,
{
ÂÂ 
IO
ÊÊ 
.
ÊÊ 
Logger
ÊÊ 
.
ÊÊ 
Log
ÊÊ !
(
ÊÊ! "
NLog
ÊÊ" &
.
ÊÊ& '
LogLevel
ÊÊ' /
.
ÊÊ/ 0
Warn
ÊÊ0 4
,
ÊÊ4 5
exceptIO
ÊÊ6 >
,
ÊÊ> ?
$str
ÊÊ@ W
)
ÊÊW X
;
ÊÊX Y
}
ÁÁ 
try
ÈÈ 
{
ÍÍ 
if
ÎÎ 
(
ÎÎ 
listener
ÎÎ  
!=
ÎÎ! #
null
ÎÎ$ (
)
ÎÎ( )
{
ÏÏ 
listener
ÌÌ  
.
ÌÌ  !
Stop
ÌÌ! %
(
ÌÌ% &
)
ÌÌ& '
;
ÌÌ' (
}
ÓÓ 
}
ÔÔ 
catch
 
(
 
IOException
 "
exceptIO
# +
)
+ ,
{
ÒÒ 
IO
ÚÚ 
.
ÚÚ 
Logger
ÚÚ 
.
ÚÚ 
Log
ÚÚ !
(
ÚÚ! "
NLog
ÚÚ" &
.
ÚÚ& '
LogLevel
ÚÚ' /
.
ÚÚ/ 0
Warn
ÚÚ0 4
,
ÚÚ4 5
exceptIO
ÚÚ6 >
,
ÚÚ> ?
$str
ÚÚ@ W
)
ÚÚW X
;
ÚÚX Y
}
ÛÛ 
}
ıı 
}
ˆˆ 	
}
˜˜ 
public
˘˘ 

override
˘˘ 
void
˘˘ 
Good
˘˘ 
(
˘˘ 
)
˘˘ 
{
˙˙ 
Good1
˚˚ 
(
˚˚ 
)
˚˚ 
;
˚˚ 
Good2
¸¸ 
(
¸¸ 
)
¸¸ 
;
¸¸ 
}
˝˝ 
}ˇˇ 
}ÄÄ ‰å
ñC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__hostname_based_logic_06.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 4
(CWE510_Trapdoor__hostname_based_logic_06 .
:/ 0
AbstractTestCase1 A
{ 
private   
const   
int   
PRIVATE_CONST_FIVE   (
=  ) *
$num  + ,
;  , -
public"" 

override"" 
void"" 
Bad"" 
("" 
)"" 
{## 
if$$ 

($$ 
PRIVATE_CONST_FIVE$$ 
==$$ !
$num$$" #
)$$# $
{%% 	
TcpListener&& 
listener&&  
=&&! "
null&&# '
;&&' (
	TcpClient'' 
tcpConn'' 
='' 
null''  $
;''$ %
Stream(( 
streamOutput(( 
=((  !
null((" &
;((& '
int)) 
port)) 
=)) 
$num)) 
;)) 
try** 
{++ 
listener,, 
=,, 
new,, 
TcpListener,, *
(,,* +
	IPAddress,,+ 4
.,,4 5
Parse,,5 :
(,,: ;
$str,,; G
),,G H
,,,H I
port,,J N
),,N O
;,,O P
listener-- 
.-- 
Start-- 
(-- 
)--  
;--  !
tcpConn.. 
=.. 
listener.. "
..." #
AcceptTcpClient..# 2
(..2 3
)..3 4
;..4 5

IPEndPoint00 
endPoint00 #
=00$ %
(00& '

IPEndPoint00' 1
)001 2
tcpConn002 9
.009 :
Client00: @
.00@ A
RemoteEndPoint00A O
;00O P
	IPAddress11 
	ipAddress11 #
=11$ %
endPoint11& .
.11. /
Address11/ 6
;116 7
IPHostEntry22 
	hostEntry22 %
=22& '
Dns22( +
.22+ ,
GetHostEntry22, 8
(228 9
	ipAddress229 B
)22B C
;22C D
if33 
(33 
	hostEntry33 
.33 
HostName33 &
.33& '
Equals33' -
(33- .
$str33. @
)33@ A
)33A B
{44 
streamOutput55  
=55! "
tcpConn55# *
.55* +
	GetStream55+ 4
(554 5
)555 6
;556 7
streamOutput66  
.66  !
Write66! &
(66& '
Encoding66' /
.66/ 0
UTF8660 4
.664 5
GetBytes665 =
(66= >
$str66> O
)66O P
,66P Q
$num66R S
,66S T
$str66U f
.66f g
Length66g m
)66m n
;66n o
}77 
else88 
{99 
streamOutput::  
=::! "
tcpConn::# *
.::* +
	GetStream::+ 4
(::4 5
)::5 6
;::6 7
streamOutput;;  
.;;  !
Write;;! &
(;;& '
Encoding;;' /
.;;/ 0
UTF8;;0 4
.;;4 5
GetBytes;;5 =
(;;= >
$str;;> N
);;N O
,;;O P
$num;;Q R
,;;R S
$str;;T d
.;;d e
Length;;e k
);;k l
;;;l m
}<< 
}== 
catch>> 
(>> 
IOException>> 
exceptIO>> '
)>>' (
{?? 
IO@@ 
.@@ 
Logger@@ 
.@@ 
Log@@ 
(@@ 
NLog@@ "
.@@" #
LogLevel@@# +
.@@+ ,
Warn@@, 0
,@@0 1
exceptIO@@2 :
,@@: ;
$str@@< X
+@@Y Z
port@@[ _
.@@_ `
ToString@@` h
(@@h i
)@@i j
)@@j k
;@@k l
}AA 
finallyBB 
{CC 
tryDD 
{EE 
ifFF 
(FF 
streamOutputFF $
!=FF% '
nullFF( ,
)FF, -
{GG 
streamOutputHH $
.HH$ %
CloseHH% *
(HH* +
)HH+ ,
;HH, -
}II 
}JJ 
catchKK 
(KK 
IOExceptionKK "
exceptIOKK# +
)KK+ ,
{LL 
IOMM 
.MM 
LoggerMM 
.MM 
LogMM !
(MM! "
NLogMM" &
.MM& '
LogLevelMM' /
.MM/ 0
WarnMM0 4
,MM4 5
exceptIOMM6 >
,MM> ?
$strMM@ W
)MMW X
;MMX Y
}NN 
tryPP 
{QQ 
ifRR 
(RR 
tcpConnRR 
!=RR  "
nullRR# '
)RR' (
{SS 
tcpConnTT 
.TT  
CloseTT  %
(TT% &
)TT& '
;TT' (
}UU 
}VV 
catchWW 
(WW 
IOExceptionWW "
exceptIOWW# +
)WW+ ,
{XX 
IOYY 
.YY 
LoggerYY 
.YY 
LogYY !
(YY! "
NLogYY" &
.YY& '
LogLevelYY' /
.YY/ 0
WarnYY0 4
,YY4 5
exceptIOYY6 >
,YY> ?
$strYY@ W
)YYW X
;YYX Y
}ZZ 
try\\ 
{]] 
if^^ 
(^^ 
listener^^  
!=^^! #
null^^$ (
)^^( )
{__ 
listener``  
.``  !
Stop``! %
(``% &
)``& '
;``' (
}aa 
}bb 
catchcc 
(cc 
IOExceptioncc "
exceptIOcc# +
)cc+ ,
{dd 
IOee 
.ee 
Loggeree 
.ee 
Logee !
(ee! "
NLogee" &
.ee& '
LogLevelee' /
.ee/ 0
Warnee0 4
,ee4 5
exceptIOee6 >
,ee> ?
$stree@ W
)eeW X
;eeX Y
}ff 
}hh 
}ii 	
}jj 
privatenn 
voidnn 
Good1nn 
(nn 
)nn 
{oo 
ifpp 

(pp 
PRIVATE_CONST_FIVEpp 
!=pp !
$numpp" #
)pp# $
{qq 	
IOss 
.ss 
	WriteLiness 
(ss 
$strss /
)ss/ 0
;ss0 1
}tt 	
elseuu 
{vv 	
TcpListenerww 
listenerww  
=ww! "
nullww# '
;ww' (
	TcpClientxx 
tcpConnxx 
=xx 
nullxx  $
;xx$ %
Streamyy 
streamOutputyy 
=yy  !
nullyy" &
;yy& '
intzz 
portzz 
=zz 
$numzz 
;zz 
try{{ 
{|| 
listener}} 
=}} 
new}} 
TcpListener}} *
(}}* +
	IPAddress}}+ 4
.}}4 5
Parse}}5 :
(}}: ;
$str}}; G
)}}G H
,}}H I
port}}J N
)}}N O
;}}O P
listener~~ 
.~~ 
Start~~ 
(~~ 
)~~  
;~~  !
tcpConn 
= 
listener "
." #
AcceptTcpClient# 2
(2 3
)3 4
;4 5
streamOutput
ÄÄ 
=
ÄÄ 
tcpConn
ÄÄ &
.
ÄÄ& '
	GetStream
ÄÄ' 0
(
ÄÄ0 1
)
ÄÄ1 2
;
ÄÄ2 3

IPEndPoint
ÅÅ 
endPoint
ÅÅ #
=
ÅÅ$ %
(
ÅÅ& '

IPEndPoint
ÅÅ' 1
)
ÅÅ1 2
tcpConn
ÅÅ2 9
.
ÅÅ9 :
Client
ÅÅ: @
.
ÅÅ@ A
RemoteEndPoint
ÅÅA O
;
ÅÅO P
	IPAddress
ÇÇ 
	ipAddress
ÇÇ #
=
ÇÇ$ %
endPoint
ÇÇ& .
.
ÇÇ. /
Address
ÇÇ/ 6
;
ÇÇ6 7
IPHostEntry
ÉÉ 
	hostEntry
ÉÉ %
=
ÉÉ& '
Dns
ÉÉ( +
.
ÉÉ+ ,
GetHostEntry
ÉÉ, 8
(
ÉÉ8 9
	ipAddress
ÉÉ9 B
)
ÉÉB C
;
ÉÉC D
streamOutput
ÖÖ 
.
ÖÖ 
Write
ÖÖ "
(
ÖÖ" #
Encoding
ÖÖ# +
.
ÖÖ+ ,
UTF8
ÖÖ, 0
.
ÖÖ0 1
GetBytes
ÖÖ1 9
(
ÖÖ9 :
(
ÖÖ: ;
$str
ÖÖ; F
+
ÖÖG H
	hostEntry
ÖÖI R
.
ÖÖR S
ToString
ÖÖS [
(
ÖÖ[ \
)
ÖÖ\ ]
)
ÖÖ] ^
)
ÖÖ^ _
,
ÖÖ_ `
$num
ÖÖa b
,
ÖÖb c
(
ÖÖd e
$str
ÖÖe p
+
ÖÖq r
	hostEntry
ÖÖs |
.
ÖÖ| }
ToStringÖÖ} Ö
(ÖÖÖ Ü
)ÖÖÜ á
)ÖÖá à
.ÖÖà â
LengthÖÖâ è
)ÖÖè ê
;ÖÖê ë
}
ÜÜ 
catch
áá 
(
áá 
IOException
áá 
exceptIO
áá '
)
áá' (
{
àà 
IO
ââ 
.
ââ 
Logger
ââ 
.
ââ 
Log
ââ 
(
ââ 
NLog
ââ "
.
ââ" #
LogLevel
ââ# +
.
ââ+ ,
Warn
ââ, 0
,
ââ0 1
exceptIO
ââ2 :
,
ââ: ;
$str
ââ< X
+
ââY Z
port
ââ[ _
.
ââ_ `
ToString
ââ` h
(
ââh i
)
ââi j
)
ââj k
;
ââk l
}
ää 
finally
ãã 
{
åå 
try
çç 
{
éé 
if
èè 
(
èè 
streamOutput
èè $
!=
èè% '
null
èè( ,
)
èè, -
{
êê 
streamOutput
ëë $
.
ëë$ %
Close
ëë% *
(
ëë* +
)
ëë+ ,
;
ëë, -
}
íí 
}
ìì 
catch
îî 
(
îî 
IOException
îî "
exceptIO
îî# +
)
îî+ ,
{
ïï 
IO
ññ 
.
ññ 
Logger
ññ 
.
ññ 
Log
ññ !
(
ññ! "
NLog
ññ" &
.
ññ& '
LogLevel
ññ' /
.
ññ/ 0
Warn
ññ0 4
,
ññ4 5
exceptIO
ññ6 >
,
ññ> ?
$str
ññ@ W
)
ññW X
;
ññX Y
}
óó 
try
ôô 
{
öö 
if
õõ 
(
õõ 
tcpConn
õõ 
!=
õõ  "
null
õõ# '
)
õõ' (
{
úú 
tcpConn
ùù 
.
ùù  
Close
ùù  %
(
ùù% &
)
ùù& '
;
ùù' (
}
ûû 
}
üü 
catch
†† 
(
†† 
IOException
†† "
exceptIO
††# +
)
††+ ,
{
°° 
IO
¢¢ 
.
¢¢ 
Logger
¢¢ 
.
¢¢ 
Log
¢¢ !
(
¢¢! "
NLog
¢¢" &
.
¢¢& '
LogLevel
¢¢' /
.
¢¢/ 0
Warn
¢¢0 4
,
¢¢4 5
exceptIO
¢¢6 >
,
¢¢> ?
$str
¢¢@ W
)
¢¢W X
;
¢¢X Y
}
££ 
try
•• 
{
¶¶ 
if
ßß 
(
ßß 
listener
ßß  
!=
ßß! #
null
ßß$ (
)
ßß( )
{
®® 
listener
©©  
.
©©  !
Stop
©©! %
(
©©% &
)
©©& '
;
©©' (
}
™™ 
}
´´ 
catch
¨¨ 
(
¨¨ 
IOException
¨¨ "
exceptIO
¨¨# +
)
¨¨+ ,
{
≠≠ 
IO
ÆÆ 
.
ÆÆ 
Logger
ÆÆ 
.
ÆÆ 
Log
ÆÆ !
(
ÆÆ! "
NLog
ÆÆ" &
.
ÆÆ& '
LogLevel
ÆÆ' /
.
ÆÆ/ 0
Warn
ÆÆ0 4
,
ÆÆ4 5
exceptIO
ÆÆ6 >
,
ÆÆ> ?
$str
ÆÆ@ W
)
ÆÆW X
;
ÆÆX Y
}
ØØ 
}
±± 
}
≤≤ 	
}
≥≥ 
private
∂∂ 
void
∂∂ 
Good2
∂∂ 
(
∂∂ 
)
∂∂ 
{
∑∑ 
if
∏∏ 

(
∏∏  
PRIVATE_CONST_FIVE
∏∏ 
==
∏∏ !
$num
∏∏" #
)
∏∏# $
{
ππ 	
TcpListener
∫∫ 
listener
∫∫  
=
∫∫! "
null
∫∫# '
;
∫∫' (
	TcpClient
ªª 
tcpConn
ªª 
=
ªª 
null
ªª  $
;
ªª$ %
Stream
ºº 
streamOutput
ºº 
=
ºº  !
null
ºº" &
;
ºº& '
int
ΩΩ 
port
ΩΩ 
=
ΩΩ 
$num
ΩΩ 
;
ΩΩ 
try
ææ 
{
øø 
listener
¿¿ 
=
¿¿ 
new
¿¿ 
TcpListener
¿¿ *
(
¿¿* +
	IPAddress
¿¿+ 4
.
¿¿4 5
Parse
¿¿5 :
(
¿¿: ;
$str
¿¿; G
)
¿¿G H
,
¿¿H I
port
¿¿J N
)
¿¿N O
;
¿¿O P
listener
¡¡ 
.
¡¡ 
Start
¡¡ 
(
¡¡ 
)
¡¡  
;
¡¡  !
tcpConn
¬¬ 
=
¬¬ 
listener
¬¬ "
.
¬¬" #
AcceptTcpClient
¬¬# 2
(
¬¬2 3
)
¬¬3 4
;
¬¬4 5
streamOutput
√√ 
=
√√ 
tcpConn
√√ &
.
√√& '
	GetStream
√√' 0
(
√√0 1
)
√√1 2
;
√√2 3

IPEndPoint
ƒƒ 
endPoint
ƒƒ #
=
ƒƒ$ %
(
ƒƒ& '

IPEndPoint
ƒƒ' 1
)
ƒƒ1 2
tcpConn
ƒƒ2 9
.
ƒƒ9 :
Client
ƒƒ: @
.
ƒƒ@ A
RemoteEndPoint
ƒƒA O
;
ƒƒO P
	IPAddress
≈≈ 
	ipAddress
≈≈ #
=
≈≈$ %
endPoint
≈≈& .
.
≈≈. /
Address
≈≈/ 6
;
≈≈6 7
IPHostEntry
∆∆ 
	hostEntry
∆∆ %
=
∆∆& '
Dns
∆∆( +
.
∆∆+ ,
GetHostEntry
∆∆, 8
(
∆∆8 9
	ipAddress
∆∆9 B
)
∆∆B C
;
∆∆C D
streamOutput
»» 
.
»» 
Write
»» "
(
»»" #
Encoding
»»# +
.
»»+ ,
UTF8
»», 0
.
»»0 1
GetBytes
»»1 9
(
»»9 :
(
»»: ;
$str
»»; F
+
»»G H
	hostEntry
»»I R
.
»»R S
ToString
»»S [
(
»»[ \
)
»»\ ]
)
»»] ^
)
»»^ _
,
»»_ `
$num
»»a b
,
»»b c
(
»»d e
$str
»»e p
+
»»q r
	hostEntry
»»s |
.
»»| }
ToString»»} Ö
(»»Ö Ü
)»»Ü á
)»»á à
.»»à â
Length»»â è
)»»è ê
;»»ê ë
}
…… 
catch
   
(
   
IOException
   
exceptIO
   '
)
  ' (
{
ÀÀ 
IO
ÃÃ 
.
ÃÃ 
Logger
ÃÃ 
.
ÃÃ 
Log
ÃÃ 
(
ÃÃ 
NLog
ÃÃ "
.
ÃÃ" #
LogLevel
ÃÃ# +
.
ÃÃ+ ,
Warn
ÃÃ, 0
,
ÃÃ0 1
exceptIO
ÃÃ2 :
,
ÃÃ: ;
$str
ÃÃ< X
+
ÃÃY Z
port
ÃÃ[ _
.
ÃÃ_ `
ToString
ÃÃ` h
(
ÃÃh i
)
ÃÃi j
)
ÃÃj k
;
ÃÃk l
}
ÕÕ 
finally
ŒŒ 
{
œœ 
try
–– 
{
—— 
if
““ 
(
““ 
streamOutput
““ $
!=
““% '
null
““( ,
)
““, -
{
”” 
streamOutput
‘‘ $
.
‘‘$ %
Close
‘‘% *
(
‘‘* +
)
‘‘+ ,
;
‘‘, -
}
’’ 
}
÷÷ 
catch
◊◊ 
(
◊◊ 
IOException
◊◊ "
exceptIO
◊◊# +
)
◊◊+ ,
{
ÿÿ 
IO
ŸŸ 
.
ŸŸ 
Logger
ŸŸ 
.
ŸŸ 
Log
ŸŸ !
(
ŸŸ! "
NLog
ŸŸ" &
.
ŸŸ& '
LogLevel
ŸŸ' /
.
ŸŸ/ 0
Warn
ŸŸ0 4
,
ŸŸ4 5
exceptIO
ŸŸ6 >
,
ŸŸ> ?
$str
ŸŸ@ W
)
ŸŸW X
;
ŸŸX Y
}
⁄⁄ 
try
‹‹ 
{
›› 
if
ﬁﬁ 
(
ﬁﬁ 
tcpConn
ﬁﬁ 
!=
ﬁﬁ  "
null
ﬁﬁ# '
)
ﬁﬁ' (
{
ﬂﬂ 
tcpConn
‡‡ 
.
‡‡  
Close
‡‡  %
(
‡‡% &
)
‡‡& '
;
‡‡' (
}
·· 
}
‚‚ 
catch
„„ 
(
„„ 
IOException
„„ "
exceptIO
„„# +
)
„„+ ,
{
‰‰ 
IO
ÂÂ 
.
ÂÂ 
Logger
ÂÂ 
.
ÂÂ 
Log
ÂÂ !
(
ÂÂ! "
NLog
ÂÂ" &
.
ÂÂ& '
LogLevel
ÂÂ' /
.
ÂÂ/ 0
Warn
ÂÂ0 4
,
ÂÂ4 5
exceptIO
ÂÂ6 >
,
ÂÂ> ?
$str
ÂÂ@ W
)
ÂÂW X
;
ÂÂX Y
}
ÊÊ 
try
ËË 
{
ÈÈ 
if
ÍÍ 
(
ÍÍ 
listener
ÍÍ  
!=
ÍÍ! #
null
ÍÍ$ (
)
ÍÍ( )
{
ÎÎ 
listener
ÏÏ  
.
ÏÏ  !
Stop
ÏÏ! %
(
ÏÏ% &
)
ÏÏ& '
;
ÏÏ' (
}
ÌÌ 
}
ÓÓ 
catch
ÔÔ 
(
ÔÔ 
IOException
ÔÔ "
exceptIO
ÔÔ# +
)
ÔÔ+ ,
{
 
IO
ÒÒ 
.
ÒÒ 
Logger
ÒÒ 
.
ÒÒ 
Log
ÒÒ !
(
ÒÒ! "
NLog
ÒÒ" &
.
ÒÒ& '
LogLevel
ÒÒ' /
.
ÒÒ/ 0
Warn
ÒÒ0 4
,
ÒÒ4 5
exceptIO
ÒÒ6 >
,
ÒÒ> ?
$str
ÒÒ@ W
)
ÒÒW X
;
ÒÒX Y
}
ÚÚ 
}
ÙÙ 
}
ıı 	
}
ˆˆ 
public
¯¯ 

override
¯¯ 
void
¯¯ 
Good
¯¯ 
(
¯¯ 
)
¯¯ 
{
˘˘ 
Good1
˙˙ 
(
˙˙ 
)
˙˙ 
;
˙˙ 
Good2
˚˚ 
(
˚˚ 
)
˚˚ 
;
˚˚ 
}
¸¸ 
}˛˛ 
}ˇˇ µå
ñC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__hostname_based_logic_07.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 4
(CWE510_Trapdoor__hostname_based_logic_07 .
:/ 0
AbstractTestCase1 A
{ 
private   
int   
privateFive   
=   
$num   
;    
public"" 

override"" 
void"" 
Bad"" 
("" 
)"" 
{## 
if$$ 

($$ 
privateFive$$ 
==$$ 
$num$$ 
)$$ 
{%% 	
TcpListener&& 
listener&&  
=&&! "
null&&# '
;&&' (
	TcpClient'' 
tcpConn'' 
='' 
null''  $
;''$ %
Stream(( 
streamOutput(( 
=((  !
null((" &
;((& '
int)) 
port)) 
=)) 
$num)) 
;)) 
try** 
{++ 
listener,, 
=,, 
new,, 
TcpListener,, *
(,,* +
	IPAddress,,+ 4
.,,4 5
Parse,,5 :
(,,: ;
$str,,; G
),,G H
,,,H I
port,,J N
),,N O
;,,O P
listener-- 
.-- 
Start-- 
(-- 
)--  
;--  !
tcpConn.. 
=.. 
listener.. "
..." #
AcceptTcpClient..# 2
(..2 3
)..3 4
;..4 5

IPEndPoint00 
endPoint00 #
=00$ %
(00& '

IPEndPoint00' 1
)001 2
tcpConn002 9
.009 :
Client00: @
.00@ A
RemoteEndPoint00A O
;00O P
	IPAddress11 
	ipAddress11 #
=11$ %
endPoint11& .
.11. /
Address11/ 6
;116 7
IPHostEntry22 
	hostEntry22 %
=22& '
Dns22( +
.22+ ,
GetHostEntry22, 8
(228 9
	ipAddress229 B
)22B C
;22C D
if33 
(33 
	hostEntry33 
.33 
HostName33 &
.33& '
Equals33' -
(33- .
$str33. @
)33@ A
)33A B
{44 
streamOutput55  
=55! "
tcpConn55# *
.55* +
	GetStream55+ 4
(554 5
)555 6
;556 7
streamOutput66  
.66  !
Write66! &
(66& '
Encoding66' /
.66/ 0
UTF8660 4
.664 5
GetBytes665 =
(66= >
$str66> O
)66O P
,66P Q
$num66R S
,66S T
$str66U f
.66f g
Length66g m
)66m n
;66n o
}77 
else88 
{99 
streamOutput::  
=::! "
tcpConn::# *
.::* +
	GetStream::+ 4
(::4 5
)::5 6
;::6 7
streamOutput;;  
.;;  !
Write;;! &
(;;& '
Encoding;;' /
.;;/ 0
UTF8;;0 4
.;;4 5
GetBytes;;5 =
(;;= >
$str;;> N
);;N O
,;;O P
$num;;Q R
,;;R S
$str;;T d
.;;d e
Length;;e k
);;k l
;;;l m
}<< 
}== 
catch>> 
(>> 
IOException>> 
exceptIO>> '
)>>' (
{?? 
IO@@ 
.@@ 
Logger@@ 
.@@ 
Log@@ 
(@@ 
NLog@@ "
.@@" #
LogLevel@@# +
.@@+ ,
Warn@@, 0
,@@0 1
exceptIO@@2 :
,@@: ;
$str@@< X
+@@Y Z
port@@[ _
.@@_ `
ToString@@` h
(@@h i
)@@i j
)@@j k
;@@k l
}AA 
finallyBB 
{CC 
tryDD 
{EE 
ifFF 
(FF 
streamOutputFF $
!=FF% '
nullFF( ,
)FF, -
{GG 
streamOutputHH $
.HH$ %
CloseHH% *
(HH* +
)HH+ ,
;HH, -
}II 
}JJ 
catchKK 
(KK 
IOExceptionKK "
exceptIOKK# +
)KK+ ,
{LL 
IOMM 
.MM 
LoggerMM 
.MM 
LogMM !
(MM! "
NLogMM" &
.MM& '
LogLevelMM' /
.MM/ 0
WarnMM0 4
,MM4 5
exceptIOMM6 >
,MM> ?
$strMM@ W
)MMW X
;MMX Y
}NN 
tryPP 
{QQ 
ifRR 
(RR 
tcpConnRR 
!=RR  "
nullRR# '
)RR' (
{SS 
tcpConnTT 
.TT  
CloseTT  %
(TT% &
)TT& '
;TT' (
}UU 
}VV 
catchWW 
(WW 
IOExceptionWW "
exceptIOWW# +
)WW+ ,
{XX 
IOYY 
.YY 
LoggerYY 
.YY 
LogYY !
(YY! "
NLogYY" &
.YY& '
LogLevelYY' /
.YY/ 0
WarnYY0 4
,YY4 5
exceptIOYY6 >
,YY> ?
$strYY@ W
)YYW X
;YYX Y
}ZZ 
try\\ 
{]] 
if^^ 
(^^ 
listener^^  
!=^^! #
null^^$ (
)^^( )
{__ 
listener``  
.``  !
Stop``! %
(``% &
)``& '
;``' (
}aa 
}bb 
catchcc 
(cc 
IOExceptioncc "
exceptIOcc# +
)cc+ ,
{dd 
IOee 
.ee 
Loggeree 
.ee 
Logee !
(ee! "
NLogee" &
.ee& '
LogLevelee' /
.ee/ 0
Warnee0 4
,ee4 5
exceptIOee6 >
,ee> ?
$stree@ W
)eeW X
;eeX Y
}ff 
}hh 
}ii 	
}jj 
privatenn 
voidnn 
Good1nn 
(nn 
)nn 
{oo 
ifpp 

(pp 
privateFivepp 
!=pp 
$numpp 
)pp 
{qq 	
IOss 
.ss 
	WriteLiness 
(ss 
$strss /
)ss/ 0
;ss0 1
}tt 	
elseuu 
{vv 	
TcpListenerww 
listenerww  
=ww! "
nullww# '
;ww' (
	TcpClientxx 
tcpConnxx 
=xx 
nullxx  $
;xx$ %
Streamyy 
streamOutputyy 
=yy  !
nullyy" &
;yy& '
intzz 
portzz 
=zz 
$numzz 
;zz 
try{{ 
{|| 
listener}} 
=}} 
new}} 
TcpListener}} *
(}}* +
	IPAddress}}+ 4
.}}4 5
Parse}}5 :
(}}: ;
$str}}; G
)}}G H
,}}H I
port}}J N
)}}N O
;}}O P
listener~~ 
.~~ 
Start~~ 
(~~ 
)~~  
;~~  !
tcpConn 
= 
listener "
." #
AcceptTcpClient# 2
(2 3
)3 4
;4 5
streamOutput
ÄÄ 
=
ÄÄ 
tcpConn
ÄÄ &
.
ÄÄ& '
	GetStream
ÄÄ' 0
(
ÄÄ0 1
)
ÄÄ1 2
;
ÄÄ2 3

IPEndPoint
ÅÅ 
endPoint
ÅÅ #
=
ÅÅ$ %
(
ÅÅ& '

IPEndPoint
ÅÅ' 1
)
ÅÅ1 2
tcpConn
ÅÅ2 9
.
ÅÅ9 :
Client
ÅÅ: @
.
ÅÅ@ A
RemoteEndPoint
ÅÅA O
;
ÅÅO P
	IPAddress
ÇÇ 
	ipAddress
ÇÇ #
=
ÇÇ$ %
endPoint
ÇÇ& .
.
ÇÇ. /
Address
ÇÇ/ 6
;
ÇÇ6 7
IPHostEntry
ÉÉ 
	hostEntry
ÉÉ %
=
ÉÉ& '
Dns
ÉÉ( +
.
ÉÉ+ ,
GetHostEntry
ÉÉ, 8
(
ÉÉ8 9
	ipAddress
ÉÉ9 B
)
ÉÉB C
;
ÉÉC D
streamOutput
ÖÖ 
.
ÖÖ 
Write
ÖÖ "
(
ÖÖ" #
Encoding
ÖÖ# +
.
ÖÖ+ ,
UTF8
ÖÖ, 0
.
ÖÖ0 1
GetBytes
ÖÖ1 9
(
ÖÖ9 :
(
ÖÖ: ;
$str
ÖÖ; F
+
ÖÖG H
	hostEntry
ÖÖI R
.
ÖÖR S
ToString
ÖÖS [
(
ÖÖ[ \
)
ÖÖ\ ]
)
ÖÖ] ^
)
ÖÖ^ _
,
ÖÖ_ `
$num
ÖÖa b
,
ÖÖb c
(
ÖÖd e
$str
ÖÖe p
+
ÖÖq r
	hostEntry
ÖÖs |
.
ÖÖ| }
ToStringÖÖ} Ö
(ÖÖÖ Ü
)ÖÖÜ á
)ÖÖá à
.ÖÖà â
LengthÖÖâ è
)ÖÖè ê
;ÖÖê ë
}
ÜÜ 
catch
áá 
(
áá 
IOException
áá 
exceptIO
áá '
)
áá' (
{
àà 
IO
ââ 
.
ââ 
Logger
ââ 
.
ââ 
Log
ââ 
(
ââ 
NLog
ââ "
.
ââ" #
LogLevel
ââ# +
.
ââ+ ,
Warn
ââ, 0
,
ââ0 1
exceptIO
ââ2 :
,
ââ: ;
$str
ââ< X
+
ââY Z
port
ââ[ _
.
ââ_ `
ToString
ââ` h
(
ââh i
)
ââi j
)
ââj k
;
ââk l
}
ää 
finally
ãã 
{
åå 
try
çç 
{
éé 
if
èè 
(
èè 
streamOutput
èè $
!=
èè% '
null
èè( ,
)
èè, -
{
êê 
streamOutput
ëë $
.
ëë$ %
Close
ëë% *
(
ëë* +
)
ëë+ ,
;
ëë, -
}
íí 
}
ìì 
catch
îî 
(
îî 
IOException
îî "
exceptIO
îî# +
)
îî+ ,
{
ïï 
IO
ññ 
.
ññ 
Logger
ññ 
.
ññ 
Log
ññ !
(
ññ! "
NLog
ññ" &
.
ññ& '
LogLevel
ññ' /
.
ññ/ 0
Warn
ññ0 4
,
ññ4 5
exceptIO
ññ6 >
,
ññ> ?
$str
ññ@ W
)
ññW X
;
ññX Y
}
óó 
try
ôô 
{
öö 
if
õõ 
(
õõ 
tcpConn
õõ 
!=
õõ  "
null
õõ# '
)
õõ' (
{
úú 
tcpConn
ùù 
.
ùù  
Close
ùù  %
(
ùù% &
)
ùù& '
;
ùù' (
}
ûû 
}
üü 
catch
†† 
(
†† 
IOException
†† "
exceptIO
††# +
)
††+ ,
{
°° 
IO
¢¢ 
.
¢¢ 
Logger
¢¢ 
.
¢¢ 
Log
¢¢ !
(
¢¢! "
NLog
¢¢" &
.
¢¢& '
LogLevel
¢¢' /
.
¢¢/ 0
Warn
¢¢0 4
,
¢¢4 5
exceptIO
¢¢6 >
,
¢¢> ?
$str
¢¢@ W
)
¢¢W X
;
¢¢X Y
}
££ 
try
•• 
{
¶¶ 
if
ßß 
(
ßß 
listener
ßß  
!=
ßß! #
null
ßß$ (
)
ßß( )
{
®® 
listener
©©  
.
©©  !
Stop
©©! %
(
©©% &
)
©©& '
;
©©' (
}
™™ 
}
´´ 
catch
¨¨ 
(
¨¨ 
IOException
¨¨ "
exceptIO
¨¨# +
)
¨¨+ ,
{
≠≠ 
IO
ÆÆ 
.
ÆÆ 
Logger
ÆÆ 
.
ÆÆ 
Log
ÆÆ !
(
ÆÆ! "
NLog
ÆÆ" &
.
ÆÆ& '
LogLevel
ÆÆ' /
.
ÆÆ/ 0
Warn
ÆÆ0 4
,
ÆÆ4 5
exceptIO
ÆÆ6 >
,
ÆÆ> ?
$str
ÆÆ@ W
)
ÆÆW X
;
ÆÆX Y
}
ØØ 
}
±± 
}
≤≤ 	
}
≥≥ 
private
∂∂ 
void
∂∂ 
Good2
∂∂ 
(
∂∂ 
)
∂∂ 
{
∑∑ 
if
∏∏ 

(
∏∏ 
privateFive
∏∏ 
==
∏∏ 
$num
∏∏ 
)
∏∏ 
{
ππ 	
TcpListener
∫∫ 
listener
∫∫  
=
∫∫! "
null
∫∫# '
;
∫∫' (
	TcpClient
ªª 
tcpConn
ªª 
=
ªª 
null
ªª  $
;
ªª$ %
Stream
ºº 
streamOutput
ºº 
=
ºº  !
null
ºº" &
;
ºº& '
int
ΩΩ 
port
ΩΩ 
=
ΩΩ 
$num
ΩΩ 
;
ΩΩ 
try
ææ 
{
øø 
listener
¿¿ 
=
¿¿ 
new
¿¿ 
TcpListener
¿¿ *
(
¿¿* +
	IPAddress
¿¿+ 4
.
¿¿4 5
Parse
¿¿5 :
(
¿¿: ;
$str
¿¿; G
)
¿¿G H
,
¿¿H I
port
¿¿J N
)
¿¿N O
;
¿¿O P
listener
¡¡ 
.
¡¡ 
Start
¡¡ 
(
¡¡ 
)
¡¡  
;
¡¡  !
tcpConn
¬¬ 
=
¬¬ 
listener
¬¬ "
.
¬¬" #
AcceptTcpClient
¬¬# 2
(
¬¬2 3
)
¬¬3 4
;
¬¬4 5
streamOutput
√√ 
=
√√ 
tcpConn
√√ &
.
√√& '
	GetStream
√√' 0
(
√√0 1
)
√√1 2
;
√√2 3

IPEndPoint
ƒƒ 
endPoint
ƒƒ #
=
ƒƒ$ %
(
ƒƒ& '

IPEndPoint
ƒƒ' 1
)
ƒƒ1 2
tcpConn
ƒƒ2 9
.
ƒƒ9 :
Client
ƒƒ: @
.
ƒƒ@ A
RemoteEndPoint
ƒƒA O
;
ƒƒO P
	IPAddress
≈≈ 
	ipAddress
≈≈ #
=
≈≈$ %
endPoint
≈≈& .
.
≈≈. /
Address
≈≈/ 6
;
≈≈6 7
IPHostEntry
∆∆ 
	hostEntry
∆∆ %
=
∆∆& '
Dns
∆∆( +
.
∆∆+ ,
GetHostEntry
∆∆, 8
(
∆∆8 9
	ipAddress
∆∆9 B
)
∆∆B C
;
∆∆C D
streamOutput
»» 
.
»» 
Write
»» "
(
»»" #
Encoding
»»# +
.
»»+ ,
UTF8
»», 0
.
»»0 1
GetBytes
»»1 9
(
»»9 :
(
»»: ;
$str
»»; F
+
»»G H
	hostEntry
»»I R
.
»»R S
ToString
»»S [
(
»»[ \
)
»»\ ]
)
»»] ^
)
»»^ _
,
»»_ `
$num
»»a b
,
»»b c
(
»»d e
$str
»»e p
+
»»q r
	hostEntry
»»s |
.
»»| }
ToString»»} Ö
(»»Ö Ü
)»»Ü á
)»»á à
.»»à â
Length»»â è
)»»è ê
;»»ê ë
}
…… 
catch
   
(
   
IOException
   
exceptIO
   '
)
  ' (
{
ÀÀ 
IO
ÃÃ 
.
ÃÃ 
Logger
ÃÃ 
.
ÃÃ 
Log
ÃÃ 
(
ÃÃ 
NLog
ÃÃ "
.
ÃÃ" #
LogLevel
ÃÃ# +
.
ÃÃ+ ,
Warn
ÃÃ, 0
,
ÃÃ0 1
exceptIO
ÃÃ2 :
,
ÃÃ: ;
$str
ÃÃ< X
+
ÃÃY Z
port
ÃÃ[ _
.
ÃÃ_ `
ToString
ÃÃ` h
(
ÃÃh i
)
ÃÃi j
)
ÃÃj k
;
ÃÃk l
}
ÕÕ 
finally
ŒŒ 
{
œœ 
try
–– 
{
—— 
if
““ 
(
““ 
streamOutput
““ $
!=
““% '
null
““( ,
)
““, -
{
”” 
streamOutput
‘‘ $
.
‘‘$ %
Close
‘‘% *
(
‘‘* +
)
‘‘+ ,
;
‘‘, -
}
’’ 
}
÷÷ 
catch
◊◊ 
(
◊◊ 
IOException
◊◊ "
exceptIO
◊◊# +
)
◊◊+ ,
{
ÿÿ 
IO
ŸŸ 
.
ŸŸ 
Logger
ŸŸ 
.
ŸŸ 
Log
ŸŸ !
(
ŸŸ! "
NLog
ŸŸ" &
.
ŸŸ& '
LogLevel
ŸŸ' /
.
ŸŸ/ 0
Warn
ŸŸ0 4
,
ŸŸ4 5
exceptIO
ŸŸ6 >
,
ŸŸ> ?
$str
ŸŸ@ W
)
ŸŸW X
;
ŸŸX Y
}
⁄⁄ 
try
‹‹ 
{
›› 
if
ﬁﬁ 
(
ﬁﬁ 
tcpConn
ﬁﬁ 
!=
ﬁﬁ  "
null
ﬁﬁ# '
)
ﬁﬁ' (
{
ﬂﬂ 
tcpConn
‡‡ 
.
‡‡  
Close
‡‡  %
(
‡‡% &
)
‡‡& '
;
‡‡' (
}
·· 
}
‚‚ 
catch
„„ 
(
„„ 
IOException
„„ "
exceptIO
„„# +
)
„„+ ,
{
‰‰ 
IO
ÂÂ 
.
ÂÂ 
Logger
ÂÂ 
.
ÂÂ 
Log
ÂÂ !
(
ÂÂ! "
NLog
ÂÂ" &
.
ÂÂ& '
LogLevel
ÂÂ' /
.
ÂÂ/ 0
Warn
ÂÂ0 4
,
ÂÂ4 5
exceptIO
ÂÂ6 >
,
ÂÂ> ?
$str
ÂÂ@ W
)
ÂÂW X
;
ÂÂX Y
}
ÊÊ 
try
ËË 
{
ÈÈ 
if
ÍÍ 
(
ÍÍ 
listener
ÍÍ  
!=
ÍÍ! #
null
ÍÍ$ (
)
ÍÍ( )
{
ÎÎ 
listener
ÏÏ  
.
ÏÏ  !
Stop
ÏÏ! %
(
ÏÏ% &
)
ÏÏ& '
;
ÏÏ' (
}
ÌÌ 
}
ÓÓ 
catch
ÔÔ 
(
ÔÔ 
IOException
ÔÔ "
exceptIO
ÔÔ# +
)
ÔÔ+ ,
{
 
IO
ÒÒ 
.
ÒÒ 
Logger
ÒÒ 
.
ÒÒ 
Log
ÒÒ !
(
ÒÒ! "
NLog
ÒÒ" &
.
ÒÒ& '
LogLevel
ÒÒ' /
.
ÒÒ/ 0
Warn
ÒÒ0 4
,
ÒÒ4 5
exceptIO
ÒÒ6 >
,
ÒÒ> ?
$str
ÒÒ@ W
)
ÒÒW X
;
ÒÒX Y
}
ÚÚ 
}
ÙÙ 
}
ıı 	
}
ˆˆ 
public
¯¯ 

override
¯¯ 
void
¯¯ 
Good
¯¯ 
(
¯¯ 
)
¯¯ 
{
˘˘ 
Good1
˙˙ 
(
˙˙ 
)
˙˙ 
;
˙˙ 
Good2
˚˚ 
(
˚˚ 
)
˚˚ 
;
˚˚ 
}
¸¸ 
}˛˛ 
}ˇˇ ∆è
ñC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__hostname_based_logic_08.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 4
(CWE510_Trapdoor__hostname_based_logic_08 .
:/ 0
AbstractTestCase1 A
{ 
private   
static   
bool   
PrivateReturnsTrue   *
(  * +
)  + ,
{!! 
return"" 
true"" 
;"" 
}## 
private%% 
static%% 
bool%% 
PrivateReturnsFalse%% +
(%%+ ,
)%%, -
{&& 
return'' 
false'' 
;'' 
}(( 
public** 

override** 
void** 
Bad** 
(** 
)** 
{++ 
if,, 

(,, 
PrivateReturnsTrue,, 
(,, 
),,  
),,  !
{-- 	
TcpListener.. 
listener..  
=..! "
null..# '
;..' (
	TcpClient// 
tcpConn// 
=// 
null//  $
;//$ %
Stream00 
streamOutput00 
=00  !
null00" &
;00& '
int11 
port11 
=11 
$num11 
;11 
try22 
{33 
listener44 
=44 
new44 
TcpListener44 *
(44* +
	IPAddress44+ 4
.444 5
Parse445 :
(44: ;
$str44; G
)44G H
,44H I
port44J N
)44N O
;44O P
listener55 
.55 
Start55 
(55 
)55  
;55  !
tcpConn66 
=66 
listener66 "
.66" #
AcceptTcpClient66# 2
(662 3
)663 4
;664 5

IPEndPoint88 
endPoint88 #
=88$ %
(88& '

IPEndPoint88' 1
)881 2
tcpConn882 9
.889 :
Client88: @
.88@ A
RemoteEndPoint88A O
;88O P
	IPAddress99 
	ipAddress99 #
=99$ %
endPoint99& .
.99. /
Address99/ 6
;996 7
IPHostEntry:: 
	hostEntry:: %
=::& '
Dns::( +
.::+ ,
GetHostEntry::, 8
(::8 9
	ipAddress::9 B
)::B C
;::C D
if;; 
(;; 
	hostEntry;; 
.;; 
HostName;; &
.;;& '
Equals;;' -
(;;- .
$str;;. @
);;@ A
);;A B
{<< 
streamOutput==  
===! "
tcpConn==# *
.==* +
	GetStream==+ 4
(==4 5
)==5 6
;==6 7
streamOutput>>  
.>>  !
Write>>! &
(>>& '
Encoding>>' /
.>>/ 0
UTF8>>0 4
.>>4 5
GetBytes>>5 =
(>>= >
$str>>> O
)>>O P
,>>P Q
$num>>R S
,>>S T
$str>>U f
.>>f g
Length>>g m
)>>m n
;>>n o
}?? 
else@@ 
{AA 
streamOutputBB  
=BB! "
tcpConnBB# *
.BB* +
	GetStreamBB+ 4
(BB4 5
)BB5 6
;BB6 7
streamOutputCC  
.CC  !
WriteCC! &
(CC& '
EncodingCC' /
.CC/ 0
UTF8CC0 4
.CC4 5
GetBytesCC5 =
(CC= >
$strCC> N
)CCN O
,CCO P
$numCCQ R
,CCR S
$strCCT d
.CCd e
LengthCCe k
)CCk l
;CCl m
}DD 
}EE 
catchFF 
(FF 
IOExceptionFF 
exceptIOFF '
)FF' (
{GG 
IOHH 
.HH 
LoggerHH 
.HH 
LogHH 
(HH 
NLogHH "
.HH" #
LogLevelHH# +
.HH+ ,
WarnHH, 0
,HH0 1
exceptIOHH2 :
,HH: ;
$strHH< X
+HHY Z
portHH[ _
.HH_ `
ToStringHH` h
(HHh i
)HHi j
)HHj k
;HHk l
}II 
finallyJJ 
{KK 
tryLL 
{MM 
ifNN 
(NN 
streamOutputNN $
!=NN% '
nullNN( ,
)NN, -
{OO 
streamOutputPP $
.PP$ %
ClosePP% *
(PP* +
)PP+ ,
;PP, -
}QQ 
}RR 
catchSS 
(SS 
IOExceptionSS "
exceptIOSS# +
)SS+ ,
{TT 
IOUU 
.UU 
LoggerUU 
.UU 
LogUU !
(UU! "
NLogUU" &
.UU& '
LogLevelUU' /
.UU/ 0
WarnUU0 4
,UU4 5
exceptIOUU6 >
,UU> ?
$strUU@ W
)UUW X
;UUX Y
}VV 
tryXX 
{YY 
ifZZ 
(ZZ 
tcpConnZZ 
!=ZZ  "
nullZZ# '
)ZZ' (
{[[ 
tcpConn\\ 
.\\  
Close\\  %
(\\% &
)\\& '
;\\' (
}]] 
}^^ 
catch__ 
(__ 
IOException__ "
exceptIO__# +
)__+ ,
{`` 
IOaa 
.aa 
Loggeraa 
.aa 
Logaa !
(aa! "
NLogaa" &
.aa& '
LogLevelaa' /
.aa/ 0
Warnaa0 4
,aa4 5
exceptIOaa6 >
,aa> ?
$straa@ W
)aaW X
;aaX Y
}bb 
trydd 
{ee 
ifff 
(ff 
listenerff  
!=ff! #
nullff$ (
)ff( )
{gg 
listenerhh  
.hh  !
Stophh! %
(hh% &
)hh& '
;hh' (
}ii 
}jj 
catchkk 
(kk 
IOExceptionkk "
exceptIOkk# +
)kk+ ,
{ll 
IOmm 
.mm 
Loggermm 
.mm 
Logmm !
(mm! "
NLogmm" &
.mm& '
LogLevelmm' /
.mm/ 0
Warnmm0 4
,mm4 5
exceptIOmm6 >
,mm> ?
$strmm@ W
)mmW X
;mmX Y
}nn 
}pp 
}qq 	
}rr 
privatevv 
voidvv 
Good1vv 
(vv 
)vv 
{ww 
ifxx 

(xx 
PrivateReturnsFalsexx 
(xx  
)xx  !
)xx! "
{yy 	
IO{{ 
.{{ 
	WriteLine{{ 
({{ 
$str{{ /
){{/ 0
;{{0 1
}|| 	
else}} 
{~~ 	
TcpListener 
listener  
=! "
null# '
;' (
	TcpClient
ÄÄ 
tcpConn
ÄÄ 
=
ÄÄ 
null
ÄÄ  $
;
ÄÄ$ %
Stream
ÅÅ 
streamOutput
ÅÅ 
=
ÅÅ  !
null
ÅÅ" &
;
ÅÅ& '
int
ÇÇ 
port
ÇÇ 
=
ÇÇ 
$num
ÇÇ 
;
ÇÇ 
try
ÉÉ 
{
ÑÑ 
listener
ÖÖ 
=
ÖÖ 
new
ÖÖ 
TcpListener
ÖÖ *
(
ÖÖ* +
	IPAddress
ÖÖ+ 4
.
ÖÖ4 5
Parse
ÖÖ5 :
(
ÖÖ: ;
$str
ÖÖ; G
)
ÖÖG H
,
ÖÖH I
port
ÖÖJ N
)
ÖÖN O
;
ÖÖO P
listener
ÜÜ 
.
ÜÜ 
Start
ÜÜ 
(
ÜÜ 
)
ÜÜ  
;
ÜÜ  !
tcpConn
áá 
=
áá 
listener
áá "
.
áá" #
AcceptTcpClient
áá# 2
(
áá2 3
)
áá3 4
;
áá4 5
streamOutput
àà 
=
àà 
tcpConn
àà &
.
àà& '
	GetStream
àà' 0
(
àà0 1
)
àà1 2
;
àà2 3

IPEndPoint
ââ 
endPoint
ââ #
=
ââ$ %
(
ââ& '

IPEndPoint
ââ' 1
)
ââ1 2
tcpConn
ââ2 9
.
ââ9 :
Client
ââ: @
.
ââ@ A
RemoteEndPoint
ââA O
;
ââO P
	IPAddress
ää 
	ipAddress
ää #
=
ää$ %
endPoint
ää& .
.
ää. /
Address
ää/ 6
;
ää6 7
IPHostEntry
ãã 
	hostEntry
ãã %
=
ãã& '
Dns
ãã( +
.
ãã+ ,
GetHostEntry
ãã, 8
(
ãã8 9
	ipAddress
ãã9 B
)
ããB C
;
ããC D
streamOutput
çç 
.
çç 
Write
çç "
(
çç" #
Encoding
çç# +
.
çç+ ,
UTF8
çç, 0
.
çç0 1
GetBytes
çç1 9
(
çç9 :
(
çç: ;
$str
çç; F
+
ççG H
	hostEntry
ççI R
.
ççR S
ToString
ççS [
(
çç[ \
)
çç\ ]
)
çç] ^
)
çç^ _
,
çç_ `
$num
çça b
,
ççb c
(
ççd e
$str
ççe p
+
ççq r
	hostEntry
ççs |
.
çç| }
ToStringçç} Ö
(ççÖ Ü
)ççÜ á
)ççá à
.ççà â
Lengthççâ è
)ççè ê
;ççê ë
}
éé 
catch
èè 
(
èè 
IOException
èè 
exceptIO
èè '
)
èè' (
{
êê 
IO
ëë 
.
ëë 
Logger
ëë 
.
ëë 
Log
ëë 
(
ëë 
NLog
ëë "
.
ëë" #
LogLevel
ëë# +
.
ëë+ ,
Warn
ëë, 0
,
ëë0 1
exceptIO
ëë2 :
,
ëë: ;
$str
ëë< X
+
ëëY Z
port
ëë[ _
.
ëë_ `
ToString
ëë` h
(
ëëh i
)
ëëi j
)
ëëj k
;
ëëk l
}
íí 
finally
ìì 
{
îî 
try
ïï 
{
ññ 
if
óó 
(
óó 
streamOutput
óó $
!=
óó% '
null
óó( ,
)
óó, -
{
òò 
streamOutput
ôô $
.
ôô$ %
Close
ôô% *
(
ôô* +
)
ôô+ ,
;
ôô, -
}
öö 
}
õõ 
catch
úú 
(
úú 
IOException
úú "
exceptIO
úú# +
)
úú+ ,
{
ùù 
IO
ûû 
.
ûû 
Logger
ûû 
.
ûû 
Log
ûû !
(
ûû! "
NLog
ûû" &
.
ûû& '
LogLevel
ûû' /
.
ûû/ 0
Warn
ûû0 4
,
ûû4 5
exceptIO
ûû6 >
,
ûû> ?
$str
ûû@ W
)
ûûW X
;
ûûX Y
}
üü 
try
°° 
{
¢¢ 
if
££ 
(
££ 
tcpConn
££ 
!=
££  "
null
££# '
)
££' (
{
§§ 
tcpConn
•• 
.
••  
Close
••  %
(
••% &
)
••& '
;
••' (
}
¶¶ 
}
ßß 
catch
®® 
(
®® 
IOException
®® "
exceptIO
®®# +
)
®®+ ,
{
©© 
IO
™™ 
.
™™ 
Logger
™™ 
.
™™ 
Log
™™ !
(
™™! "
NLog
™™" &
.
™™& '
LogLevel
™™' /
.
™™/ 0
Warn
™™0 4
,
™™4 5
exceptIO
™™6 >
,
™™> ?
$str
™™@ W
)
™™W X
;
™™X Y
}
´´ 
try
≠≠ 
{
ÆÆ 
if
ØØ 
(
ØØ 
listener
ØØ  
!=
ØØ! #
null
ØØ$ (
)
ØØ( )
{
∞∞ 
listener
±±  
.
±±  !
Stop
±±! %
(
±±% &
)
±±& '
;
±±' (
}
≤≤ 
}
≥≥ 
catch
¥¥ 
(
¥¥ 
IOException
¥¥ "
exceptIO
¥¥# +
)
¥¥+ ,
{
µµ 
IO
∂∂ 
.
∂∂ 
Logger
∂∂ 
.
∂∂ 
Log
∂∂ !
(
∂∂! "
NLog
∂∂" &
.
∂∂& '
LogLevel
∂∂' /
.
∂∂/ 0
Warn
∂∂0 4
,
∂∂4 5
exceptIO
∂∂6 >
,
∂∂> ?
$str
∂∂@ W
)
∂∂W X
;
∂∂X Y
}
∑∑ 
}
ππ 
}
∫∫ 	
}
ªª 
private
ææ 
void
ææ 
Good2
ææ 
(
ææ 
)
ææ 
{
øø 
if
¿¿ 

(
¿¿  
PrivateReturnsTrue
¿¿ 
(
¿¿ 
)
¿¿  
)
¿¿  !
{
¡¡ 	
TcpListener
¬¬ 
listener
¬¬  
=
¬¬! "
null
¬¬# '
;
¬¬' (
	TcpClient
√√ 
tcpConn
√√ 
=
√√ 
null
√√  $
;
√√$ %
Stream
ƒƒ 
streamOutput
ƒƒ 
=
ƒƒ  !
null
ƒƒ" &
;
ƒƒ& '
int
≈≈ 
port
≈≈ 
=
≈≈ 
$num
≈≈ 
;
≈≈ 
try
∆∆ 
{
«« 
listener
»» 
=
»» 
new
»» 
TcpListener
»» *
(
»»* +
	IPAddress
»»+ 4
.
»»4 5
Parse
»»5 :
(
»»: ;
$str
»»; G
)
»»G H
,
»»H I
port
»»J N
)
»»N O
;
»»O P
listener
…… 
.
…… 
Start
…… 
(
…… 
)
……  
;
……  !
tcpConn
   
=
   
listener
   "
.
  " #
AcceptTcpClient
  # 2
(
  2 3
)
  3 4
;
  4 5
streamOutput
ÀÀ 
=
ÀÀ 
tcpConn
ÀÀ &
.
ÀÀ& '
	GetStream
ÀÀ' 0
(
ÀÀ0 1
)
ÀÀ1 2
;
ÀÀ2 3

IPEndPoint
ÃÃ 
endPoint
ÃÃ #
=
ÃÃ$ %
(
ÃÃ& '

IPEndPoint
ÃÃ' 1
)
ÃÃ1 2
tcpConn
ÃÃ2 9
.
ÃÃ9 :
Client
ÃÃ: @
.
ÃÃ@ A
RemoteEndPoint
ÃÃA O
;
ÃÃO P
	IPAddress
ÕÕ 
	ipAddress
ÕÕ #
=
ÕÕ$ %
endPoint
ÕÕ& .
.
ÕÕ. /
Address
ÕÕ/ 6
;
ÕÕ6 7
IPHostEntry
ŒŒ 
	hostEntry
ŒŒ %
=
ŒŒ& '
Dns
ŒŒ( +
.
ŒŒ+ ,
GetHostEntry
ŒŒ, 8
(
ŒŒ8 9
	ipAddress
ŒŒ9 B
)
ŒŒB C
;
ŒŒC D
streamOutput
–– 
.
–– 
Write
–– "
(
––" #
Encoding
––# +
.
––+ ,
UTF8
––, 0
.
––0 1
GetBytes
––1 9
(
––9 :
(
––: ;
$str
––; F
+
––G H
	hostEntry
––I R
.
––R S
ToString
––S [
(
––[ \
)
––\ ]
)
––] ^
)
––^ _
,
––_ `
$num
––a b
,
––b c
(
––d e
$str
––e p
+
––q r
	hostEntry
––s |
.
––| }
ToString––} Ö
(––Ö Ü
)––Ü á
)––á à
.––à â
Length––â è
)––è ê
;––ê ë
}
—— 
catch
““ 
(
““ 
IOException
““ 
exceptIO
““ '
)
““' (
{
”” 
IO
‘‘ 
.
‘‘ 
Logger
‘‘ 
.
‘‘ 
Log
‘‘ 
(
‘‘ 
NLog
‘‘ "
.
‘‘" #
LogLevel
‘‘# +
.
‘‘+ ,
Warn
‘‘, 0
,
‘‘0 1
exceptIO
‘‘2 :
,
‘‘: ;
$str
‘‘< X
+
‘‘Y Z
port
‘‘[ _
.
‘‘_ `
ToString
‘‘` h
(
‘‘h i
)
‘‘i j
)
‘‘j k
;
‘‘k l
}
’’ 
finally
÷÷ 
{
◊◊ 
try
ÿÿ 
{
ŸŸ 
if
⁄⁄ 
(
⁄⁄ 
streamOutput
⁄⁄ $
!=
⁄⁄% '
null
⁄⁄( ,
)
⁄⁄, -
{
€€ 
streamOutput
‹‹ $
.
‹‹$ %
Close
‹‹% *
(
‹‹* +
)
‹‹+ ,
;
‹‹, -
}
›› 
}
ﬁﬁ 
catch
ﬂﬂ 
(
ﬂﬂ 
IOException
ﬂﬂ "
exceptIO
ﬂﬂ# +
)
ﬂﬂ+ ,
{
‡‡ 
IO
·· 
.
·· 
Logger
·· 
.
·· 
Log
·· !
(
··! "
NLog
··" &
.
··& '
LogLevel
··' /
.
··/ 0
Warn
··0 4
,
··4 5
exceptIO
··6 >
,
··> ?
$str
··@ W
)
··W X
;
··X Y
}
‚‚ 
try
‰‰ 
{
ÂÂ 
if
ÊÊ 
(
ÊÊ 
tcpConn
ÊÊ 
!=
ÊÊ  "
null
ÊÊ# '
)
ÊÊ' (
{
ÁÁ 
tcpConn
ËË 
.
ËË  
Close
ËË  %
(
ËË% &
)
ËË& '
;
ËË' (
}
ÈÈ 
}
ÍÍ 
catch
ÎÎ 
(
ÎÎ 
IOException
ÎÎ "
exceptIO
ÎÎ# +
)
ÎÎ+ ,
{
ÏÏ 
IO
ÌÌ 
.
ÌÌ 
Logger
ÌÌ 
.
ÌÌ 
Log
ÌÌ !
(
ÌÌ! "
NLog
ÌÌ" &
.
ÌÌ& '
LogLevel
ÌÌ' /
.
ÌÌ/ 0
Warn
ÌÌ0 4
,
ÌÌ4 5
exceptIO
ÌÌ6 >
,
ÌÌ> ?
$str
ÌÌ@ W
)
ÌÌW X
;
ÌÌX Y
}
ÓÓ 
try
 
{
ÒÒ 
if
ÚÚ 
(
ÚÚ 
listener
ÚÚ  
!=
ÚÚ! #
null
ÚÚ$ (
)
ÚÚ( )
{
ÛÛ 
listener
ÙÙ  
.
ÙÙ  !
Stop
ÙÙ! %
(
ÙÙ% &
)
ÙÙ& '
;
ÙÙ' (
}
ıı 
}
ˆˆ 
catch
˜˜ 
(
˜˜ 
IOException
˜˜ "
exceptIO
˜˜# +
)
˜˜+ ,
{
¯¯ 
IO
˘˘ 
.
˘˘ 
Logger
˘˘ 
.
˘˘ 
Log
˘˘ !
(
˘˘! "
NLog
˘˘" &
.
˘˘& '
LogLevel
˘˘' /
.
˘˘/ 0
Warn
˘˘0 4
,
˘˘4 5
exceptIO
˘˘6 >
,
˘˘> ?
$str
˘˘@ W
)
˘˘W X
;
˘˘X Y
}
˙˙ 
}
¸¸ 
}
˝˝ 	
}
˛˛ 
public
ÄÄ 

override
ÄÄ 
void
ÄÄ 
Good
ÄÄ 
(
ÄÄ 
)
ÄÄ 
{
ÅÅ 
Good1
ÇÇ 
(
ÇÇ 
)
ÇÇ 
;
ÇÇ 
Good2
ÉÉ 
(
ÉÉ 
)
ÉÉ 
;
ÉÉ 
}
ÑÑ 
}ÜÜ 
}áá èã
ñC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__hostname_based_logic_09.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 4
(CWE510_Trapdoor__hostname_based_logic_09 .
:/ 0
AbstractTestCase1 A
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
IO 
.  
STATIC_READONLY_TRUE #
)# $
{   	
TcpListener!! 
listener!!  
=!!! "
null!!# '
;!!' (
	TcpClient"" 
tcpConn"" 
="" 
null""  $
;""$ %
Stream## 
streamOutput## 
=##  !
null##" &
;##& '
int$$ 
port$$ 
=$$ 
$num$$ 
;$$ 
try%% 
{&& 
listener'' 
='' 
new'' 
TcpListener'' *
(''* +
	IPAddress''+ 4
.''4 5
Parse''5 :
('': ;
$str''; G
)''G H
,''H I
port''J N
)''N O
;''O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
tcpConn)) 
=)) 
listener)) "
.))" #
AcceptTcpClient))# 2
())2 3
)))3 4
;))4 5

IPEndPoint++ 
endPoint++ #
=++$ %
(++& '

IPEndPoint++' 1
)++1 2
tcpConn++2 9
.++9 :
Client++: @
.++@ A
RemoteEndPoint++A O
;++O P
	IPAddress,, 
	ipAddress,, #
=,,$ %
endPoint,,& .
.,,. /
Address,,/ 6
;,,6 7
IPHostEntry-- 
	hostEntry-- %
=--& '
Dns--( +
.--+ ,
GetHostEntry--, 8
(--8 9
	ipAddress--9 B
)--B C
;--C D
if.. 
(.. 
	hostEntry.. 
... 
HostName.. &
...& '
Equals..' -
(..- .
$str... @
)..@ A
)..A B
{// 
streamOutput00  
=00! "
tcpConn00# *
.00* +
	GetStream00+ 4
(004 5
)005 6
;006 7
streamOutput11  
.11  !
Write11! &
(11& '
Encoding11' /
.11/ 0
UTF8110 4
.114 5
GetBytes115 =
(11= >
$str11> O
)11O P
,11P Q
$num11R S
,11S T
$str11U f
.11f g
Length11g m
)11m n
;11n o
}22 
else33 
{44 
streamOutput55  
=55! "
tcpConn55# *
.55* +
	GetStream55+ 4
(554 5
)555 6
;556 7
streamOutput66  
.66  !
Write66! &
(66& '
Encoding66' /
.66/ 0
UTF8660 4
.664 5
GetBytes665 =
(66= >
$str66> N
)66N O
,66O P
$num66Q R
,66R S
$str66T d
.66d e
Length66e k
)66k l
;66l m
}77 
}88 
catch99 
(99 
IOException99 
exceptIO99 '
)99' (
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; 
(;; 
NLog;; "
.;;" #
LogLevel;;# +
.;;+ ,
Warn;;, 0
,;;0 1
exceptIO;;2 :
,;;: ;
$str;;< X
+;;Y Z
port;;[ _
.;;_ `
ToString;;` h
(;;h i
);;i j
);;j k
;;;k l
}<< 
finally== 
{>> 
try?? 
{@@ 
ifAA 
(AA 
streamOutputAA $
!=AA% '
nullAA( ,
)AA, -
{BB 
streamOutputCC $
.CC$ %
CloseCC% *
(CC* +
)CC+ ,
;CC, -
}DD 
}EE 
catchFF 
(FF 
IOExceptionFF "
exceptIOFF# +
)FF+ ,
{GG 
IOHH 
.HH 
LoggerHH 
.HH 
LogHH !
(HH! "
NLogHH" &
.HH& '
LogLevelHH' /
.HH/ 0
WarnHH0 4
,HH4 5
exceptIOHH6 >
,HH> ?
$strHH@ W
)HHW X
;HHX Y
}II 
tryKK 
{LL 
ifMM 
(MM 
tcpConnMM 
!=MM  "
nullMM# '
)MM' (
{NN 
tcpConnOO 
.OO  
CloseOO  %
(OO% &
)OO& '
;OO' (
}PP 
}QQ 
catchRR 
(RR 
IOExceptionRR "
exceptIORR# +
)RR+ ,
{SS 
IOTT 
.TT 
LoggerTT 
.TT 
LogTT !
(TT! "
NLogTT" &
.TT& '
LogLevelTT' /
.TT/ 0
WarnTT0 4
,TT4 5
exceptIOTT6 >
,TT> ?
$strTT@ W
)TTW X
;TTX Y
}UU 
tryWW 
{XX 
ifYY 
(YY 
listenerYY  
!=YY! #
nullYY$ (
)YY( )
{ZZ 
listener[[  
.[[  !
Stop[[! %
([[% &
)[[& '
;[[' (
}\\ 
}]] 
catch^^ 
(^^ 
IOException^^ "
exceptIO^^# +
)^^+ ,
{__ 
IO`` 
.`` 
Logger`` 
.`` 
Log`` !
(``! "
NLog``" &
.``& '
LogLevel``' /
.``/ 0
Warn``0 4
,``4 5
exceptIO``6 >
,``> ?
$str``@ W
)``W X
;``X Y
}aa 
}cc 
}dd 	
}ee 
privateii 
voidii 
Good1ii 
(ii 
)ii 
{jj 
ifkk 

(kk 
IOkk 
.kk !
STATIC_READONLY_FALSEkk $
)kk$ %
{ll 	
IOnn 
.nn 
	WriteLinenn 
(nn 
$strnn /
)nn/ 0
;nn0 1
}oo 	
elsepp 
{qq 	
TcpListenerrr 
listenerrr  
=rr! "
nullrr# '
;rr' (
	TcpClientss 
tcpConnss 
=ss 
nullss  $
;ss$ %
Streamtt 
streamOutputtt 
=tt  !
nulltt" &
;tt& '
intuu 
portuu 
=uu 
$numuu 
;uu 
tryvv 
{ww 
listenerxx 
=xx 
newxx 
TcpListenerxx *
(xx* +
	IPAddressxx+ 4
.xx4 5
Parsexx5 :
(xx: ;
$strxx; G
)xxG H
,xxH I
portxxJ N
)xxN O
;xxO P
listeneryy 
.yy 
Startyy 
(yy 
)yy  
;yy  !
tcpConnzz 
=zz 
listenerzz "
.zz" #
AcceptTcpClientzz# 2
(zz2 3
)zz3 4
;zz4 5
streamOutput{{ 
={{ 
tcpConn{{ &
.{{& '
	GetStream{{' 0
({{0 1
){{1 2
;{{2 3

IPEndPoint|| 
endPoint|| #
=||$ %
(||& '

IPEndPoint||' 1
)||1 2
tcpConn||2 9
.||9 :
Client||: @
.||@ A
RemoteEndPoint||A O
;||O P
	IPAddress}} 
	ipAddress}} #
=}}$ %
endPoint}}& .
.}}. /
Address}}/ 6
;}}6 7
IPHostEntry~~ 
	hostEntry~~ %
=~~& '
Dns~~( +
.~~+ ,
GetHostEntry~~, 8
(~~8 9
	ipAddress~~9 B
)~~B C
;~~C D
streamOutput
ÄÄ 
.
ÄÄ 
Write
ÄÄ "
(
ÄÄ" #
Encoding
ÄÄ# +
.
ÄÄ+ ,
UTF8
ÄÄ, 0
.
ÄÄ0 1
GetBytes
ÄÄ1 9
(
ÄÄ9 :
(
ÄÄ: ;
$str
ÄÄ; F
+
ÄÄG H
	hostEntry
ÄÄI R
.
ÄÄR S
ToString
ÄÄS [
(
ÄÄ[ \
)
ÄÄ\ ]
)
ÄÄ] ^
)
ÄÄ^ _
,
ÄÄ_ `
$num
ÄÄa b
,
ÄÄb c
(
ÄÄd e
$str
ÄÄe p
+
ÄÄq r
	hostEntry
ÄÄs |
.
ÄÄ| }
ToStringÄÄ} Ö
(ÄÄÖ Ü
)ÄÄÜ á
)ÄÄá à
.ÄÄà â
LengthÄÄâ è
)ÄÄè ê
;ÄÄê ë
}
ÅÅ 
catch
ÇÇ 
(
ÇÇ 
IOException
ÇÇ 
exceptIO
ÇÇ '
)
ÇÇ' (
{
ÉÉ 
IO
ÑÑ 
.
ÑÑ 
Logger
ÑÑ 
.
ÑÑ 
Log
ÑÑ 
(
ÑÑ 
NLog
ÑÑ "
.
ÑÑ" #
LogLevel
ÑÑ# +
.
ÑÑ+ ,
Warn
ÑÑ, 0
,
ÑÑ0 1
exceptIO
ÑÑ2 :
,
ÑÑ: ;
$str
ÑÑ< X
+
ÑÑY Z
port
ÑÑ[ _
.
ÑÑ_ `
ToString
ÑÑ` h
(
ÑÑh i
)
ÑÑi j
)
ÑÑj k
;
ÑÑk l
}
ÖÖ 
finally
ÜÜ 
{
áá 
try
àà 
{
ââ 
if
ää 
(
ää 
streamOutput
ää $
!=
ää% '
null
ää( ,
)
ää, -
{
ãã 
streamOutput
åå $
.
åå$ %
Close
åå% *
(
åå* +
)
åå+ ,
;
åå, -
}
çç 
}
éé 
catch
èè 
(
èè 
IOException
èè "
exceptIO
èè# +
)
èè+ ,
{
êê 
IO
ëë 
.
ëë 
Logger
ëë 
.
ëë 
Log
ëë !
(
ëë! "
NLog
ëë" &
.
ëë& '
LogLevel
ëë' /
.
ëë/ 0
Warn
ëë0 4
,
ëë4 5
exceptIO
ëë6 >
,
ëë> ?
$str
ëë@ W
)
ëëW X
;
ëëX Y
}
íí 
try
îî 
{
ïï 
if
ññ 
(
ññ 
tcpConn
ññ 
!=
ññ  "
null
ññ# '
)
ññ' (
{
óó 
tcpConn
òò 
.
òò  
Close
òò  %
(
òò% &
)
òò& '
;
òò' (
}
ôô 
}
öö 
catch
õõ 
(
õõ 
IOException
õõ "
exceptIO
õõ# +
)
õõ+ ,
{
úú 
IO
ùù 
.
ùù 
Logger
ùù 
.
ùù 
Log
ùù !
(
ùù! "
NLog
ùù" &
.
ùù& '
LogLevel
ùù' /
.
ùù/ 0
Warn
ùù0 4
,
ùù4 5
exceptIO
ùù6 >
,
ùù> ?
$str
ùù@ W
)
ùùW X
;
ùùX Y
}
ûû 
try
†† 
{
°° 
if
¢¢ 
(
¢¢ 
listener
¢¢  
!=
¢¢! #
null
¢¢$ (
)
¢¢( )
{
££ 
listener
§§  
.
§§  !
Stop
§§! %
(
§§% &
)
§§& '
;
§§' (
}
•• 
}
¶¶ 
catch
ßß 
(
ßß 
IOException
ßß "
exceptIO
ßß# +
)
ßß+ ,
{
®® 
IO
©© 
.
©© 
Logger
©© 
.
©© 
Log
©© !
(
©©! "
NLog
©©" &
.
©©& '
LogLevel
©©' /
.
©©/ 0
Warn
©©0 4
,
©©4 5
exceptIO
©©6 >
,
©©> ?
$str
©©@ W
)
©©W X
;
©©X Y
}
™™ 
}
¨¨ 
}
≠≠ 	
}
ÆÆ 
private
±± 
void
±± 
Good2
±± 
(
±± 
)
±± 
{
≤≤ 
if
≥≥ 

(
≥≥ 
IO
≥≥ 
.
≥≥ "
STATIC_READONLY_TRUE
≥≥ #
)
≥≥# $
{
¥¥ 	
TcpListener
µµ 
listener
µµ  
=
µµ! "
null
µµ# '
;
µµ' (
	TcpClient
∂∂ 
tcpConn
∂∂ 
=
∂∂ 
null
∂∂  $
;
∂∂$ %
Stream
∑∑ 
streamOutput
∑∑ 
=
∑∑  !
null
∑∑" &
;
∑∑& '
int
∏∏ 
port
∏∏ 
=
∏∏ 
$num
∏∏ 
;
∏∏ 
try
ππ 
{
∫∫ 
listener
ªª 
=
ªª 
new
ªª 
TcpListener
ªª *
(
ªª* +
	IPAddress
ªª+ 4
.
ªª4 5
Parse
ªª5 :
(
ªª: ;
$str
ªª; G
)
ªªG H
,
ªªH I
port
ªªJ N
)
ªªN O
;
ªªO P
listener
ºº 
.
ºº 
Start
ºº 
(
ºº 
)
ºº  
;
ºº  !
tcpConn
ΩΩ 
=
ΩΩ 
listener
ΩΩ "
.
ΩΩ" #
AcceptTcpClient
ΩΩ# 2
(
ΩΩ2 3
)
ΩΩ3 4
;
ΩΩ4 5
streamOutput
ææ 
=
ææ 
tcpConn
ææ &
.
ææ& '
	GetStream
ææ' 0
(
ææ0 1
)
ææ1 2
;
ææ2 3

IPEndPoint
øø 
endPoint
øø #
=
øø$ %
(
øø& '

IPEndPoint
øø' 1
)
øø1 2
tcpConn
øø2 9
.
øø9 :
Client
øø: @
.
øø@ A
RemoteEndPoint
øøA O
;
øøO P
	IPAddress
¿¿ 
	ipAddress
¿¿ #
=
¿¿$ %
endPoint
¿¿& .
.
¿¿. /
Address
¿¿/ 6
;
¿¿6 7
IPHostEntry
¡¡ 
	hostEntry
¡¡ %
=
¡¡& '
Dns
¡¡( +
.
¡¡+ ,
GetHostEntry
¡¡, 8
(
¡¡8 9
	ipAddress
¡¡9 B
)
¡¡B C
;
¡¡C D
streamOutput
√√ 
.
√√ 
Write
√√ "
(
√√" #
Encoding
√√# +
.
√√+ ,
UTF8
√√, 0
.
√√0 1
GetBytes
√√1 9
(
√√9 :
(
√√: ;
$str
√√; F
+
√√G H
	hostEntry
√√I R
.
√√R S
ToString
√√S [
(
√√[ \
)
√√\ ]
)
√√] ^
)
√√^ _
,
√√_ `
$num
√√a b
,
√√b c
(
√√d e
$str
√√e p
+
√√q r
	hostEntry
√√s |
.
√√| }
ToString√√} Ö
(√√Ö Ü
)√√Ü á
)√√á à
.√√à â
Length√√â è
)√√è ê
;√√ê ë
}
ƒƒ 
catch
≈≈ 
(
≈≈ 
IOException
≈≈ 
exceptIO
≈≈ '
)
≈≈' (
{
∆∆ 
IO
«« 
.
«« 
Logger
«« 
.
«« 
Log
«« 
(
«« 
NLog
«« "
.
««" #
LogLevel
««# +
.
««+ ,
Warn
««, 0
,
««0 1
exceptIO
««2 :
,
««: ;
$str
««< X
+
««Y Z
port
««[ _
.
««_ `
ToString
««` h
(
««h i
)
««i j
)
««j k
;
««k l
}
»» 
finally
…… 
{
   
try
ÀÀ 
{
ÃÃ 
if
ÕÕ 
(
ÕÕ 
streamOutput
ÕÕ $
!=
ÕÕ% '
null
ÕÕ( ,
)
ÕÕ, -
{
ŒŒ 
streamOutput
œœ $
.
œœ$ %
Close
œœ% *
(
œœ* +
)
œœ+ ,
;
œœ, -
}
–– 
}
—— 
catch
““ 
(
““ 
IOException
““ "
exceptIO
““# +
)
““+ ,
{
”” 
IO
‘‘ 
.
‘‘ 
Logger
‘‘ 
.
‘‘ 
Log
‘‘ !
(
‘‘! "
NLog
‘‘" &
.
‘‘& '
LogLevel
‘‘' /
.
‘‘/ 0
Warn
‘‘0 4
,
‘‘4 5
exceptIO
‘‘6 >
,
‘‘> ?
$str
‘‘@ W
)
‘‘W X
;
‘‘X Y
}
’’ 
try
◊◊ 
{
ÿÿ 
if
ŸŸ 
(
ŸŸ 
tcpConn
ŸŸ 
!=
ŸŸ  "
null
ŸŸ# '
)
ŸŸ' (
{
⁄⁄ 
tcpConn
€€ 
.
€€  
Close
€€  %
(
€€% &
)
€€& '
;
€€' (
}
‹‹ 
}
›› 
catch
ﬁﬁ 
(
ﬁﬁ 
IOException
ﬁﬁ "
exceptIO
ﬁﬁ# +
)
ﬁﬁ+ ,
{
ﬂﬂ 
IO
‡‡ 
.
‡‡ 
Logger
‡‡ 
.
‡‡ 
Log
‡‡ !
(
‡‡! "
NLog
‡‡" &
.
‡‡& '
LogLevel
‡‡' /
.
‡‡/ 0
Warn
‡‡0 4
,
‡‡4 5
exceptIO
‡‡6 >
,
‡‡> ?
$str
‡‡@ W
)
‡‡W X
;
‡‡X Y
}
·· 
try
„„ 
{
‰‰ 
if
ÂÂ 
(
ÂÂ 
listener
ÂÂ  
!=
ÂÂ! #
null
ÂÂ$ (
)
ÂÂ( )
{
ÊÊ 
listener
ÁÁ  
.
ÁÁ  !
Stop
ÁÁ! %
(
ÁÁ% &
)
ÁÁ& '
;
ÁÁ' (
}
ËË 
}
ÈÈ 
catch
ÍÍ 
(
ÍÍ 
IOException
ÍÍ "
exceptIO
ÍÍ# +
)
ÍÍ+ ,
{
ÎÎ 
IO
ÏÏ 
.
ÏÏ 
Logger
ÏÏ 
.
ÏÏ 
Log
ÏÏ !
(
ÏÏ! "
NLog
ÏÏ" &
.
ÏÏ& '
LogLevel
ÏÏ' /
.
ÏÏ/ 0
Warn
ÏÏ0 4
,
ÏÏ4 5
exceptIO
ÏÏ6 >
,
ÏÏ> ?
$str
ÏÏ@ W
)
ÏÏW X
;
ÏÏX Y
}
ÌÌ 
}
ÔÔ 
}
 	
}
ÒÒ 
public
ÛÛ 

override
ÛÛ 
void
ÛÛ 
Good
ÛÛ 
(
ÛÛ 
)
ÛÛ 
{
ÙÙ 
Good1
ıı 
(
ıı 
)
ıı 
;
ıı 
Good2
ˆˆ 
(
ˆˆ 
)
ˆˆ 
;
ˆˆ 
}
˜˜ 
}˘˘ 
}˙˙ Òä
ñC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__hostname_based_logic_10.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 4
(CWE510_Trapdoor__hostname_based_logic_10 .
:/ 0
AbstractTestCase1 A
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
IO 
. 

staticTrue 
) 
{   	
TcpListener!! 
listener!!  
=!!! "
null!!# '
;!!' (
	TcpClient"" 
tcpConn"" 
="" 
null""  $
;""$ %
Stream## 
streamOutput## 
=##  !
null##" &
;##& '
int$$ 
port$$ 
=$$ 
$num$$ 
;$$ 
try%% 
{&& 
listener'' 
='' 
new'' 
TcpListener'' *
(''* +
	IPAddress''+ 4
.''4 5
Parse''5 :
('': ;
$str''; G
)''G H
,''H I
port''J N
)''N O
;''O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
tcpConn)) 
=)) 
listener)) "
.))" #
AcceptTcpClient))# 2
())2 3
)))3 4
;))4 5

IPEndPoint++ 
endPoint++ #
=++$ %
(++& '

IPEndPoint++' 1
)++1 2
tcpConn++2 9
.++9 :
Client++: @
.++@ A
RemoteEndPoint++A O
;++O P
	IPAddress,, 
	ipAddress,, #
=,,$ %
endPoint,,& .
.,,. /
Address,,/ 6
;,,6 7
IPHostEntry-- 
	hostEntry-- %
=--& '
Dns--( +
.--+ ,
GetHostEntry--, 8
(--8 9
	ipAddress--9 B
)--B C
;--C D
if.. 
(.. 
	hostEntry.. 
... 
HostName.. &
...& '
Equals..' -
(..- .
$str... @
)..@ A
)..A B
{// 
streamOutput00  
=00! "
tcpConn00# *
.00* +
	GetStream00+ 4
(004 5
)005 6
;006 7
streamOutput11  
.11  !
Write11! &
(11& '
Encoding11' /
.11/ 0
UTF8110 4
.114 5
GetBytes115 =
(11= >
$str11> O
)11O P
,11P Q
$num11R S
,11S T
$str11U f
.11f g
Length11g m
)11m n
;11n o
}22 
else33 
{44 
streamOutput55  
=55! "
tcpConn55# *
.55* +
	GetStream55+ 4
(554 5
)555 6
;556 7
streamOutput66  
.66  !
Write66! &
(66& '
Encoding66' /
.66/ 0
UTF8660 4
.664 5
GetBytes665 =
(66= >
$str66> N
)66N O
,66O P
$num66Q R
,66R S
$str66T d
.66d e
Length66e k
)66k l
;66l m
}77 
}88 
catch99 
(99 
IOException99 
exceptIO99 '
)99' (
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; 
(;; 
NLog;; "
.;;" #
LogLevel;;# +
.;;+ ,
Warn;;, 0
,;;0 1
exceptIO;;2 :
,;;: ;
$str;;< X
+;;Y Z
port;;[ _
.;;_ `
ToString;;` h
(;;h i
);;i j
);;j k
;;;k l
}<< 
finally== 
{>> 
try?? 
{@@ 
ifAA 
(AA 
streamOutputAA $
!=AA% '
nullAA( ,
)AA, -
{BB 
streamOutputCC $
.CC$ %
CloseCC% *
(CC* +
)CC+ ,
;CC, -
}DD 
}EE 
catchFF 
(FF 
IOExceptionFF "
exceptIOFF# +
)FF+ ,
{GG 
IOHH 
.HH 
LoggerHH 
.HH 
LogHH !
(HH! "
NLogHH" &
.HH& '
LogLevelHH' /
.HH/ 0
WarnHH0 4
,HH4 5
exceptIOHH6 >
,HH> ?
$strHH@ W
)HHW X
;HHX Y
}II 
tryKK 
{LL 
ifMM 
(MM 
tcpConnMM 
!=MM  "
nullMM# '
)MM' (
{NN 
tcpConnOO 
.OO  
CloseOO  %
(OO% &
)OO& '
;OO' (
}PP 
}QQ 
catchRR 
(RR 
IOExceptionRR "
exceptIORR# +
)RR+ ,
{SS 
IOTT 
.TT 
LoggerTT 
.TT 
LogTT !
(TT! "
NLogTT" &
.TT& '
LogLevelTT' /
.TT/ 0
WarnTT0 4
,TT4 5
exceptIOTT6 >
,TT> ?
$strTT@ W
)TTW X
;TTX Y
}UU 
tryWW 
{XX 
ifYY 
(YY 
listenerYY  
!=YY! #
nullYY$ (
)YY( )
{ZZ 
listener[[  
.[[  !
Stop[[! %
([[% &
)[[& '
;[[' (
}\\ 
}]] 
catch^^ 
(^^ 
IOException^^ "
exceptIO^^# +
)^^+ ,
{__ 
IO`` 
.`` 
Logger`` 
.`` 
Log`` !
(``! "
NLog``" &
.``& '
LogLevel``' /
.``/ 0
Warn``0 4
,``4 5
exceptIO``6 >
,``> ?
$str``@ W
)``W X
;``X Y
}aa 
}cc 
}dd 	
}ee 
privateii 
voidii 
Good1ii 
(ii 
)ii 
{jj 
ifkk 

(kk 
IOkk 
.kk 
staticFalsekk 
)kk 
{ll 	
IOnn 
.nn 
	WriteLinenn 
(nn 
$strnn /
)nn/ 0
;nn0 1
}oo 	
elsepp 
{qq 	
TcpListenerrr 
listenerrr  
=rr! "
nullrr# '
;rr' (
	TcpClientss 
tcpConnss 
=ss 
nullss  $
;ss$ %
Streamtt 
streamOutputtt 
=tt  !
nulltt" &
;tt& '
intuu 
portuu 
=uu 
$numuu 
;uu 
tryvv 
{ww 
listenerxx 
=xx 
newxx 
TcpListenerxx *
(xx* +
	IPAddressxx+ 4
.xx4 5
Parsexx5 :
(xx: ;
$strxx; G
)xxG H
,xxH I
portxxJ N
)xxN O
;xxO P
listeneryy 
.yy 
Startyy 
(yy 
)yy  
;yy  !
tcpConnzz 
=zz 
listenerzz "
.zz" #
AcceptTcpClientzz# 2
(zz2 3
)zz3 4
;zz4 5
streamOutput{{ 
={{ 
tcpConn{{ &
.{{& '
	GetStream{{' 0
({{0 1
){{1 2
;{{2 3

IPEndPoint|| 
endPoint|| #
=||$ %
(||& '

IPEndPoint||' 1
)||1 2
tcpConn||2 9
.||9 :
Client||: @
.||@ A
RemoteEndPoint||A O
;||O P
	IPAddress}} 
	ipAddress}} #
=}}$ %
endPoint}}& .
.}}. /
Address}}/ 6
;}}6 7
IPHostEntry~~ 
	hostEntry~~ %
=~~& '
Dns~~( +
.~~+ ,
GetHostEntry~~, 8
(~~8 9
	ipAddress~~9 B
)~~B C
;~~C D
streamOutput
ÄÄ 
.
ÄÄ 
Write
ÄÄ "
(
ÄÄ" #
Encoding
ÄÄ# +
.
ÄÄ+ ,
UTF8
ÄÄ, 0
.
ÄÄ0 1
GetBytes
ÄÄ1 9
(
ÄÄ9 :
(
ÄÄ: ;
$str
ÄÄ; F
+
ÄÄG H
	hostEntry
ÄÄI R
.
ÄÄR S
ToString
ÄÄS [
(
ÄÄ[ \
)
ÄÄ\ ]
)
ÄÄ] ^
)
ÄÄ^ _
,
ÄÄ_ `
$num
ÄÄa b
,
ÄÄb c
(
ÄÄd e
$str
ÄÄe p
+
ÄÄq r
	hostEntry
ÄÄs |
.
ÄÄ| }
ToStringÄÄ} Ö
(ÄÄÖ Ü
)ÄÄÜ á
)ÄÄá à
.ÄÄà â
LengthÄÄâ è
)ÄÄè ê
;ÄÄê ë
}
ÅÅ 
catch
ÇÇ 
(
ÇÇ 
IOException
ÇÇ 
exceptIO
ÇÇ '
)
ÇÇ' (
{
ÉÉ 
IO
ÑÑ 
.
ÑÑ 
Logger
ÑÑ 
.
ÑÑ 
Log
ÑÑ 
(
ÑÑ 
NLog
ÑÑ "
.
ÑÑ" #
LogLevel
ÑÑ# +
.
ÑÑ+ ,
Warn
ÑÑ, 0
,
ÑÑ0 1
exceptIO
ÑÑ2 :
,
ÑÑ: ;
$str
ÑÑ< X
+
ÑÑY Z
port
ÑÑ[ _
.
ÑÑ_ `
ToString
ÑÑ` h
(
ÑÑh i
)
ÑÑi j
)
ÑÑj k
;
ÑÑk l
}
ÖÖ 
finally
ÜÜ 
{
áá 
try
àà 
{
ââ 
if
ää 
(
ää 
streamOutput
ää $
!=
ää% '
null
ää( ,
)
ää, -
{
ãã 
streamOutput
åå $
.
åå$ %
Close
åå% *
(
åå* +
)
åå+ ,
;
åå, -
}
çç 
}
éé 
catch
èè 
(
èè 
IOException
èè "
exceptIO
èè# +
)
èè+ ,
{
êê 
IO
ëë 
.
ëë 
Logger
ëë 
.
ëë 
Log
ëë !
(
ëë! "
NLog
ëë" &
.
ëë& '
LogLevel
ëë' /
.
ëë/ 0
Warn
ëë0 4
,
ëë4 5
exceptIO
ëë6 >
,
ëë> ?
$str
ëë@ W
)
ëëW X
;
ëëX Y
}
íí 
try
îî 
{
ïï 
if
ññ 
(
ññ 
tcpConn
ññ 
!=
ññ  "
null
ññ# '
)
ññ' (
{
óó 
tcpConn
òò 
.
òò  
Close
òò  %
(
òò% &
)
òò& '
;
òò' (
}
ôô 
}
öö 
catch
õõ 
(
õõ 
IOException
õõ "
exceptIO
õõ# +
)
õõ+ ,
{
úú 
IO
ùù 
.
ùù 
Logger
ùù 
.
ùù 
Log
ùù !
(
ùù! "
NLog
ùù" &
.
ùù& '
LogLevel
ùù' /
.
ùù/ 0
Warn
ùù0 4
,
ùù4 5
exceptIO
ùù6 >
,
ùù> ?
$str
ùù@ W
)
ùùW X
;
ùùX Y
}
ûû 
try
†† 
{
°° 
if
¢¢ 
(
¢¢ 
listener
¢¢  
!=
¢¢! #
null
¢¢$ (
)
¢¢( )
{
££ 
listener
§§  
.
§§  !
Stop
§§! %
(
§§% &
)
§§& '
;
§§' (
}
•• 
}
¶¶ 
catch
ßß 
(
ßß 
IOException
ßß "
exceptIO
ßß# +
)
ßß+ ,
{
®® 
IO
©© 
.
©© 
Logger
©© 
.
©© 
Log
©© !
(
©©! "
NLog
©©" &
.
©©& '
LogLevel
©©' /
.
©©/ 0
Warn
©©0 4
,
©©4 5
exceptIO
©©6 >
,
©©> ?
$str
©©@ W
)
©©W X
;
©©X Y
}
™™ 
}
¨¨ 
}
≠≠ 	
}
ÆÆ 
private
±± 
void
±± 
Good2
±± 
(
±± 
)
±± 
{
≤≤ 
if
≥≥ 

(
≥≥ 
IO
≥≥ 
.
≥≥ 

staticTrue
≥≥ 
)
≥≥ 
{
¥¥ 	
TcpListener
µµ 
listener
µµ  
=
µµ! "
null
µµ# '
;
µµ' (
	TcpClient
∂∂ 
tcpConn
∂∂ 
=
∂∂ 
null
∂∂  $
;
∂∂$ %
Stream
∑∑ 
streamOutput
∑∑ 
=
∑∑  !
null
∑∑" &
;
∑∑& '
int
∏∏ 
port
∏∏ 
=
∏∏ 
$num
∏∏ 
;
∏∏ 
try
ππ 
{
∫∫ 
listener
ªª 
=
ªª 
new
ªª 
TcpListener
ªª *
(
ªª* +
	IPAddress
ªª+ 4
.
ªª4 5
Parse
ªª5 :
(
ªª: ;
$str
ªª; G
)
ªªG H
,
ªªH I
port
ªªJ N
)
ªªN O
;
ªªO P
listener
ºº 
.
ºº 
Start
ºº 
(
ºº 
)
ºº  
;
ºº  !
tcpConn
ΩΩ 
=
ΩΩ 
listener
ΩΩ "
.
ΩΩ" #
AcceptTcpClient
ΩΩ# 2
(
ΩΩ2 3
)
ΩΩ3 4
;
ΩΩ4 5
streamOutput
ææ 
=
ææ 
tcpConn
ææ &
.
ææ& '
	GetStream
ææ' 0
(
ææ0 1
)
ææ1 2
;
ææ2 3

IPEndPoint
øø 
endPoint
øø #
=
øø$ %
(
øø& '

IPEndPoint
øø' 1
)
øø1 2
tcpConn
øø2 9
.
øø9 :
Client
øø: @
.
øø@ A
RemoteEndPoint
øøA O
;
øøO P
	IPAddress
¿¿ 
	ipAddress
¿¿ #
=
¿¿$ %
endPoint
¿¿& .
.
¿¿. /
Address
¿¿/ 6
;
¿¿6 7
IPHostEntry
¡¡ 
	hostEntry
¡¡ %
=
¡¡& '
Dns
¡¡( +
.
¡¡+ ,
GetHostEntry
¡¡, 8
(
¡¡8 9
	ipAddress
¡¡9 B
)
¡¡B C
;
¡¡C D
streamOutput
√√ 
.
√√ 
Write
√√ "
(
√√" #
Encoding
√√# +
.
√√+ ,
UTF8
√√, 0
.
√√0 1
GetBytes
√√1 9
(
√√9 :
(
√√: ;
$str
√√; F
+
√√G H
	hostEntry
√√I R
.
√√R S
ToString
√√S [
(
√√[ \
)
√√\ ]
)
√√] ^
)
√√^ _
,
√√_ `
$num
√√a b
,
√√b c
(
√√d e
$str
√√e p
+
√√q r
	hostEntry
√√s |
.
√√| }
ToString√√} Ö
(√√Ö Ü
)√√Ü á
)√√á à
.√√à â
Length√√â è
)√√è ê
;√√ê ë
}
ƒƒ 
catch
≈≈ 
(
≈≈ 
IOException
≈≈ 
exceptIO
≈≈ '
)
≈≈' (
{
∆∆ 
IO
«« 
.
«« 
Logger
«« 
.
«« 
Log
«« 
(
«« 
NLog
«« "
.
««" #
LogLevel
««# +
.
««+ ,
Warn
««, 0
,
««0 1
exceptIO
««2 :
,
««: ;
$str
««< X
+
««Y Z
port
««[ _
.
««_ `
ToString
««` h
(
««h i
)
««i j
)
««j k
;
««k l
}
»» 
finally
…… 
{
   
try
ÀÀ 
{
ÃÃ 
if
ÕÕ 
(
ÕÕ 
streamOutput
ÕÕ $
!=
ÕÕ% '
null
ÕÕ( ,
)
ÕÕ, -
{
ŒŒ 
streamOutput
œœ $
.
œœ$ %
Close
œœ% *
(
œœ* +
)
œœ+ ,
;
œœ, -
}
–– 
}
—— 
catch
““ 
(
““ 
IOException
““ "
exceptIO
““# +
)
““+ ,
{
”” 
IO
‘‘ 
.
‘‘ 
Logger
‘‘ 
.
‘‘ 
Log
‘‘ !
(
‘‘! "
NLog
‘‘" &
.
‘‘& '
LogLevel
‘‘' /
.
‘‘/ 0
Warn
‘‘0 4
,
‘‘4 5
exceptIO
‘‘6 >
,
‘‘> ?
$str
‘‘@ W
)
‘‘W X
;
‘‘X Y
}
’’ 
try
◊◊ 
{
ÿÿ 
if
ŸŸ 
(
ŸŸ 
tcpConn
ŸŸ 
!=
ŸŸ  "
null
ŸŸ# '
)
ŸŸ' (
{
⁄⁄ 
tcpConn
€€ 
.
€€  
Close
€€  %
(
€€% &
)
€€& '
;
€€' (
}
‹‹ 
}
›› 
catch
ﬁﬁ 
(
ﬁﬁ 
IOException
ﬁﬁ "
exceptIO
ﬁﬁ# +
)
ﬁﬁ+ ,
{
ﬂﬂ 
IO
‡‡ 
.
‡‡ 
Logger
‡‡ 
.
‡‡ 
Log
‡‡ !
(
‡‡! "
NLog
‡‡" &
.
‡‡& '
LogLevel
‡‡' /
.
‡‡/ 0
Warn
‡‡0 4
,
‡‡4 5
exceptIO
‡‡6 >
,
‡‡> ?
$str
‡‡@ W
)
‡‡W X
;
‡‡X Y
}
·· 
try
„„ 
{
‰‰ 
if
ÂÂ 
(
ÂÂ 
listener
ÂÂ  
!=
ÂÂ! #
null
ÂÂ$ (
)
ÂÂ( )
{
ÊÊ 
listener
ÁÁ  
.
ÁÁ  !
Stop
ÁÁ! %
(
ÁÁ% &
)
ÁÁ& '
;
ÁÁ' (
}
ËË 
}
ÈÈ 
catch
ÍÍ 
(
ÍÍ 
IOException
ÍÍ "
exceptIO
ÍÍ# +
)
ÍÍ+ ,
{
ÎÎ 
IO
ÏÏ 
.
ÏÏ 
Logger
ÏÏ 
.
ÏÏ 
Log
ÏÏ !
(
ÏÏ! "
NLog
ÏÏ" &
.
ÏÏ& '
LogLevel
ÏÏ' /
.
ÏÏ/ 0
Warn
ÏÏ0 4
,
ÏÏ4 5
exceptIO
ÏÏ6 >
,
ÏÏ> ?
$str
ÏÏ@ W
)
ÏÏW X
;
ÏÏX Y
}
ÌÌ 
}
ÔÔ 
}
 	
}
ÒÒ 
public
ÛÛ 

override
ÛÛ 
void
ÛÛ 
Good
ÛÛ 
(
ÛÛ 
)
ÛÛ 
{
ÙÙ 
Good1
ıı 
(
ıı 
)
ıı 
;
ıı 
Good2
ˆˆ 
(
ˆˆ 
)
ˆˆ 
;
ˆˆ 
}
˜˜ 
}˘˘ 
}˙˙ ‰ã
ñC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__hostname_based_logic_11.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 4
(CWE510_Trapdoor__hostname_based_logic_11 .
:/ 0
AbstractTestCase1 A
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
IO 
. 
StaticReturnsTrue  
(  !
)! "
)" #
{   	
TcpListener!! 
listener!!  
=!!! "
null!!# '
;!!' (
	TcpClient"" 
tcpConn"" 
="" 
null""  $
;""$ %
Stream## 
streamOutput## 
=##  !
null##" &
;##& '
int$$ 
port$$ 
=$$ 
$num$$ 
;$$ 
try%% 
{&& 
listener'' 
='' 
new'' 
TcpListener'' *
(''* +
	IPAddress''+ 4
.''4 5
Parse''5 :
('': ;
$str''; G
)''G H
,''H I
port''J N
)''N O
;''O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
tcpConn)) 
=)) 
listener)) "
.))" #
AcceptTcpClient))# 2
())2 3
)))3 4
;))4 5

IPEndPoint++ 
endPoint++ #
=++$ %
(++& '

IPEndPoint++' 1
)++1 2
tcpConn++2 9
.++9 :
Client++: @
.++@ A
RemoteEndPoint++A O
;++O P
	IPAddress,, 
	ipAddress,, #
=,,$ %
endPoint,,& .
.,,. /
Address,,/ 6
;,,6 7
IPHostEntry-- 
	hostEntry-- %
=--& '
Dns--( +
.--+ ,
GetHostEntry--, 8
(--8 9
	ipAddress--9 B
)--B C
;--C D
if.. 
(.. 
	hostEntry.. 
... 
HostName.. &
...& '
Equals..' -
(..- .
$str... @
)..@ A
)..A B
{// 
streamOutput00  
=00! "
tcpConn00# *
.00* +
	GetStream00+ 4
(004 5
)005 6
;006 7
streamOutput11  
.11  !
Write11! &
(11& '
Encoding11' /
.11/ 0
UTF8110 4
.114 5
GetBytes115 =
(11= >
$str11> O
)11O P
,11P Q
$num11R S
,11S T
$str11U f
.11f g
Length11g m
)11m n
;11n o
}22 
else33 
{44 
streamOutput55  
=55! "
tcpConn55# *
.55* +
	GetStream55+ 4
(554 5
)555 6
;556 7
streamOutput66  
.66  !
Write66! &
(66& '
Encoding66' /
.66/ 0
UTF8660 4
.664 5
GetBytes665 =
(66= >
$str66> N
)66N O
,66O P
$num66Q R
,66R S
$str66T d
.66d e
Length66e k
)66k l
;66l m
}77 
}88 
catch99 
(99 
IOException99 
exceptIO99 '
)99' (
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; 
(;; 
NLog;; "
.;;" #
LogLevel;;# +
.;;+ ,
Warn;;, 0
,;;0 1
exceptIO;;2 :
,;;: ;
$str;;< X
+;;Y Z
port;;[ _
.;;_ `
ToString;;` h
(;;h i
);;i j
);;j k
;;;k l
}<< 
finally== 
{>> 
try?? 
{@@ 
ifAA 
(AA 
streamOutputAA $
!=AA% '
nullAA( ,
)AA, -
{BB 
streamOutputCC $
.CC$ %
CloseCC% *
(CC* +
)CC+ ,
;CC, -
}DD 
}EE 
catchFF 
(FF 
IOExceptionFF "
exceptIOFF# +
)FF+ ,
{GG 
IOHH 
.HH 
LoggerHH 
.HH 
LogHH !
(HH! "
NLogHH" &
.HH& '
LogLevelHH' /
.HH/ 0
WarnHH0 4
,HH4 5
exceptIOHH6 >
,HH> ?
$strHH@ W
)HHW X
;HHX Y
}II 
tryKK 
{LL 
ifMM 
(MM 
tcpConnMM 
!=MM  "
nullMM# '
)MM' (
{NN 
tcpConnOO 
.OO  
CloseOO  %
(OO% &
)OO& '
;OO' (
}PP 
}QQ 
catchRR 
(RR 
IOExceptionRR "
exceptIORR# +
)RR+ ,
{SS 
IOTT 
.TT 
LoggerTT 
.TT 
LogTT !
(TT! "
NLogTT" &
.TT& '
LogLevelTT' /
.TT/ 0
WarnTT0 4
,TT4 5
exceptIOTT6 >
,TT> ?
$strTT@ W
)TTW X
;TTX Y
}UU 
tryWW 
{XX 
ifYY 
(YY 
listenerYY  
!=YY! #
nullYY$ (
)YY( )
{ZZ 
listener[[  
.[[  !
Stop[[! %
([[% &
)[[& '
;[[' (
}\\ 
}]] 
catch^^ 
(^^ 
IOException^^ "
exceptIO^^# +
)^^+ ,
{__ 
IO`` 
.`` 
Logger`` 
.`` 
Log`` !
(``! "
NLog``" &
.``& '
LogLevel``' /
.``/ 0
Warn``0 4
,``4 5
exceptIO``6 >
,``> ?
$str``@ W
)``W X
;``X Y
}aa 
}cc 
}dd 	
}ee 
privateii 
voidii 
Good1ii 
(ii 
)ii 
{jj 
ifkk 

(kk 
IOkk 
.kk 
StaticReturnsFalsekk !
(kk! "
)kk" #
)kk# $
{ll 	
IOnn 
.nn 
	WriteLinenn 
(nn 
$strnn /
)nn/ 0
;nn0 1
}oo 	
elsepp 
{qq 	
TcpListenerrr 
listenerrr  
=rr! "
nullrr# '
;rr' (
	TcpClientss 
tcpConnss 
=ss 
nullss  $
;ss$ %
Streamtt 
streamOutputtt 
=tt  !
nulltt" &
;tt& '
intuu 
portuu 
=uu 
$numuu 
;uu 
tryvv 
{ww 
listenerxx 
=xx 
newxx 
TcpListenerxx *
(xx* +
	IPAddressxx+ 4
.xx4 5
Parsexx5 :
(xx: ;
$strxx; G
)xxG H
,xxH I
portxxJ N
)xxN O
;xxO P
listeneryy 
.yy 
Startyy 
(yy 
)yy  
;yy  !
tcpConnzz 
=zz 
listenerzz "
.zz" #
AcceptTcpClientzz# 2
(zz2 3
)zz3 4
;zz4 5
streamOutput{{ 
={{ 
tcpConn{{ &
.{{& '
	GetStream{{' 0
({{0 1
){{1 2
;{{2 3

IPEndPoint|| 
endPoint|| #
=||$ %
(||& '

IPEndPoint||' 1
)||1 2
tcpConn||2 9
.||9 :
Client||: @
.||@ A
RemoteEndPoint||A O
;||O P
	IPAddress}} 
	ipAddress}} #
=}}$ %
endPoint}}& .
.}}. /
Address}}/ 6
;}}6 7
IPHostEntry~~ 
	hostEntry~~ %
=~~& '
Dns~~( +
.~~+ ,
GetHostEntry~~, 8
(~~8 9
	ipAddress~~9 B
)~~B C
;~~C D
streamOutput
ÄÄ 
.
ÄÄ 
Write
ÄÄ "
(
ÄÄ" #
Encoding
ÄÄ# +
.
ÄÄ+ ,
UTF8
ÄÄ, 0
.
ÄÄ0 1
GetBytes
ÄÄ1 9
(
ÄÄ9 :
(
ÄÄ: ;
$str
ÄÄ; F
+
ÄÄG H
	hostEntry
ÄÄI R
.
ÄÄR S
ToString
ÄÄS [
(
ÄÄ[ \
)
ÄÄ\ ]
)
ÄÄ] ^
)
ÄÄ^ _
,
ÄÄ_ `
$num
ÄÄa b
,
ÄÄb c
(
ÄÄd e
$str
ÄÄe p
+
ÄÄq r
	hostEntry
ÄÄs |
.
ÄÄ| }
ToStringÄÄ} Ö
(ÄÄÖ Ü
)ÄÄÜ á
)ÄÄá à
.ÄÄà â
LengthÄÄâ è
)ÄÄè ê
;ÄÄê ë
}
ÅÅ 
catch
ÇÇ 
(
ÇÇ 
IOException
ÇÇ 
exceptIO
ÇÇ '
)
ÇÇ' (
{
ÉÉ 
IO
ÑÑ 
.
ÑÑ 
Logger
ÑÑ 
.
ÑÑ 
Log
ÑÑ 
(
ÑÑ 
NLog
ÑÑ "
.
ÑÑ" #
LogLevel
ÑÑ# +
.
ÑÑ+ ,
Warn
ÑÑ, 0
,
ÑÑ0 1
exceptIO
ÑÑ2 :
,
ÑÑ: ;
$str
ÑÑ< X
+
ÑÑY Z
port
ÑÑ[ _
.
ÑÑ_ `
ToString
ÑÑ` h
(
ÑÑh i
)
ÑÑi j
)
ÑÑj k
;
ÑÑk l
}
ÖÖ 
finally
ÜÜ 
{
áá 
try
àà 
{
ââ 
if
ää 
(
ää 
streamOutput
ää $
!=
ää% '
null
ää( ,
)
ää, -
{
ãã 
streamOutput
åå $
.
åå$ %
Close
åå% *
(
åå* +
)
åå+ ,
;
åå, -
}
çç 
}
éé 
catch
èè 
(
èè 
IOException
èè "
exceptIO
èè# +
)
èè+ ,
{
êê 
IO
ëë 
.
ëë 
Logger
ëë 
.
ëë 
Log
ëë !
(
ëë! "
NLog
ëë" &
.
ëë& '
LogLevel
ëë' /
.
ëë/ 0
Warn
ëë0 4
,
ëë4 5
exceptIO
ëë6 >
,
ëë> ?
$str
ëë@ W
)
ëëW X
;
ëëX Y
}
íí 
try
îî 
{
ïï 
if
ññ 
(
ññ 
tcpConn
ññ 
!=
ññ  "
null
ññ# '
)
ññ' (
{
óó 
tcpConn
òò 
.
òò  
Close
òò  %
(
òò% &
)
òò& '
;
òò' (
}
ôô 
}
öö 
catch
õõ 
(
õõ 
IOException
õõ "
exceptIO
õõ# +
)
õõ+ ,
{
úú 
IO
ùù 
.
ùù 
Logger
ùù 
.
ùù 
Log
ùù !
(
ùù! "
NLog
ùù" &
.
ùù& '
LogLevel
ùù' /
.
ùù/ 0
Warn
ùù0 4
,
ùù4 5
exceptIO
ùù6 >
,
ùù> ?
$str
ùù@ W
)
ùùW X
;
ùùX Y
}
ûû 
try
†† 
{
°° 
if
¢¢ 
(
¢¢ 
listener
¢¢  
!=
¢¢! #
null
¢¢$ (
)
¢¢( )
{
££ 
listener
§§  
.
§§  !
Stop
§§! %
(
§§% &
)
§§& '
;
§§' (
}
•• 
}
¶¶ 
catch
ßß 
(
ßß 
IOException
ßß "
exceptIO
ßß# +
)
ßß+ ,
{
®® 
IO
©© 
.
©© 
Logger
©© 
.
©© 
Log
©© !
(
©©! "
NLog
©©" &
.
©©& '
LogLevel
©©' /
.
©©/ 0
Warn
©©0 4
,
©©4 5
exceptIO
©©6 >
,
©©> ?
$str
©©@ W
)
©©W X
;
©©X Y
}
™™ 
}
¨¨ 
}
≠≠ 	
}
ÆÆ 
private
±± 
void
±± 
Good2
±± 
(
±± 
)
±± 
{
≤≤ 
if
≥≥ 

(
≥≥ 
IO
≥≥ 
.
≥≥ 
StaticReturnsTrue
≥≥  
(
≥≥  !
)
≥≥! "
)
≥≥" #
{
¥¥ 	
TcpListener
µµ 
listener
µµ  
=
µµ! "
null
µµ# '
;
µµ' (
	TcpClient
∂∂ 
tcpConn
∂∂ 
=
∂∂ 
null
∂∂  $
;
∂∂$ %
Stream
∑∑ 
streamOutput
∑∑ 
=
∑∑  !
null
∑∑" &
;
∑∑& '
int
∏∏ 
port
∏∏ 
=
∏∏ 
$num
∏∏ 
;
∏∏ 
try
ππ 
{
∫∫ 
listener
ªª 
=
ªª 
new
ªª 
TcpListener
ªª *
(
ªª* +
	IPAddress
ªª+ 4
.
ªª4 5
Parse
ªª5 :
(
ªª: ;
$str
ªª; G
)
ªªG H
,
ªªH I
port
ªªJ N
)
ªªN O
;
ªªO P
listener
ºº 
.
ºº 
Start
ºº 
(
ºº 
)
ºº  
;
ºº  !
tcpConn
ΩΩ 
=
ΩΩ 
listener
ΩΩ "
.
ΩΩ" #
AcceptTcpClient
ΩΩ# 2
(
ΩΩ2 3
)
ΩΩ3 4
;
ΩΩ4 5
streamOutput
ææ 
=
ææ 
tcpConn
ææ &
.
ææ& '
	GetStream
ææ' 0
(
ææ0 1
)
ææ1 2
;
ææ2 3

IPEndPoint
øø 
endPoint
øø #
=
øø$ %
(
øø& '

IPEndPoint
øø' 1
)
øø1 2
tcpConn
øø2 9
.
øø9 :
Client
øø: @
.
øø@ A
RemoteEndPoint
øøA O
;
øøO P
	IPAddress
¿¿ 
	ipAddress
¿¿ #
=
¿¿$ %
endPoint
¿¿& .
.
¿¿. /
Address
¿¿/ 6
;
¿¿6 7
IPHostEntry
¡¡ 
	hostEntry
¡¡ %
=
¡¡& '
Dns
¡¡( +
.
¡¡+ ,
GetHostEntry
¡¡, 8
(
¡¡8 9
	ipAddress
¡¡9 B
)
¡¡B C
;
¡¡C D
streamOutput
√√ 
.
√√ 
Write
√√ "
(
√√" #
Encoding
√√# +
.
√√+ ,
UTF8
√√, 0
.
√√0 1
GetBytes
√√1 9
(
√√9 :
(
√√: ;
$str
√√; F
+
√√G H
	hostEntry
√√I R
.
√√R S
ToString
√√S [
(
√√[ \
)
√√\ ]
)
√√] ^
)
√√^ _
,
√√_ `
$num
√√a b
,
√√b c
(
√√d e
$str
√√e p
+
√√q r
	hostEntry
√√s |
.
√√| }
ToString√√} Ö
(√√Ö Ü
)√√Ü á
)√√á à
.√√à â
Length√√â è
)√√è ê
;√√ê ë
}
ƒƒ 
catch
≈≈ 
(
≈≈ 
IOException
≈≈ 
exceptIO
≈≈ '
)
≈≈' (
{
∆∆ 
IO
«« 
.
«« 
Logger
«« 
.
«« 
Log
«« 
(
«« 
NLog
«« "
.
««" #
LogLevel
««# +
.
««+ ,
Warn
««, 0
,
««0 1
exceptIO
««2 :
,
««: ;
$str
««< X
+
««Y Z
port
««[ _
.
««_ `
ToString
««` h
(
««h i
)
««i j
)
««j k
;
««k l
}
»» 
finally
…… 
{
   
try
ÀÀ 
{
ÃÃ 
if
ÕÕ 
(
ÕÕ 
streamOutput
ÕÕ $
!=
ÕÕ% '
null
ÕÕ( ,
)
ÕÕ, -
{
ŒŒ 
streamOutput
œœ $
.
œœ$ %
Close
œœ% *
(
œœ* +
)
œœ+ ,
;
œœ, -
}
–– 
}
—— 
catch
““ 
(
““ 
IOException
““ "
exceptIO
““# +
)
““+ ,
{
”” 
IO
‘‘ 
.
‘‘ 
Logger
‘‘ 
.
‘‘ 
Log
‘‘ !
(
‘‘! "
NLog
‘‘" &
.
‘‘& '
LogLevel
‘‘' /
.
‘‘/ 0
Warn
‘‘0 4
,
‘‘4 5
exceptIO
‘‘6 >
,
‘‘> ?
$str
‘‘@ W
)
‘‘W X
;
‘‘X Y
}
’’ 
try
◊◊ 
{
ÿÿ 
if
ŸŸ 
(
ŸŸ 
tcpConn
ŸŸ 
!=
ŸŸ  "
null
ŸŸ# '
)
ŸŸ' (
{
⁄⁄ 
tcpConn
€€ 
.
€€  
Close
€€  %
(
€€% &
)
€€& '
;
€€' (
}
‹‹ 
}
›› 
catch
ﬁﬁ 
(
ﬁﬁ 
IOException
ﬁﬁ "
exceptIO
ﬁﬁ# +
)
ﬁﬁ+ ,
{
ﬂﬂ 
IO
‡‡ 
.
‡‡ 
Logger
‡‡ 
.
‡‡ 
Log
‡‡ !
(
‡‡! "
NLog
‡‡" &
.
‡‡& '
LogLevel
‡‡' /
.
‡‡/ 0
Warn
‡‡0 4
,
‡‡4 5
exceptIO
‡‡6 >
,
‡‡> ?
$str
‡‡@ W
)
‡‡W X
;
‡‡X Y
}
·· 
try
„„ 
{
‰‰ 
if
ÂÂ 
(
ÂÂ 
listener
ÂÂ  
!=
ÂÂ! #
null
ÂÂ$ (
)
ÂÂ( )
{
ÊÊ 
listener
ÁÁ  
.
ÁÁ  !
Stop
ÁÁ! %
(
ÁÁ% &
)
ÁÁ& '
;
ÁÁ' (
}
ËË 
}
ÈÈ 
catch
ÍÍ 
(
ÍÍ 
IOException
ÍÍ "
exceptIO
ÍÍ# +
)
ÍÍ+ ,
{
ÎÎ 
IO
ÏÏ 
.
ÏÏ 
Logger
ÏÏ 
.
ÏÏ 
Log
ÏÏ !
(
ÏÏ! "
NLog
ÏÏ" &
.
ÏÏ& '
LogLevel
ÏÏ' /
.
ÏÏ/ 0
Warn
ÏÏ0 4
,
ÏÏ4 5
exceptIO
ÏÏ6 >
,
ÏÏ> ?
$str
ÏÏ@ W
)
ÏÏW X
;
ÏÏX Y
}
ÌÌ 
}
ÔÔ 
}
 	
}
ÒÒ 
public
ÛÛ 

override
ÛÛ 
void
ÛÛ 
Good
ÛÛ 
(
ÛÛ 
)
ÛÛ 
{
ÙÙ 
Good1
ıı 
(
ıı 
)
ıı 
;
ıı 
Good2
ˆˆ 
(
ˆˆ 
)
ˆˆ 
;
ˆˆ 
}
˜˜ 
}˘˘ 
}˙˙ Å≤
ñC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__hostname_based_logic_12.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 4
(CWE510_Trapdoor__hostname_based_logic_12 .
:/ 0
AbstractTestCase1 A
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
IO 
. $
StaticReturnsTrueOrFalse '
(' (
)( )
)) *
{   	
TcpListener!! 
listener!!  
=!!! "
null!!# '
;!!' (
	TcpClient"" 
tcpConn"" 
="" 
null""  $
;""$ %
Stream## 
streamOutput## 
=##  !
null##" &
;##& '
int$$ 
port$$ 
=$$ 
$num$$ 
;$$ 
try%% 
{&& 
listener'' 
='' 
new'' 
TcpListener'' *
(''* +
	IPAddress''+ 4
.''4 5
Parse''5 :
('': ;
$str''; G
)''G H
,''H I
port''J N
)''N O
;''O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
tcpConn)) 
=)) 
listener)) "
.))" #
AcceptTcpClient))# 2
())2 3
)))3 4
;))4 5

IPEndPoint++ 
endPoint++ #
=++$ %
(++& '

IPEndPoint++' 1
)++1 2
tcpConn++2 9
.++9 :
Client++: @
.++@ A
RemoteEndPoint++A O
;++O P
	IPAddress,, 
	ipAddress,, #
=,,$ %
endPoint,,& .
.,,. /
Address,,/ 6
;,,6 7
IPHostEntry-- 
	hostEntry-- %
=--& '
Dns--( +
.--+ ,
GetHostEntry--, 8
(--8 9
	ipAddress--9 B
)--B C
;--C D
if.. 
(.. 
	hostEntry.. 
... 
HostName.. &
...& '
Equals..' -
(..- .
$str... @
)..@ A
)..A B
{// 
streamOutput00  
=00! "
tcpConn00# *
.00* +
	GetStream00+ 4
(004 5
)005 6
;006 7
streamOutput11  
.11  !
Write11! &
(11& '
Encoding11' /
.11/ 0
UTF8110 4
.114 5
GetBytes115 =
(11= >
$str11> O
)11O P
,11P Q
$num11R S
,11S T
$str11U f
.11f g
Length11g m
)11m n
;11n o
}22 
else33 
{44 
streamOutput55  
=55! "
tcpConn55# *
.55* +
	GetStream55+ 4
(554 5
)555 6
;556 7
streamOutput66  
.66  !
Write66! &
(66& '
Encoding66' /
.66/ 0
UTF8660 4
.664 5
GetBytes665 =
(66= >
$str66> N
)66N O
,66O P
$num66Q R
,66R S
$str66T d
.66d e
Length66e k
)66k l
;66l m
}77 
}88 
catch99 
(99 
IOException99 
exceptIO99 '
)99' (
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; 
(;; 
NLog;; "
.;;" #
LogLevel;;# +
.;;+ ,
Warn;;, 0
,;;0 1
exceptIO;;2 :
,;;: ;
$str;;< X
+;;Y Z
port;;[ _
.;;_ `
ToString;;` h
(;;h i
);;i j
);;j k
;;;k l
}<< 
finally== 
{>> 
try?? 
{@@ 
ifAA 
(AA 
streamOutputAA $
!=AA% '
nullAA( ,
)AA, -
{BB 
streamOutputCC $
.CC$ %
CloseCC% *
(CC* +
)CC+ ,
;CC, -
}DD 
}EE 
catchFF 
(FF 
IOExceptionFF "
exceptIOFF# +
)FF+ ,
{GG 
IOHH 
.HH 
LoggerHH 
.HH 
LogHH !
(HH! "
NLogHH" &
.HH& '
LogLevelHH' /
.HH/ 0
WarnHH0 4
,HH4 5
exceptIOHH6 >
,HH> ?
$strHH@ W
)HHW X
;HHX Y
}II 
tryKK 
{LL 
ifMM 
(MM 
tcpConnMM 
!=MM  "
nullMM# '
)MM' (
{NN 
tcpConnOO 
.OO  
CloseOO  %
(OO% &
)OO& '
;OO' (
}PP 
}QQ 
catchRR 
(RR 
IOExceptionRR "
exceptIORR# +
)RR+ ,
{SS 
IOTT 
.TT 
LoggerTT 
.TT 
LogTT !
(TT! "
NLogTT" &
.TT& '
LogLevelTT' /
.TT/ 0
WarnTT0 4
,TT4 5
exceptIOTT6 >
,TT> ?
$strTT@ W
)TTW X
;TTX Y
}UU 
tryWW 
{XX 
ifYY 
(YY 
listenerYY  
!=YY! #
nullYY$ (
)YY( )
{ZZ 
listener[[  
.[[  !
Stop[[! %
([[% &
)[[& '
;[[' (
}\\ 
}]] 
catch^^ 
(^^ 
IOException^^ "
exceptIO^^# +
)^^+ ,
{__ 
IO`` 
.`` 
Logger`` 
.`` 
Log`` !
(``! "
NLog``" &
.``& '
LogLevel``' /
.``/ 0
Warn``0 4
,``4 5
exceptIO``6 >
,``> ?
$str``@ W
)``W X
;``X Y
}aa 
}cc 
}dd 	
elseee 
{ff 	
TcpListenergg 
listenergg  
=gg! "
nullgg# '
;gg' (
	TcpClienthh 
tcpConnhh 
=hh 
nullhh  $
;hh$ %
Streamii 
streamOutputii 
=ii  !
nullii" &
;ii& '
intjj 
portjj 
=jj 
$numjj 
;jj 
trykk 
{ll 
listenermm 
=mm 
newmm 
TcpListenermm *
(mm* +
	IPAddressmm+ 4
.mm4 5
Parsemm5 :
(mm: ;
$strmm; G
)mmG H
,mmH I
portmmJ N
)mmN O
;mmO P
listenernn 
.nn 
Startnn 
(nn 
)nn  
;nn  !
tcpConnoo 
=oo 
listeneroo "
.oo" #
AcceptTcpClientoo# 2
(oo2 3
)oo3 4
;oo4 5
streamOutputpp 
=pp 
tcpConnpp &
.pp& '
	GetStreampp' 0
(pp0 1
)pp1 2
;pp2 3

IPEndPointqq 
endPointqq #
=qq$ %
(qq& '

IPEndPointqq' 1
)qq1 2
tcpConnqq2 9
.qq9 :
Clientqq: @
.qq@ A
RemoteEndPointqqA O
;qqO P
	IPAddressrr 
	ipAddressrr #
=rr$ %
endPointrr& .
.rr. /
Addressrr/ 6
;rr6 7
IPHostEntryss 
	hostEntryss %
=ss& '
Dnsss( +
.ss+ ,
GetHostEntryss, 8
(ss8 9
	ipAddressss9 B
)ssB C
;ssC D
streamOutputuu 
.uu 
Writeuu "
(uu" #
Encodinguu# +
.uu+ ,
UTF8uu, 0
.uu0 1
GetBytesuu1 9
(uu9 :
(uu: ;
$struu; F
+uuG H
	hostEntryuuI R
.uuR S
ToStringuuS [
(uu[ \
)uu\ ]
)uu] ^
)uu^ _
,uu_ `
$numuua b
,uub c
(uud e
$struue p
+uuq r
	hostEntryuus |
.uu| }
ToString	uu} Ö
(
uuÖ Ü
)
uuÜ á
)
uuá à
.
uuà â
Length
uuâ è
)
uuè ê
;
uuê ë
}vv 
catchww 
(ww 
IOExceptionww 
exceptIOww '
)ww' (
{xx 
IOyy 
.yy 
Loggeryy 
.yy 
Logyy 
(yy 
NLogyy "
.yy" #
LogLevelyy# +
.yy+ ,
Warnyy, 0
,yy0 1
exceptIOyy2 :
,yy: ;
$stryy< X
+yyY Z
portyy[ _
.yy_ `
ToStringyy` h
(yyh i
)yyi j
)yyj k
;yyk l
}zz 
finally{{ 
{|| 
try}} 
{~~ 
if 
( 
streamOutput $
!=% '
null( ,
), -
{
ÄÄ 
streamOutput
ÅÅ $
.
ÅÅ$ %
Close
ÅÅ% *
(
ÅÅ* +
)
ÅÅ+ ,
;
ÅÅ, -
}
ÇÇ 
}
ÉÉ 
catch
ÑÑ 
(
ÑÑ 
IOException
ÑÑ "
exceptIO
ÑÑ# +
)
ÑÑ+ ,
{
ÖÖ 
IO
ÜÜ 
.
ÜÜ 
Logger
ÜÜ 
.
ÜÜ 
Log
ÜÜ !
(
ÜÜ! "
NLog
ÜÜ" &
.
ÜÜ& '
LogLevel
ÜÜ' /
.
ÜÜ/ 0
Warn
ÜÜ0 4
,
ÜÜ4 5
exceptIO
ÜÜ6 >
,
ÜÜ> ?
$str
ÜÜ@ W
)
ÜÜW X
;
ÜÜX Y
}
áá 
try
ââ 
{
ää 
if
ãã 
(
ãã 
tcpConn
ãã 
!=
ãã  "
null
ãã# '
)
ãã' (
{
åå 
tcpConn
çç 
.
çç  
Close
çç  %
(
çç% &
)
çç& '
;
çç' (
}
éé 
}
èè 
catch
êê 
(
êê 
IOException
êê "
exceptIO
êê# +
)
êê+ ,
{
ëë 
IO
íí 
.
íí 
Logger
íí 
.
íí 
Log
íí !
(
íí! "
NLog
íí" &
.
íí& '
LogLevel
íí' /
.
íí/ 0
Warn
íí0 4
,
íí4 5
exceptIO
íí6 >
,
íí> ?
$str
íí@ W
)
ííW X
;
ííX Y
}
ìì 
try
ïï 
{
ññ 
if
óó 
(
óó 
listener
óó  
!=
óó! #
null
óó$ (
)
óó( )
{
òò 
listener
ôô  
.
ôô  !
Stop
ôô! %
(
ôô% &
)
ôô& '
;
ôô' (
}
öö 
}
õõ 
catch
úú 
(
úú 
IOException
úú "
exceptIO
úú# +
)
úú+ ,
{
ùù 
IO
ûû 
.
ûû 
Logger
ûû 
.
ûû 
Log
ûû !
(
ûû! "
NLog
ûû" &
.
ûû& '
LogLevel
ûû' /
.
ûû/ 0
Warn
ûû0 4
,
ûû4 5
exceptIO
ûû6 >
,
ûû> ?
$str
ûû@ W
)
ûûW X
;
ûûX Y
}
üü 
}
°° 
}
¢¢ 	
}
££ 
private
ßß 
void
ßß 
Good1
ßß 
(
ßß 
)
ßß 
{
®® 
if
©© 

(
©© 
IO
©© 
.
©© &
StaticReturnsTrueOrFalse
©© '
(
©©' (
)
©©( )
)
©©) *
{
™™ 	
TcpListener
´´ 
listener
´´  
=
´´! "
null
´´# '
;
´´' (
	TcpClient
¨¨ 
tcpConn
¨¨ 
=
¨¨ 
null
¨¨  $
;
¨¨$ %
Stream
≠≠ 
streamOutput
≠≠ 
=
≠≠  !
null
≠≠" &
;
≠≠& '
int
ÆÆ 
port
ÆÆ 
=
ÆÆ 
$num
ÆÆ 
;
ÆÆ 
try
ØØ 
{
∞∞ 
listener
±± 
=
±± 
new
±± 
TcpListener
±± *
(
±±* +
	IPAddress
±±+ 4
.
±±4 5
Parse
±±5 :
(
±±: ;
$str
±±; G
)
±±G H
,
±±H I
port
±±J N
)
±±N O
;
±±O P
listener
≤≤ 
.
≤≤ 
Start
≤≤ 
(
≤≤ 
)
≤≤  
;
≤≤  !
tcpConn
≥≥ 
=
≥≥ 
listener
≥≥ "
.
≥≥" #
AcceptTcpClient
≥≥# 2
(
≥≥2 3
)
≥≥3 4
;
≥≥4 5
streamOutput
¥¥ 
=
¥¥ 
tcpConn
¥¥ &
.
¥¥& '
	GetStream
¥¥' 0
(
¥¥0 1
)
¥¥1 2
;
¥¥2 3

IPEndPoint
µµ 
endPoint
µµ #
=
µµ$ %
(
µµ& '

IPEndPoint
µµ' 1
)
µµ1 2
tcpConn
µµ2 9
.
µµ9 :
Client
µµ: @
.
µµ@ A
RemoteEndPoint
µµA O
;
µµO P
	IPAddress
∂∂ 
	ipAddress
∂∂ #
=
∂∂$ %
endPoint
∂∂& .
.
∂∂. /
Address
∂∂/ 6
;
∂∂6 7
IPHostEntry
∑∑ 
	hostEntry
∑∑ %
=
∑∑& '
Dns
∑∑( +
.
∑∑+ ,
GetHostEntry
∑∑, 8
(
∑∑8 9
	ipAddress
∑∑9 B
)
∑∑B C
;
∑∑C D
streamOutput
ππ 
.
ππ 
Write
ππ "
(
ππ" #
Encoding
ππ# +
.
ππ+ ,
UTF8
ππ, 0
.
ππ0 1
GetBytes
ππ1 9
(
ππ9 :
(
ππ: ;
$str
ππ; F
+
ππG H
	hostEntry
ππI R
.
ππR S
ToString
ππS [
(
ππ[ \
)
ππ\ ]
)
ππ] ^
)
ππ^ _
,
ππ_ `
$num
ππa b
,
ππb c
(
ππd e
$str
ππe p
+
ππq r
	hostEntry
ππs |
.
ππ| }
ToStringππ} Ö
(ππÖ Ü
)ππÜ á
)ππá à
.ππà â
Lengthππâ è
)ππè ê
;ππê ë
}
∫∫ 
catch
ªª 
(
ªª 
IOException
ªª 
exceptIO
ªª '
)
ªª' (
{
ºº 
IO
ΩΩ 
.
ΩΩ 
Logger
ΩΩ 
.
ΩΩ 
Log
ΩΩ 
(
ΩΩ 
NLog
ΩΩ "
.
ΩΩ" #
LogLevel
ΩΩ# +
.
ΩΩ+ ,
Warn
ΩΩ, 0
,
ΩΩ0 1
exceptIO
ΩΩ2 :
,
ΩΩ: ;
$str
ΩΩ< X
+
ΩΩY Z
port
ΩΩ[ _
.
ΩΩ_ `
ToString
ΩΩ` h
(
ΩΩh i
)
ΩΩi j
)
ΩΩj k
;
ΩΩk l
}
ææ 
finally
øø 
{
¿¿ 
try
¡¡ 
{
¬¬ 
if
√√ 
(
√√ 
streamOutput
√√ $
!=
√√% '
null
√√( ,
)
√√, -
{
ƒƒ 
streamOutput
≈≈ $
.
≈≈$ %
Close
≈≈% *
(
≈≈* +
)
≈≈+ ,
;
≈≈, -
}
∆∆ 
}
«« 
catch
»» 
(
»» 
IOException
»» "
exceptIO
»»# +
)
»»+ ,
{
…… 
IO
   
.
   
Logger
   
.
   
Log
   !
(
  ! "
NLog
  " &
.
  & '
LogLevel
  ' /
.
  / 0
Warn
  0 4
,
  4 5
exceptIO
  6 >
,
  > ?
$str
  @ W
)
  W X
;
  X Y
}
ÀÀ 
try
ÕÕ 
{
ŒŒ 
if
œœ 
(
œœ 
tcpConn
œœ 
!=
œœ  "
null
œœ# '
)
œœ' (
{
–– 
tcpConn
—— 
.
——  
Close
——  %
(
——% &
)
——& '
;
——' (
}
““ 
}
”” 
catch
‘‘ 
(
‘‘ 
IOException
‘‘ "
exceptIO
‘‘# +
)
‘‘+ ,
{
’’ 
IO
÷÷ 
.
÷÷ 
Logger
÷÷ 
.
÷÷ 
Log
÷÷ !
(
÷÷! "
NLog
÷÷" &
.
÷÷& '
LogLevel
÷÷' /
.
÷÷/ 0
Warn
÷÷0 4
,
÷÷4 5
exceptIO
÷÷6 >
,
÷÷> ?
$str
÷÷@ W
)
÷÷W X
;
÷÷X Y
}
◊◊ 
try
ŸŸ 
{
⁄⁄ 
if
€€ 
(
€€ 
listener
€€  
!=
€€! #
null
€€$ (
)
€€( )
{
‹‹ 
listener
››  
.
››  !
Stop
››! %
(
››% &
)
››& '
;
››' (
}
ﬁﬁ 
}
ﬂﬂ 
catch
‡‡ 
(
‡‡ 
IOException
‡‡ "
exceptIO
‡‡# +
)
‡‡+ ,
{
·· 
IO
‚‚ 
.
‚‚ 
Logger
‚‚ 
.
‚‚ 
Log
‚‚ !
(
‚‚! "
NLog
‚‚" &
.
‚‚& '
LogLevel
‚‚' /
.
‚‚/ 0
Warn
‚‚0 4
,
‚‚4 5
exceptIO
‚‚6 >
,
‚‚> ?
$str
‚‚@ W
)
‚‚W X
;
‚‚X Y
}
„„ 
}
ÂÂ 
}
ÊÊ 	
else
ÁÁ 
{
ËË 	
TcpListener
ÈÈ 
listener
ÈÈ  
=
ÈÈ! "
null
ÈÈ# '
;
ÈÈ' (
	TcpClient
ÍÍ 
tcpConn
ÍÍ 
=
ÍÍ 
null
ÍÍ  $
;
ÍÍ$ %
Stream
ÎÎ 
streamOutput
ÎÎ 
=
ÎÎ  !
null
ÎÎ" &
;
ÎÎ& '
int
ÏÏ 
port
ÏÏ 
=
ÏÏ 
$num
ÏÏ 
;
ÏÏ 
try
ÌÌ 
{
ÓÓ 
listener
ÔÔ 
=
ÔÔ 
new
ÔÔ 
TcpListener
ÔÔ *
(
ÔÔ* +
	IPAddress
ÔÔ+ 4
.
ÔÔ4 5
Parse
ÔÔ5 :
(
ÔÔ: ;
$str
ÔÔ; G
)
ÔÔG H
,
ÔÔH I
port
ÔÔJ N
)
ÔÔN O
;
ÔÔO P
listener
 
.
 
Start
 
(
 
)
  
;
  !
tcpConn
ÒÒ 
=
ÒÒ 
listener
ÒÒ "
.
ÒÒ" #
AcceptTcpClient
ÒÒ# 2
(
ÒÒ2 3
)
ÒÒ3 4
;
ÒÒ4 5
streamOutput
ÚÚ 
=
ÚÚ 
tcpConn
ÚÚ &
.
ÚÚ& '
	GetStream
ÚÚ' 0
(
ÚÚ0 1
)
ÚÚ1 2
;
ÚÚ2 3

IPEndPoint
ÛÛ 
endPoint
ÛÛ #
=
ÛÛ$ %
(
ÛÛ& '

IPEndPoint
ÛÛ' 1
)
ÛÛ1 2
tcpConn
ÛÛ2 9
.
ÛÛ9 :
Client
ÛÛ: @
.
ÛÛ@ A
RemoteEndPoint
ÛÛA O
;
ÛÛO P
	IPAddress
ÙÙ 
	ipAddress
ÙÙ #
=
ÙÙ$ %
endPoint
ÙÙ& .
.
ÙÙ. /
Address
ÙÙ/ 6
;
ÙÙ6 7
IPHostEntry
ıı 
	hostEntry
ıı %
=
ıı& '
Dns
ıı( +
.
ıı+ ,
GetHostEntry
ıı, 8
(
ıı8 9
	ipAddress
ıı9 B
)
ııB C
;
ııC D
streamOutput
˜˜ 
.
˜˜ 
Write
˜˜ "
(
˜˜" #
Encoding
˜˜# +
.
˜˜+ ,
UTF8
˜˜, 0
.
˜˜0 1
GetBytes
˜˜1 9
(
˜˜9 :
(
˜˜: ;
$str
˜˜; F
+
˜˜G H
	hostEntry
˜˜I R
.
˜˜R S
ToString
˜˜S [
(
˜˜[ \
)
˜˜\ ]
)
˜˜] ^
)
˜˜^ _
,
˜˜_ `
$num
˜˜a b
,
˜˜b c
(
˜˜d e
$str
˜˜e p
+
˜˜q r
	hostEntry
˜˜s |
.
˜˜| }
ToString˜˜} Ö
(˜˜Ö Ü
)˜˜Ü á
)˜˜á à
.˜˜à â
Length˜˜â è
)˜˜è ê
;˜˜ê ë
}
¯¯ 
catch
˘˘ 
(
˘˘ 
IOException
˘˘ 
exceptIO
˘˘ '
)
˘˘' (
{
˙˙ 
IO
˚˚ 
.
˚˚ 
Logger
˚˚ 
.
˚˚ 
Log
˚˚ 
(
˚˚ 
NLog
˚˚ "
.
˚˚" #
LogLevel
˚˚# +
.
˚˚+ ,
Warn
˚˚, 0
,
˚˚0 1
exceptIO
˚˚2 :
,
˚˚: ;
$str
˚˚< X
+
˚˚Y Z
port
˚˚[ _
.
˚˚_ `
ToString
˚˚` h
(
˚˚h i
)
˚˚i j
)
˚˚j k
;
˚˚k l
}
¸¸ 
finally
˝˝ 
{
˛˛ 
try
ˇˇ 
{
ÄÄ 
if
ÅÅ 
(
ÅÅ 
streamOutput
ÅÅ $
!=
ÅÅ% '
null
ÅÅ( ,
)
ÅÅ, -
{
ÇÇ 
streamOutput
ÉÉ $
.
ÉÉ$ %
Close
ÉÉ% *
(
ÉÉ* +
)
ÉÉ+ ,
;
ÉÉ, -
}
ÑÑ 
}
ÖÖ 
catch
ÜÜ 
(
ÜÜ 
IOException
ÜÜ "
exceptIO
ÜÜ# +
)
ÜÜ+ ,
{
áá 
IO
àà 
.
àà 
Logger
àà 
.
àà 
Log
àà !
(
àà! "
NLog
àà" &
.
àà& '
LogLevel
àà' /
.
àà/ 0
Warn
àà0 4
,
àà4 5
exceptIO
àà6 >
,
àà> ?
$str
àà@ W
)
ààW X
;
ààX Y
}
ââ 
try
ãã 
{
åå 
if
çç 
(
çç 
tcpConn
çç 
!=
çç  "
null
çç# '
)
çç' (
{
éé 
tcpConn
èè 
.
èè  
Close
èè  %
(
èè% &
)
èè& '
;
èè' (
}
êê 
}
ëë 
catch
íí 
(
íí 
IOException
íí "
exceptIO
íí# +
)
íí+ ,
{
ìì 
IO
îî 
.
îî 
Logger
îî 
.
îî 
Log
îî !
(
îî! "
NLog
îî" &
.
îî& '
LogLevel
îî' /
.
îî/ 0
Warn
îî0 4
,
îî4 5
exceptIO
îî6 >
,
îî> ?
$str
îî@ W
)
îîW X
;
îîX Y
}
ïï 
try
óó 
{
òò 
if
ôô 
(
ôô 
listener
ôô  
!=
ôô! #
null
ôô$ (
)
ôô( )
{
öö 
listener
õõ  
.
õõ  !
Stop
õõ! %
(
õõ% &
)
õõ& '
;
õõ' (
}
úú 
}
ùù 
catch
ûû 
(
ûû 
IOException
ûû "
exceptIO
ûû# +
)
ûû+ ,
{
üü 
IO
†† 
.
†† 
Logger
†† 
.
†† 
Log
†† !
(
††! "
NLog
††" &
.
††& '
LogLevel
††' /
.
††/ 0
Warn
††0 4
,
††4 5
exceptIO
††6 >
,
††> ?
$str
††@ W
)
††W X
;
††X Y
}
°° 
}
££ 
}
§§ 	
}
•• 
public
ßß 

override
ßß 
void
ßß 
Good
ßß 
(
ßß 
)
ßß 
{
®® 
Good1
©© 
(
©© 
)
©© 
;
©© 
}
™™ 
}¨¨ 
}≠≠ ¯ã
ñC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__hostname_based_logic_13.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 4
(CWE510_Trapdoor__hostname_based_logic_13 .
:/ 0
AbstractTestCase1 A
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
IO 
.  
STATIC_READONLY_FIVE #
==$ &
$num' (
)( )
{   	
TcpListener!! 
listener!!  
=!!! "
null!!# '
;!!' (
	TcpClient"" 
tcpConn"" 
="" 
null""  $
;""$ %
Stream## 
streamOutput## 
=##  !
null##" &
;##& '
int$$ 
port$$ 
=$$ 
$num$$ 
;$$ 
try%% 
{&& 
listener'' 
='' 
new'' 
TcpListener'' *
(''* +
	IPAddress''+ 4
.''4 5
Parse''5 :
('': ;
$str''; G
)''G H
,''H I
port''J N
)''N O
;''O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
tcpConn)) 
=)) 
listener)) "
.))" #
AcceptTcpClient))# 2
())2 3
)))3 4
;))4 5

IPEndPoint++ 
endPoint++ #
=++$ %
(++& '

IPEndPoint++' 1
)++1 2
tcpConn++2 9
.++9 :
Client++: @
.++@ A
RemoteEndPoint++A O
;++O P
	IPAddress,, 
	ipAddress,, #
=,,$ %
endPoint,,& .
.,,. /
Address,,/ 6
;,,6 7
IPHostEntry-- 
	hostEntry-- %
=--& '
Dns--( +
.--+ ,
GetHostEntry--, 8
(--8 9
	ipAddress--9 B
)--B C
;--C D
if.. 
(.. 
	hostEntry.. 
... 
HostName.. &
...& '
Equals..' -
(..- .
$str... @
)..@ A
)..A B
{// 
streamOutput00  
=00! "
tcpConn00# *
.00* +
	GetStream00+ 4
(004 5
)005 6
;006 7
streamOutput11  
.11  !
Write11! &
(11& '
Encoding11' /
.11/ 0
UTF8110 4
.114 5
GetBytes115 =
(11= >
$str11> O
)11O P
,11P Q
$num11R S
,11S T
$str11U f
.11f g
Length11g m
)11m n
;11n o
}22 
else33 
{44 
streamOutput55  
=55! "
tcpConn55# *
.55* +
	GetStream55+ 4
(554 5
)555 6
;556 7
streamOutput66  
.66  !
Write66! &
(66& '
Encoding66' /
.66/ 0
UTF8660 4
.664 5
GetBytes665 =
(66= >
$str66> N
)66N O
,66O P
$num66Q R
,66R S
$str66T d
.66d e
Length66e k
)66k l
;66l m
}77 
}88 
catch99 
(99 
IOException99 
exceptIO99 '
)99' (
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; 
(;; 
NLog;; "
.;;" #
LogLevel;;# +
.;;+ ,
Warn;;, 0
,;;0 1
exceptIO;;2 :
,;;: ;
$str;;< X
+;;Y Z
port;;[ _
.;;_ `
ToString;;` h
(;;h i
);;i j
);;j k
;;;k l
}<< 
finally== 
{>> 
try?? 
{@@ 
ifAA 
(AA 
streamOutputAA $
!=AA% '
nullAA( ,
)AA, -
{BB 
streamOutputCC $
.CC$ %
CloseCC% *
(CC* +
)CC+ ,
;CC, -
}DD 
}EE 
catchFF 
(FF 
IOExceptionFF "
exceptIOFF# +
)FF+ ,
{GG 
IOHH 
.HH 
LoggerHH 
.HH 
LogHH !
(HH! "
NLogHH" &
.HH& '
LogLevelHH' /
.HH/ 0
WarnHH0 4
,HH4 5
exceptIOHH6 >
,HH> ?
$strHH@ W
)HHW X
;HHX Y
}II 
tryKK 
{LL 
ifMM 
(MM 
tcpConnMM 
!=MM  "
nullMM# '
)MM' (
{NN 
tcpConnOO 
.OO  
CloseOO  %
(OO% &
)OO& '
;OO' (
}PP 
}QQ 
catchRR 
(RR 
IOExceptionRR "
exceptIORR# +
)RR+ ,
{SS 
IOTT 
.TT 
LoggerTT 
.TT 
LogTT !
(TT! "
NLogTT" &
.TT& '
LogLevelTT' /
.TT/ 0
WarnTT0 4
,TT4 5
exceptIOTT6 >
,TT> ?
$strTT@ W
)TTW X
;TTX Y
}UU 
tryWW 
{XX 
ifYY 
(YY 
listenerYY  
!=YY! #
nullYY$ (
)YY( )
{ZZ 
listener[[  
.[[  !
Stop[[! %
([[% &
)[[& '
;[[' (
}\\ 
}]] 
catch^^ 
(^^ 
IOException^^ "
exceptIO^^# +
)^^+ ,
{__ 
IO`` 
.`` 
Logger`` 
.`` 
Log`` !
(``! "
NLog``" &
.``& '
LogLevel``' /
.``/ 0
Warn``0 4
,``4 5
exceptIO``6 >
,``> ?
$str``@ W
)``W X
;``X Y
}aa 
}cc 
}dd 	
}ee 
privateii 
voidii 
Good1ii 
(ii 
)ii 
{jj 
ifkk 

(kk 
IOkk 
.kk  
STATIC_READONLY_FIVEkk #
!=kk$ &
$numkk' (
)kk( )
{ll 	
IOnn 
.nn 
	WriteLinenn 
(nn 
$strnn /
)nn/ 0
;nn0 1
}oo 	
elsepp 
{qq 	
TcpListenerrr 
listenerrr  
=rr! "
nullrr# '
;rr' (
	TcpClientss 
tcpConnss 
=ss 
nullss  $
;ss$ %
Streamtt 
streamOutputtt 
=tt  !
nulltt" &
;tt& '
intuu 
portuu 
=uu 
$numuu 
;uu 
tryvv 
{ww 
listenerxx 
=xx 
newxx 
TcpListenerxx *
(xx* +
	IPAddressxx+ 4
.xx4 5
Parsexx5 :
(xx: ;
$strxx; G
)xxG H
,xxH I
portxxJ N
)xxN O
;xxO P
listeneryy 
.yy 
Startyy 
(yy 
)yy  
;yy  !
tcpConnzz 
=zz 
listenerzz "
.zz" #
AcceptTcpClientzz# 2
(zz2 3
)zz3 4
;zz4 5
streamOutput{{ 
={{ 
tcpConn{{ &
.{{& '
	GetStream{{' 0
({{0 1
){{1 2
;{{2 3

IPEndPoint|| 
endPoint|| #
=||$ %
(||& '

IPEndPoint||' 1
)||1 2
tcpConn||2 9
.||9 :
Client||: @
.||@ A
RemoteEndPoint||A O
;||O P
	IPAddress}} 
	ipAddress}} #
=}}$ %
endPoint}}& .
.}}. /
Address}}/ 6
;}}6 7
IPHostEntry~~ 
	hostEntry~~ %
=~~& '
Dns~~( +
.~~+ ,
GetHostEntry~~, 8
(~~8 9
	ipAddress~~9 B
)~~B C
;~~C D
streamOutput
ÄÄ 
.
ÄÄ 
Write
ÄÄ "
(
ÄÄ" #
Encoding
ÄÄ# +
.
ÄÄ+ ,
UTF8
ÄÄ, 0
.
ÄÄ0 1
GetBytes
ÄÄ1 9
(
ÄÄ9 :
(
ÄÄ: ;
$str
ÄÄ; F
+
ÄÄG H
	hostEntry
ÄÄI R
.
ÄÄR S
ToString
ÄÄS [
(
ÄÄ[ \
)
ÄÄ\ ]
)
ÄÄ] ^
)
ÄÄ^ _
,
ÄÄ_ `
$num
ÄÄa b
,
ÄÄb c
(
ÄÄd e
$str
ÄÄe p
+
ÄÄq r
	hostEntry
ÄÄs |
.
ÄÄ| }
ToStringÄÄ} Ö
(ÄÄÖ Ü
)ÄÄÜ á
)ÄÄá à
.ÄÄà â
LengthÄÄâ è
)ÄÄè ê
;ÄÄê ë
}
ÅÅ 
catch
ÇÇ 
(
ÇÇ 
IOException
ÇÇ 
exceptIO
ÇÇ '
)
ÇÇ' (
{
ÉÉ 
IO
ÑÑ 
.
ÑÑ 
Logger
ÑÑ 
.
ÑÑ 
Log
ÑÑ 
(
ÑÑ 
NLog
ÑÑ "
.
ÑÑ" #
LogLevel
ÑÑ# +
.
ÑÑ+ ,
Warn
ÑÑ, 0
,
ÑÑ0 1
exceptIO
ÑÑ2 :
,
ÑÑ: ;
$str
ÑÑ< X
+
ÑÑY Z
port
ÑÑ[ _
.
ÑÑ_ `
ToString
ÑÑ` h
(
ÑÑh i
)
ÑÑi j
)
ÑÑj k
;
ÑÑk l
}
ÖÖ 
finally
ÜÜ 
{
áá 
try
àà 
{
ââ 
if
ää 
(
ää 
streamOutput
ää $
!=
ää% '
null
ää( ,
)
ää, -
{
ãã 
streamOutput
åå $
.
åå$ %
Close
åå% *
(
åå* +
)
åå+ ,
;
åå, -
}
çç 
}
éé 
catch
èè 
(
èè 
IOException
èè "
exceptIO
èè# +
)
èè+ ,
{
êê 
IO
ëë 
.
ëë 
Logger
ëë 
.
ëë 
Log
ëë !
(
ëë! "
NLog
ëë" &
.
ëë& '
LogLevel
ëë' /
.
ëë/ 0
Warn
ëë0 4
,
ëë4 5
exceptIO
ëë6 >
,
ëë> ?
$str
ëë@ W
)
ëëW X
;
ëëX Y
}
íí 
try
îî 
{
ïï 
if
ññ 
(
ññ 
tcpConn
ññ 
!=
ññ  "
null
ññ# '
)
ññ' (
{
óó 
tcpConn
òò 
.
òò  
Close
òò  %
(
òò% &
)
òò& '
;
òò' (
}
ôô 
}
öö 
catch
õõ 
(
õõ 
IOException
õõ "
exceptIO
õõ# +
)
õõ+ ,
{
úú 
IO
ùù 
.
ùù 
Logger
ùù 
.
ùù 
Log
ùù !
(
ùù! "
NLog
ùù" &
.
ùù& '
LogLevel
ùù' /
.
ùù/ 0
Warn
ùù0 4
,
ùù4 5
exceptIO
ùù6 >
,
ùù> ?
$str
ùù@ W
)
ùùW X
;
ùùX Y
}
ûû 
try
†† 
{
°° 
if
¢¢ 
(
¢¢ 
listener
¢¢  
!=
¢¢! #
null
¢¢$ (
)
¢¢( )
{
££ 
listener
§§  
.
§§  !
Stop
§§! %
(
§§% &
)
§§& '
;
§§' (
}
•• 
}
¶¶ 
catch
ßß 
(
ßß 
IOException
ßß "
exceptIO
ßß# +
)
ßß+ ,
{
®® 
IO
©© 
.
©© 
Logger
©© 
.
©© 
Log
©© !
(
©©! "
NLog
©©" &
.
©©& '
LogLevel
©©' /
.
©©/ 0
Warn
©©0 4
,
©©4 5
exceptIO
©©6 >
,
©©> ?
$str
©©@ W
)
©©W X
;
©©X Y
}
™™ 
}
¨¨ 
}
≠≠ 	
}
ÆÆ 
private
±± 
void
±± 
Good2
±± 
(
±± 
)
±± 
{
≤≤ 
if
≥≥ 

(
≥≥ 
IO
≥≥ 
.
≥≥ "
STATIC_READONLY_FIVE
≥≥ #
==
≥≥$ &
$num
≥≥' (
)
≥≥( )
{
¥¥ 	
TcpListener
µµ 
listener
µµ  
=
µµ! "
null
µµ# '
;
µµ' (
	TcpClient
∂∂ 
tcpConn
∂∂ 
=
∂∂ 
null
∂∂  $
;
∂∂$ %
Stream
∑∑ 
streamOutput
∑∑ 
=
∑∑  !
null
∑∑" &
;
∑∑& '
int
∏∏ 
port
∏∏ 
=
∏∏ 
$num
∏∏ 
;
∏∏ 
try
ππ 
{
∫∫ 
listener
ªª 
=
ªª 
new
ªª 
TcpListener
ªª *
(
ªª* +
	IPAddress
ªª+ 4
.
ªª4 5
Parse
ªª5 :
(
ªª: ;
$str
ªª; G
)
ªªG H
,
ªªH I
port
ªªJ N
)
ªªN O
;
ªªO P
listener
ºº 
.
ºº 
Start
ºº 
(
ºº 
)
ºº  
;
ºº  !
tcpConn
ΩΩ 
=
ΩΩ 
listener
ΩΩ "
.
ΩΩ" #
AcceptTcpClient
ΩΩ# 2
(
ΩΩ2 3
)
ΩΩ3 4
;
ΩΩ4 5
streamOutput
ææ 
=
ææ 
tcpConn
ææ &
.
ææ& '
	GetStream
ææ' 0
(
ææ0 1
)
ææ1 2
;
ææ2 3

IPEndPoint
øø 
endPoint
øø #
=
øø$ %
(
øø& '

IPEndPoint
øø' 1
)
øø1 2
tcpConn
øø2 9
.
øø9 :
Client
øø: @
.
øø@ A
RemoteEndPoint
øøA O
;
øøO P
	IPAddress
¿¿ 
	ipAddress
¿¿ #
=
¿¿$ %
endPoint
¿¿& .
.
¿¿. /
Address
¿¿/ 6
;
¿¿6 7
IPHostEntry
¡¡ 
	hostEntry
¡¡ %
=
¡¡& '
Dns
¡¡( +
.
¡¡+ ,
GetHostEntry
¡¡, 8
(
¡¡8 9
	ipAddress
¡¡9 B
)
¡¡B C
;
¡¡C D
streamOutput
√√ 
.
√√ 
Write
√√ "
(
√√" #
Encoding
√√# +
.
√√+ ,
UTF8
√√, 0
.
√√0 1
GetBytes
√√1 9
(
√√9 :
(
√√: ;
$str
√√; F
+
√√G H
	hostEntry
√√I R
.
√√R S
ToString
√√S [
(
√√[ \
)
√√\ ]
)
√√] ^
)
√√^ _
,
√√_ `
$num
√√a b
,
√√b c
(
√√d e
$str
√√e p
+
√√q r
	hostEntry
√√s |
.
√√| }
ToString√√} Ö
(√√Ö Ü
)√√Ü á
)√√á à
.√√à â
Length√√â è
)√√è ê
;√√ê ë
}
ƒƒ 
catch
≈≈ 
(
≈≈ 
IOException
≈≈ 
exceptIO
≈≈ '
)
≈≈' (
{
∆∆ 
IO
«« 
.
«« 
Logger
«« 
.
«« 
Log
«« 
(
«« 
NLog
«« "
.
««" #
LogLevel
««# +
.
««+ ,
Warn
««, 0
,
««0 1
exceptIO
««2 :
,
««: ;
$str
««< X
+
««Y Z
port
««[ _
.
««_ `
ToString
««` h
(
««h i
)
««i j
)
««j k
;
««k l
}
»» 
finally
…… 
{
   
try
ÀÀ 
{
ÃÃ 
if
ÕÕ 
(
ÕÕ 
streamOutput
ÕÕ $
!=
ÕÕ% '
null
ÕÕ( ,
)
ÕÕ, -
{
ŒŒ 
streamOutput
œœ $
.
œœ$ %
Close
œœ% *
(
œœ* +
)
œœ+ ,
;
œœ, -
}
–– 
}
—— 
catch
““ 
(
““ 
IOException
““ "
exceptIO
““# +
)
““+ ,
{
”” 
IO
‘‘ 
.
‘‘ 
Logger
‘‘ 
.
‘‘ 
Log
‘‘ !
(
‘‘! "
NLog
‘‘" &
.
‘‘& '
LogLevel
‘‘' /
.
‘‘/ 0
Warn
‘‘0 4
,
‘‘4 5
exceptIO
‘‘6 >
,
‘‘> ?
$str
‘‘@ W
)
‘‘W X
;
‘‘X Y
}
’’ 
try
◊◊ 
{
ÿÿ 
if
ŸŸ 
(
ŸŸ 
tcpConn
ŸŸ 
!=
ŸŸ  "
null
ŸŸ# '
)
ŸŸ' (
{
⁄⁄ 
tcpConn
€€ 
.
€€  
Close
€€  %
(
€€% &
)
€€& '
;
€€' (
}
‹‹ 
}
›› 
catch
ﬁﬁ 
(
ﬁﬁ 
IOException
ﬁﬁ "
exceptIO
ﬁﬁ# +
)
ﬁﬁ+ ,
{
ﬂﬂ 
IO
‡‡ 
.
‡‡ 
Logger
‡‡ 
.
‡‡ 
Log
‡‡ !
(
‡‡! "
NLog
‡‡" &
.
‡‡& '
LogLevel
‡‡' /
.
‡‡/ 0
Warn
‡‡0 4
,
‡‡4 5
exceptIO
‡‡6 >
,
‡‡> ?
$str
‡‡@ W
)
‡‡W X
;
‡‡X Y
}
·· 
try
„„ 
{
‰‰ 
if
ÂÂ 
(
ÂÂ 
listener
ÂÂ  
!=
ÂÂ! #
null
ÂÂ$ (
)
ÂÂ( )
{
ÊÊ 
listener
ÁÁ  
.
ÁÁ  !
Stop
ÁÁ! %
(
ÁÁ% &
)
ÁÁ& '
;
ÁÁ' (
}
ËË 
}
ÈÈ 
catch
ÍÍ 
(
ÍÍ 
IOException
ÍÍ "
exceptIO
ÍÍ# +
)
ÍÍ+ ,
{
ÎÎ 
IO
ÏÏ 
.
ÏÏ 
Logger
ÏÏ 
.
ÏÏ 
Log
ÏÏ !
(
ÏÏ! "
NLog
ÏÏ" &
.
ÏÏ& '
LogLevel
ÏÏ' /
.
ÏÏ/ 0
Warn
ÏÏ0 4
,
ÏÏ4 5
exceptIO
ÏÏ6 >
,
ÏÏ> ?
$str
ÏÏ@ W
)
ÏÏW X
;
ÏÏX Y
}
ÌÌ 
}
ÔÔ 
}
 	
}
ÒÒ 
public
ÛÛ 

override
ÛÛ 
void
ÛÛ 
Good
ÛÛ 
(
ÛÛ 
)
ÛÛ 
{
ÙÙ 
Good1
ıı 
(
ıı 
)
ıı 
;
ıı 
Good2
ˆˆ 
(
ˆˆ 
)
ˆˆ 
;
ˆˆ 
}
˜˜ 
}˘˘ 
}˙˙ ⁄ã
ñC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__hostname_based_logic_14.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 4
(CWE510_Trapdoor__hostname_based_logic_14 .
:/ 0
AbstractTestCase1 A
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
IO 
. 

staticFive 
== 
$num 
) 
{   	
TcpListener!! 
listener!!  
=!!! "
null!!# '
;!!' (
	TcpClient"" 
tcpConn"" 
="" 
null""  $
;""$ %
Stream## 
streamOutput## 
=##  !
null##" &
;##& '
int$$ 
port$$ 
=$$ 
$num$$ 
;$$ 
try%% 
{&& 
listener'' 
='' 
new'' 
TcpListener'' *
(''* +
	IPAddress''+ 4
.''4 5
Parse''5 :
('': ;
$str''; G
)''G H
,''H I
port''J N
)''N O
;''O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
tcpConn)) 
=)) 
listener)) "
.))" #
AcceptTcpClient))# 2
())2 3
)))3 4
;))4 5

IPEndPoint++ 
endPoint++ #
=++$ %
(++& '

IPEndPoint++' 1
)++1 2
tcpConn++2 9
.++9 :
Client++: @
.++@ A
RemoteEndPoint++A O
;++O P
	IPAddress,, 
	ipAddress,, #
=,,$ %
endPoint,,& .
.,,. /
Address,,/ 6
;,,6 7
IPHostEntry-- 
	hostEntry-- %
=--& '
Dns--( +
.--+ ,
GetHostEntry--, 8
(--8 9
	ipAddress--9 B
)--B C
;--C D
if.. 
(.. 
	hostEntry.. 
... 
HostName.. &
...& '
Equals..' -
(..- .
$str... @
)..@ A
)..A B
{// 
streamOutput00  
=00! "
tcpConn00# *
.00* +
	GetStream00+ 4
(004 5
)005 6
;006 7
streamOutput11  
.11  !
Write11! &
(11& '
Encoding11' /
.11/ 0
UTF8110 4
.114 5
GetBytes115 =
(11= >
$str11> O
)11O P
,11P Q
$num11R S
,11S T
$str11U f
.11f g
Length11g m
)11m n
;11n o
}22 
else33 
{44 
streamOutput55  
=55! "
tcpConn55# *
.55* +
	GetStream55+ 4
(554 5
)555 6
;556 7
streamOutput66  
.66  !
Write66! &
(66& '
Encoding66' /
.66/ 0
UTF8660 4
.664 5
GetBytes665 =
(66= >
$str66> N
)66N O
,66O P
$num66Q R
,66R S
$str66T d
.66d e
Length66e k
)66k l
;66l m
}77 
}88 
catch99 
(99 
IOException99 
exceptIO99 '
)99' (
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; 
(;; 
NLog;; "
.;;" #
LogLevel;;# +
.;;+ ,
Warn;;, 0
,;;0 1
exceptIO;;2 :
,;;: ;
$str;;< X
+;;Y Z
port;;[ _
.;;_ `
ToString;;` h
(;;h i
);;i j
);;j k
;;;k l
}<< 
finally== 
{>> 
try?? 
{@@ 
ifAA 
(AA 
streamOutputAA $
!=AA% '
nullAA( ,
)AA, -
{BB 
streamOutputCC $
.CC$ %
CloseCC% *
(CC* +
)CC+ ,
;CC, -
}DD 
}EE 
catchFF 
(FF 
IOExceptionFF "
exceptIOFF# +
)FF+ ,
{GG 
IOHH 
.HH 
LoggerHH 
.HH 
LogHH !
(HH! "
NLogHH" &
.HH& '
LogLevelHH' /
.HH/ 0
WarnHH0 4
,HH4 5
exceptIOHH6 >
,HH> ?
$strHH@ W
)HHW X
;HHX Y
}II 
tryKK 
{LL 
ifMM 
(MM 
tcpConnMM 
!=MM  "
nullMM# '
)MM' (
{NN 
tcpConnOO 
.OO  
CloseOO  %
(OO% &
)OO& '
;OO' (
}PP 
}QQ 
catchRR 
(RR 
IOExceptionRR "
exceptIORR# +
)RR+ ,
{SS 
IOTT 
.TT 
LoggerTT 
.TT 
LogTT !
(TT! "
NLogTT" &
.TT& '
LogLevelTT' /
.TT/ 0
WarnTT0 4
,TT4 5
exceptIOTT6 >
,TT> ?
$strTT@ W
)TTW X
;TTX Y
}UU 
tryWW 
{XX 
ifYY 
(YY 
listenerYY  
!=YY! #
nullYY$ (
)YY( )
{ZZ 
listener[[  
.[[  !
Stop[[! %
([[% &
)[[& '
;[[' (
}\\ 
}]] 
catch^^ 
(^^ 
IOException^^ "
exceptIO^^# +
)^^+ ,
{__ 
IO`` 
.`` 
Logger`` 
.`` 
Log`` !
(``! "
NLog``" &
.``& '
LogLevel``' /
.``/ 0
Warn``0 4
,``4 5
exceptIO``6 >
,``> ?
$str``@ W
)``W X
;``X Y
}aa 
}cc 
}dd 	
}ee 
privateii 
voidii 
Good1ii 
(ii 
)ii 
{jj 
ifkk 

(kk 
IOkk 
.kk 

staticFivekk 
!=kk 
$numkk 
)kk 
{ll 	
IOnn 
.nn 
	WriteLinenn 
(nn 
$strnn /
)nn/ 0
;nn0 1
}oo 	
elsepp 
{qq 	
TcpListenerrr 
listenerrr  
=rr! "
nullrr# '
;rr' (
	TcpClientss 
tcpConnss 
=ss 
nullss  $
;ss$ %
Streamtt 
streamOutputtt 
=tt  !
nulltt" &
;tt& '
intuu 
portuu 
=uu 
$numuu 
;uu 
tryvv 
{ww 
listenerxx 
=xx 
newxx 
TcpListenerxx *
(xx* +
	IPAddressxx+ 4
.xx4 5
Parsexx5 :
(xx: ;
$strxx; G
)xxG H
,xxH I
portxxJ N
)xxN O
;xxO P
listeneryy 
.yy 
Startyy 
(yy 
)yy  
;yy  !
tcpConnzz 
=zz 
listenerzz "
.zz" #
AcceptTcpClientzz# 2
(zz2 3
)zz3 4
;zz4 5
streamOutput{{ 
={{ 
tcpConn{{ &
.{{& '
	GetStream{{' 0
({{0 1
){{1 2
;{{2 3

IPEndPoint|| 
endPoint|| #
=||$ %
(||& '

IPEndPoint||' 1
)||1 2
tcpConn||2 9
.||9 :
Client||: @
.||@ A
RemoteEndPoint||A O
;||O P
	IPAddress}} 
	ipAddress}} #
=}}$ %
endPoint}}& .
.}}. /
Address}}/ 6
;}}6 7
IPHostEntry~~ 
	hostEntry~~ %
=~~& '
Dns~~( +
.~~+ ,
GetHostEntry~~, 8
(~~8 9
	ipAddress~~9 B
)~~B C
;~~C D
streamOutput
ÄÄ 
.
ÄÄ 
Write
ÄÄ "
(
ÄÄ" #
Encoding
ÄÄ# +
.
ÄÄ+ ,
UTF8
ÄÄ, 0
.
ÄÄ0 1
GetBytes
ÄÄ1 9
(
ÄÄ9 :
(
ÄÄ: ;
$str
ÄÄ; F
+
ÄÄG H
	hostEntry
ÄÄI R
.
ÄÄR S
ToString
ÄÄS [
(
ÄÄ[ \
)
ÄÄ\ ]
)
ÄÄ] ^
)
ÄÄ^ _
,
ÄÄ_ `
$num
ÄÄa b
,
ÄÄb c
(
ÄÄd e
$str
ÄÄe p
+
ÄÄq r
	hostEntry
ÄÄs |
.
ÄÄ| }
ToStringÄÄ} Ö
(ÄÄÖ Ü
)ÄÄÜ á
)ÄÄá à
.ÄÄà â
LengthÄÄâ è
)ÄÄè ê
;ÄÄê ë
}
ÅÅ 
catch
ÇÇ 
(
ÇÇ 
IOException
ÇÇ 
exceptIO
ÇÇ '
)
ÇÇ' (
{
ÉÉ 
IO
ÑÑ 
.
ÑÑ 
Logger
ÑÑ 
.
ÑÑ 
Log
ÑÑ 
(
ÑÑ 
NLog
ÑÑ "
.
ÑÑ" #
LogLevel
ÑÑ# +
.
ÑÑ+ ,
Warn
ÑÑ, 0
,
ÑÑ0 1
exceptIO
ÑÑ2 :
,
ÑÑ: ;
$str
ÑÑ< X
+
ÑÑY Z
port
ÑÑ[ _
.
ÑÑ_ `
ToString
ÑÑ` h
(
ÑÑh i
)
ÑÑi j
)
ÑÑj k
;
ÑÑk l
}
ÖÖ 
finally
ÜÜ 
{
áá 
try
àà 
{
ââ 
if
ää 
(
ää 
streamOutput
ää $
!=
ää% '
null
ää( ,
)
ää, -
{
ãã 
streamOutput
åå $
.
åå$ %
Close
åå% *
(
åå* +
)
åå+ ,
;
åå, -
}
çç 
}
éé 
catch
èè 
(
èè 
IOException
èè "
exceptIO
èè# +
)
èè+ ,
{
êê 
IO
ëë 
.
ëë 
Logger
ëë 
.
ëë 
Log
ëë !
(
ëë! "
NLog
ëë" &
.
ëë& '
LogLevel
ëë' /
.
ëë/ 0
Warn
ëë0 4
,
ëë4 5
exceptIO
ëë6 >
,
ëë> ?
$str
ëë@ W
)
ëëW X
;
ëëX Y
}
íí 
try
îî 
{
ïï 
if
ññ 
(
ññ 
tcpConn
ññ 
!=
ññ  "
null
ññ# '
)
ññ' (
{
óó 
tcpConn
òò 
.
òò  
Close
òò  %
(
òò% &
)
òò& '
;
òò' (
}
ôô 
}
öö 
catch
õõ 
(
õõ 
IOException
õõ "
exceptIO
õõ# +
)
õõ+ ,
{
úú 
IO
ùù 
.
ùù 
Logger
ùù 
.
ùù 
Log
ùù !
(
ùù! "
NLog
ùù" &
.
ùù& '
LogLevel
ùù' /
.
ùù/ 0
Warn
ùù0 4
,
ùù4 5
exceptIO
ùù6 >
,
ùù> ?
$str
ùù@ W
)
ùùW X
;
ùùX Y
}
ûû 
try
†† 
{
°° 
if
¢¢ 
(
¢¢ 
listener
¢¢  
!=
¢¢! #
null
¢¢$ (
)
¢¢( )
{
££ 
listener
§§  
.
§§  !
Stop
§§! %
(
§§% &
)
§§& '
;
§§' (
}
•• 
}
¶¶ 
catch
ßß 
(
ßß 
IOException
ßß "
exceptIO
ßß# +
)
ßß+ ,
{
®® 
IO
©© 
.
©© 
Logger
©© 
.
©© 
Log
©© !
(
©©! "
NLog
©©" &
.
©©& '
LogLevel
©©' /
.
©©/ 0
Warn
©©0 4
,
©©4 5
exceptIO
©©6 >
,
©©> ?
$str
©©@ W
)
©©W X
;
©©X Y
}
™™ 
}
¨¨ 
}
≠≠ 	
}
ÆÆ 
private
±± 
void
±± 
Good2
±± 
(
±± 
)
±± 
{
≤≤ 
if
≥≥ 

(
≥≥ 
IO
≥≥ 
.
≥≥ 

staticFive
≥≥ 
==
≥≥ 
$num
≥≥ 
)
≥≥ 
{
¥¥ 	
TcpListener
µµ 
listener
µµ  
=
µµ! "
null
µµ# '
;
µµ' (
	TcpClient
∂∂ 
tcpConn
∂∂ 
=
∂∂ 
null
∂∂  $
;
∂∂$ %
Stream
∑∑ 
streamOutput
∑∑ 
=
∑∑  !
null
∑∑" &
;
∑∑& '
int
∏∏ 
port
∏∏ 
=
∏∏ 
$num
∏∏ 
;
∏∏ 
try
ππ 
{
∫∫ 
listener
ªª 
=
ªª 
new
ªª 
TcpListener
ªª *
(
ªª* +
	IPAddress
ªª+ 4
.
ªª4 5
Parse
ªª5 :
(
ªª: ;
$str
ªª; G
)
ªªG H
,
ªªH I
port
ªªJ N
)
ªªN O
;
ªªO P
listener
ºº 
.
ºº 
Start
ºº 
(
ºº 
)
ºº  
;
ºº  !
tcpConn
ΩΩ 
=
ΩΩ 
listener
ΩΩ "
.
ΩΩ" #
AcceptTcpClient
ΩΩ# 2
(
ΩΩ2 3
)
ΩΩ3 4
;
ΩΩ4 5
streamOutput
ææ 
=
ææ 
tcpConn
ææ &
.
ææ& '
	GetStream
ææ' 0
(
ææ0 1
)
ææ1 2
;
ææ2 3

IPEndPoint
øø 
endPoint
øø #
=
øø$ %
(
øø& '

IPEndPoint
øø' 1
)
øø1 2
tcpConn
øø2 9
.
øø9 :
Client
øø: @
.
øø@ A
RemoteEndPoint
øøA O
;
øøO P
	IPAddress
¿¿ 
	ipAddress
¿¿ #
=
¿¿$ %
endPoint
¿¿& .
.
¿¿. /
Address
¿¿/ 6
;
¿¿6 7
IPHostEntry
¡¡ 
	hostEntry
¡¡ %
=
¡¡& '
Dns
¡¡( +
.
¡¡+ ,
GetHostEntry
¡¡, 8
(
¡¡8 9
	ipAddress
¡¡9 B
)
¡¡B C
;
¡¡C D
streamOutput
√√ 
.
√√ 
Write
√√ "
(
√√" #
Encoding
√√# +
.
√√+ ,
UTF8
√√, 0
.
√√0 1
GetBytes
√√1 9
(
√√9 :
(
√√: ;
$str
√√; F
+
√√G H
	hostEntry
√√I R
.
√√R S
ToString
√√S [
(
√√[ \
)
√√\ ]
)
√√] ^
)
√√^ _
,
√√_ `
$num
√√a b
,
√√b c
(
√√d e
$str
√√e p
+
√√q r
	hostEntry
√√s |
.
√√| }
ToString√√} Ö
(√√Ö Ü
)√√Ü á
)√√á à
.√√à â
Length√√â è
)√√è ê
;√√ê ë
}
ƒƒ 
catch
≈≈ 
(
≈≈ 
IOException
≈≈ 
exceptIO
≈≈ '
)
≈≈' (
{
∆∆ 
IO
«« 
.
«« 
Logger
«« 
.
«« 
Log
«« 
(
«« 
NLog
«« "
.
««" #
LogLevel
««# +
.
««+ ,
Warn
««, 0
,
««0 1
exceptIO
««2 :
,
««: ;
$str
««< X
+
««Y Z
port
««[ _
.
««_ `
ToString
««` h
(
««h i
)
««i j
)
««j k
;
««k l
}
»» 
finally
…… 
{
   
try
ÀÀ 
{
ÃÃ 
if
ÕÕ 
(
ÕÕ 
streamOutput
ÕÕ $
!=
ÕÕ% '
null
ÕÕ( ,
)
ÕÕ, -
{
ŒŒ 
streamOutput
œœ $
.
œœ$ %
Close
œœ% *
(
œœ* +
)
œœ+ ,
;
œœ, -
}
–– 
}
—— 
catch
““ 
(
““ 
IOException
““ "
exceptIO
““# +
)
““+ ,
{
”” 
IO
‘‘ 
.
‘‘ 
Logger
‘‘ 
.
‘‘ 
Log
‘‘ !
(
‘‘! "
NLog
‘‘" &
.
‘‘& '
LogLevel
‘‘' /
.
‘‘/ 0
Warn
‘‘0 4
,
‘‘4 5
exceptIO
‘‘6 >
,
‘‘> ?
$str
‘‘@ W
)
‘‘W X
;
‘‘X Y
}
’’ 
try
◊◊ 
{
ÿÿ 
if
ŸŸ 
(
ŸŸ 
tcpConn
ŸŸ 
!=
ŸŸ  "
null
ŸŸ# '
)
ŸŸ' (
{
⁄⁄ 
tcpConn
€€ 
.
€€  
Close
€€  %
(
€€% &
)
€€& '
;
€€' (
}
‹‹ 
}
›› 
catch
ﬁﬁ 
(
ﬁﬁ 
IOException
ﬁﬁ "
exceptIO
ﬁﬁ# +
)
ﬁﬁ+ ,
{
ﬂﬂ 
IO
‡‡ 
.
‡‡ 
Logger
‡‡ 
.
‡‡ 
Log
‡‡ !
(
‡‡! "
NLog
‡‡" &
.
‡‡& '
LogLevel
‡‡' /
.
‡‡/ 0
Warn
‡‡0 4
,
‡‡4 5
exceptIO
‡‡6 >
,
‡‡> ?
$str
‡‡@ W
)
‡‡W X
;
‡‡X Y
}
·· 
try
„„ 
{
‰‰ 
if
ÂÂ 
(
ÂÂ 
listener
ÂÂ  
!=
ÂÂ! #
null
ÂÂ$ (
)
ÂÂ( )
{
ÊÊ 
listener
ÁÁ  
.
ÁÁ  !
Stop
ÁÁ! %
(
ÁÁ% &
)
ÁÁ& '
;
ÁÁ' (
}
ËË 
}
ÈÈ 
catch
ÍÍ 
(
ÍÍ 
IOException
ÍÍ "
exceptIO
ÍÍ# +
)
ÍÍ+ ,
{
ÎÎ 
IO
ÏÏ 
.
ÏÏ 
Logger
ÏÏ 
.
ÏÏ 
Log
ÏÏ !
(
ÏÏ! "
NLog
ÏÏ" &
.
ÏÏ& '
LogLevel
ÏÏ' /
.
ÏÏ/ 0
Warn
ÏÏ0 4
,
ÏÏ4 5
exceptIO
ÏÏ6 >
,
ÏÏ> ?
$str
ÏÏ@ W
)
ÏÏW X
;
ÏÏX Y
}
ÌÌ 
}
ÔÔ 
}
 	
}
ÒÒ 
public
ÛÛ 

override
ÛÛ 
void
ÛÛ 
Good
ÛÛ 
(
ÛÛ 
)
ÛÛ 
{
ÙÙ 
Good1
ıı 
(
ıı 
)
ıı 
;
ıı 
Good2
ˆˆ 
(
ˆˆ 
)
ˆˆ 
;
ˆˆ 
}
˜˜ 
}˘˘ 
}˙˙ íê
ñC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__hostname_based_logic_15.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 4
(CWE510_Trapdoor__hostname_based_logic_15 .
:/ 0
AbstractTestCase1 A
{ 
public 

override 
void 
Bad 
( 
) 
{ 
switch 
( 
$num 
) 
{   	
case!! 
$num!! 
:!! 
TcpListener"" 
listener""  
=""! "
null""# '
;""' (
	TcpClient## 
tcpConn## 
=## 
null##  $
;##$ %
Stream$$ 
streamOutput$$ 
=$$  !
null$$" &
;$$& '
int%% 
port%% 
=%% 
$num%% 
;%% 
try&& 
{'' 
listener(( 
=(( 
new(( 
TcpListener(( *
(((* +
	IPAddress((+ 4
.((4 5
Parse((5 :
(((: ;
$str((; G
)((G H
,((H I
port((J N
)((N O
;((O P
listener)) 
.)) 
Start)) 
()) 
)))  
;))  !
tcpConn** 
=** 
listener** "
.**" #
AcceptTcpClient**# 2
(**2 3
)**3 4
;**4 5

IPEndPoint,, 
endPoint,, #
=,,$ %
(,,& '

IPEndPoint,,' 1
),,1 2
tcpConn,,2 9
.,,9 :
Client,,: @
.,,@ A
RemoteEndPoint,,A O
;,,O P
	IPAddress-- 
	ipAddress-- #
=--$ %
endPoint--& .
.--. /
Address--/ 6
;--6 7
IPHostEntry.. 
	hostEntry.. %
=..& '
Dns..( +
...+ ,
GetHostEntry.., 8
(..8 9
	ipAddress..9 B
)..B C
;..C D
if// 
(// 
	hostEntry// 
.// 
HostName// &
.//& '
Equals//' -
(//- .
$str//. @
)//@ A
)//A B
{00 
streamOutput11  
=11! "
tcpConn11# *
.11* +
	GetStream11+ 4
(114 5
)115 6
;116 7
streamOutput22  
.22  !
Write22! &
(22& '
Encoding22' /
.22/ 0
UTF8220 4
.224 5
GetBytes225 =
(22= >
$str22> O
)22O P
,22P Q
$num22R S
,22S T
$str22U f
.22f g
Length22g m
)22m n
;22n o
}33 
else44 
{55 
streamOutput66  
=66! "
tcpConn66# *
.66* +
	GetStream66+ 4
(664 5
)665 6
;666 7
streamOutput77  
.77  !
Write77! &
(77& '
Encoding77' /
.77/ 0
UTF8770 4
.774 5
GetBytes775 =
(77= >
$str77> N
)77N O
,77O P
$num77Q R
,77R S
$str77T d
.77d e
Length77e k
)77k l
;77l m
}88 
}99 
catch:: 
(:: 
IOException:: 
exceptIO:: '
)::' (
{;; 
IO<< 
.<< 
Logger<< 
.<< 
Log<< 
(<< 
NLog<< "
.<<" #
LogLevel<<# +
.<<+ ,
Warn<<, 0
,<<0 1
exceptIO<<2 :
,<<: ;
$str<<< X
+<<Y Z
port<<[ _
.<<_ `
ToString<<` h
(<<h i
)<<i j
)<<j k
;<<k l
}== 
finally>> 
{?? 
try@@ 
{AA 
ifBB 
(BB 
streamOutputBB $
!=BB% '
nullBB( ,
)BB, -
{CC 
streamOutputDD $
.DD$ %
CloseDD% *
(DD* +
)DD+ ,
;DD, -
}EE 
}FF 
catchGG 
(GG 
IOExceptionGG "
exceptIOGG# +
)GG+ ,
{HH 
IOII 
.II 
LoggerII 
.II 
LogII !
(II! "
NLogII" &
.II& '
LogLevelII' /
.II/ 0
WarnII0 4
,II4 5
exceptIOII6 >
,II> ?
$strII@ W
)IIW X
;IIX Y
}JJ 
tryLL 
{MM 
ifNN 
(NN 
tcpConnNN 
!=NN  "
nullNN# '
)NN' (
{OO 
tcpConnPP 
.PP  
ClosePP  %
(PP% &
)PP& '
;PP' (
}QQ 
}RR 
catchSS 
(SS 
IOExceptionSS "
exceptIOSS# +
)SS+ ,
{TT 
IOUU 
.UU 
LoggerUU 
.UU 
LogUU !
(UU! "
NLogUU" &
.UU& '
LogLevelUU' /
.UU/ 0
WarnUU0 4
,UU4 5
exceptIOUU6 >
,UU> ?
$strUU@ W
)UUW X
;UUX Y
}VV 
tryXX 
{YY 
ifZZ 
(ZZ 
listenerZZ  
!=ZZ! #
nullZZ$ (
)ZZ( )
{[[ 
listener\\  
.\\  !
Stop\\! %
(\\% &
)\\& '
;\\' (
}]] 
}^^ 
catch__ 
(__ 
IOException__ "
exceptIO__# +
)__+ ,
{`` 
IOaa 
.aa 
Loggeraa 
.aa 
Logaa !
(aa! "
NLogaa" &
.aa& '
LogLevelaa' /
.aa/ 0
Warnaa0 4
,aa4 5
exceptIOaa6 >
,aa> ?
$straa@ W
)aaW X
;aaX Y
}bb 
}dd 
breakee 
;ee 
defaultff 
:ff 
IOhh 
.hh 
	WriteLinehh 
(hh 
$strhh /
)hh/ 0
;hh0 1
breakii 
;ii 
}jj 	
}kk 
privateoo 
voidoo 
Good1oo 
(oo 
)oo 
{pp 
switchqq 
(qq 
$numqq 
)qq 
{rr 	
casess 
$numss 
:ss 
IOuu 
.uu 
	WriteLineuu 
(uu 
$struu /
)uu/ 0
;uu0 1
breakvv 
;vv 
defaultww 
:ww 
TcpListenerxx 
listenerxx  
=xx! "
nullxx# '
;xx' (
	TcpClientyy 
tcpConnyy 
=yy 
nullyy  $
;yy$ %
Streamzz 
streamOutputzz 
=zz  !
nullzz" &
;zz& '
int{{ 
port{{ 
={{ 
$num{{ 
;{{ 
try|| 
{}} 
listener~~ 
=~~ 
new~~ 
TcpListener~~ *
(~~* +
	IPAddress~~+ 4
.~~4 5
Parse~~5 :
(~~: ;
$str~~; G
)~~G H
,~~H I
port~~J N
)~~N O
;~~O P
listener 
. 
Start 
( 
)  
;  !
tcpConn
ÄÄ 
=
ÄÄ 
listener
ÄÄ "
.
ÄÄ" #
AcceptTcpClient
ÄÄ# 2
(
ÄÄ2 3
)
ÄÄ3 4
;
ÄÄ4 5
streamOutput
ÅÅ 
=
ÅÅ 
tcpConn
ÅÅ &
.
ÅÅ& '
	GetStream
ÅÅ' 0
(
ÅÅ0 1
)
ÅÅ1 2
;
ÅÅ2 3

IPEndPoint
ÇÇ 
endPoint
ÇÇ #
=
ÇÇ$ %
(
ÇÇ& '

IPEndPoint
ÇÇ' 1
)
ÇÇ1 2
tcpConn
ÇÇ2 9
.
ÇÇ9 :
Client
ÇÇ: @
.
ÇÇ@ A
RemoteEndPoint
ÇÇA O
;
ÇÇO P
	IPAddress
ÉÉ 
	ipAddress
ÉÉ #
=
ÉÉ$ %
endPoint
ÉÉ& .
.
ÉÉ. /
Address
ÉÉ/ 6
;
ÉÉ6 7
IPHostEntry
ÑÑ 
	hostEntry
ÑÑ %
=
ÑÑ& '
Dns
ÑÑ( +
.
ÑÑ+ ,
GetHostEntry
ÑÑ, 8
(
ÑÑ8 9
	ipAddress
ÑÑ9 B
)
ÑÑB C
;
ÑÑC D
streamOutput
ÜÜ 
.
ÜÜ 
Write
ÜÜ "
(
ÜÜ" #
Encoding
ÜÜ# +
.
ÜÜ+ ,
UTF8
ÜÜ, 0
.
ÜÜ0 1
GetBytes
ÜÜ1 9
(
ÜÜ9 :
(
ÜÜ: ;
$str
ÜÜ; F
+
ÜÜG H
	hostEntry
ÜÜI R
.
ÜÜR S
ToString
ÜÜS [
(
ÜÜ[ \
)
ÜÜ\ ]
)
ÜÜ] ^
)
ÜÜ^ _
,
ÜÜ_ `
$num
ÜÜa b
,
ÜÜb c
(
ÜÜd e
$str
ÜÜe p
+
ÜÜq r
	hostEntry
ÜÜs |
.
ÜÜ| }
ToStringÜÜ} Ö
(ÜÜÖ Ü
)ÜÜÜ á
)ÜÜá à
.ÜÜà â
LengthÜÜâ è
)ÜÜè ê
;ÜÜê ë
}
áá 
catch
àà 
(
àà 
IOException
àà 
exceptIO
àà '
)
àà' (
{
ââ 
IO
ää 
.
ää 
Logger
ää 
.
ää 
Log
ää 
(
ää 
NLog
ää "
.
ää" #
LogLevel
ää# +
.
ää+ ,
Warn
ää, 0
,
ää0 1
exceptIO
ää2 :
,
ää: ;
$str
ää< X
+
ääY Z
port
ää[ _
.
ää_ `
ToString
ää` h
(
ääh i
)
ääi j
)
ääj k
;
ääk l
}
ãã 
finally
åå 
{
çç 
try
éé 
{
èè 
if
êê 
(
êê 
streamOutput
êê $
!=
êê% '
null
êê( ,
)
êê, -
{
ëë 
streamOutput
íí $
.
íí$ %
Close
íí% *
(
íí* +
)
íí+ ,
;
íí, -
}
ìì 
}
îî 
catch
ïï 
(
ïï 
IOException
ïï "
exceptIO
ïï# +
)
ïï+ ,
{
ññ 
IO
óó 
.
óó 
Logger
óó 
.
óó 
Log
óó !
(
óó! "
NLog
óó" &
.
óó& '
LogLevel
óó' /
.
óó/ 0
Warn
óó0 4
,
óó4 5
exceptIO
óó6 >
,
óó> ?
$str
óó@ W
)
óóW X
;
óóX Y
}
òò 
try
öö 
{
õõ 
if
úú 
(
úú 
tcpConn
úú 
!=
úú  "
null
úú# '
)
úú' (
{
ùù 
tcpConn
ûû 
.
ûû  
Close
ûû  %
(
ûû% &
)
ûû& '
;
ûû' (
}
üü 
}
†† 
catch
°° 
(
°° 
IOException
°° "
exceptIO
°°# +
)
°°+ ,
{
¢¢ 
IO
££ 
.
££ 
Logger
££ 
.
££ 
Log
££ !
(
££! "
NLog
££" &
.
££& '
LogLevel
££' /
.
££/ 0
Warn
££0 4
,
££4 5
exceptIO
££6 >
,
££> ?
$str
££@ W
)
££W X
;
££X Y
}
§§ 
try
¶¶ 
{
ßß 
if
®® 
(
®® 
listener
®®  
!=
®®! #
null
®®$ (
)
®®( )
{
©© 
listener
™™  
.
™™  !
Stop
™™! %
(
™™% &
)
™™& '
;
™™' (
}
´´ 
}
¨¨ 
catch
≠≠ 
(
≠≠ 
IOException
≠≠ "
exceptIO
≠≠# +
)
≠≠+ ,
{
ÆÆ 
IO
ØØ 
.
ØØ 
Logger
ØØ 
.
ØØ 
Log
ØØ !
(
ØØ! "
NLog
ØØ" &
.
ØØ& '
LogLevel
ØØ' /
.
ØØ/ 0
Warn
ØØ0 4
,
ØØ4 5
exceptIO
ØØ6 >
,
ØØ> ?
$str
ØØ@ W
)
ØØW X
;
ØØX Y
}
∞∞ 
}
≤≤ 
break
≥≥ 
;
≥≥ 
}
¥¥ 	
}
µµ 
private
∏∏ 
void
∏∏ 
Good2
∏∏ 
(
∏∏ 
)
∏∏ 
{
ππ 
switch
∫∫ 
(
∫∫ 
$num
∫∫ 
)
∫∫ 
{
ªª 	
case
ºº 
$num
ºº 
:
ºº 
TcpListener
ΩΩ 
listener
ΩΩ  
=
ΩΩ! "
null
ΩΩ# '
;
ΩΩ' (
	TcpClient
ææ 
tcpConn
ææ 
=
ææ 
null
ææ  $
;
ææ$ %
Stream
øø 
streamOutput
øø 
=
øø  !
null
øø" &
;
øø& '
int
¿¿ 
port
¿¿ 
=
¿¿ 
$num
¿¿ 
;
¿¿ 
try
¡¡ 
{
¬¬ 
listener
√√ 
=
√√ 
new
√√ 
TcpListener
√√ *
(
√√* +
	IPAddress
√√+ 4
.
√√4 5
Parse
√√5 :
(
√√: ;
$str
√√; G
)
√√G H
,
√√H I
port
√√J N
)
√√N O
;
√√O P
listener
ƒƒ 
.
ƒƒ 
Start
ƒƒ 
(
ƒƒ 
)
ƒƒ  
;
ƒƒ  !
tcpConn
≈≈ 
=
≈≈ 
listener
≈≈ "
.
≈≈" #
AcceptTcpClient
≈≈# 2
(
≈≈2 3
)
≈≈3 4
;
≈≈4 5
streamOutput
∆∆ 
=
∆∆ 
tcpConn
∆∆ &
.
∆∆& '
	GetStream
∆∆' 0
(
∆∆0 1
)
∆∆1 2
;
∆∆2 3

IPEndPoint
«« 
endPoint
«« #
=
««$ %
(
««& '

IPEndPoint
««' 1
)
««1 2
tcpConn
««2 9
.
««9 :
Client
««: @
.
««@ A
RemoteEndPoint
««A O
;
««O P
	IPAddress
»» 
	ipAddress
»» #
=
»»$ %
endPoint
»»& .
.
»». /
Address
»»/ 6
;
»»6 7
IPHostEntry
…… 
	hostEntry
…… %
=
……& '
Dns
……( +
.
……+ ,
GetHostEntry
……, 8
(
……8 9
	ipAddress
……9 B
)
……B C
;
……C D
streamOutput
ÀÀ 
.
ÀÀ 
Write
ÀÀ "
(
ÀÀ" #
Encoding
ÀÀ# +
.
ÀÀ+ ,
UTF8
ÀÀ, 0
.
ÀÀ0 1
GetBytes
ÀÀ1 9
(
ÀÀ9 :
(
ÀÀ: ;
$str
ÀÀ; F
+
ÀÀG H
	hostEntry
ÀÀI R
.
ÀÀR S
ToString
ÀÀS [
(
ÀÀ[ \
)
ÀÀ\ ]
)
ÀÀ] ^
)
ÀÀ^ _
,
ÀÀ_ `
$num
ÀÀa b
,
ÀÀb c
(
ÀÀd e
$str
ÀÀe p
+
ÀÀq r
	hostEntry
ÀÀs |
.
ÀÀ| }
ToStringÀÀ} Ö
(ÀÀÖ Ü
)ÀÀÜ á
)ÀÀá à
.ÀÀà â
LengthÀÀâ è
)ÀÀè ê
;ÀÀê ë
}
ÃÃ 
catch
ÕÕ 
(
ÕÕ 
IOException
ÕÕ 
exceptIO
ÕÕ '
)
ÕÕ' (
{
ŒŒ 
IO
œœ 
.
œœ 
Logger
œœ 
.
œœ 
Log
œœ 
(
œœ 
NLog
œœ "
.
œœ" #
LogLevel
œœ# +
.
œœ+ ,
Warn
œœ, 0
,
œœ0 1
exceptIO
œœ2 :
,
œœ: ;
$str
œœ< X
+
œœY Z
port
œœ[ _
.
œœ_ `
ToString
œœ` h
(
œœh i
)
œœi j
)
œœj k
;
œœk l
}
–– 
finally
—— 
{
““ 
try
”” 
{
‘‘ 
if
’’ 
(
’’ 
streamOutput
’’ $
!=
’’% '
null
’’( ,
)
’’, -
{
÷÷ 
streamOutput
◊◊ $
.
◊◊$ %
Close
◊◊% *
(
◊◊* +
)
◊◊+ ,
;
◊◊, -
}
ÿÿ 
}
ŸŸ 
catch
⁄⁄ 
(
⁄⁄ 
IOException
⁄⁄ "
exceptIO
⁄⁄# +
)
⁄⁄+ ,
{
€€ 
IO
‹‹ 
.
‹‹ 
Logger
‹‹ 
.
‹‹ 
Log
‹‹ !
(
‹‹! "
NLog
‹‹" &
.
‹‹& '
LogLevel
‹‹' /
.
‹‹/ 0
Warn
‹‹0 4
,
‹‹4 5
exceptIO
‹‹6 >
,
‹‹> ?
$str
‹‹@ W
)
‹‹W X
;
‹‹X Y
}
›› 
try
ﬂﬂ 
{
‡‡ 
if
·· 
(
·· 
tcpConn
·· 
!=
··  "
null
··# '
)
··' (
{
‚‚ 
tcpConn
„„ 
.
„„  
Close
„„  %
(
„„% &
)
„„& '
;
„„' (
}
‰‰ 
}
ÂÂ 
catch
ÊÊ 
(
ÊÊ 
IOException
ÊÊ "
exceptIO
ÊÊ# +
)
ÊÊ+ ,
{
ÁÁ 
IO
ËË 
.
ËË 
Logger
ËË 
.
ËË 
Log
ËË !
(
ËË! "
NLog
ËË" &
.
ËË& '
LogLevel
ËË' /
.
ËË/ 0
Warn
ËË0 4
,
ËË4 5
exceptIO
ËË6 >
,
ËË> ?
$str
ËË@ W
)
ËËW X
;
ËËX Y
}
ÈÈ 
try
ÎÎ 
{
ÏÏ 
if
ÌÌ 
(
ÌÌ 
listener
ÌÌ  
!=
ÌÌ! #
null
ÌÌ$ (
)
ÌÌ( )
{
ÓÓ 
listener
ÔÔ  
.
ÔÔ  !
Stop
ÔÔ! %
(
ÔÔ% &
)
ÔÔ& '
;
ÔÔ' (
}
 
}
ÒÒ 
catch
ÚÚ 
(
ÚÚ 
IOException
ÚÚ "
exceptIO
ÚÚ# +
)
ÚÚ+ ,
{
ÛÛ 
IO
ÙÙ 
.
ÙÙ 
Logger
ÙÙ 
.
ÙÙ 
Log
ÙÙ !
(
ÙÙ! "
NLog
ÙÙ" &
.
ÙÙ& '
LogLevel
ÙÙ' /
.
ÙÙ/ 0
Warn
ÙÙ0 4
,
ÙÙ4 5
exceptIO
ÙÙ6 >
,
ÙÙ> ?
$str
ÙÙ@ W
)
ÙÙW X
;
ÙÙX Y
}
ıı 
}
˜˜ 
break
¯¯ 
;
¯¯ 
default
˘˘ 
:
˘˘ 
IO
˚˚ 
.
˚˚ 
	WriteLine
˚˚ 
(
˚˚ 
$str
˚˚ /
)
˚˚/ 0
;
˚˚0 1
break
¸¸ 
;
¸¸ 
}
˝˝ 	
}
˛˛ 
public
ÄÄ 

override
ÄÄ 
void
ÄÄ 
Good
ÄÄ 
(
ÄÄ 
)
ÄÄ 
{
ÅÅ 
Good1
ÇÇ 
(
ÇÇ 
)
ÇÇ 
;
ÇÇ 
Good2
ÉÉ 
(
ÉÉ 
)
ÉÉ 
;
ÉÉ 
}
ÑÑ 
}ÜÜ 
}áá À[
ñC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__hostname_based_logic_16.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 4
(CWE510_Trapdoor__hostname_based_logic_16 .
:/ 0
AbstractTestCase1 A
{ 
public 

override 
void 
Bad 
( 
) 
{ 
while 
( 
true 
) 
{   	
TcpListener!! 
listener!!  
=!!! "
null!!# '
;!!' (
	TcpClient"" 
tcpConn"" 
="" 
null""  $
;""$ %
Stream## 
streamOutput## 
=##  !
null##" &
;##& '
int$$ 
port$$ 
=$$ 
$num$$ 
;$$ 
try%% 
{&& 
listener'' 
='' 
new'' 
TcpListener'' *
(''* +
	IPAddress''+ 4
.''4 5
Parse''5 :
('': ;
$str''; G
)''G H
,''H I
port''J N
)''N O
;''O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
tcpConn)) 
=)) 
listener)) "
.))" #
AcceptTcpClient))# 2
())2 3
)))3 4
;))4 5

IPEndPoint++ 
endPoint++ #
=++$ %
(++& '

IPEndPoint++' 1
)++1 2
tcpConn++2 9
.++9 :
Client++: @
.++@ A
RemoteEndPoint++A O
;++O P
	IPAddress,, 
	ipAddress,, #
=,,$ %
endPoint,,& .
.,,. /
Address,,/ 6
;,,6 7
IPHostEntry-- 
	hostEntry-- %
=--& '
Dns--( +
.--+ ,
GetHostEntry--, 8
(--8 9
	ipAddress--9 B
)--B C
;--C D
if.. 
(.. 
	hostEntry.. 
... 
HostName.. &
...& '
Equals..' -
(..- .
$str... @
)..@ A
)..A B
{// 
streamOutput00  
=00! "
tcpConn00# *
.00* +
	GetStream00+ 4
(004 5
)005 6
;006 7
streamOutput11  
.11  !
Write11! &
(11& '
Encoding11' /
.11/ 0
UTF8110 4
.114 5
GetBytes115 =
(11= >
$str11> O
)11O P
,11P Q
$num11R S
,11S T
$str11U f
.11f g
Length11g m
)11m n
;11n o
}22 
else33 
{44 
streamOutput55  
=55! "
tcpConn55# *
.55* +
	GetStream55+ 4
(554 5
)555 6
;556 7
streamOutput66  
.66  !
Write66! &
(66& '
Encoding66' /
.66/ 0
UTF8660 4
.664 5
GetBytes665 =
(66= >
$str66> N
)66N O
,66O P
$num66Q R
,66R S
$str66T d
.66d e
Length66e k
)66k l
;66l m
}77 
}88 
catch99 
(99 
IOException99 
exceptIO99 '
)99' (
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; 
(;; 
NLog;; "
.;;" #
LogLevel;;# +
.;;+ ,
Warn;;, 0
,;;0 1
exceptIO;;2 :
,;;: ;
$str;;< X
+;;Y Z
port;;[ _
.;;_ `
ToString;;` h
(;;h i
);;i j
);;j k
;;;k l
}<< 
finally== 
{>> 
try?? 
{@@ 
ifAA 
(AA 
streamOutputAA $
!=AA% '
nullAA( ,
)AA, -
{BB 
streamOutputCC $
.CC$ %
CloseCC% *
(CC* +
)CC+ ,
;CC, -
}DD 
}EE 
catchFF 
(FF 
IOExceptionFF "
exceptIOFF# +
)FF+ ,
{GG 
IOHH 
.HH 
LoggerHH 
.HH 
LogHH !
(HH! "
NLogHH" &
.HH& '
LogLevelHH' /
.HH/ 0
WarnHH0 4
,HH4 5
exceptIOHH6 >
,HH> ?
$strHH@ W
)HHW X
;HHX Y
}II 
tryKK 
{LL 
ifMM 
(MM 
tcpConnMM 
!=MM  "
nullMM# '
)MM' (
{NN 
tcpConnOO 
.OO  
CloseOO  %
(OO% &
)OO& '
;OO' (
}PP 
}QQ 
catchRR 
(RR 
IOExceptionRR "
exceptIORR# +
)RR+ ,
{SS 
IOTT 
.TT 
LoggerTT 
.TT 
LogTT !
(TT! "
NLogTT" &
.TT& '
LogLevelTT' /
.TT/ 0
WarnTT0 4
,TT4 5
exceptIOTT6 >
,TT> ?
$strTT@ W
)TTW X
;TTX Y
}UU 
tryWW 
{XX 
ifYY 
(YY 
listenerYY  
!=YY! #
nullYY$ (
)YY( )
{ZZ 
listener[[  
.[[  !
Stop[[! %
([[% &
)[[& '
;[[' (
}\\ 
}]] 
catch^^ 
(^^ 
IOException^^ "
exceptIO^^# +
)^^+ ,
{__ 
IO`` 
.`` 
Logger`` 
.`` 
Log`` !
(``! "
NLog``" &
.``& '
LogLevel``' /
.``/ 0
Warn``0 4
,``4 5
exceptIO``6 >
,``> ?
$str``@ W
)``W X
;``X Y
}aa 
}cc 
breakdd 
;dd 
}ee 	
}ff 
privatejj 
voidjj 
Good1jj 
(jj 
)jj 
{kk 
whilell 
(ll 
truell 
)ll 
{mm 	
TcpListenernn 
listenernn  
=nn! "
nullnn# '
;nn' (
	TcpClientoo 
tcpConnoo 
=oo 
nulloo  $
;oo$ %
Streampp 
streamOutputpp 
=pp  !
nullpp" &
;pp& '
intqq 
portqq 
=qq 
$numqq 
;qq 
tryrr 
{ss 
listenertt 
=tt 
newtt 
TcpListenertt *
(tt* +
	IPAddresstt+ 4
.tt4 5
Parsett5 :
(tt: ;
$strtt; G
)ttG H
,ttH I
portttJ N
)ttN O
;ttO P
listeneruu 
.uu 
Startuu 
(uu 
)uu  
;uu  !
tcpConnvv 
=vv 
listenervv "
.vv" #
AcceptTcpClientvv# 2
(vv2 3
)vv3 4
;vv4 5
streamOutputww 
=ww 
tcpConnww &
.ww& '
	GetStreamww' 0
(ww0 1
)ww1 2
;ww2 3

IPEndPointxx 
endPointxx #
=xx$ %
(xx& '

IPEndPointxx' 1
)xx1 2
tcpConnxx2 9
.xx9 :
Clientxx: @
.xx@ A
RemoteEndPointxxA O
;xxO P
	IPAddressyy 
	ipAddressyy #
=yy$ %
endPointyy& .
.yy. /
Addressyy/ 6
;yy6 7
IPHostEntryzz 
	hostEntryzz %
=zz& '
Dnszz( +
.zz+ ,
GetHostEntryzz, 8
(zz8 9
	ipAddresszz9 B
)zzB C
;zzC D
streamOutput|| 
.|| 
Write|| "
(||" #
Encoding||# +
.||+ ,
UTF8||, 0
.||0 1
GetBytes||1 9
(||9 :
(||: ;
$str||; F
+||G H
	hostEntry||I R
.||R S
ToString||S [
(||[ \
)||\ ]
)||] ^
)||^ _
,||_ `
$num||a b
,||b c
(||d e
$str||e p
+||q r
	hostEntry||s |
.||| }
ToString	||} Ö
(
||Ö Ü
)
||Ü á
)
||á à
.
||à â
Length
||â è
)
||è ê
;
||ê ë
}}} 
catch~~ 
(~~ 
IOException~~ 
exceptIO~~ '
)~~' (
{ 
IO
ÄÄ 
.
ÄÄ 
Logger
ÄÄ 
.
ÄÄ 
Log
ÄÄ 
(
ÄÄ 
NLog
ÄÄ "
.
ÄÄ" #
LogLevel
ÄÄ# +
.
ÄÄ+ ,
Warn
ÄÄ, 0
,
ÄÄ0 1
exceptIO
ÄÄ2 :
,
ÄÄ: ;
$str
ÄÄ< X
+
ÄÄY Z
port
ÄÄ[ _
.
ÄÄ_ `
ToString
ÄÄ` h
(
ÄÄh i
)
ÄÄi j
)
ÄÄj k
;
ÄÄk l
}
ÅÅ 
finally
ÇÇ 
{
ÉÉ 
try
ÑÑ 
{
ÖÖ 
if
ÜÜ 
(
ÜÜ 
streamOutput
ÜÜ $
!=
ÜÜ% '
null
ÜÜ( ,
)
ÜÜ, -
{
áá 
streamOutput
àà $
.
àà$ %
Close
àà% *
(
àà* +
)
àà+ ,
;
àà, -
}
ââ 
}
ää 
catch
ãã 
(
ãã 
IOException
ãã "
exceptIO
ãã# +
)
ãã+ ,
{
åå 
IO
çç 
.
çç 
Logger
çç 
.
çç 
Log
çç !
(
çç! "
NLog
çç" &
.
çç& '
LogLevel
çç' /
.
çç/ 0
Warn
çç0 4
,
çç4 5
exceptIO
çç6 >
,
çç> ?
$str
çç@ W
)
ççW X
;
ççX Y
}
éé 
try
êê 
{
ëë 
if
íí 
(
íí 
tcpConn
íí 
!=
íí  "
null
íí# '
)
íí' (
{
ìì 
tcpConn
îî 
.
îî  
Close
îî  %
(
îî% &
)
îî& '
;
îî' (
}
ïï 
}
ññ 
catch
óó 
(
óó 
IOException
óó "
exceptIO
óó# +
)
óó+ ,
{
òò 
IO
ôô 
.
ôô 
Logger
ôô 
.
ôô 
Log
ôô !
(
ôô! "
NLog
ôô" &
.
ôô& '
LogLevel
ôô' /
.
ôô/ 0
Warn
ôô0 4
,
ôô4 5
exceptIO
ôô6 >
,
ôô> ?
$str
ôô@ W
)
ôôW X
;
ôôX Y
}
öö 
try
úú 
{
ùù 
if
ûû 
(
ûû 
listener
ûû  
!=
ûû! #
null
ûû$ (
)
ûû( )
{
üü 
listener
††  
.
††  !
Stop
††! %
(
††% &
)
††& '
;
††' (
}
°° 
}
¢¢ 
catch
££ 
(
££ 
IOException
££ "
exceptIO
££# +
)
££+ ,
{
§§ 
IO
•• 
.
•• 
Logger
•• 
.
•• 
Log
•• !
(
••! "
NLog
••" &
.
••& '
LogLevel
••' /
.
••/ 0
Warn
••0 4
,
••4 5
exceptIO
••6 >
,
••> ?
$str
••@ W
)
••W X
;
••X Y
}
¶¶ 
}
®® 
break
©© 
;
©© 
}
™™ 	
}
´´ 
public
≠≠ 

override
≠≠ 
void
≠≠ 
Good
≠≠ 
(
≠≠ 
)
≠≠ 
{
ÆÆ 
Good1
ØØ 
(
ØØ 
)
ØØ 
;
ØØ 
}
∞∞ 
}≤≤ 
}≥≥ â]
ñC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__hostname_based_logic_17.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 4
(CWE510_Trapdoor__hostname_based_logic_17 .
:/ 0
AbstractTestCase1 A
{ 
public 

override 
void 
Bad 
( 
) 
{ 
for 
( 
int 
j 
= 
$num 
; 
j 
< 
$num 
; 
j 
++ !
)! "
{   	
TcpListener!! 
listener!!  
=!!! "
null!!# '
;!!' (
	TcpClient"" 
tcpConn"" 
="" 
null""  $
;""$ %
Stream## 
streamOutput## 
=##  !
null##" &
;##& '
int$$ 
port$$ 
=$$ 
$num$$ 
;$$ 
try%% 
{&& 
listener'' 
='' 
new'' 
TcpListener'' *
(''* +
	IPAddress''+ 4
.''4 5
Parse''5 :
('': ;
$str''; G
)''G H
,''H I
port''J N
)''N O
;''O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
tcpConn)) 
=)) 
listener)) "
.))" #
AcceptTcpClient))# 2
())2 3
)))3 4
;))4 5

IPEndPoint++ 
endPoint++ #
=++$ %
(++& '

IPEndPoint++' 1
)++1 2
tcpConn++2 9
.++9 :
Client++: @
.++@ A
RemoteEndPoint++A O
;++O P
	IPAddress,, 
	ipAddress,, #
=,,$ %
endPoint,,& .
.,,. /
Address,,/ 6
;,,6 7
IPHostEntry-- 
	hostEntry-- %
=--& '
Dns--( +
.--+ ,
GetHostEntry--, 8
(--8 9
	ipAddress--9 B
)--B C
;--C D
if.. 
(.. 
	hostEntry.. 
... 
HostName.. &
...& '
Equals..' -
(..- .
$str... @
)..@ A
)..A B
{// 
streamOutput00  
=00! "
tcpConn00# *
.00* +
	GetStream00+ 4
(004 5
)005 6
;006 7
streamOutput11  
.11  !
Write11! &
(11& '
Encoding11' /
.11/ 0
UTF8110 4
.114 5
GetBytes115 =
(11= >
$str11> O
)11O P
,11P Q
$num11R S
,11S T
$str11U f
.11f g
Length11g m
)11m n
;11n o
}22 
else33 
{44 
streamOutput55  
=55! "
tcpConn55# *
.55* +
	GetStream55+ 4
(554 5
)555 6
;556 7
streamOutput66  
.66  !
Write66! &
(66& '
Encoding66' /
.66/ 0
UTF8660 4
.664 5
GetBytes665 =
(66= >
$str66> N
)66N O
,66O P
$num66Q R
,66R S
$str66T d
.66d e
Length66e k
)66k l
;66l m
}77 
}88 
catch99 
(99 
IOException99 
exceptIO99 '
)99' (
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; 
(;; 
NLog;; "
.;;" #
LogLevel;;# +
.;;+ ,
Warn;;, 0
,;;0 1
exceptIO;;2 :
,;;: ;
$str;;< X
+;;Y Z
port;;[ _
.;;_ `
ToString;;` h
(;;h i
);;i j
);;j k
;;;k l
}<< 
finally== 
{>> 
try?? 
{@@ 
ifAA 
(AA 
streamOutputAA $
!=AA% '
nullAA( ,
)AA, -
{BB 
streamOutputCC $
.CC$ %
CloseCC% *
(CC* +
)CC+ ,
;CC, -
}DD 
}EE 
catchFF 
(FF 
IOExceptionFF "
exceptIOFF# +
)FF+ ,
{GG 
IOHH 
.HH 
LoggerHH 
.HH 
LogHH !
(HH! "
NLogHH" &
.HH& '
LogLevelHH' /
.HH/ 0
WarnHH0 4
,HH4 5
exceptIOHH6 >
,HH> ?
$strHH@ W
)HHW X
;HHX Y
}II 
tryKK 
{LL 
ifMM 
(MM 
tcpConnMM 
!=MM  "
nullMM# '
)MM' (
{NN 
tcpConnOO 
.OO  
CloseOO  %
(OO% &
)OO& '
;OO' (
}PP 
}QQ 
catchRR 
(RR 
IOExceptionRR "
exceptIORR# +
)RR+ ,
{SS 
IOTT 
.TT 
LoggerTT 
.TT 
LogTT !
(TT! "
NLogTT" &
.TT& '
LogLevelTT' /
.TT/ 0
WarnTT0 4
,TT4 5
exceptIOTT6 >
,TT> ?
$strTT@ W
)TTW X
;TTX Y
}UU 
tryWW 
{XX 
ifYY 
(YY 
listenerYY  
!=YY! #
nullYY$ (
)YY( )
{ZZ 
listener[[  
.[[  !
Stop[[! %
([[% &
)[[& '
;[[' (
}\\ 
}]] 
catch^^ 
(^^ 
IOException^^ "
exceptIO^^# +
)^^+ ,
{__ 
IO`` 
.`` 
Logger`` 
.`` 
Log`` !
(``! "
NLog``" &
.``& '
LogLevel``' /
.``/ 0
Warn``0 4
,``4 5
exceptIO``6 >
,``> ?
$str``@ W
)``W X
;``X Y
}aa 
}cc 
}dd 	
}ee 
privateii 
voidii 
Good1ii 
(ii 
)ii 
{jj 
forkk 
(kk 
intkk 
kkk 
=kk 
$numkk 
;kk 
kkk 
<kk 
$numkk 
;kk 
kkk 
++kk !
)kk! "
{ll 	
TcpListenermm 
listenermm  
=mm! "
nullmm# '
;mm' (
	TcpClientnn 
tcpConnnn 
=nn 
nullnn  $
;nn$ %
Streamoo 
streamOutputoo 
=oo  !
nulloo" &
;oo& '
intpp 
portpp 
=pp 
$numpp 
;pp 
tryqq 
{rr 
listenerss 
=ss 
newss 
TcpListenerss *
(ss* +
	IPAddressss+ 4
.ss4 5
Parsess5 :
(ss: ;
$strss; G
)ssG H
,ssH I
portssJ N
)ssN O
;ssO P
listenertt 
.tt 
Starttt 
(tt 
)tt  
;tt  !
tcpConnuu 
=uu 
listeneruu "
.uu" #
AcceptTcpClientuu# 2
(uu2 3
)uu3 4
;uu4 5
streamOutputvv 
=vv 
tcpConnvv &
.vv& '
	GetStreamvv' 0
(vv0 1
)vv1 2
;vv2 3

IPEndPointww 
endPointww #
=ww$ %
(ww& '

IPEndPointww' 1
)ww1 2
tcpConnww2 9
.ww9 :
Clientww: @
.ww@ A
RemoteEndPointwwA O
;wwO P
	IPAddressxx 
	ipAddressxx #
=xx$ %
endPointxx& .
.xx. /
Addressxx/ 6
;xx6 7
IPHostEntryyy 
	hostEntryyy %
=yy& '
Dnsyy( +
.yy+ ,
GetHostEntryyy, 8
(yy8 9
	ipAddressyy9 B
)yyB C
;yyC D
streamOutput{{ 
.{{ 
Write{{ "
({{" #
Encoding{{# +
.{{+ ,
UTF8{{, 0
.{{0 1
GetBytes{{1 9
({{9 :
({{: ;
$str{{; F
+{{G H
	hostEntry{{I R
.{{R S
ToString{{S [
({{[ \
){{\ ]
){{] ^
){{^ _
,{{_ `
$num{{a b
,{{b c
({{d e
$str{{e p
+{{q r
	hostEntry{{s |
.{{| }
ToString	{{} Ö
(
{{Ö Ü
)
{{Ü á
)
{{á à
.
{{à â
Length
{{â è
)
{{è ê
;
{{ê ë
}|| 
catch}} 
(}} 
IOException}} 
exceptIO}} '
)}}' (
{~~ 
IO 
. 
Logger 
. 
Log 
( 
NLog "
." #
LogLevel# +
.+ ,
Warn, 0
,0 1
exceptIO2 :
,: ;
$str< X
+Y Z
port[ _
._ `
ToString` h
(h i
)i j
)j k
;k l
}
ÄÄ 
finally
ÅÅ 
{
ÇÇ 
try
ÉÉ 
{
ÑÑ 
if
ÖÖ 
(
ÖÖ 
streamOutput
ÖÖ $
!=
ÖÖ% '
null
ÖÖ( ,
)
ÖÖ, -
{
ÜÜ 
streamOutput
áá $
.
áá$ %
Close
áá% *
(
áá* +
)
áá+ ,
;
áá, -
}
àà 
}
ââ 
catch
ää 
(
ää 
IOException
ää "
exceptIO
ää# +
)
ää+ ,
{
ãã 
IO
åå 
.
åå 
Logger
åå 
.
åå 
Log
åå !
(
åå! "
NLog
åå" &
.
åå& '
LogLevel
åå' /
.
åå/ 0
Warn
åå0 4
,
åå4 5
exceptIO
åå6 >
,
åå> ?
$str
åå@ W
)
ååW X
;
ååX Y
}
çç 
try
èè 
{
êê 
if
ëë 
(
ëë 
tcpConn
ëë 
!=
ëë  "
null
ëë# '
)
ëë' (
{
íí 
tcpConn
ìì 
.
ìì  
Close
ìì  %
(
ìì% &
)
ìì& '
;
ìì' (
}
îî 
}
ïï 
catch
ññ 
(
ññ 
IOException
ññ "
exceptIO
ññ# +
)
ññ+ ,
{
óó 
IO
òò 
.
òò 
Logger
òò 
.
òò 
Log
òò !
(
òò! "
NLog
òò" &
.
òò& '
LogLevel
òò' /
.
òò/ 0
Warn
òò0 4
,
òò4 5
exceptIO
òò6 >
,
òò> ?
$str
òò@ W
)
òòW X
;
òòX Y
}
ôô 
try
õõ 
{
úú 
if
ùù 
(
ùù 
listener
ùù  
!=
ùù! #
null
ùù$ (
)
ùù( )
{
ûû 
listener
üü  
.
üü  !
Stop
üü! %
(
üü% &
)
üü& '
;
üü' (
}
†† 
}
°° 
catch
¢¢ 
(
¢¢ 
IOException
¢¢ "
exceptIO
¢¢# +
)
¢¢+ ,
{
££ 
IO
§§ 
.
§§ 
Logger
§§ 
.
§§ 
Log
§§ !
(
§§! "
NLog
§§" &
.
§§& '
LogLevel
§§' /
.
§§/ 0
Warn
§§0 4
,
§§4 5
exceptIO
§§6 >
,
§§> ?
$str
§§@ W
)
§§W X
;
§§X Y
}
•• 
}
ßß 
}
®® 	
}
©© 
public
´´ 

override
´´ 
void
´´ 
Good
´´ 
(
´´ 
)
´´ 
{
¨¨ 
Good1
≠≠ 
(
≠≠ 
)
≠≠ 
;
≠≠ 
}
ÆÆ 
}∞∞ 
}±± ƒX
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__ip_based_logic_01.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__ip_based_logic_01 (
:) *
AbstractTestCase+ ;
{ 
public 

override 
void 
Bad 
( 
) 
{ 
TcpListener 
listener 
= 
null #
;# $
	TcpClient   
tcpConn   
=   
null    
;    !
Stream!! 
streamOutput!! 
=!! 
null!! "
;!!" #
int"" 
port"" 
="" 
$num"" 
;"" 
try## 
{$$ 	
listener%% 
=%% 
new%% 
TcpListener%% &
(%%& '
	IPAddress%%' 0
.%%0 1
Parse%%1 6
(%%6 7
$str%%7 C
)%%C D
,%%D E
port%%F J
)%%J K
;%%K L
listener&& 
.&& 
Start&& 
(&& 
)&& 
;&& 
tcpConn'' 
='' 
listener'' 
.'' 
AcceptTcpClient'' .
(''. /
)''/ 0
;''0 1

IPEndPoint)) 
endPoint)) 
=))  !
())" #

IPEndPoint))# -
)))- .
tcpConn)). 5
.))5 6
Client))6 <
.))< =
RemoteEndPoint))= K
;))K L
	IPAddress** 
	ipAddress** 
=**  !
endPoint**" *
.*** +
Address**+ 2
;**2 3
IPHostEntry++ 
	hostEntry++ !
=++" #
Dns++$ '
.++' (
GetHostEntry++( 4
(++4 5
	ipAddress++5 >
)++> ?
;++? @
if,, 
(,, 
	hostEntry,, 
.,, 
Equals,,  
(,,  !
$str,,! 1
),,1 2
),,2 3
{-- 
streamOutput.. 
=.. 
tcpConn.. &
...& '
	GetStream..' 0
(..0 1
)..1 2
;..2 3
streamOutput// 
.// 
Write// "
(//" #
Encoding//# +
.//+ ,
UTF8//, 0
.//0 1
GetBytes//1 9
(//9 :
$str//: K
)//K L
,//L M
$num//N O
,//O P
$str//Q b
.//b c
Length//c i
)//i j
;//j k
}00 
else11 
{22 
streamOutput33 
=33 
tcpConn33 &
.33& '
	GetStream33' 0
(330 1
)331 2
;332 3
streamOutput44 
.44 
Write44 "
(44" #
Encoding44# +
.44+ ,
UTF844, 0
.440 1
GetBytes441 9
(449 :
$str44: J
)44J K
,44K L
$num44M N
,44N O
$str44P `
.44` a
Length44a g
)44g h
;44h i
}55 
}66 	
catch77 
(77 
IOException77 
exceptIO77 #
)77# $
{88 	
IO99 
.99 
Logger99 
.99 
Log99 
(99 
NLog99 
.99 
LogLevel99 '
.99' (
Warn99( ,
,99, -
exceptIO99. 6
,996 7
$str998 T
+99U V
port99W [
.99[ \
ToString99\ d
(99d e
)99e f
)99f g
;99g h
}:: 	
finally;; 
{<< 	
try== 
{>> 
if?? 
(?? 
streamOutput??  
!=??! #
null??$ (
)??( )
{@@ 
streamOutputAA  
.AA  !
CloseAA! &
(AA& '
)AA' (
;AA( )
}BB 
}CC 
catchDD 
(DD 
IOExceptionDD 
exceptIODD '
)DD' (
{EE 
IOFF 
.FF 
LoggerFF 
.FF 
LogFF 
(FF 
NLogFF "
.FF" #
LogLevelFF# +
.FF+ ,
WarnFF, 0
,FF0 1
exceptIOFF2 :
,FF: ;
$strFF< S
)FFS T
;FFT U
}GG 
tryII 
{JJ 
ifKK 
(KK 
tcpConnKK 
!=KK 
nullKK #
)KK# $
{LL 
tcpConnMM 
.MM 
CloseMM !
(MM! "
)MM" #
;MM# $
}NN 
}OO 
catchPP 
(PP 
IOExceptionPP 
exceptIOPP '
)PP' (
{QQ 
IORR 
.RR 
LoggerRR 
.RR 
LogRR 
(RR 
NLogRR "
.RR" #
LogLevelRR# +
.RR+ ,
WarnRR, 0
,RR0 1
exceptIORR2 :
,RR: ;
$strRR< S
)RRS T
;RRT U
}SS 
tryUU 
{VV 
ifWW 
(WW 
listenerWW 
!=WW 
nullWW  $
)WW$ %
{XX 
listenerYY 
.YY 
StopYY !
(YY! "
)YY" #
;YY# $
}ZZ 
}[[ 
catch\\ 
(\\ 
IOException\\ 
exceptIO\\ '
)\\' (
{]] 
IO^^ 
.^^ 
Logger^^ 
.^^ 
Log^^ 
(^^ 
NLog^^ "
.^^" #
LogLevel^^# +
.^^+ ,
Warn^^, 0
,^^0 1
exceptIO^^2 :
,^^: ;
$str^^< S
)^^S T
;^^T U
}__ 
}`` 	
}aa 
publicdd 

overridedd 
voiddd 
Gooddd 
(dd 
)dd 
{ee 
Good1ff 
(ff 
)ff 
;ff 
}gg 
privateii 
voidii 
Good1ii 
(ii 
)ii 
{jj 
TcpListenerkk 
listenerkk 
=kk 
nullkk #
;kk# $
	TcpClientll 
tcpConnll 
=ll 
nullll  
;ll  !
Streammm 
streamOutputmm 
=mm 
nullmm "
;mm" #
intnn 
portnn 
=nn 
$numnn 
;nn 
tryoo 
{pp 	
listenerqq 
=qq 
newqq 
TcpListenerqq &
(qq& '
	IPAddressqq' 0
.qq0 1
Parseqq1 6
(qq6 7
$strqq7 C
)qqC D
,qqD E
portqqF J
)qqJ K
;qqK L
listenerrr 
.rr 
Startrr 
(rr 
)rr 
;rr 
tcpConnss 
=ss 
listenerss 
.ss 
AcceptTcpClientss .
(ss. /
)ss/ 0
;ss0 1
streamOutputtt 
=tt 
tcpConntt "
.tt" #
	GetStreamtt# ,
(tt, -
)tt- .
;tt. /

IPEndPointuu 
endPointuu 
=uu  !
(uu" #

IPEndPointuu# -
)uu- .
tcpConnuu. 5
.uu5 6
Clientuu6 <
.uu< =
RemoteEndPointuu= K
;uuK L
	IPAddressvv 
	ipAddressvv 
=vv  !
endPointvv" *
.vv* +
Addressvv+ 2
;vv2 3
IPHostEntryww 
	hostEntryww !
=ww" #
Dnsww$ '
.ww' (
GetHostEntryww( 4
(ww4 5
	ipAddressww5 >
)ww> ?
;ww? @
streamOutputyy 
.yy 
Writeyy 
(yy 
Encodingyy '
.yy' (
UTF8yy( ,
.yy, -
GetBytesyy- 5
(yy5 6
(yy6 7
$stryy7 B
+yyC D
	hostEntryyyE N
.yyN O
ToStringyyO W
(yyW X
)yyX Y
)yyY Z
)yyZ [
,yy[ \
$numyy] ^
,yy^ _
(yy` a
$stryya l
+yym n
	hostEntryyyo x
.yyx y
ToString	yyy Å
(
yyÅ Ç
)
yyÇ É
)
yyÉ Ñ
.
yyÑ Ö
Length
yyÖ ã
)
yyã å
;
yyå ç
}zz 	
catch{{ 
({{ 
IOException{{ 
exceptIO{{ #
){{# $
{|| 	
IO}} 
.}} 
Logger}} 
.}} 
Log}} 
(}} 
NLog}} 
.}} 
LogLevel}} '
.}}' (
Warn}}( ,
,}}, -
exceptIO}}. 6
,}}6 7
$str}}8 T
+}}U V
port}}W [
.}}[ \
ToString}}\ d
(}}d e
)}}e f
)}}f g
;}}g h
}~~ 	
finally 
{
ÄÄ 	
try
ÅÅ 
{
ÇÇ 
if
ÉÉ 
(
ÉÉ 
streamOutput
ÉÉ  
!=
ÉÉ! #
null
ÉÉ$ (
)
ÉÉ( )
{
ÑÑ 
streamOutput
ÖÖ  
.
ÖÖ  !
Close
ÖÖ! &
(
ÖÖ& '
)
ÖÖ' (
;
ÖÖ( )
}
ÜÜ 
}
áá 
catch
àà 
(
àà 
IOException
àà 
exceptIO
àà '
)
àà' (
{
ââ 
IO
ää 
.
ää 
Logger
ää 
.
ää 
Log
ää 
(
ää 
NLog
ää "
.
ää" #
LogLevel
ää# +
.
ää+ ,
Warn
ää, 0
,
ää0 1
exceptIO
ää2 :
,
ää: ;
$str
ää< S
)
ääS T
;
ääT U
}
ãã 
try
çç 
{
éé 
if
èè 
(
èè 
tcpConn
èè 
!=
èè 
null
èè #
)
èè# $
{
êê 
tcpConn
ëë 
.
ëë 
Close
ëë !
(
ëë! "
)
ëë" #
;
ëë# $
}
íí 
}
ìì 
catch
îî 
(
îî 
IOException
îî 
exceptIO
îî '
)
îî' (
{
ïï 
IO
ññ 
.
ññ 
Logger
ññ 
.
ññ 
Log
ññ 
(
ññ 
NLog
ññ "
.
ññ" #
LogLevel
ññ# +
.
ññ+ ,
Warn
ññ, 0
,
ññ0 1
exceptIO
ññ2 :
,
ññ: ;
$str
ññ< S
)
ññS T
;
ññT U
}
óó 
try
ôô 
{
öö 
if
õõ 
(
õõ 
listener
õõ 
!=
õõ 
null
õõ  $
)
õõ$ %
{
úú 
listener
ùù 
.
ùù 
Stop
ùù !
(
ùù! "
)
ùù" #
;
ùù# $
}
ûû 
}
üü 
catch
†† 
(
†† 
IOException
†† 
exceptIO
†† '
)
††' (
{
°° 
IO
¢¢ 
.
¢¢ 
Logger
¢¢ 
.
¢¢ 
Log
¢¢ 
(
¢¢ 
NLog
¢¢ "
.
¢¢" #
LogLevel
¢¢# +
.
¢¢+ ,
Warn
¢¢, 0
,
¢¢0 1
exceptIO
¢¢2 :
,
¢¢: ;
$str
¢¢< S
)
¢¢S T
;
¢¢T U
}
££ 
}
•• 	
}
¶¶ 
}®® 
}©© Öâ
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__ip_based_logic_02.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__ip_based_logic_02 (
:) *
AbstractTestCase+ ;
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
true 
) 
{   	
TcpListener!! 
listener!!  
=!!! "
null!!# '
;!!' (
	TcpClient"" 
tcpConn"" 
="" 
null""  $
;""$ %
Stream## 
streamOutput## 
=##  !
null##" &
;##& '
int$$ 
port$$ 
=$$ 
$num$$ 
;$$ 
try%% 
{&& 
listener'' 
='' 
new'' 
TcpListener'' *
(''* +
	IPAddress''+ 4
.''4 5
Parse''5 :
('': ;
$str''; G
)''G H
,''H I
port''J N
)''N O
;''O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
tcpConn)) 
=)) 
listener)) "
.))" #
AcceptTcpClient))# 2
())2 3
)))3 4
;))4 5

IPEndPoint++ 
endPoint++ #
=++$ %
(++& '

IPEndPoint++' 1
)++1 2
tcpConn++2 9
.++9 :
Client++: @
.++@ A
RemoteEndPoint++A O
;++O P
	IPAddress,, 
	ipAddress,, #
=,,$ %
endPoint,,& .
.,,. /
Address,,/ 6
;,,6 7
IPHostEntry-- 
	hostEntry-- %
=--& '
Dns--( +
.--+ ,
GetHostEntry--, 8
(--8 9
	ipAddress--9 B
)--B C
;--C D
if.. 
(.. 
	hostEntry.. 
... 
Equals.. $
(..$ %
$str..% 5
)..5 6
)..6 7
{// 
streamOutput00  
=00! "
tcpConn00# *
.00* +
	GetStream00+ 4
(004 5
)005 6
;006 7
streamOutput11  
.11  !
Write11! &
(11& '
Encoding11' /
.11/ 0
UTF8110 4
.114 5
GetBytes115 =
(11= >
$str11> O
)11O P
,11P Q
$num11R S
,11S T
$str11U f
.11f g
Length11g m
)11m n
;11n o
}22 
else33 
{44 
streamOutput55  
=55! "
tcpConn55# *
.55* +
	GetStream55+ 4
(554 5
)555 6
;556 7
streamOutput66  
.66  !
Write66! &
(66& '
Encoding66' /
.66/ 0
UTF8660 4
.664 5
GetBytes665 =
(66= >
$str66> N
)66N O
,66O P
$num66Q R
,66R S
$str66T d
.66d e
Length66e k
)66k l
;66l m
}77 
}88 
catch99 
(99 
IOException99 
exceptIO99 '
)99' (
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; 
(;; 
NLog;; "
.;;" #
LogLevel;;# +
.;;+ ,
Warn;;, 0
,;;0 1
exceptIO;;2 :
,;;: ;
$str;;< X
+;;Y Z
port;;[ _
.;;_ `
ToString;;` h
(;;h i
);;i j
);;j k
;;;k l
}<< 
finally== 
{>> 
try?? 
{@@ 
ifAA 
(AA 
streamOutputAA $
!=AA% '
nullAA( ,
)AA, -
{BB 
streamOutputCC $
.CC$ %
CloseCC% *
(CC* +
)CC+ ,
;CC, -
}DD 
}EE 
catchFF 
(FF 
IOExceptionFF "
exceptIOFF# +
)FF+ ,
{GG 
IOHH 
.HH 
LoggerHH 
.HH 
LogHH !
(HH! "
NLogHH" &
.HH& '
LogLevelHH' /
.HH/ 0
WarnHH0 4
,HH4 5
exceptIOHH6 >
,HH> ?
$strHH@ W
)HHW X
;HHX Y
}II 
tryKK 
{LL 
ifMM 
(MM 
tcpConnMM 
!=MM  "
nullMM# '
)MM' (
{NN 
tcpConnOO 
.OO  
CloseOO  %
(OO% &
)OO& '
;OO' (
}PP 
}QQ 
catchRR 
(RR 
IOExceptionRR "
exceptIORR# +
)RR+ ,
{SS 
IOTT 
.TT 
LoggerTT 
.TT 
LogTT !
(TT! "
NLogTT" &
.TT& '
LogLevelTT' /
.TT/ 0
WarnTT0 4
,TT4 5
exceptIOTT6 >
,TT> ?
$strTT@ W
)TTW X
;TTX Y
}UU 
tryWW 
{XX 
ifYY 
(YY 
listenerYY  
!=YY! #
nullYY$ (
)YY( )
{ZZ 
listener[[  
.[[  !
Stop[[! %
([[% &
)[[& '
;[[' (
}\\ 
}]] 
catch^^ 
(^^ 
IOException^^ "
exceptIO^^# +
)^^+ ,
{__ 
IO`` 
.`` 
Logger`` 
.`` 
Log`` !
(``! "
NLog``" &
.``& '
LogLevel``' /
.``/ 0
Warn``0 4
,``4 5
exceptIO``6 >
,``> ?
$str``@ W
)``W X
;``X Y
}aa 
}bb 
}cc 	
}dd 
privatehh 
voidhh 
Good1hh 
(hh 
)hh 
{ii 
ifjj 

(jj 
falsejj 
)jj 
{kk 	
IOmm 
.mm 
	WriteLinemm 
(mm 
$strmm /
)mm/ 0
;mm0 1
}nn 	
elseoo 
{pp 	
TcpListenerqq 
listenerqq  
=qq! "
nullqq# '
;qq' (
	TcpClientrr 
tcpConnrr 
=rr 
nullrr  $
;rr$ %
Streamss 
streamOutputss 
=ss  !
nullss" &
;ss& '
inttt 
porttt 
=tt 
$numtt 
;tt 
tryuu 
{vv 
listenerww 
=ww 
newww 
TcpListenerww *
(ww* +
	IPAddressww+ 4
.ww4 5
Parseww5 :
(ww: ;
$strww; G
)wwG H
,wwH I
portwwJ N
)wwN O
;wwO P
listenerxx 
.xx 
Startxx 
(xx 
)xx  
;xx  !
tcpConnyy 
=yy 
listeneryy "
.yy" #
AcceptTcpClientyy# 2
(yy2 3
)yy3 4
;yy4 5
streamOutputzz 
=zz 
tcpConnzz &
.zz& '
	GetStreamzz' 0
(zz0 1
)zz1 2
;zz2 3

IPEndPoint{{ 
endPoint{{ #
={{$ %
({{& '

IPEndPoint{{' 1
){{1 2
tcpConn{{2 9
.{{9 :
Client{{: @
.{{@ A
RemoteEndPoint{{A O
;{{O P
	IPAddress|| 
	ipAddress|| #
=||$ %
endPoint||& .
.||. /
Address||/ 6
;||6 7
IPHostEntry}} 
	hostEntry}} %
=}}& '
Dns}}( +
.}}+ ,
GetHostEntry}}, 8
(}}8 9
	ipAddress}}9 B
)}}B C
;}}C D
streamOutput 
. 
Write "
(" #
Encoding# +
.+ ,
UTF8, 0
.0 1
GetBytes1 9
(9 :
(: ;
$str; F
+G H
	hostEntryI R
.R S
ToStringS [
([ \
)\ ]
)] ^
)^ _
,_ `
$numa b
,b c
(d e
$stre p
+q r
	hostEntrys |
.| }
ToString	} Ö
(
Ö Ü
)
Ü á
)
á à
.
à â
Length
â è
)
è ê
;
ê ë
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
IOException
ÅÅ 
exceptIO
ÅÅ '
)
ÅÅ' (
{
ÇÇ 
IO
ÉÉ 
.
ÉÉ 
Logger
ÉÉ 
.
ÉÉ 
Log
ÉÉ 
(
ÉÉ 
NLog
ÉÉ "
.
ÉÉ" #
LogLevel
ÉÉ# +
.
ÉÉ+ ,
Warn
ÉÉ, 0
,
ÉÉ0 1
exceptIO
ÉÉ2 :
,
ÉÉ: ;
$str
ÉÉ< X
+
ÉÉY Z
port
ÉÉ[ _
.
ÉÉ_ `
ToString
ÉÉ` h
(
ÉÉh i
)
ÉÉi j
)
ÉÉj k
;
ÉÉk l
}
ÑÑ 
finally
ÖÖ 
{
ÜÜ 
try
áá 
{
àà 
if
ââ 
(
ââ 
streamOutput
ââ $
!=
ââ% '
null
ââ( ,
)
ââ, -
{
ää 
streamOutput
ãã $
.
ãã$ %
Close
ãã% *
(
ãã* +
)
ãã+ ,
;
ãã, -
}
åå 
}
çç 
catch
éé 
(
éé 
IOException
éé "
exceptIO
éé# +
)
éé+ ,
{
èè 
IO
êê 
.
êê 
Logger
êê 
.
êê 
Log
êê !
(
êê! "
NLog
êê" &
.
êê& '
LogLevel
êê' /
.
êê/ 0
Warn
êê0 4
,
êê4 5
exceptIO
êê6 >
,
êê> ?
$str
êê@ W
)
êêW X
;
êêX Y
}
ëë 
try
ìì 
{
îî 
if
ïï 
(
ïï 
tcpConn
ïï 
!=
ïï  "
null
ïï# '
)
ïï' (
{
ññ 
tcpConn
óó 
.
óó  
Close
óó  %
(
óó% &
)
óó& '
;
óó' (
}
òò 
}
ôô 
catch
öö 
(
öö 
IOException
öö "
exceptIO
öö# +
)
öö+ ,
{
õõ 
IO
úú 
.
úú 
Logger
úú 
.
úú 
Log
úú !
(
úú! "
NLog
úú" &
.
úú& '
LogLevel
úú' /
.
úú/ 0
Warn
úú0 4
,
úú4 5
exceptIO
úú6 >
,
úú> ?
$str
úú@ W
)
úúW X
;
úúX Y
}
ùù 
try
üü 
{
†† 
if
°° 
(
°° 
listener
°°  
!=
°°! #
null
°°$ (
)
°°( )
{
¢¢ 
listener
££  
.
££  !
Stop
££! %
(
££% &
)
££& '
;
££' (
}
§§ 
}
•• 
catch
¶¶ 
(
¶¶ 
IOException
¶¶ "
exceptIO
¶¶# +
)
¶¶+ ,
{
ßß 
IO
®® 
.
®® 
Logger
®® 
.
®® 
Log
®® !
(
®®! "
NLog
®®" &
.
®®& '
LogLevel
®®' /
.
®®/ 0
Warn
®®0 4
,
®®4 5
exceptIO
®®6 >
,
®®> ?
$str
®®@ W
)
®®W X
;
®®X Y
}
©© 
}
´´ 
}
¨¨ 	
}
≠≠ 
private
∞∞ 
void
∞∞ 
Good2
∞∞ 
(
∞∞ 
)
∞∞ 
{
±± 
if
≤≤ 

(
≤≤ 
true
≤≤ 
)
≤≤ 
{
≥≥ 	
TcpListener
¥¥ 
listener
¥¥  
=
¥¥! "
null
¥¥# '
;
¥¥' (
	TcpClient
µµ 
tcpConn
µµ 
=
µµ 
null
µµ  $
;
µµ$ %
Stream
∂∂ 
streamOutput
∂∂ 
=
∂∂  !
null
∂∂" &
;
∂∂& '
int
∑∑ 
port
∑∑ 
=
∑∑ 
$num
∑∑ 
;
∑∑ 
try
∏∏ 
{
ππ 
listener
∫∫ 
=
∫∫ 
new
∫∫ 
TcpListener
∫∫ *
(
∫∫* +
	IPAddress
∫∫+ 4
.
∫∫4 5
Parse
∫∫5 :
(
∫∫: ;
$str
∫∫; G
)
∫∫G H
,
∫∫H I
port
∫∫J N
)
∫∫N O
;
∫∫O P
listener
ªª 
.
ªª 
Start
ªª 
(
ªª 
)
ªª  
;
ªª  !
tcpConn
ºº 
=
ºº 
listener
ºº "
.
ºº" #
AcceptTcpClient
ºº# 2
(
ºº2 3
)
ºº3 4
;
ºº4 5
streamOutput
ΩΩ 
=
ΩΩ 
tcpConn
ΩΩ &
.
ΩΩ& '
	GetStream
ΩΩ' 0
(
ΩΩ0 1
)
ΩΩ1 2
;
ΩΩ2 3

IPEndPoint
ææ 
endPoint
ææ #
=
ææ$ %
(
ææ& '

IPEndPoint
ææ' 1
)
ææ1 2
tcpConn
ææ2 9
.
ææ9 :
Client
ææ: @
.
ææ@ A
RemoteEndPoint
ææA O
;
ææO P
	IPAddress
øø 
	ipAddress
øø #
=
øø$ %
endPoint
øø& .
.
øø. /
Address
øø/ 6
;
øø6 7
IPHostEntry
¿¿ 
	hostEntry
¿¿ %
=
¿¿& '
Dns
¿¿( +
.
¿¿+ ,
GetHostEntry
¿¿, 8
(
¿¿8 9
	ipAddress
¿¿9 B
)
¿¿B C
;
¿¿C D
streamOutput
¬¬ 
.
¬¬ 
Write
¬¬ "
(
¬¬" #
Encoding
¬¬# +
.
¬¬+ ,
UTF8
¬¬, 0
.
¬¬0 1
GetBytes
¬¬1 9
(
¬¬9 :
(
¬¬: ;
$str
¬¬; F
+
¬¬G H
	hostEntry
¬¬I R
.
¬¬R S
ToString
¬¬S [
(
¬¬[ \
)
¬¬\ ]
)
¬¬] ^
)
¬¬^ _
,
¬¬_ `
$num
¬¬a b
,
¬¬b c
(
¬¬d e
$str
¬¬e p
+
¬¬q r
	hostEntry
¬¬s |
.
¬¬| }
ToString¬¬} Ö
(¬¬Ö Ü
)¬¬Ü á
)¬¬á à
.¬¬à â
Length¬¬â è
)¬¬è ê
;¬¬ê ë
}
√√ 
catch
ƒƒ 
(
ƒƒ 
IOException
ƒƒ 
exceptIO
ƒƒ '
)
ƒƒ' (
{
≈≈ 
IO
∆∆ 
.
∆∆ 
Logger
∆∆ 
.
∆∆ 
Log
∆∆ 
(
∆∆ 
NLog
∆∆ "
.
∆∆" #
LogLevel
∆∆# +
.
∆∆+ ,
Warn
∆∆, 0
,
∆∆0 1
exceptIO
∆∆2 :
,
∆∆: ;
$str
∆∆< X
+
∆∆Y Z
port
∆∆[ _
.
∆∆_ `
ToString
∆∆` h
(
∆∆h i
)
∆∆i j
)
∆∆j k
;
∆∆k l
}
«« 
finally
»» 
{
…… 
try
   
{
ÀÀ 
if
ÃÃ 
(
ÃÃ 
streamOutput
ÃÃ $
!=
ÃÃ% '
null
ÃÃ( ,
)
ÃÃ, -
{
ÕÕ 
streamOutput
ŒŒ $
.
ŒŒ$ %
Close
ŒŒ% *
(
ŒŒ* +
)
ŒŒ+ ,
;
ŒŒ, -
}
œœ 
}
–– 
catch
—— 
(
—— 
IOException
—— "
exceptIO
——# +
)
——+ ,
{
““ 
IO
”” 
.
”” 
Logger
”” 
.
”” 
Log
”” !
(
””! "
NLog
””" &
.
””& '
LogLevel
””' /
.
””/ 0
Warn
””0 4
,
””4 5
exceptIO
””6 >
,
””> ?
$str
””@ W
)
””W X
;
””X Y
}
‘‘ 
try
÷÷ 
{
◊◊ 
if
ÿÿ 
(
ÿÿ 
tcpConn
ÿÿ 
!=
ÿÿ  "
null
ÿÿ# '
)
ÿÿ' (
{
ŸŸ 
tcpConn
⁄⁄ 
.
⁄⁄  
Close
⁄⁄  %
(
⁄⁄% &
)
⁄⁄& '
;
⁄⁄' (
}
€€ 
}
‹‹ 
catch
›› 
(
›› 
IOException
›› "
exceptIO
››# +
)
››+ ,
{
ﬁﬁ 
IO
ﬂﬂ 
.
ﬂﬂ 
Logger
ﬂﬂ 
.
ﬂﬂ 
Log
ﬂﬂ !
(
ﬂﬂ! "
NLog
ﬂﬂ" &
.
ﬂﬂ& '
LogLevel
ﬂﬂ' /
.
ﬂﬂ/ 0
Warn
ﬂﬂ0 4
,
ﬂﬂ4 5
exceptIO
ﬂﬂ6 >
,
ﬂﬂ> ?
$str
ﬂﬂ@ W
)
ﬂﬂW X
;
ﬂﬂX Y
}
‡‡ 
try
‚‚ 
{
„„ 
if
‰‰ 
(
‰‰ 
listener
‰‰  
!=
‰‰! #
null
‰‰$ (
)
‰‰( )
{
ÂÂ 
listener
ÊÊ  
.
ÊÊ  !
Stop
ÊÊ! %
(
ÊÊ% &
)
ÊÊ& '
;
ÊÊ' (
}
ÁÁ 
}
ËË 
catch
ÈÈ 
(
ÈÈ 
IOException
ÈÈ "
exceptIO
ÈÈ# +
)
ÈÈ+ ,
{
ÍÍ 
IO
ÎÎ 
.
ÎÎ 
Logger
ÎÎ 
.
ÎÎ 
Log
ÎÎ !
(
ÎÎ! "
NLog
ÎÎ" &
.
ÎÎ& '
LogLevel
ÎÎ' /
.
ÎÎ/ 0
Warn
ÎÎ0 4
,
ÎÎ4 5
exceptIO
ÎÎ6 >
,
ÎÎ> ?
$str
ÎÎ@ W
)
ÎÎW X
;
ÎÎX Y
}
ÏÏ 
}
ÓÓ 
}
ÔÔ 	
}
 
public
ÚÚ 

override
ÚÚ 
void
ÚÚ 
Good
ÚÚ 
(
ÚÚ 
)
ÚÚ 
{
ÛÛ 
Good1
ÙÙ 
(
ÙÙ 
)
ÙÙ 
;
ÙÙ 
Good2
ıı 
(
ıı 
)
ıı 
;
ıı 
}
ˆˆ 
}¯¯ 
}˘˘ Óâ
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__ip_based_logic_03.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__ip_based_logic_03 (
:) *
AbstractTestCase+ ;
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
$num 
== 
$num 
) 
{   	
TcpListener!! 
listener!!  
=!!! "
null!!# '
;!!' (
	TcpClient"" 
tcpConn"" 
="" 
null""  $
;""$ %
Stream## 
streamOutput## 
=##  !
null##" &
;##& '
int$$ 
port$$ 
=$$ 
$num$$ 
;$$ 
try%% 
{&& 
listener'' 
='' 
new'' 
TcpListener'' *
(''* +
	IPAddress''+ 4
.''4 5
Parse''5 :
('': ;
$str''; G
)''G H
,''H I
port''J N
)''N O
;''O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
tcpConn)) 
=)) 
listener)) "
.))" #
AcceptTcpClient))# 2
())2 3
)))3 4
;))4 5

IPEndPoint++ 
endPoint++ #
=++$ %
(++& '

IPEndPoint++' 1
)++1 2
tcpConn++2 9
.++9 :
Client++: @
.++@ A
RemoteEndPoint++A O
;++O P
	IPAddress,, 
	ipAddress,, #
=,,$ %
endPoint,,& .
.,,. /
Address,,/ 6
;,,6 7
IPHostEntry-- 
	hostEntry-- %
=--& '
Dns--( +
.--+ ,
GetHostEntry--, 8
(--8 9
	ipAddress--9 B
)--B C
;--C D
if.. 
(.. 
	hostEntry.. 
... 
Equals.. $
(..$ %
$str..% 5
)..5 6
)..6 7
{// 
streamOutput00  
=00! "
tcpConn00# *
.00* +
	GetStream00+ 4
(004 5
)005 6
;006 7
streamOutput11  
.11  !
Write11! &
(11& '
Encoding11' /
.11/ 0
UTF8110 4
.114 5
GetBytes115 =
(11= >
$str11> O
)11O P
,11P Q
$num11R S
,11S T
$str11U f
.11f g
Length11g m
)11m n
;11n o
}22 
else33 
{44 
streamOutput55  
=55! "
tcpConn55# *
.55* +
	GetStream55+ 4
(554 5
)555 6
;556 7
streamOutput66  
.66  !
Write66! &
(66& '
Encoding66' /
.66/ 0
UTF8660 4
.664 5
GetBytes665 =
(66= >
$str66> N
)66N O
,66O P
$num66Q R
,66R S
$str66T d
.66d e
Length66e k
)66k l
;66l m
}77 
}88 
catch99 
(99 
IOException99 
exceptIO99 '
)99' (
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; 
(;; 
NLog;; "
.;;" #
LogLevel;;# +
.;;+ ,
Warn;;, 0
,;;0 1
exceptIO;;2 :
,;;: ;
$str;;< X
+;;Y Z
port;;[ _
.;;_ `
ToString;;` h
(;;h i
);;i j
);;j k
;;;k l
}<< 
finally== 
{>> 
try?? 
{@@ 
ifAA 
(AA 
streamOutputAA $
!=AA% '
nullAA( ,
)AA, -
{BB 
streamOutputCC $
.CC$ %
CloseCC% *
(CC* +
)CC+ ,
;CC, -
}DD 
}EE 
catchFF 
(FF 
IOExceptionFF "
exceptIOFF# +
)FF+ ,
{GG 
IOHH 
.HH 
LoggerHH 
.HH 
LogHH !
(HH! "
NLogHH" &
.HH& '
LogLevelHH' /
.HH/ 0
WarnHH0 4
,HH4 5
exceptIOHH6 >
,HH> ?
$strHH@ W
)HHW X
;HHX Y
}II 
tryKK 
{LL 
ifMM 
(MM 
tcpConnMM 
!=MM  "
nullMM# '
)MM' (
{NN 
tcpConnOO 
.OO  
CloseOO  %
(OO% &
)OO& '
;OO' (
}PP 
}QQ 
catchRR 
(RR 
IOExceptionRR "
exceptIORR# +
)RR+ ,
{SS 
IOTT 
.TT 
LoggerTT 
.TT 
LogTT !
(TT! "
NLogTT" &
.TT& '
LogLevelTT' /
.TT/ 0
WarnTT0 4
,TT4 5
exceptIOTT6 >
,TT> ?
$strTT@ W
)TTW X
;TTX Y
}UU 
tryWW 
{XX 
ifYY 
(YY 
listenerYY  
!=YY! #
nullYY$ (
)YY( )
{ZZ 
listener[[  
.[[  !
Stop[[! %
([[% &
)[[& '
;[[' (
}\\ 
}]] 
catch^^ 
(^^ 
IOException^^ "
exceptIO^^# +
)^^+ ,
{__ 
IO`` 
.`` 
Logger`` 
.`` 
Log`` !
(``! "
NLog``" &
.``& '
LogLevel``' /
.``/ 0
Warn``0 4
,``4 5
exceptIO``6 >
,``> ?
$str``@ W
)``W X
;``X Y
}aa 
}bb 
}cc 	
}dd 
privatehh 
voidhh 
Good1hh 
(hh 
)hh 
{ii 
ifjj 

(jj 
$numjj 
!=jj 
$numjj 
)jj 
{kk 	
IOmm 
.mm 
	WriteLinemm 
(mm 
$strmm /
)mm/ 0
;mm0 1
}nn 	
elseoo 
{pp 	
TcpListenerqq 
listenerqq  
=qq! "
nullqq# '
;qq' (
	TcpClientrr 
tcpConnrr 
=rr 
nullrr  $
;rr$ %
Streamss 
streamOutputss 
=ss  !
nullss" &
;ss& '
inttt 
porttt 
=tt 
$numtt 
;tt 
tryuu 
{vv 
listenerww 
=ww 
newww 
TcpListenerww *
(ww* +
	IPAddressww+ 4
.ww4 5
Parseww5 :
(ww: ;
$strww; G
)wwG H
,wwH I
portwwJ N
)wwN O
;wwO P
listenerxx 
.xx 
Startxx 
(xx 
)xx  
;xx  !
tcpConnyy 
=yy 
listeneryy "
.yy" #
AcceptTcpClientyy# 2
(yy2 3
)yy3 4
;yy4 5
streamOutputzz 
=zz 
tcpConnzz &
.zz& '
	GetStreamzz' 0
(zz0 1
)zz1 2
;zz2 3

IPEndPoint{{ 
endPoint{{ #
={{$ %
({{& '

IPEndPoint{{' 1
){{1 2
tcpConn{{2 9
.{{9 :
Client{{: @
.{{@ A
RemoteEndPoint{{A O
;{{O P
	IPAddress|| 
	ipAddress|| #
=||$ %
endPoint||& .
.||. /
Address||/ 6
;||6 7
IPHostEntry}} 
	hostEntry}} %
=}}& '
Dns}}( +
.}}+ ,
GetHostEntry}}, 8
(}}8 9
	ipAddress}}9 B
)}}B C
;}}C D
streamOutput 
. 
Write "
(" #
Encoding# +
.+ ,
UTF8, 0
.0 1
GetBytes1 9
(9 :
(: ;
$str; F
+G H
	hostEntryI R
.R S
ToStringS [
([ \
)\ ]
)] ^
)^ _
,_ `
$numa b
,b c
(d e
$stre p
+q r
	hostEntrys |
.| }
ToString	} Ö
(
Ö Ü
)
Ü á
)
á à
.
à â
Length
â è
)
è ê
;
ê ë
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
IOException
ÅÅ 
exceptIO
ÅÅ '
)
ÅÅ' (
{
ÇÇ 
IO
ÉÉ 
.
ÉÉ 
Logger
ÉÉ 
.
ÉÉ 
Log
ÉÉ 
(
ÉÉ 
NLog
ÉÉ "
.
ÉÉ" #
LogLevel
ÉÉ# +
.
ÉÉ+ ,
Warn
ÉÉ, 0
,
ÉÉ0 1
exceptIO
ÉÉ2 :
,
ÉÉ: ;
$str
ÉÉ< X
+
ÉÉY Z
port
ÉÉ[ _
.
ÉÉ_ `
ToString
ÉÉ` h
(
ÉÉh i
)
ÉÉi j
)
ÉÉj k
;
ÉÉk l
}
ÑÑ 
finally
ÖÖ 
{
ÜÜ 
try
áá 
{
àà 
if
ââ 
(
ââ 
streamOutput
ââ $
!=
ââ% '
null
ââ( ,
)
ââ, -
{
ää 
streamOutput
ãã $
.
ãã$ %
Close
ãã% *
(
ãã* +
)
ãã+ ,
;
ãã, -
}
åå 
}
çç 
catch
éé 
(
éé 
IOException
éé "
exceptIO
éé# +
)
éé+ ,
{
èè 
IO
êê 
.
êê 
Logger
êê 
.
êê 
Log
êê !
(
êê! "
NLog
êê" &
.
êê& '
LogLevel
êê' /
.
êê/ 0
Warn
êê0 4
,
êê4 5
exceptIO
êê6 >
,
êê> ?
$str
êê@ W
)
êêW X
;
êêX Y
}
ëë 
try
ìì 
{
îî 
if
ïï 
(
ïï 
tcpConn
ïï 
!=
ïï  "
null
ïï# '
)
ïï' (
{
ññ 
tcpConn
óó 
.
óó  
Close
óó  %
(
óó% &
)
óó& '
;
óó' (
}
òò 
}
ôô 
catch
öö 
(
öö 
IOException
öö "
exceptIO
öö# +
)
öö+ ,
{
õõ 
IO
úú 
.
úú 
Logger
úú 
.
úú 
Log
úú !
(
úú! "
NLog
úú" &
.
úú& '
LogLevel
úú' /
.
úú/ 0
Warn
úú0 4
,
úú4 5
exceptIO
úú6 >
,
úú> ?
$str
úú@ W
)
úúW X
;
úúX Y
}
ùù 
try
üü 
{
†† 
if
°° 
(
°° 
listener
°°  
!=
°°! #
null
°°$ (
)
°°( )
{
¢¢ 
listener
££  
.
££  !
Stop
££! %
(
££% &
)
££& '
;
££' (
}
§§ 
}
•• 
catch
¶¶ 
(
¶¶ 
IOException
¶¶ "
exceptIO
¶¶# +
)
¶¶+ ,
{
ßß 
IO
®® 
.
®® 
Logger
®® 
.
®® 
Log
®® !
(
®®! "
NLog
®®" &
.
®®& '
LogLevel
®®' /
.
®®/ 0
Warn
®®0 4
,
®®4 5
exceptIO
®®6 >
,
®®> ?
$str
®®@ W
)
®®W X
;
®®X Y
}
©© 
}
´´ 
}
¨¨ 	
}
≠≠ 
private
∞∞ 
void
∞∞ 
Good2
∞∞ 
(
∞∞ 
)
∞∞ 
{
±± 
if
≤≤ 

(
≤≤ 
$num
≤≤ 
==
≤≤ 
$num
≤≤ 
)
≤≤ 
{
≥≥ 	
TcpListener
¥¥ 
listener
¥¥  
=
¥¥! "
null
¥¥# '
;
¥¥' (
	TcpClient
µµ 
tcpConn
µµ 
=
µµ 
null
µµ  $
;
µµ$ %
Stream
∂∂ 
streamOutput
∂∂ 
=
∂∂  !
null
∂∂" &
;
∂∂& '
int
∑∑ 
port
∑∑ 
=
∑∑ 
$num
∑∑ 
;
∑∑ 
try
∏∏ 
{
ππ 
listener
∫∫ 
=
∫∫ 
new
∫∫ 
TcpListener
∫∫ *
(
∫∫* +
	IPAddress
∫∫+ 4
.
∫∫4 5
Parse
∫∫5 :
(
∫∫: ;
$str
∫∫; G
)
∫∫G H
,
∫∫H I
port
∫∫J N
)
∫∫N O
;
∫∫O P
listener
ªª 
.
ªª 
Start
ªª 
(
ªª 
)
ªª  
;
ªª  !
tcpConn
ºº 
=
ºº 
listener
ºº "
.
ºº" #
AcceptTcpClient
ºº# 2
(
ºº2 3
)
ºº3 4
;
ºº4 5
streamOutput
ΩΩ 
=
ΩΩ 
tcpConn
ΩΩ &
.
ΩΩ& '
	GetStream
ΩΩ' 0
(
ΩΩ0 1
)
ΩΩ1 2
;
ΩΩ2 3

IPEndPoint
ææ 
endPoint
ææ #
=
ææ$ %
(
ææ& '

IPEndPoint
ææ' 1
)
ææ1 2
tcpConn
ææ2 9
.
ææ9 :
Client
ææ: @
.
ææ@ A
RemoteEndPoint
ææA O
;
ææO P
	IPAddress
øø 
	ipAddress
øø #
=
øø$ %
endPoint
øø& .
.
øø. /
Address
øø/ 6
;
øø6 7
IPHostEntry
¿¿ 
	hostEntry
¿¿ %
=
¿¿& '
Dns
¿¿( +
.
¿¿+ ,
GetHostEntry
¿¿, 8
(
¿¿8 9
	ipAddress
¿¿9 B
)
¿¿B C
;
¿¿C D
streamOutput
¬¬ 
.
¬¬ 
Write
¬¬ "
(
¬¬" #
Encoding
¬¬# +
.
¬¬+ ,
UTF8
¬¬, 0
.
¬¬0 1
GetBytes
¬¬1 9
(
¬¬9 :
(
¬¬: ;
$str
¬¬; F
+
¬¬G H
	hostEntry
¬¬I R
.
¬¬R S
ToString
¬¬S [
(
¬¬[ \
)
¬¬\ ]
)
¬¬] ^
)
¬¬^ _
,
¬¬_ `
$num
¬¬a b
,
¬¬b c
(
¬¬d e
$str
¬¬e p
+
¬¬q r
	hostEntry
¬¬s |
.
¬¬| }
ToString¬¬} Ö
(¬¬Ö Ü
)¬¬Ü á
)¬¬á à
.¬¬à â
Length¬¬â è
)¬¬è ê
;¬¬ê ë
}
√√ 
catch
ƒƒ 
(
ƒƒ 
IOException
ƒƒ 
exceptIO
ƒƒ '
)
ƒƒ' (
{
≈≈ 
IO
∆∆ 
.
∆∆ 
Logger
∆∆ 
.
∆∆ 
Log
∆∆ 
(
∆∆ 
NLog
∆∆ "
.
∆∆" #
LogLevel
∆∆# +
.
∆∆+ ,
Warn
∆∆, 0
,
∆∆0 1
exceptIO
∆∆2 :
,
∆∆: ;
$str
∆∆< X
+
∆∆Y Z
port
∆∆[ _
.
∆∆_ `
ToString
∆∆` h
(
∆∆h i
)
∆∆i j
)
∆∆j k
;
∆∆k l
}
«« 
finally
»» 
{
…… 
try
   
{
ÀÀ 
if
ÃÃ 
(
ÃÃ 
streamOutput
ÃÃ $
!=
ÃÃ% '
null
ÃÃ( ,
)
ÃÃ, -
{
ÕÕ 
streamOutput
ŒŒ $
.
ŒŒ$ %
Close
ŒŒ% *
(
ŒŒ* +
)
ŒŒ+ ,
;
ŒŒ, -
}
œœ 
}
–– 
catch
—— 
(
—— 
IOException
—— "
exceptIO
——# +
)
——+ ,
{
““ 
IO
”” 
.
”” 
Logger
”” 
.
”” 
Log
”” !
(
””! "
NLog
””" &
.
””& '
LogLevel
””' /
.
””/ 0
Warn
””0 4
,
””4 5
exceptIO
””6 >
,
””> ?
$str
””@ W
)
””W X
;
””X Y
}
‘‘ 
try
÷÷ 
{
◊◊ 
if
ÿÿ 
(
ÿÿ 
tcpConn
ÿÿ 
!=
ÿÿ  "
null
ÿÿ# '
)
ÿÿ' (
{
ŸŸ 
tcpConn
⁄⁄ 
.
⁄⁄  
Close
⁄⁄  %
(
⁄⁄% &
)
⁄⁄& '
;
⁄⁄' (
}
€€ 
}
‹‹ 
catch
›› 
(
›› 
IOException
›› "
exceptIO
››# +
)
››+ ,
{
ﬁﬁ 
IO
ﬂﬂ 
.
ﬂﬂ 
Logger
ﬂﬂ 
.
ﬂﬂ 
Log
ﬂﬂ !
(
ﬂﬂ! "
NLog
ﬂﬂ" &
.
ﬂﬂ& '
LogLevel
ﬂﬂ' /
.
ﬂﬂ/ 0
Warn
ﬂﬂ0 4
,
ﬂﬂ4 5
exceptIO
ﬂﬂ6 >
,
ﬂﬂ> ?
$str
ﬂﬂ@ W
)
ﬂﬂW X
;
ﬂﬂX Y
}
‡‡ 
try
‚‚ 
{
„„ 
if
‰‰ 
(
‰‰ 
listener
‰‰  
!=
‰‰! #
null
‰‰$ (
)
‰‰( )
{
ÂÂ 
listener
ÊÊ  
.
ÊÊ  !
Stop
ÊÊ! %
(
ÊÊ% &
)
ÊÊ& '
;
ÊÊ' (
}
ÁÁ 
}
ËË 
catch
ÈÈ 
(
ÈÈ 
IOException
ÈÈ "
exceptIO
ÈÈ# +
)
ÈÈ+ ,
{
ÍÍ 
IO
ÎÎ 
.
ÎÎ 
Logger
ÎÎ 
.
ÎÎ 
Log
ÎÎ !
(
ÎÎ! "
NLog
ÎÎ" &
.
ÎÎ& '
LogLevel
ÎÎ' /
.
ÎÎ/ 0
Warn
ÎÎ0 4
,
ÎÎ4 5
exceptIO
ÎÎ6 >
,
ÎÎ> ?
$str
ÎÎ@ W
)
ÎÎW X
;
ÎÎX Y
}
ÏÏ 
}
ÓÓ 
}
ÔÔ 	
}
 
public
ÚÚ 

override
ÚÚ 
void
ÚÚ 
Good
ÚÚ 
(
ÚÚ 
)
ÚÚ 
{
ÛÛ 
Good1
ÙÙ 
(
ÙÙ 
)
ÙÙ 
;
ÙÙ 
Good2
ıı 
(
ıı 
)
ıı 
;
ıı 
}
ˆˆ 
}¯¯ 
}˘˘ ◊å
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__ip_based_logic_04.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__ip_based_logic_04 (
:) *
AbstractTestCase+ ;
{ 
private   
const   
bool   
PRIVATE_CONST_TRUE   )
=  * +
true  , 0
;  0 1
private!! 
const!! 
bool!! 
PRIVATE_CONST_FALSE!! *
=!!+ ,
false!!- 2
;!!2 3
public## 

override## 
void## 
Bad## 
(## 
)## 
{$$ 
if%% 

(%% 
PRIVATE_CONST_TRUE%% 
)%% 
{&& 	
TcpListener'' 
listener''  
=''! "
null''# '
;''' (
	TcpClient(( 
tcpConn(( 
=(( 
null((  $
;(($ %
Stream)) 
streamOutput)) 
=))  !
null))" &
;))& '
int** 
port** 
=** 
$num** 
;** 
try++ 
{,, 
listener-- 
=-- 
new-- 
TcpListener-- *
(--* +
	IPAddress--+ 4
.--4 5
Parse--5 :
(--: ;
$str--; G
)--G H
,--H I
port--J N
)--N O
;--O P
listener.. 
... 
Start.. 
(.. 
)..  
;..  !
tcpConn// 
=// 
listener// "
.//" #
AcceptTcpClient//# 2
(//2 3
)//3 4
;//4 5

IPEndPoint11 
endPoint11 #
=11$ %
(11& '

IPEndPoint11' 1
)111 2
tcpConn112 9
.119 :
Client11: @
.11@ A
RemoteEndPoint11A O
;11O P
	IPAddress22 
	ipAddress22 #
=22$ %
endPoint22& .
.22. /
Address22/ 6
;226 7
IPHostEntry33 
	hostEntry33 %
=33& '
Dns33( +
.33+ ,
GetHostEntry33, 8
(338 9
	ipAddress339 B
)33B C
;33C D
if44 
(44 
	hostEntry44 
.44 
Equals44 $
(44$ %
$str44% 5
)445 6
)446 7
{55 
streamOutput66  
=66! "
tcpConn66# *
.66* +
	GetStream66+ 4
(664 5
)665 6
;666 7
streamOutput77  
.77  !
Write77! &
(77& '
Encoding77' /
.77/ 0
UTF8770 4
.774 5
GetBytes775 =
(77= >
$str77> O
)77O P
,77P Q
$num77R S
,77S T
$str77U f
.77f g
Length77g m
)77m n
;77n o
}88 
else99 
{:: 
streamOutput;;  
=;;! "
tcpConn;;# *
.;;* +
	GetStream;;+ 4
(;;4 5
);;5 6
;;;6 7
streamOutput<<  
.<<  !
Write<<! &
(<<& '
Encoding<<' /
.<</ 0
UTF8<<0 4
.<<4 5
GetBytes<<5 =
(<<= >
$str<<> N
)<<N O
,<<O P
$num<<Q R
,<<R S
$str<<T d
.<<d e
Length<<e k
)<<k l
;<<l m
}== 
}>> 
catch?? 
(?? 
IOException?? 
exceptIO?? '
)??' (
{@@ 
IOAA 
.AA 
LoggerAA 
.AA 
LogAA 
(AA 
NLogAA "
.AA" #
LogLevelAA# +
.AA+ ,
WarnAA, 0
,AA0 1
exceptIOAA2 :
,AA: ;
$strAA< X
+AAY Z
portAA[ _
.AA_ `
ToStringAA` h
(AAh i
)AAi j
)AAj k
;AAk l
}BB 
finallyCC 
{DD 
tryEE 
{FF 
ifGG 
(GG 
streamOutputGG $
!=GG% '
nullGG( ,
)GG, -
{HH 
streamOutputII $
.II$ %
CloseII% *
(II* +
)II+ ,
;II, -
}JJ 
}KK 
catchLL 
(LL 
IOExceptionLL "
exceptIOLL# +
)LL+ ,
{MM 
IONN 
.NN 
LoggerNN 
.NN 
LogNN !
(NN! "
NLogNN" &
.NN& '
LogLevelNN' /
.NN/ 0
WarnNN0 4
,NN4 5
exceptIONN6 >
,NN> ?
$strNN@ W
)NNW X
;NNX Y
}OO 
tryQQ 
{RR 
ifSS 
(SS 
tcpConnSS 
!=SS  "
nullSS# '
)SS' (
{TT 
tcpConnUU 
.UU  
CloseUU  %
(UU% &
)UU& '
;UU' (
}VV 
}WW 
catchXX 
(XX 
IOExceptionXX "
exceptIOXX# +
)XX+ ,
{YY 
IOZZ 
.ZZ 
LoggerZZ 
.ZZ 
LogZZ !
(ZZ! "
NLogZZ" &
.ZZ& '
LogLevelZZ' /
.ZZ/ 0
WarnZZ0 4
,ZZ4 5
exceptIOZZ6 >
,ZZ> ?
$strZZ@ W
)ZZW X
;ZZX Y
}[[ 
try]] 
{^^ 
if__ 
(__ 
listener__  
!=__! #
null__$ (
)__( )
{`` 
listeneraa  
.aa  !
Stopaa! %
(aa% &
)aa& '
;aa' (
}bb 
}cc 
catchdd 
(dd 
IOExceptiondd "
exceptIOdd# +
)dd+ ,
{ee 
IOff 
.ff 
Loggerff 
.ff 
Logff !
(ff! "
NLogff" &
.ff& '
LogLevelff' /
.ff/ 0
Warnff0 4
,ff4 5
exceptIOff6 >
,ff> ?
$strff@ W
)ffW X
;ffX Y
}gg 
}hh 
}ii 	
}jj 
privatenn 
voidnn 
Good1nn 
(nn 
)nn 
{oo 
ifpp 

(pp 
PRIVATE_CONST_FALSEpp 
)pp  
{qq 	
IOss 
.ss 
	WriteLiness 
(ss 
$strss /
)ss/ 0
;ss0 1
}tt 	
elseuu 
{vv 	
TcpListenerww 
listenerww  
=ww! "
nullww# '
;ww' (
	TcpClientxx 
tcpConnxx 
=xx 
nullxx  $
;xx$ %
Streamyy 
streamOutputyy 
=yy  !
nullyy" &
;yy& '
intzz 
portzz 
=zz 
$numzz 
;zz 
try{{ 
{|| 
listener}} 
=}} 
new}} 
TcpListener}} *
(}}* +
	IPAddress}}+ 4
.}}4 5
Parse}}5 :
(}}: ;
$str}}; G
)}}G H
,}}H I
port}}J N
)}}N O
;}}O P
listener~~ 
.~~ 
Start~~ 
(~~ 
)~~  
;~~  !
tcpConn 
= 
listener "
." #
AcceptTcpClient# 2
(2 3
)3 4
;4 5
streamOutput
ÄÄ 
=
ÄÄ 
tcpConn
ÄÄ &
.
ÄÄ& '
	GetStream
ÄÄ' 0
(
ÄÄ0 1
)
ÄÄ1 2
;
ÄÄ2 3

IPEndPoint
ÅÅ 
endPoint
ÅÅ #
=
ÅÅ$ %
(
ÅÅ& '

IPEndPoint
ÅÅ' 1
)
ÅÅ1 2
tcpConn
ÅÅ2 9
.
ÅÅ9 :
Client
ÅÅ: @
.
ÅÅ@ A
RemoteEndPoint
ÅÅA O
;
ÅÅO P
	IPAddress
ÇÇ 
	ipAddress
ÇÇ #
=
ÇÇ$ %
endPoint
ÇÇ& .
.
ÇÇ. /
Address
ÇÇ/ 6
;
ÇÇ6 7
IPHostEntry
ÉÉ 
	hostEntry
ÉÉ %
=
ÉÉ& '
Dns
ÉÉ( +
.
ÉÉ+ ,
GetHostEntry
ÉÉ, 8
(
ÉÉ8 9
	ipAddress
ÉÉ9 B
)
ÉÉB C
;
ÉÉC D
streamOutput
ÖÖ 
.
ÖÖ 
Write
ÖÖ "
(
ÖÖ" #
Encoding
ÖÖ# +
.
ÖÖ+ ,
UTF8
ÖÖ, 0
.
ÖÖ0 1
GetBytes
ÖÖ1 9
(
ÖÖ9 :
(
ÖÖ: ;
$str
ÖÖ; F
+
ÖÖG H
	hostEntry
ÖÖI R
.
ÖÖR S
ToString
ÖÖS [
(
ÖÖ[ \
)
ÖÖ\ ]
)
ÖÖ] ^
)
ÖÖ^ _
,
ÖÖ_ `
$num
ÖÖa b
,
ÖÖb c
(
ÖÖd e
$str
ÖÖe p
+
ÖÖq r
	hostEntry
ÖÖs |
.
ÖÖ| }
ToStringÖÖ} Ö
(ÖÖÖ Ü
)ÖÖÜ á
)ÖÖá à
.ÖÖà â
LengthÖÖâ è
)ÖÖè ê
;ÖÖê ë
}
ÜÜ 
catch
áá 
(
áá 
IOException
áá 
exceptIO
áá '
)
áá' (
{
àà 
IO
ââ 
.
ââ 
Logger
ââ 
.
ââ 
Log
ââ 
(
ââ 
NLog
ââ "
.
ââ" #
LogLevel
ââ# +
.
ââ+ ,
Warn
ââ, 0
,
ââ0 1
exceptIO
ââ2 :
,
ââ: ;
$str
ââ< X
+
ââY Z
port
ââ[ _
.
ââ_ `
ToString
ââ` h
(
ââh i
)
ââi j
)
ââj k
;
ââk l
}
ää 
finally
ãã 
{
åå 
try
çç 
{
éé 
if
èè 
(
èè 
streamOutput
èè $
!=
èè% '
null
èè( ,
)
èè, -
{
êê 
streamOutput
ëë $
.
ëë$ %
Close
ëë% *
(
ëë* +
)
ëë+ ,
;
ëë, -
}
íí 
}
ìì 
catch
îî 
(
îî 
IOException
îî "
exceptIO
îî# +
)
îî+ ,
{
ïï 
IO
ññ 
.
ññ 
Logger
ññ 
.
ññ 
Log
ññ !
(
ññ! "
NLog
ññ" &
.
ññ& '
LogLevel
ññ' /
.
ññ/ 0
Warn
ññ0 4
,
ññ4 5
exceptIO
ññ6 >
,
ññ> ?
$str
ññ@ W
)
ññW X
;
ññX Y
}
óó 
try
ôô 
{
öö 
if
õõ 
(
õõ 
tcpConn
õõ 
!=
õõ  "
null
õõ# '
)
õõ' (
{
úú 
tcpConn
ùù 
.
ùù  
Close
ùù  %
(
ùù% &
)
ùù& '
;
ùù' (
}
ûû 
}
üü 
catch
†† 
(
†† 
IOException
†† "
exceptIO
††# +
)
††+ ,
{
°° 
IO
¢¢ 
.
¢¢ 
Logger
¢¢ 
.
¢¢ 
Log
¢¢ !
(
¢¢! "
NLog
¢¢" &
.
¢¢& '
LogLevel
¢¢' /
.
¢¢/ 0
Warn
¢¢0 4
,
¢¢4 5
exceptIO
¢¢6 >
,
¢¢> ?
$str
¢¢@ W
)
¢¢W X
;
¢¢X Y
}
££ 
try
•• 
{
¶¶ 
if
ßß 
(
ßß 
listener
ßß  
!=
ßß! #
null
ßß$ (
)
ßß( )
{
®® 
listener
©©  
.
©©  !
Stop
©©! %
(
©©% &
)
©©& '
;
©©' (
}
™™ 
}
´´ 
catch
¨¨ 
(
¨¨ 
IOException
¨¨ "
exceptIO
¨¨# +
)
¨¨+ ,
{
≠≠ 
IO
ÆÆ 
.
ÆÆ 
Logger
ÆÆ 
.
ÆÆ 
Log
ÆÆ !
(
ÆÆ! "
NLog
ÆÆ" &
.
ÆÆ& '
LogLevel
ÆÆ' /
.
ÆÆ/ 0
Warn
ÆÆ0 4
,
ÆÆ4 5
exceptIO
ÆÆ6 >
,
ÆÆ> ?
$str
ÆÆ@ W
)
ÆÆW X
;
ÆÆX Y
}
ØØ 
}
±± 
}
≤≤ 	
}
≥≥ 
private
∂∂ 
void
∂∂ 
Good2
∂∂ 
(
∂∂ 
)
∂∂ 
{
∑∑ 
if
∏∏ 

(
∏∏  
PRIVATE_CONST_TRUE
∏∏ 
)
∏∏ 
{
ππ 	
TcpListener
∫∫ 
listener
∫∫  
=
∫∫! "
null
∫∫# '
;
∫∫' (
	TcpClient
ªª 
tcpConn
ªª 
=
ªª 
null
ªª  $
;
ªª$ %
Stream
ºº 
streamOutput
ºº 
=
ºº  !
null
ºº" &
;
ºº& '
int
ΩΩ 
port
ΩΩ 
=
ΩΩ 
$num
ΩΩ 
;
ΩΩ 
try
ææ 
{
øø 
listener
¿¿ 
=
¿¿ 
new
¿¿ 
TcpListener
¿¿ *
(
¿¿* +
	IPAddress
¿¿+ 4
.
¿¿4 5
Parse
¿¿5 :
(
¿¿: ;
$str
¿¿; G
)
¿¿G H
,
¿¿H I
port
¿¿J N
)
¿¿N O
;
¿¿O P
listener
¡¡ 
.
¡¡ 
Start
¡¡ 
(
¡¡ 
)
¡¡  
;
¡¡  !
tcpConn
¬¬ 
=
¬¬ 
listener
¬¬ "
.
¬¬" #
AcceptTcpClient
¬¬# 2
(
¬¬2 3
)
¬¬3 4
;
¬¬4 5
streamOutput
√√ 
=
√√ 
tcpConn
√√ &
.
√√& '
	GetStream
√√' 0
(
√√0 1
)
√√1 2
;
√√2 3

IPEndPoint
ƒƒ 
endPoint
ƒƒ #
=
ƒƒ$ %
(
ƒƒ& '

IPEndPoint
ƒƒ' 1
)
ƒƒ1 2
tcpConn
ƒƒ2 9
.
ƒƒ9 :
Client
ƒƒ: @
.
ƒƒ@ A
RemoteEndPoint
ƒƒA O
;
ƒƒO P
	IPAddress
≈≈ 
	ipAddress
≈≈ #
=
≈≈$ %
endPoint
≈≈& .
.
≈≈. /
Address
≈≈/ 6
;
≈≈6 7
IPHostEntry
∆∆ 
	hostEntry
∆∆ %
=
∆∆& '
Dns
∆∆( +
.
∆∆+ ,
GetHostEntry
∆∆, 8
(
∆∆8 9
	ipAddress
∆∆9 B
)
∆∆B C
;
∆∆C D
streamOutput
»» 
.
»» 
Write
»» "
(
»»" #
Encoding
»»# +
.
»»+ ,
UTF8
»», 0
.
»»0 1
GetBytes
»»1 9
(
»»9 :
(
»»: ;
$str
»»; F
+
»»G H
	hostEntry
»»I R
.
»»R S
ToString
»»S [
(
»»[ \
)
»»\ ]
)
»»] ^
)
»»^ _
,
»»_ `
$num
»»a b
,
»»b c
(
»»d e
$str
»»e p
+
»»q r
	hostEntry
»»s |
.
»»| }
ToString»»} Ö
(»»Ö Ü
)»»Ü á
)»»á à
.»»à â
Length»»â è
)»»è ê
;»»ê ë
}
…… 
catch
   
(
   
IOException
   
exceptIO
   '
)
  ' (
{
ÀÀ 
IO
ÃÃ 
.
ÃÃ 
Logger
ÃÃ 
.
ÃÃ 
Log
ÃÃ 
(
ÃÃ 
NLog
ÃÃ "
.
ÃÃ" #
LogLevel
ÃÃ# +
.
ÃÃ+ ,
Warn
ÃÃ, 0
,
ÃÃ0 1
exceptIO
ÃÃ2 :
,
ÃÃ: ;
$str
ÃÃ< X
+
ÃÃY Z
port
ÃÃ[ _
.
ÃÃ_ `
ToString
ÃÃ` h
(
ÃÃh i
)
ÃÃi j
)
ÃÃj k
;
ÃÃk l
}
ÕÕ 
finally
ŒŒ 
{
œœ 
try
–– 
{
—— 
if
““ 
(
““ 
streamOutput
““ $
!=
““% '
null
““( ,
)
““, -
{
”” 
streamOutput
‘‘ $
.
‘‘$ %
Close
‘‘% *
(
‘‘* +
)
‘‘+ ,
;
‘‘, -
}
’’ 
}
÷÷ 
catch
◊◊ 
(
◊◊ 
IOException
◊◊ "
exceptIO
◊◊# +
)
◊◊+ ,
{
ÿÿ 
IO
ŸŸ 
.
ŸŸ 
Logger
ŸŸ 
.
ŸŸ 
Log
ŸŸ !
(
ŸŸ! "
NLog
ŸŸ" &
.
ŸŸ& '
LogLevel
ŸŸ' /
.
ŸŸ/ 0
Warn
ŸŸ0 4
,
ŸŸ4 5
exceptIO
ŸŸ6 >
,
ŸŸ> ?
$str
ŸŸ@ W
)
ŸŸW X
;
ŸŸX Y
}
⁄⁄ 
try
‹‹ 
{
›› 
if
ﬁﬁ 
(
ﬁﬁ 
tcpConn
ﬁﬁ 
!=
ﬁﬁ  "
null
ﬁﬁ# '
)
ﬁﬁ' (
{
ﬂﬂ 
tcpConn
‡‡ 
.
‡‡  
Close
‡‡  %
(
‡‡% &
)
‡‡& '
;
‡‡' (
}
·· 
}
‚‚ 
catch
„„ 
(
„„ 
IOException
„„ "
exceptIO
„„# +
)
„„+ ,
{
‰‰ 
IO
ÂÂ 
.
ÂÂ 
Logger
ÂÂ 
.
ÂÂ 
Log
ÂÂ !
(
ÂÂ! "
NLog
ÂÂ" &
.
ÂÂ& '
LogLevel
ÂÂ' /
.
ÂÂ/ 0
Warn
ÂÂ0 4
,
ÂÂ4 5
exceptIO
ÂÂ6 >
,
ÂÂ> ?
$str
ÂÂ@ W
)
ÂÂW X
;
ÂÂX Y
}
ÊÊ 
try
ËË 
{
ÈÈ 
if
ÍÍ 
(
ÍÍ 
listener
ÍÍ  
!=
ÍÍ! #
null
ÍÍ$ (
)
ÍÍ( )
{
ÎÎ 
listener
ÏÏ  
.
ÏÏ  !
Stop
ÏÏ! %
(
ÏÏ% &
)
ÏÏ& '
;
ÏÏ' (
}
ÌÌ 
}
ÓÓ 
catch
ÔÔ 
(
ÔÔ 
IOException
ÔÔ "
exceptIO
ÔÔ# +
)
ÔÔ+ ,
{
 
IO
ÒÒ 
.
ÒÒ 
Logger
ÒÒ 
.
ÒÒ 
Log
ÒÒ !
(
ÒÒ! "
NLog
ÒÒ" &
.
ÒÒ& '
LogLevel
ÒÒ' /
.
ÒÒ/ 0
Warn
ÒÒ0 4
,
ÒÒ4 5
exceptIO
ÒÒ6 >
,
ÒÒ> ?
$str
ÒÒ@ W
)
ÒÒW X
;
ÒÒX Y
}
ÚÚ 
}
ÙÙ 
}
ıı 	
}
ˆˆ 
public
¯¯ 

override
¯¯ 
void
¯¯ 
Good
¯¯ 
(
¯¯ 
)
¯¯ 
{
˘˘ 
Good1
˙˙ 
(
˙˙ 
)
˙˙ 
;
˙˙ 
Good2
˚˚ 
(
˚˚ 
)
˚˚ 
;
˚˚ 
}
¸¸ 
}˛˛ 
}ˇˇ éå
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__ip_based_logic_05.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__ip_based_logic_05 (
:) *
AbstractTestCase+ ;
{ 
private   
bool   
privateTrue   
=   
true   #
;  # $
private!! 
bool!! 
privateFalse!! 
=!! 
false!!  %
;!!% &
public## 

override## 
void## 
Bad## 
(## 
)## 
{$$ 
if%% 

(%% 
privateTrue%% 
)%% 
{&& 	
TcpListener'' 
listener''  
=''! "
null''# '
;''' (
	TcpClient(( 
tcpConn(( 
=(( 
null((  $
;(($ %
Stream)) 
streamOutput)) 
=))  !
null))" &
;))& '
int** 
port** 
=** 
$num** 
;** 
try++ 
{,, 
listener-- 
=-- 
new-- 
TcpListener-- *
(--* +
	IPAddress--+ 4
.--4 5
Parse--5 :
(--: ;
$str--; G
)--G H
,--H I
port--J N
)--N O
;--O P
listener.. 
... 
Start.. 
(.. 
)..  
;..  !
tcpConn// 
=// 
listener// "
.//" #
AcceptTcpClient//# 2
(//2 3
)//3 4
;//4 5

IPEndPoint11 
endPoint11 #
=11$ %
(11& '

IPEndPoint11' 1
)111 2
tcpConn112 9
.119 :
Client11: @
.11@ A
RemoteEndPoint11A O
;11O P
	IPAddress22 
	ipAddress22 #
=22$ %
endPoint22& .
.22. /
Address22/ 6
;226 7
IPHostEntry33 
	hostEntry33 %
=33& '
Dns33( +
.33+ ,
GetHostEntry33, 8
(338 9
	ipAddress339 B
)33B C
;33C D
if44 
(44 
	hostEntry44 
.44 
Equals44 $
(44$ %
$str44% 5
)445 6
)446 7
{55 
streamOutput66  
=66! "
tcpConn66# *
.66* +
	GetStream66+ 4
(664 5
)665 6
;666 7
streamOutput77  
.77  !
Write77! &
(77& '
Encoding77' /
.77/ 0
UTF8770 4
.774 5
GetBytes775 =
(77= >
$str77> O
)77O P
,77P Q
$num77R S
,77S T
$str77U f
.77f g
Length77g m
)77m n
;77n o
}88 
else99 
{:: 
streamOutput;;  
=;;! "
tcpConn;;# *
.;;* +
	GetStream;;+ 4
(;;4 5
);;5 6
;;;6 7
streamOutput<<  
.<<  !
Write<<! &
(<<& '
Encoding<<' /
.<</ 0
UTF8<<0 4
.<<4 5
GetBytes<<5 =
(<<= >
$str<<> N
)<<N O
,<<O P
$num<<Q R
,<<R S
$str<<T d
.<<d e
Length<<e k
)<<k l
;<<l m
}== 
}>> 
catch?? 
(?? 
IOException?? 
exceptIO?? '
)??' (
{@@ 
IOAA 
.AA 
LoggerAA 
.AA 
LogAA 
(AA 
NLogAA "
.AA" #
LogLevelAA# +
.AA+ ,
WarnAA, 0
,AA0 1
exceptIOAA2 :
,AA: ;
$strAA< X
+AAY Z
portAA[ _
.AA_ `
ToStringAA` h
(AAh i
)AAi j
)AAj k
;AAk l
}BB 
finallyCC 
{DD 
tryEE 
{FF 
ifGG 
(GG 
streamOutputGG $
!=GG% '
nullGG( ,
)GG, -
{HH 
streamOutputII $
.II$ %
CloseII% *
(II* +
)II+ ,
;II, -
}JJ 
}KK 
catchLL 
(LL 
IOExceptionLL "
exceptIOLL# +
)LL+ ,
{MM 
IONN 
.NN 
LoggerNN 
.NN 
LogNN !
(NN! "
NLogNN" &
.NN& '
LogLevelNN' /
.NN/ 0
WarnNN0 4
,NN4 5
exceptIONN6 >
,NN> ?
$strNN@ W
)NNW X
;NNX Y
}OO 
tryQQ 
{RR 
ifSS 
(SS 
tcpConnSS 
!=SS  "
nullSS# '
)SS' (
{TT 
tcpConnUU 
.UU  
CloseUU  %
(UU% &
)UU& '
;UU' (
}VV 
}WW 
catchXX 
(XX 
IOExceptionXX "
exceptIOXX# +
)XX+ ,
{YY 
IOZZ 
.ZZ 
LoggerZZ 
.ZZ 
LogZZ !
(ZZ! "
NLogZZ" &
.ZZ& '
LogLevelZZ' /
.ZZ/ 0
WarnZZ0 4
,ZZ4 5
exceptIOZZ6 >
,ZZ> ?
$strZZ@ W
)ZZW X
;ZZX Y
}[[ 
try]] 
{^^ 
if__ 
(__ 
listener__  
!=__! #
null__$ (
)__( )
{`` 
listeneraa  
.aa  !
Stopaa! %
(aa% &
)aa& '
;aa' (
}bb 
}cc 
catchdd 
(dd 
IOExceptiondd "
exceptIOdd# +
)dd+ ,
{ee 
IOff 
.ff 
Loggerff 
.ff 
Logff !
(ff! "
NLogff" &
.ff& '
LogLevelff' /
.ff/ 0
Warnff0 4
,ff4 5
exceptIOff6 >
,ff> ?
$strff@ W
)ffW X
;ffX Y
}gg 
}hh 
}ii 	
}jj 
privatenn 
voidnn 
Good1nn 
(nn 
)nn 
{oo 
ifpp 

(pp 
privateFalsepp 
)pp 
{qq 	
IOss 
.ss 
	WriteLiness 
(ss 
$strss /
)ss/ 0
;ss0 1
}tt 	
elseuu 
{vv 	
TcpListenerww 
listenerww  
=ww! "
nullww# '
;ww' (
	TcpClientxx 
tcpConnxx 
=xx 
nullxx  $
;xx$ %
Streamyy 
streamOutputyy 
=yy  !
nullyy" &
;yy& '
intzz 
portzz 
=zz 
$numzz 
;zz 
try{{ 
{|| 
listener}} 
=}} 
new}} 
TcpListener}} *
(}}* +
	IPAddress}}+ 4
.}}4 5
Parse}}5 :
(}}: ;
$str}}; G
)}}G H
,}}H I
port}}J N
)}}N O
;}}O P
listener~~ 
.~~ 
Start~~ 
(~~ 
)~~  
;~~  !
tcpConn 
= 
listener "
." #
AcceptTcpClient# 2
(2 3
)3 4
;4 5
streamOutput
ÄÄ 
=
ÄÄ 
tcpConn
ÄÄ &
.
ÄÄ& '
	GetStream
ÄÄ' 0
(
ÄÄ0 1
)
ÄÄ1 2
;
ÄÄ2 3

IPEndPoint
ÅÅ 
endPoint
ÅÅ #
=
ÅÅ$ %
(
ÅÅ& '

IPEndPoint
ÅÅ' 1
)
ÅÅ1 2
tcpConn
ÅÅ2 9
.
ÅÅ9 :
Client
ÅÅ: @
.
ÅÅ@ A
RemoteEndPoint
ÅÅA O
;
ÅÅO P
	IPAddress
ÇÇ 
	ipAddress
ÇÇ #
=
ÇÇ$ %
endPoint
ÇÇ& .
.
ÇÇ. /
Address
ÇÇ/ 6
;
ÇÇ6 7
IPHostEntry
ÉÉ 
	hostEntry
ÉÉ %
=
ÉÉ& '
Dns
ÉÉ( +
.
ÉÉ+ ,
GetHostEntry
ÉÉ, 8
(
ÉÉ8 9
	ipAddress
ÉÉ9 B
)
ÉÉB C
;
ÉÉC D
streamOutput
ÖÖ 
.
ÖÖ 
Write
ÖÖ "
(
ÖÖ" #
Encoding
ÖÖ# +
.
ÖÖ+ ,
UTF8
ÖÖ, 0
.
ÖÖ0 1
GetBytes
ÖÖ1 9
(
ÖÖ9 :
(
ÖÖ: ;
$str
ÖÖ; F
+
ÖÖG H
	hostEntry
ÖÖI R
.
ÖÖR S
ToString
ÖÖS [
(
ÖÖ[ \
)
ÖÖ\ ]
)
ÖÖ] ^
)
ÖÖ^ _
,
ÖÖ_ `
$num
ÖÖa b
,
ÖÖb c
(
ÖÖd e
$str
ÖÖe p
+
ÖÖq r
	hostEntry
ÖÖs |
.
ÖÖ| }
ToStringÖÖ} Ö
(ÖÖÖ Ü
)ÖÖÜ á
)ÖÖá à
.ÖÖà â
LengthÖÖâ è
)ÖÖè ê
;ÖÖê ë
}
ÜÜ 
catch
áá 
(
áá 
IOException
áá 
exceptIO
áá '
)
áá' (
{
àà 
IO
ââ 
.
ââ 
Logger
ââ 
.
ââ 
Log
ââ 
(
ââ 
NLog
ââ "
.
ââ" #
LogLevel
ââ# +
.
ââ+ ,
Warn
ââ, 0
,
ââ0 1
exceptIO
ââ2 :
,
ââ: ;
$str
ââ< X
+
ââY Z
port
ââ[ _
.
ââ_ `
ToString
ââ` h
(
ââh i
)
ââi j
)
ââj k
;
ââk l
}
ää 
finally
ãã 
{
åå 
try
çç 
{
éé 
if
èè 
(
èè 
streamOutput
èè $
!=
èè% '
null
èè( ,
)
èè, -
{
êê 
streamOutput
ëë $
.
ëë$ %
Close
ëë% *
(
ëë* +
)
ëë+ ,
;
ëë, -
}
íí 
}
ìì 
catch
îî 
(
îî 
IOException
îî "
exceptIO
îî# +
)
îî+ ,
{
ïï 
IO
ññ 
.
ññ 
Logger
ññ 
.
ññ 
Log
ññ !
(
ññ! "
NLog
ññ" &
.
ññ& '
LogLevel
ññ' /
.
ññ/ 0
Warn
ññ0 4
,
ññ4 5
exceptIO
ññ6 >
,
ññ> ?
$str
ññ@ W
)
ññW X
;
ññX Y
}
óó 
try
ôô 
{
öö 
if
õõ 
(
õõ 
tcpConn
õõ 
!=
õõ  "
null
õõ# '
)
õõ' (
{
úú 
tcpConn
ùù 
.
ùù  
Close
ùù  %
(
ùù% &
)
ùù& '
;
ùù' (
}
ûû 
}
üü 
catch
†† 
(
†† 
IOException
†† "
exceptIO
††# +
)
††+ ,
{
°° 
IO
¢¢ 
.
¢¢ 
Logger
¢¢ 
.
¢¢ 
Log
¢¢ !
(
¢¢! "
NLog
¢¢" &
.
¢¢& '
LogLevel
¢¢' /
.
¢¢/ 0
Warn
¢¢0 4
,
¢¢4 5
exceptIO
¢¢6 >
,
¢¢> ?
$str
¢¢@ W
)
¢¢W X
;
¢¢X Y
}
££ 
try
•• 
{
¶¶ 
if
ßß 
(
ßß 
listener
ßß  
!=
ßß! #
null
ßß$ (
)
ßß( )
{
®® 
listener
©©  
.
©©  !
Stop
©©! %
(
©©% &
)
©©& '
;
©©' (
}
™™ 
}
´´ 
catch
¨¨ 
(
¨¨ 
IOException
¨¨ "
exceptIO
¨¨# +
)
¨¨+ ,
{
≠≠ 
IO
ÆÆ 
.
ÆÆ 
Logger
ÆÆ 
.
ÆÆ 
Log
ÆÆ !
(
ÆÆ! "
NLog
ÆÆ" &
.
ÆÆ& '
LogLevel
ÆÆ' /
.
ÆÆ/ 0
Warn
ÆÆ0 4
,
ÆÆ4 5
exceptIO
ÆÆ6 >
,
ÆÆ> ?
$str
ÆÆ@ W
)
ÆÆW X
;
ÆÆX Y
}
ØØ 
}
±± 
}
≤≤ 	
}
≥≥ 
private
∂∂ 
void
∂∂ 
Good2
∂∂ 
(
∂∂ 
)
∂∂ 
{
∑∑ 
if
∏∏ 

(
∏∏ 
privateTrue
∏∏ 
)
∏∏ 
{
ππ 	
TcpListener
∫∫ 
listener
∫∫  
=
∫∫! "
null
∫∫# '
;
∫∫' (
	TcpClient
ªª 
tcpConn
ªª 
=
ªª 
null
ªª  $
;
ªª$ %
Stream
ºº 
streamOutput
ºº 
=
ºº  !
null
ºº" &
;
ºº& '
int
ΩΩ 
port
ΩΩ 
=
ΩΩ 
$num
ΩΩ 
;
ΩΩ 
try
ææ 
{
øø 
listener
¿¿ 
=
¿¿ 
new
¿¿ 
TcpListener
¿¿ *
(
¿¿* +
	IPAddress
¿¿+ 4
.
¿¿4 5
Parse
¿¿5 :
(
¿¿: ;
$str
¿¿; G
)
¿¿G H
,
¿¿H I
port
¿¿J N
)
¿¿N O
;
¿¿O P
listener
¡¡ 
.
¡¡ 
Start
¡¡ 
(
¡¡ 
)
¡¡  
;
¡¡  !
tcpConn
¬¬ 
=
¬¬ 
listener
¬¬ "
.
¬¬" #
AcceptTcpClient
¬¬# 2
(
¬¬2 3
)
¬¬3 4
;
¬¬4 5
streamOutput
√√ 
=
√√ 
tcpConn
√√ &
.
√√& '
	GetStream
√√' 0
(
√√0 1
)
√√1 2
;
√√2 3

IPEndPoint
ƒƒ 
endPoint
ƒƒ #
=
ƒƒ$ %
(
ƒƒ& '

IPEndPoint
ƒƒ' 1
)
ƒƒ1 2
tcpConn
ƒƒ2 9
.
ƒƒ9 :
Client
ƒƒ: @
.
ƒƒ@ A
RemoteEndPoint
ƒƒA O
;
ƒƒO P
	IPAddress
≈≈ 
	ipAddress
≈≈ #
=
≈≈$ %
endPoint
≈≈& .
.
≈≈. /
Address
≈≈/ 6
;
≈≈6 7
IPHostEntry
∆∆ 
	hostEntry
∆∆ %
=
∆∆& '
Dns
∆∆( +
.
∆∆+ ,
GetHostEntry
∆∆, 8
(
∆∆8 9
	ipAddress
∆∆9 B
)
∆∆B C
;
∆∆C D
streamOutput
»» 
.
»» 
Write
»» "
(
»»" #
Encoding
»»# +
.
»»+ ,
UTF8
»», 0
.
»»0 1
GetBytes
»»1 9
(
»»9 :
(
»»: ;
$str
»»; F
+
»»G H
	hostEntry
»»I R
.
»»R S
ToString
»»S [
(
»»[ \
)
»»\ ]
)
»»] ^
)
»»^ _
,
»»_ `
$num
»»a b
,
»»b c
(
»»d e
$str
»»e p
+
»»q r
	hostEntry
»»s |
.
»»| }
ToString»»} Ö
(»»Ö Ü
)»»Ü á
)»»á à
.»»à â
Length»»â è
)»»è ê
;»»ê ë
}
…… 
catch
   
(
   
IOException
   
exceptIO
   '
)
  ' (
{
ÀÀ 
IO
ÃÃ 
.
ÃÃ 
Logger
ÃÃ 
.
ÃÃ 
Log
ÃÃ 
(
ÃÃ 
NLog
ÃÃ "
.
ÃÃ" #
LogLevel
ÃÃ# +
.
ÃÃ+ ,
Warn
ÃÃ, 0
,
ÃÃ0 1
exceptIO
ÃÃ2 :
,
ÃÃ: ;
$str
ÃÃ< X
+
ÃÃY Z
port
ÃÃ[ _
.
ÃÃ_ `
ToString
ÃÃ` h
(
ÃÃh i
)
ÃÃi j
)
ÃÃj k
;
ÃÃk l
}
ÕÕ 
finally
ŒŒ 
{
œœ 
try
–– 
{
—— 
if
““ 
(
““ 
streamOutput
““ $
!=
““% '
null
““( ,
)
““, -
{
”” 
streamOutput
‘‘ $
.
‘‘$ %
Close
‘‘% *
(
‘‘* +
)
‘‘+ ,
;
‘‘, -
}
’’ 
}
÷÷ 
catch
◊◊ 
(
◊◊ 
IOException
◊◊ "
exceptIO
◊◊# +
)
◊◊+ ,
{
ÿÿ 
IO
ŸŸ 
.
ŸŸ 
Logger
ŸŸ 
.
ŸŸ 
Log
ŸŸ !
(
ŸŸ! "
NLog
ŸŸ" &
.
ŸŸ& '
LogLevel
ŸŸ' /
.
ŸŸ/ 0
Warn
ŸŸ0 4
,
ŸŸ4 5
exceptIO
ŸŸ6 >
,
ŸŸ> ?
$str
ŸŸ@ W
)
ŸŸW X
;
ŸŸX Y
}
⁄⁄ 
try
‹‹ 
{
›› 
if
ﬁﬁ 
(
ﬁﬁ 
tcpConn
ﬁﬁ 
!=
ﬁﬁ  "
null
ﬁﬁ# '
)
ﬁﬁ' (
{
ﬂﬂ 
tcpConn
‡‡ 
.
‡‡  
Close
‡‡  %
(
‡‡% &
)
‡‡& '
;
‡‡' (
}
·· 
}
‚‚ 
catch
„„ 
(
„„ 
IOException
„„ "
exceptIO
„„# +
)
„„+ ,
{
‰‰ 
IO
ÂÂ 
.
ÂÂ 
Logger
ÂÂ 
.
ÂÂ 
Log
ÂÂ !
(
ÂÂ! "
NLog
ÂÂ" &
.
ÂÂ& '
LogLevel
ÂÂ' /
.
ÂÂ/ 0
Warn
ÂÂ0 4
,
ÂÂ4 5
exceptIO
ÂÂ6 >
,
ÂÂ> ?
$str
ÂÂ@ W
)
ÂÂW X
;
ÂÂX Y
}
ÊÊ 
try
ËË 
{
ÈÈ 
if
ÍÍ 
(
ÍÍ 
listener
ÍÍ  
!=
ÍÍ! #
null
ÍÍ$ (
)
ÍÍ( )
{
ÎÎ 
listener
ÏÏ  
.
ÏÏ  !
Stop
ÏÏ! %
(
ÏÏ% &
)
ÏÏ& '
;
ÏÏ' (
}
ÌÌ 
}
ÓÓ 
catch
ÔÔ 
(
ÔÔ 
IOException
ÔÔ "
exceptIO
ÔÔ# +
)
ÔÔ+ ,
{
 
IO
ÒÒ 
.
ÒÒ 
Logger
ÒÒ 
.
ÒÒ 
Log
ÒÒ !
(
ÒÒ! "
NLog
ÒÒ" &
.
ÒÒ& '
LogLevel
ÒÒ' /
.
ÒÒ/ 0
Warn
ÒÒ0 4
,
ÒÒ4 5
exceptIO
ÒÒ6 >
,
ÒÒ> ?
$str
ÒÒ@ W
)
ÒÒW X
;
ÒÒX Y
}
ÚÚ 
}
ÙÙ 
}
ıı 	
}
ˆˆ 
public
¯¯ 

override
¯¯ 
void
¯¯ 
Good
¯¯ 
(
¯¯ 
)
¯¯ 
{
˘˘ 
Good1
˙˙ 
(
˙˙ 
)
˙˙ 
;
˙˙ 
Good2
˚˚ 
(
˚˚ 
)
˚˚ 
;
˚˚ 
}
¸¸ 
}˛˛ 
}ˇˇ £å
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__ip_based_logic_06.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__ip_based_logic_06 (
:) *
AbstractTestCase+ ;
{ 
private   
const   
int   
PRIVATE_CONST_FIVE   (
=  ) *
$num  + ,
;  , -
public"" 

override"" 
void"" 
Bad"" 
("" 
)"" 
{## 
if$$ 

($$ 
PRIVATE_CONST_FIVE$$ 
==$$ !
$num$$" #
)$$# $
{%% 	
TcpListener&& 
listener&&  
=&&! "
null&&# '
;&&' (
	TcpClient'' 
tcpConn'' 
='' 
null''  $
;''$ %
Stream(( 
streamOutput(( 
=((  !
null((" &
;((& '
int)) 
port)) 
=)) 
$num)) 
;)) 
try** 
{++ 
listener,, 
=,, 
new,, 
TcpListener,, *
(,,* +
	IPAddress,,+ 4
.,,4 5
Parse,,5 :
(,,: ;
$str,,; G
),,G H
,,,H I
port,,J N
),,N O
;,,O P
listener-- 
.-- 
Start-- 
(-- 
)--  
;--  !
tcpConn.. 
=.. 
listener.. "
..." #
AcceptTcpClient..# 2
(..2 3
)..3 4
;..4 5

IPEndPoint00 
endPoint00 #
=00$ %
(00& '

IPEndPoint00' 1
)001 2
tcpConn002 9
.009 :
Client00: @
.00@ A
RemoteEndPoint00A O
;00O P
	IPAddress11 
	ipAddress11 #
=11$ %
endPoint11& .
.11. /
Address11/ 6
;116 7
IPHostEntry22 
	hostEntry22 %
=22& '
Dns22( +
.22+ ,
GetHostEntry22, 8
(228 9
	ipAddress229 B
)22B C
;22C D
if33 
(33 
	hostEntry33 
.33 
Equals33 $
(33$ %
$str33% 5
)335 6
)336 7
{44 
streamOutput55  
=55! "
tcpConn55# *
.55* +
	GetStream55+ 4
(554 5
)555 6
;556 7
streamOutput66  
.66  !
Write66! &
(66& '
Encoding66' /
.66/ 0
UTF8660 4
.664 5
GetBytes665 =
(66= >
$str66> O
)66O P
,66P Q
$num66R S
,66S T
$str66U f
.66f g
Length66g m
)66m n
;66n o
}77 
else88 
{99 
streamOutput::  
=::! "
tcpConn::# *
.::* +
	GetStream::+ 4
(::4 5
)::5 6
;::6 7
streamOutput;;  
.;;  !
Write;;! &
(;;& '
Encoding;;' /
.;;/ 0
UTF8;;0 4
.;;4 5
GetBytes;;5 =
(;;= >
$str;;> N
);;N O
,;;O P
$num;;Q R
,;;R S
$str;;T d
.;;d e
Length;;e k
);;k l
;;;l m
}<< 
}== 
catch>> 
(>> 
IOException>> 
exceptIO>> '
)>>' (
{?? 
IO@@ 
.@@ 
Logger@@ 
.@@ 
Log@@ 
(@@ 
NLog@@ "
.@@" #
LogLevel@@# +
.@@+ ,
Warn@@, 0
,@@0 1
exceptIO@@2 :
,@@: ;
$str@@< X
+@@Y Z
port@@[ _
.@@_ `
ToString@@` h
(@@h i
)@@i j
)@@j k
;@@k l
}AA 
finallyBB 
{CC 
tryDD 
{EE 
ifFF 
(FF 
streamOutputFF $
!=FF% '
nullFF( ,
)FF, -
{GG 
streamOutputHH $
.HH$ %
CloseHH% *
(HH* +
)HH+ ,
;HH, -
}II 
}JJ 
catchKK 
(KK 
IOExceptionKK "
exceptIOKK# +
)KK+ ,
{LL 
IOMM 
.MM 
LoggerMM 
.MM 
LogMM !
(MM! "
NLogMM" &
.MM& '
LogLevelMM' /
.MM/ 0
WarnMM0 4
,MM4 5
exceptIOMM6 >
,MM> ?
$strMM@ W
)MMW X
;MMX Y
}NN 
tryPP 
{QQ 
ifRR 
(RR 
tcpConnRR 
!=RR  "
nullRR# '
)RR' (
{SS 
tcpConnTT 
.TT  
CloseTT  %
(TT% &
)TT& '
;TT' (
}UU 
}VV 
catchWW 
(WW 
IOExceptionWW "
exceptIOWW# +
)WW+ ,
{XX 
IOYY 
.YY 
LoggerYY 
.YY 
LogYY !
(YY! "
NLogYY" &
.YY& '
LogLevelYY' /
.YY/ 0
WarnYY0 4
,YY4 5
exceptIOYY6 >
,YY> ?
$strYY@ W
)YYW X
;YYX Y
}ZZ 
try\\ 
{]] 
if^^ 
(^^ 
listener^^  
!=^^! #
null^^$ (
)^^( )
{__ 
listener``  
.``  !
Stop``! %
(``% &
)``& '
;``' (
}aa 
}bb 
catchcc 
(cc 
IOExceptioncc "
exceptIOcc# +
)cc+ ,
{dd 
IOee 
.ee 
Loggeree 
.ee 
Logee !
(ee! "
NLogee" &
.ee& '
LogLevelee' /
.ee/ 0
Warnee0 4
,ee4 5
exceptIOee6 >
,ee> ?
$stree@ W
)eeW X
;eeX Y
}ff 
}gg 
}hh 	
}ii 
privatemm 
voidmm 
Good1mm 
(mm 
)mm 
{nn 
ifoo 

(oo 
PRIVATE_CONST_FIVEoo 
!=oo !
$numoo" #
)oo# $
{pp 	
IOrr 
.rr 
	WriteLinerr 
(rr 
$strrr /
)rr/ 0
;rr0 1
}ss 	
elsett 
{uu 	
TcpListenervv 
listenervv  
=vv! "
nullvv# '
;vv' (
	TcpClientww 
tcpConnww 
=ww 
nullww  $
;ww$ %
Streamxx 
streamOutputxx 
=xx  !
nullxx" &
;xx& '
intyy 
portyy 
=yy 
$numyy 
;yy 
tryzz 
{{{ 
listener|| 
=|| 
new|| 
TcpListener|| *
(||* +
	IPAddress||+ 4
.||4 5
Parse||5 :
(||: ;
$str||; G
)||G H
,||H I
port||J N
)||N O
;||O P
listener}} 
.}} 
Start}} 
(}} 
)}}  
;}}  !
tcpConn~~ 
=~~ 
listener~~ "
.~~" #
AcceptTcpClient~~# 2
(~~2 3
)~~3 4
;~~4 5
streamOutput 
= 
tcpConn &
.& '
	GetStream' 0
(0 1
)1 2
;2 3

IPEndPoint
ÄÄ 
endPoint
ÄÄ #
=
ÄÄ$ %
(
ÄÄ& '

IPEndPoint
ÄÄ' 1
)
ÄÄ1 2
tcpConn
ÄÄ2 9
.
ÄÄ9 :
Client
ÄÄ: @
.
ÄÄ@ A
RemoteEndPoint
ÄÄA O
;
ÄÄO P
	IPAddress
ÅÅ 
	ipAddress
ÅÅ #
=
ÅÅ$ %
endPoint
ÅÅ& .
.
ÅÅ. /
Address
ÅÅ/ 6
;
ÅÅ6 7
IPHostEntry
ÇÇ 
	hostEntry
ÇÇ %
=
ÇÇ& '
Dns
ÇÇ( +
.
ÇÇ+ ,
GetHostEntry
ÇÇ, 8
(
ÇÇ8 9
	ipAddress
ÇÇ9 B
)
ÇÇB C
;
ÇÇC D
streamOutput
ÑÑ 
.
ÑÑ 
Write
ÑÑ "
(
ÑÑ" #
Encoding
ÑÑ# +
.
ÑÑ+ ,
UTF8
ÑÑ, 0
.
ÑÑ0 1
GetBytes
ÑÑ1 9
(
ÑÑ9 :
(
ÑÑ: ;
$str
ÑÑ; F
+
ÑÑG H
	hostEntry
ÑÑI R
.
ÑÑR S
ToString
ÑÑS [
(
ÑÑ[ \
)
ÑÑ\ ]
)
ÑÑ] ^
)
ÑÑ^ _
,
ÑÑ_ `
$num
ÑÑa b
,
ÑÑb c
(
ÑÑd e
$str
ÑÑe p
+
ÑÑq r
	hostEntry
ÑÑs |
.
ÑÑ| }
ToStringÑÑ} Ö
(ÑÑÖ Ü
)ÑÑÜ á
)ÑÑá à
.ÑÑà â
LengthÑÑâ è
)ÑÑè ê
;ÑÑê ë
}
ÖÖ 
catch
ÜÜ 
(
ÜÜ 
IOException
ÜÜ 
exceptIO
ÜÜ '
)
ÜÜ' (
{
áá 
IO
àà 
.
àà 
Logger
àà 
.
àà 
Log
àà 
(
àà 
NLog
àà "
.
àà" #
LogLevel
àà# +
.
àà+ ,
Warn
àà, 0
,
àà0 1
exceptIO
àà2 :
,
àà: ;
$str
àà< X
+
ààY Z
port
àà[ _
.
àà_ `
ToString
àà` h
(
ààh i
)
àài j
)
ààj k
;
ààk l
}
ââ 
finally
ää 
{
ãã 
try
åå 
{
çç 
if
éé 
(
éé 
streamOutput
éé $
!=
éé% '
null
éé( ,
)
éé, -
{
èè 
streamOutput
êê $
.
êê$ %
Close
êê% *
(
êê* +
)
êê+ ,
;
êê, -
}
ëë 
}
íí 
catch
ìì 
(
ìì 
IOException
ìì "
exceptIO
ìì# +
)
ìì+ ,
{
îî 
IO
ïï 
.
ïï 
Logger
ïï 
.
ïï 
Log
ïï !
(
ïï! "
NLog
ïï" &
.
ïï& '
LogLevel
ïï' /
.
ïï/ 0
Warn
ïï0 4
,
ïï4 5
exceptIO
ïï6 >
,
ïï> ?
$str
ïï@ W
)
ïïW X
;
ïïX Y
}
ññ 
try
òò 
{
ôô 
if
öö 
(
öö 
tcpConn
öö 
!=
öö  "
null
öö# '
)
öö' (
{
õõ 
tcpConn
úú 
.
úú  
Close
úú  %
(
úú% &
)
úú& '
;
úú' (
}
ùù 
}
ûû 
catch
üü 
(
üü 
IOException
üü "
exceptIO
üü# +
)
üü+ ,
{
†† 
IO
°° 
.
°° 
Logger
°° 
.
°° 
Log
°° !
(
°°! "
NLog
°°" &
.
°°& '
LogLevel
°°' /
.
°°/ 0
Warn
°°0 4
,
°°4 5
exceptIO
°°6 >
,
°°> ?
$str
°°@ W
)
°°W X
;
°°X Y
}
¢¢ 
try
§§ 
{
•• 
if
¶¶ 
(
¶¶ 
listener
¶¶  
!=
¶¶! #
null
¶¶$ (
)
¶¶( )
{
ßß 
listener
®®  
.
®®  !
Stop
®®! %
(
®®% &
)
®®& '
;
®®' (
}
©© 
}
™™ 
catch
´´ 
(
´´ 
IOException
´´ "
exceptIO
´´# +
)
´´+ ,
{
¨¨ 
IO
≠≠ 
.
≠≠ 
Logger
≠≠ 
.
≠≠ 
Log
≠≠ !
(
≠≠! "
NLog
≠≠" &
.
≠≠& '
LogLevel
≠≠' /
.
≠≠/ 0
Warn
≠≠0 4
,
≠≠4 5
exceptIO
≠≠6 >
,
≠≠> ?
$str
≠≠@ W
)
≠≠W X
;
≠≠X Y
}
ÆÆ 
}
∞∞ 
}
±± 	
}
≤≤ 
private
µµ 
void
µµ 
Good2
µµ 
(
µµ 
)
µµ 
{
∂∂ 
if
∑∑ 

(
∑∑  
PRIVATE_CONST_FIVE
∑∑ 
==
∑∑ !
$num
∑∑" #
)
∑∑# $
{
∏∏ 	
TcpListener
ππ 
listener
ππ  
=
ππ! "
null
ππ# '
;
ππ' (
	TcpClient
∫∫ 
tcpConn
∫∫ 
=
∫∫ 
null
∫∫  $
;
∫∫$ %
Stream
ªª 
streamOutput
ªª 
=
ªª  !
null
ªª" &
;
ªª& '
int
ºº 
port
ºº 
=
ºº 
$num
ºº 
;
ºº 
try
ΩΩ 
{
ææ 
listener
øø 
=
øø 
new
øø 
TcpListener
øø *
(
øø* +
	IPAddress
øø+ 4
.
øø4 5
Parse
øø5 :
(
øø: ;
$str
øø; G
)
øøG H
,
øøH I
port
øøJ N
)
øøN O
;
øøO P
listener
¿¿ 
.
¿¿ 
Start
¿¿ 
(
¿¿ 
)
¿¿  
;
¿¿  !
tcpConn
¡¡ 
=
¡¡ 
listener
¡¡ "
.
¡¡" #
AcceptTcpClient
¡¡# 2
(
¡¡2 3
)
¡¡3 4
;
¡¡4 5
streamOutput
¬¬ 
=
¬¬ 
tcpConn
¬¬ &
.
¬¬& '
	GetStream
¬¬' 0
(
¬¬0 1
)
¬¬1 2
;
¬¬2 3

IPEndPoint
√√ 
endPoint
√√ #
=
√√$ %
(
√√& '

IPEndPoint
√√' 1
)
√√1 2
tcpConn
√√2 9
.
√√9 :
Client
√√: @
.
√√@ A
RemoteEndPoint
√√A O
;
√√O P
	IPAddress
ƒƒ 
	ipAddress
ƒƒ #
=
ƒƒ$ %
endPoint
ƒƒ& .
.
ƒƒ. /
Address
ƒƒ/ 6
;
ƒƒ6 7
IPHostEntry
≈≈ 
	hostEntry
≈≈ %
=
≈≈& '
Dns
≈≈( +
.
≈≈+ ,
GetHostEntry
≈≈, 8
(
≈≈8 9
	ipAddress
≈≈9 B
)
≈≈B C
;
≈≈C D
streamOutput
«« 
.
«« 
Write
«« "
(
««" #
Encoding
««# +
.
««+ ,
UTF8
««, 0
.
««0 1
GetBytes
««1 9
(
««9 :
(
««: ;
$str
««; F
+
««G H
	hostEntry
««I R
.
««R S
ToString
««S [
(
««[ \
)
««\ ]
)
««] ^
)
««^ _
,
««_ `
$num
««a b
,
««b c
(
««d e
$str
««e p
+
««q r
	hostEntry
««s |
.
««| }
ToString««} Ö
(««Ö Ü
)««Ü á
)««á à
.««à â
Length««â è
)««è ê
;««ê ë
}
»» 
catch
…… 
(
…… 
IOException
…… 
exceptIO
…… '
)
……' (
{
   
IO
ÀÀ 
.
ÀÀ 
Logger
ÀÀ 
.
ÀÀ 
Log
ÀÀ 
(
ÀÀ 
NLog
ÀÀ "
.
ÀÀ" #
LogLevel
ÀÀ# +
.
ÀÀ+ ,
Warn
ÀÀ, 0
,
ÀÀ0 1
exceptIO
ÀÀ2 :
,
ÀÀ: ;
$str
ÀÀ< X
+
ÀÀY Z
port
ÀÀ[ _
.
ÀÀ_ `
ToString
ÀÀ` h
(
ÀÀh i
)
ÀÀi j
)
ÀÀj k
;
ÀÀk l
}
ÃÃ 
finally
ÕÕ 
{
ŒŒ 
try
œœ 
{
–– 
if
—— 
(
—— 
streamOutput
—— $
!=
——% '
null
——( ,
)
——, -
{
““ 
streamOutput
”” $
.
””$ %
Close
””% *
(
””* +
)
””+ ,
;
””, -
}
‘‘ 
}
’’ 
catch
÷÷ 
(
÷÷ 
IOException
÷÷ "
exceptIO
÷÷# +
)
÷÷+ ,
{
◊◊ 
IO
ÿÿ 
.
ÿÿ 
Logger
ÿÿ 
.
ÿÿ 
Log
ÿÿ !
(
ÿÿ! "
NLog
ÿÿ" &
.
ÿÿ& '
LogLevel
ÿÿ' /
.
ÿÿ/ 0
Warn
ÿÿ0 4
,
ÿÿ4 5
exceptIO
ÿÿ6 >
,
ÿÿ> ?
$str
ÿÿ@ W
)
ÿÿW X
;
ÿÿX Y
}
ŸŸ 
try
€€ 
{
‹‹ 
if
›› 
(
›› 
tcpConn
›› 
!=
››  "
null
››# '
)
››' (
{
ﬁﬁ 
tcpConn
ﬂﬂ 
.
ﬂﬂ  
Close
ﬂﬂ  %
(
ﬂﬂ% &
)
ﬂﬂ& '
;
ﬂﬂ' (
}
‡‡ 
}
·· 
catch
‚‚ 
(
‚‚ 
IOException
‚‚ "
exceptIO
‚‚# +
)
‚‚+ ,
{
„„ 
IO
‰‰ 
.
‰‰ 
Logger
‰‰ 
.
‰‰ 
Log
‰‰ !
(
‰‰! "
NLog
‰‰" &
.
‰‰& '
LogLevel
‰‰' /
.
‰‰/ 0
Warn
‰‰0 4
,
‰‰4 5
exceptIO
‰‰6 >
,
‰‰> ?
$str
‰‰@ W
)
‰‰W X
;
‰‰X Y
}
ÂÂ 
try
ÁÁ 
{
ËË 
if
ÈÈ 
(
ÈÈ 
listener
ÈÈ  
!=
ÈÈ! #
null
ÈÈ$ (
)
ÈÈ( )
{
ÍÍ 
listener
ÎÎ  
.
ÎÎ  !
Stop
ÎÎ! %
(
ÎÎ% &
)
ÎÎ& '
;
ÎÎ' (
}
ÏÏ 
}
ÌÌ 
catch
ÓÓ 
(
ÓÓ 
IOException
ÓÓ "
exceptIO
ÓÓ# +
)
ÓÓ+ ,
{
ÔÔ 
IO
 
.
 
Logger
 
.
 
Log
 !
(
! "
NLog
" &
.
& '
LogLevel
' /
.
/ 0
Warn
0 4
,
4 5
exceptIO
6 >
,
> ?
$str
@ W
)
W X
;
X Y
}
ÒÒ 
}
ÛÛ 
}
ÙÙ 	
}
ıı 
public
˜˜ 

override
˜˜ 
void
˜˜ 
Good
˜˜ 
(
˜˜ 
)
˜˜ 
{
¯¯ 
Good1
˘˘ 
(
˘˘ 
)
˘˘ 
;
˘˘ 
Good2
˙˙ 
(
˙˙ 
)
˙˙ 
;
˙˙ 
}
˚˚ 
}˝˝ 
}˛˛ Ùã
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__ip_based_logic_07.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__ip_based_logic_07 (
:) *
AbstractTestCase+ ;
{ 
private   
int   
privateFive   
=   
$num   
;    
public"" 

override"" 
void"" 
Bad"" 
("" 
)"" 
{## 
if$$ 

($$ 
privateFive$$ 
==$$ 
$num$$ 
)$$ 
{%% 	
TcpListener&& 
listener&&  
=&&! "
null&&# '
;&&' (
	TcpClient'' 
tcpConn'' 
='' 
null''  $
;''$ %
Stream(( 
streamOutput(( 
=((  !
null((" &
;((& '
int)) 
port)) 
=)) 
$num)) 
;)) 
try** 
{++ 
listener,, 
=,, 
new,, 
TcpListener,, *
(,,* +
	IPAddress,,+ 4
.,,4 5
Parse,,5 :
(,,: ;
$str,,; G
),,G H
,,,H I
port,,J N
),,N O
;,,O P
listener-- 
.-- 
Start-- 
(-- 
)--  
;--  !
tcpConn.. 
=.. 
listener.. "
..." #
AcceptTcpClient..# 2
(..2 3
)..3 4
;..4 5

IPEndPoint00 
endPoint00 #
=00$ %
(00& '

IPEndPoint00' 1
)001 2
tcpConn002 9
.009 :
Client00: @
.00@ A
RemoteEndPoint00A O
;00O P
	IPAddress11 
	ipAddress11 #
=11$ %
endPoint11& .
.11. /
Address11/ 6
;116 7
IPHostEntry22 
	hostEntry22 %
=22& '
Dns22( +
.22+ ,
GetHostEntry22, 8
(228 9
	ipAddress229 B
)22B C
;22C D
if33 
(33 
	hostEntry33 
.33 
Equals33 $
(33$ %
$str33% 5
)335 6
)336 7
{44 
streamOutput55  
=55! "
tcpConn55# *
.55* +
	GetStream55+ 4
(554 5
)555 6
;556 7
streamOutput66  
.66  !
Write66! &
(66& '
Encoding66' /
.66/ 0
UTF8660 4
.664 5
GetBytes665 =
(66= >
$str66> O
)66O P
,66P Q
$num66R S
,66S T
$str66U f
.66f g
Length66g m
)66m n
;66n o
}77 
else88 
{99 
streamOutput::  
=::! "
tcpConn::# *
.::* +
	GetStream::+ 4
(::4 5
)::5 6
;::6 7
streamOutput;;  
.;;  !
Write;;! &
(;;& '
Encoding;;' /
.;;/ 0
UTF8;;0 4
.;;4 5
GetBytes;;5 =
(;;= >
$str;;> N
);;N O
,;;O P
$num;;Q R
,;;R S
$str;;T d
.;;d e
Length;;e k
);;k l
;;;l m
}<< 
}== 
catch>> 
(>> 
IOException>> 
exceptIO>> '
)>>' (
{?? 
IO@@ 
.@@ 
Logger@@ 
.@@ 
Log@@ 
(@@ 
NLog@@ "
.@@" #
LogLevel@@# +
.@@+ ,
Warn@@, 0
,@@0 1
exceptIO@@2 :
,@@: ;
$str@@< X
+@@Y Z
port@@[ _
.@@_ `
ToString@@` h
(@@h i
)@@i j
)@@j k
;@@k l
}AA 
finallyBB 
{CC 
tryDD 
{EE 
ifFF 
(FF 
streamOutputFF $
!=FF% '
nullFF( ,
)FF, -
{GG 
streamOutputHH $
.HH$ %
CloseHH% *
(HH* +
)HH+ ,
;HH, -
}II 
}JJ 
catchKK 
(KK 
IOExceptionKK "
exceptIOKK# +
)KK+ ,
{LL 
IOMM 
.MM 
LoggerMM 
.MM 
LogMM !
(MM! "
NLogMM" &
.MM& '
LogLevelMM' /
.MM/ 0
WarnMM0 4
,MM4 5
exceptIOMM6 >
,MM> ?
$strMM@ W
)MMW X
;MMX Y
}NN 
tryPP 
{QQ 
ifRR 
(RR 
tcpConnRR 
!=RR  "
nullRR# '
)RR' (
{SS 
tcpConnTT 
.TT  
CloseTT  %
(TT% &
)TT& '
;TT' (
}UU 
}VV 
catchWW 
(WW 
IOExceptionWW "
exceptIOWW# +
)WW+ ,
{XX 
IOYY 
.YY 
LoggerYY 
.YY 
LogYY !
(YY! "
NLogYY" &
.YY& '
LogLevelYY' /
.YY/ 0
WarnYY0 4
,YY4 5
exceptIOYY6 >
,YY> ?
$strYY@ W
)YYW X
;YYX Y
}ZZ 
try\\ 
{]] 
if^^ 
(^^ 
listener^^  
!=^^! #
null^^$ (
)^^( )
{__ 
listener``  
.``  !
Stop``! %
(``% &
)``& '
;``' (
}aa 
}bb 
catchcc 
(cc 
IOExceptioncc "
exceptIOcc# +
)cc+ ,
{dd 
IOee 
.ee 
Loggeree 
.ee 
Logee !
(ee! "
NLogee" &
.ee& '
LogLevelee' /
.ee/ 0
Warnee0 4
,ee4 5
exceptIOee6 >
,ee> ?
$stree@ W
)eeW X
;eeX Y
}ff 
}gg 
}hh 	
}ii 
privatemm 
voidmm 
Good1mm 
(mm 
)mm 
{nn 
ifoo 

(oo 
privateFiveoo 
!=oo 
$numoo 
)oo 
{pp 	
IOrr 
.rr 
	WriteLinerr 
(rr 
$strrr /
)rr/ 0
;rr0 1
}ss 	
elsett 
{uu 	
TcpListenervv 
listenervv  
=vv! "
nullvv# '
;vv' (
	TcpClientww 
tcpConnww 
=ww 
nullww  $
;ww$ %
Streamxx 
streamOutputxx 
=xx  !
nullxx" &
;xx& '
intyy 
portyy 
=yy 
$numyy 
;yy 
tryzz 
{{{ 
listener|| 
=|| 
new|| 
TcpListener|| *
(||* +
	IPAddress||+ 4
.||4 5
Parse||5 :
(||: ;
$str||; G
)||G H
,||H I
port||J N
)||N O
;||O P
listener}} 
.}} 
Start}} 
(}} 
)}}  
;}}  !
tcpConn~~ 
=~~ 
listener~~ "
.~~" #
AcceptTcpClient~~# 2
(~~2 3
)~~3 4
;~~4 5
streamOutput 
= 
tcpConn &
.& '
	GetStream' 0
(0 1
)1 2
;2 3

IPEndPoint
ÄÄ 
endPoint
ÄÄ #
=
ÄÄ$ %
(
ÄÄ& '

IPEndPoint
ÄÄ' 1
)
ÄÄ1 2
tcpConn
ÄÄ2 9
.
ÄÄ9 :
Client
ÄÄ: @
.
ÄÄ@ A
RemoteEndPoint
ÄÄA O
;
ÄÄO P
	IPAddress
ÅÅ 
	ipAddress
ÅÅ #
=
ÅÅ$ %
endPoint
ÅÅ& .
.
ÅÅ. /
Address
ÅÅ/ 6
;
ÅÅ6 7
IPHostEntry
ÇÇ 
	hostEntry
ÇÇ %
=
ÇÇ& '
Dns
ÇÇ( +
.
ÇÇ+ ,
GetHostEntry
ÇÇ, 8
(
ÇÇ8 9
	ipAddress
ÇÇ9 B
)
ÇÇB C
;
ÇÇC D
streamOutput
ÑÑ 
.
ÑÑ 
Write
ÑÑ "
(
ÑÑ" #
Encoding
ÑÑ# +
.
ÑÑ+ ,
UTF8
ÑÑ, 0
.
ÑÑ0 1
GetBytes
ÑÑ1 9
(
ÑÑ9 :
(
ÑÑ: ;
$str
ÑÑ; F
+
ÑÑG H
	hostEntry
ÑÑI R
.
ÑÑR S
ToString
ÑÑS [
(
ÑÑ[ \
)
ÑÑ\ ]
)
ÑÑ] ^
)
ÑÑ^ _
,
ÑÑ_ `
$num
ÑÑa b
,
ÑÑb c
(
ÑÑd e
$str
ÑÑe p
+
ÑÑq r
	hostEntry
ÑÑs |
.
ÑÑ| }
ToStringÑÑ} Ö
(ÑÑÖ Ü
)ÑÑÜ á
)ÑÑá à
.ÑÑà â
LengthÑÑâ è
)ÑÑè ê
;ÑÑê ë
}
ÖÖ 
catch
ÜÜ 
(
ÜÜ 
IOException
ÜÜ 
exceptIO
ÜÜ '
)
ÜÜ' (
{
áá 
IO
àà 
.
àà 
Logger
àà 
.
àà 
Log
àà 
(
àà 
NLog
àà "
.
àà" #
LogLevel
àà# +
.
àà+ ,
Warn
àà, 0
,
àà0 1
exceptIO
àà2 :
,
àà: ;
$str
àà< X
+
ààY Z
port
àà[ _
.
àà_ `
ToString
àà` h
(
ààh i
)
àài j
)
ààj k
;
ààk l
}
ââ 
finally
ää 
{
ãã 
try
åå 
{
çç 
if
éé 
(
éé 
streamOutput
éé $
!=
éé% '
null
éé( ,
)
éé, -
{
èè 
streamOutput
êê $
.
êê$ %
Close
êê% *
(
êê* +
)
êê+ ,
;
êê, -
}
ëë 
}
íí 
catch
ìì 
(
ìì 
IOException
ìì "
exceptIO
ìì# +
)
ìì+ ,
{
îî 
IO
ïï 
.
ïï 
Logger
ïï 
.
ïï 
Log
ïï !
(
ïï! "
NLog
ïï" &
.
ïï& '
LogLevel
ïï' /
.
ïï/ 0
Warn
ïï0 4
,
ïï4 5
exceptIO
ïï6 >
,
ïï> ?
$str
ïï@ W
)
ïïW X
;
ïïX Y
}
ññ 
try
òò 
{
ôô 
if
öö 
(
öö 
tcpConn
öö 
!=
öö  "
null
öö# '
)
öö' (
{
õõ 
tcpConn
úú 
.
úú  
Close
úú  %
(
úú% &
)
úú& '
;
úú' (
}
ùù 
}
ûû 
catch
üü 
(
üü 
IOException
üü "
exceptIO
üü# +
)
üü+ ,
{
†† 
IO
°° 
.
°° 
Logger
°° 
.
°° 
Log
°° !
(
°°! "
NLog
°°" &
.
°°& '
LogLevel
°°' /
.
°°/ 0
Warn
°°0 4
,
°°4 5
exceptIO
°°6 >
,
°°> ?
$str
°°@ W
)
°°W X
;
°°X Y
}
¢¢ 
try
§§ 
{
•• 
if
¶¶ 
(
¶¶ 
listener
¶¶  
!=
¶¶! #
null
¶¶$ (
)
¶¶( )
{
ßß 
listener
®®  
.
®®  !
Stop
®®! %
(
®®% &
)
®®& '
;
®®' (
}
©© 
}
™™ 
catch
´´ 
(
´´ 
IOException
´´ "
exceptIO
´´# +
)
´´+ ,
{
¨¨ 
IO
≠≠ 
.
≠≠ 
Logger
≠≠ 
.
≠≠ 
Log
≠≠ !
(
≠≠! "
NLog
≠≠" &
.
≠≠& '
LogLevel
≠≠' /
.
≠≠/ 0
Warn
≠≠0 4
,
≠≠4 5
exceptIO
≠≠6 >
,
≠≠> ?
$str
≠≠@ W
)
≠≠W X
;
≠≠X Y
}
ÆÆ 
}
∞∞ 
}
±± 	
}
≤≤ 
private
µµ 
void
µµ 
Good2
µµ 
(
µµ 
)
µµ 
{
∂∂ 
if
∑∑ 

(
∑∑ 
privateFive
∑∑ 
==
∑∑ 
$num
∑∑ 
)
∑∑ 
{
∏∏ 	
TcpListener
ππ 
listener
ππ  
=
ππ! "
null
ππ# '
;
ππ' (
	TcpClient
∫∫ 
tcpConn
∫∫ 
=
∫∫ 
null
∫∫  $
;
∫∫$ %
Stream
ªª 
streamOutput
ªª 
=
ªª  !
null
ªª" &
;
ªª& '
int
ºº 
port
ºº 
=
ºº 
$num
ºº 
;
ºº 
try
ΩΩ 
{
ææ 
listener
øø 
=
øø 
new
øø 
TcpListener
øø *
(
øø* +
	IPAddress
øø+ 4
.
øø4 5
Parse
øø5 :
(
øø: ;
$str
øø; G
)
øøG H
,
øøH I
port
øøJ N
)
øøN O
;
øøO P
listener
¿¿ 
.
¿¿ 
Start
¿¿ 
(
¿¿ 
)
¿¿  
;
¿¿  !
tcpConn
¡¡ 
=
¡¡ 
listener
¡¡ "
.
¡¡" #
AcceptTcpClient
¡¡# 2
(
¡¡2 3
)
¡¡3 4
;
¡¡4 5
streamOutput
¬¬ 
=
¬¬ 
tcpConn
¬¬ &
.
¬¬& '
	GetStream
¬¬' 0
(
¬¬0 1
)
¬¬1 2
;
¬¬2 3

IPEndPoint
√√ 
endPoint
√√ #
=
√√$ %
(
√√& '

IPEndPoint
√√' 1
)
√√1 2
tcpConn
√√2 9
.
√√9 :
Client
√√: @
.
√√@ A
RemoteEndPoint
√√A O
;
√√O P
	IPAddress
ƒƒ 
	ipAddress
ƒƒ #
=
ƒƒ$ %
endPoint
ƒƒ& .
.
ƒƒ. /
Address
ƒƒ/ 6
;
ƒƒ6 7
IPHostEntry
≈≈ 
	hostEntry
≈≈ %
=
≈≈& '
Dns
≈≈( +
.
≈≈+ ,
GetHostEntry
≈≈, 8
(
≈≈8 9
	ipAddress
≈≈9 B
)
≈≈B C
;
≈≈C D
streamOutput
«« 
.
«« 
Write
«« "
(
««" #
Encoding
««# +
.
««+ ,
UTF8
««, 0
.
««0 1
GetBytes
««1 9
(
««9 :
(
««: ;
$str
««; F
+
««G H
	hostEntry
««I R
.
««R S
ToString
««S [
(
««[ \
)
««\ ]
)
««] ^
)
««^ _
,
««_ `
$num
««a b
,
««b c
(
««d e
$str
««e p
+
««q r
	hostEntry
««s |
.
««| }
ToString««} Ö
(««Ö Ü
)««Ü á
)««á à
.««à â
Length««â è
)««è ê
;««ê ë
}
»» 
catch
…… 
(
…… 
IOException
…… 
exceptIO
…… '
)
……' (
{
   
IO
ÀÀ 
.
ÀÀ 
Logger
ÀÀ 
.
ÀÀ 
Log
ÀÀ 
(
ÀÀ 
NLog
ÀÀ "
.
ÀÀ" #
LogLevel
ÀÀ# +
.
ÀÀ+ ,
Warn
ÀÀ, 0
,
ÀÀ0 1
exceptIO
ÀÀ2 :
,
ÀÀ: ;
$str
ÀÀ< X
+
ÀÀY Z
port
ÀÀ[ _
.
ÀÀ_ `
ToString
ÀÀ` h
(
ÀÀh i
)
ÀÀi j
)
ÀÀj k
;
ÀÀk l
}
ÃÃ 
finally
ÕÕ 
{
ŒŒ 
try
œœ 
{
–– 
if
—— 
(
—— 
streamOutput
—— $
!=
——% '
null
——( ,
)
——, -
{
““ 
streamOutput
”” $
.
””$ %
Close
””% *
(
””* +
)
””+ ,
;
””, -
}
‘‘ 
}
’’ 
catch
÷÷ 
(
÷÷ 
IOException
÷÷ "
exceptIO
÷÷# +
)
÷÷+ ,
{
◊◊ 
IO
ÿÿ 
.
ÿÿ 
Logger
ÿÿ 
.
ÿÿ 
Log
ÿÿ !
(
ÿÿ! "
NLog
ÿÿ" &
.
ÿÿ& '
LogLevel
ÿÿ' /
.
ÿÿ/ 0
Warn
ÿÿ0 4
,
ÿÿ4 5
exceptIO
ÿÿ6 >
,
ÿÿ> ?
$str
ÿÿ@ W
)
ÿÿW X
;
ÿÿX Y
}
ŸŸ 
try
€€ 
{
‹‹ 
if
›› 
(
›› 
tcpConn
›› 
!=
››  "
null
››# '
)
››' (
{
ﬁﬁ 
tcpConn
ﬂﬂ 
.
ﬂﬂ  
Close
ﬂﬂ  %
(
ﬂﬂ% &
)
ﬂﬂ& '
;
ﬂﬂ' (
}
‡‡ 
}
·· 
catch
‚‚ 
(
‚‚ 
IOException
‚‚ "
exceptIO
‚‚# +
)
‚‚+ ,
{
„„ 
IO
‰‰ 
.
‰‰ 
Logger
‰‰ 
.
‰‰ 
Log
‰‰ !
(
‰‰! "
NLog
‰‰" &
.
‰‰& '
LogLevel
‰‰' /
.
‰‰/ 0
Warn
‰‰0 4
,
‰‰4 5
exceptIO
‰‰6 >
,
‰‰> ?
$str
‰‰@ W
)
‰‰W X
;
‰‰X Y
}
ÂÂ 
try
ÁÁ 
{
ËË 
if
ÈÈ 
(
ÈÈ 
listener
ÈÈ  
!=
ÈÈ! #
null
ÈÈ$ (
)
ÈÈ( )
{
ÍÍ 
listener
ÎÎ  
.
ÎÎ  !
Stop
ÎÎ! %
(
ÎÎ% &
)
ÎÎ& '
;
ÎÎ' (
}
ÏÏ 
}
ÌÌ 
catch
ÓÓ 
(
ÓÓ 
IOException
ÓÓ "
exceptIO
ÓÓ# +
)
ÓÓ+ ,
{
ÔÔ 
IO
 
.
 
Logger
 
.
 
Log
 !
(
! "
NLog
" &
.
& '
LogLevel
' /
.
/ 0
Warn
0 4
,
4 5
exceptIO
6 >
,
> ?
$str
@ W
)
W X
;
X Y
}
ÒÒ 
}
ÛÛ 
}
ÙÙ 	
}
ıı 
public
˜˜ 

override
˜˜ 
void
˜˜ 
Good
˜˜ 
(
˜˜ 
)
˜˜ 
{
¯¯ 
Good1
˘˘ 
(
˘˘ 
)
˘˘ 
;
˘˘ 
Good2
˙˙ 
(
˙˙ 
)
˙˙ 
;
˙˙ 
}
˚˚ 
}˝˝ 
}˛˛ ãè
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__ip_based_logic_08.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__ip_based_logic_08 (
:) *
AbstractTestCase+ ;
{ 
private   
static   
bool   
PrivateReturnsTrue   *
(  * +
)  + ,
{!! 
return"" 
true"" 
;"" 
}## 
private%% 
static%% 
bool%% 
PrivateReturnsFalse%% +
(%%+ ,
)%%, -
{&& 
return'' 
false'' 
;'' 
}(( 
public** 

override** 
void** 
Bad** 
(** 
)** 
{++ 
if,, 

(,, 
PrivateReturnsTrue,, 
(,, 
),,  
),,  !
{-- 	
TcpListener.. 
listener..  
=..! "
null..# '
;..' (
	TcpClient// 
tcpConn// 
=// 
null//  $
;//$ %
Stream00 
streamOutput00 
=00  !
null00" &
;00& '
int11 
port11 
=11 
$num11 
;11 
try22 
{33 
listener44 
=44 
new44 
TcpListener44 *
(44* +
	IPAddress44+ 4
.444 5
Parse445 :
(44: ;
$str44; G
)44G H
,44H I
port44J N
)44N O
;44O P
listener55 
.55 
Start55 
(55 
)55  
;55  !
tcpConn66 
=66 
listener66 "
.66" #
AcceptTcpClient66# 2
(662 3
)663 4
;664 5

IPEndPoint88 
endPoint88 #
=88$ %
(88& '

IPEndPoint88' 1
)881 2
tcpConn882 9
.889 :
Client88: @
.88@ A
RemoteEndPoint88A O
;88O P
	IPAddress99 
	ipAddress99 #
=99$ %
endPoint99& .
.99. /
Address99/ 6
;996 7
IPHostEntry:: 
	hostEntry:: %
=::& '
Dns::( +
.::+ ,
GetHostEntry::, 8
(::8 9
	ipAddress::9 B
)::B C
;::C D
if;; 
(;; 
	hostEntry;; 
.;; 
Equals;; $
(;;$ %
$str;;% 5
);;5 6
);;6 7
{<< 
streamOutput==  
===! "
tcpConn==# *
.==* +
	GetStream==+ 4
(==4 5
)==5 6
;==6 7
streamOutput>>  
.>>  !
Write>>! &
(>>& '
Encoding>>' /
.>>/ 0
UTF8>>0 4
.>>4 5
GetBytes>>5 =
(>>= >
$str>>> O
)>>O P
,>>P Q
$num>>R S
,>>S T
$str>>U f
.>>f g
Length>>g m
)>>m n
;>>n o
}?? 
else@@ 
{AA 
streamOutputBB  
=BB! "
tcpConnBB# *
.BB* +
	GetStreamBB+ 4
(BB4 5
)BB5 6
;BB6 7
streamOutputCC  
.CC  !
WriteCC! &
(CC& '
EncodingCC' /
.CC/ 0
UTF8CC0 4
.CC4 5
GetBytesCC5 =
(CC= >
$strCC> N
)CCN O
,CCO P
$numCCQ R
,CCR S
$strCCT d
.CCd e
LengthCCe k
)CCk l
;CCl m
}DD 
}EE 
catchFF 
(FF 
IOExceptionFF 
exceptIOFF '
)FF' (
{GG 
IOHH 
.HH 
LoggerHH 
.HH 
LogHH 
(HH 
NLogHH "
.HH" #
LogLevelHH# +
.HH+ ,
WarnHH, 0
,HH0 1
exceptIOHH2 :
,HH: ;
$strHH< X
+HHY Z
portHH[ _
.HH_ `
ToStringHH` h
(HHh i
)HHi j
)HHj k
;HHk l
}II 
finallyJJ 
{KK 
tryLL 
{MM 
ifNN 
(NN 
streamOutputNN $
!=NN% '
nullNN( ,
)NN, -
{OO 
streamOutputPP $
.PP$ %
ClosePP% *
(PP* +
)PP+ ,
;PP, -
}QQ 
}RR 
catchSS 
(SS 
IOExceptionSS "
exceptIOSS# +
)SS+ ,
{TT 
IOUU 
.UU 
LoggerUU 
.UU 
LogUU !
(UU! "
NLogUU" &
.UU& '
LogLevelUU' /
.UU/ 0
WarnUU0 4
,UU4 5
exceptIOUU6 >
,UU> ?
$strUU@ W
)UUW X
;UUX Y
}VV 
tryXX 
{YY 
ifZZ 
(ZZ 
tcpConnZZ 
!=ZZ  "
nullZZ# '
)ZZ' (
{[[ 
tcpConn\\ 
.\\  
Close\\  %
(\\% &
)\\& '
;\\' (
}]] 
}^^ 
catch__ 
(__ 
IOException__ "
exceptIO__# +
)__+ ,
{`` 
IOaa 
.aa 
Loggeraa 
.aa 
Logaa !
(aa! "
NLogaa" &
.aa& '
LogLevelaa' /
.aa/ 0
Warnaa0 4
,aa4 5
exceptIOaa6 >
,aa> ?
$straa@ W
)aaW X
;aaX Y
}bb 
trydd 
{ee 
ifff 
(ff 
listenerff  
!=ff! #
nullff$ (
)ff( )
{gg 
listenerhh  
.hh  !
Stophh! %
(hh% &
)hh& '
;hh' (
}ii 
}jj 
catchkk 
(kk 
IOExceptionkk "
exceptIOkk# +
)kk+ ,
{ll 
IOmm 
.mm 
Loggermm 
.mm 
Logmm !
(mm! "
NLogmm" &
.mm& '
LogLevelmm' /
.mm/ 0
Warnmm0 4
,mm4 5
exceptIOmm6 >
,mm> ?
$strmm@ W
)mmW X
;mmX Y
}nn 
}oo 
}pp 	
}qq 
privateuu 
voiduu 
Good1uu 
(uu 
)uu 
{vv 
ifww 

(ww 
PrivateReturnsFalseww 
(ww  
)ww  !
)ww! "
{xx 	
IOzz 
.zz 
	WriteLinezz 
(zz 
$strzz /
)zz/ 0
;zz0 1
}{{ 	
else|| 
{}} 	
TcpListener~~ 
listener~~  
=~~! "
null~~# '
;~~' (
	TcpClient 
tcpConn 
= 
null  $
;$ %
Stream
ÄÄ 
streamOutput
ÄÄ 
=
ÄÄ  !
null
ÄÄ" &
;
ÄÄ& '
int
ÅÅ 
port
ÅÅ 
=
ÅÅ 
$num
ÅÅ 
;
ÅÅ 
try
ÇÇ 
{
ÉÉ 
listener
ÑÑ 
=
ÑÑ 
new
ÑÑ 
TcpListener
ÑÑ *
(
ÑÑ* +
	IPAddress
ÑÑ+ 4
.
ÑÑ4 5
Parse
ÑÑ5 :
(
ÑÑ: ;
$str
ÑÑ; G
)
ÑÑG H
,
ÑÑH I
port
ÑÑJ N
)
ÑÑN O
;
ÑÑO P
listener
ÖÖ 
.
ÖÖ 
Start
ÖÖ 
(
ÖÖ 
)
ÖÖ  
;
ÖÖ  !
tcpConn
ÜÜ 
=
ÜÜ 
listener
ÜÜ "
.
ÜÜ" #
AcceptTcpClient
ÜÜ# 2
(
ÜÜ2 3
)
ÜÜ3 4
;
ÜÜ4 5
streamOutput
áá 
=
áá 
tcpConn
áá &
.
áá& '
	GetStream
áá' 0
(
áá0 1
)
áá1 2
;
áá2 3

IPEndPoint
àà 
endPoint
àà #
=
àà$ %
(
àà& '

IPEndPoint
àà' 1
)
àà1 2
tcpConn
àà2 9
.
àà9 :
Client
àà: @
.
àà@ A
RemoteEndPoint
ààA O
;
ààO P
	IPAddress
ââ 
	ipAddress
ââ #
=
ââ$ %
endPoint
ââ& .
.
ââ. /
Address
ââ/ 6
;
ââ6 7
IPHostEntry
ää 
	hostEntry
ää %
=
ää& '
Dns
ää( +
.
ää+ ,
GetHostEntry
ää, 8
(
ää8 9
	ipAddress
ää9 B
)
ääB C
;
ääC D
streamOutput
åå 
.
åå 
Write
åå "
(
åå" #
Encoding
åå# +
.
åå+ ,
UTF8
åå, 0
.
åå0 1
GetBytes
åå1 9
(
åå9 :
(
åå: ;
$str
åå; F
+
ååG H
	hostEntry
ååI R
.
ååR S
ToString
ååS [
(
åå[ \
)
åå\ ]
)
åå] ^
)
åå^ _
,
åå_ `
$num
ååa b
,
ååb c
(
ååd e
$str
ååe p
+
ååq r
	hostEntry
åås |
.
åå| }
ToStringåå} Ö
(ååÖ Ü
)ååÜ á
)ååá à
.ååà â
Lengthååâ è
)ååè ê
;ååê ë
}
çç 
catch
éé 
(
éé 
IOException
éé 
exceptIO
éé '
)
éé' (
{
èè 
IO
êê 
.
êê 
Logger
êê 
.
êê 
Log
êê 
(
êê 
NLog
êê "
.
êê" #
LogLevel
êê# +
.
êê+ ,
Warn
êê, 0
,
êê0 1
exceptIO
êê2 :
,
êê: ;
$str
êê< X
+
êêY Z
port
êê[ _
.
êê_ `
ToString
êê` h
(
êêh i
)
êêi j
)
êêj k
;
êêk l
}
ëë 
finally
íí 
{
ìì 
try
îî 
{
ïï 
if
ññ 
(
ññ 
streamOutput
ññ $
!=
ññ% '
null
ññ( ,
)
ññ, -
{
óó 
streamOutput
òò $
.
òò$ %
Close
òò% *
(
òò* +
)
òò+ ,
;
òò, -
}
ôô 
}
öö 
catch
õõ 
(
õõ 
IOException
õõ "
exceptIO
õõ# +
)
õõ+ ,
{
úú 
IO
ùù 
.
ùù 
Logger
ùù 
.
ùù 
Log
ùù !
(
ùù! "
NLog
ùù" &
.
ùù& '
LogLevel
ùù' /
.
ùù/ 0
Warn
ùù0 4
,
ùù4 5
exceptIO
ùù6 >
,
ùù> ?
$str
ùù@ W
)
ùùW X
;
ùùX Y
}
ûû 
try
†† 
{
°° 
if
¢¢ 
(
¢¢ 
tcpConn
¢¢ 
!=
¢¢  "
null
¢¢# '
)
¢¢' (
{
££ 
tcpConn
§§ 
.
§§  
Close
§§  %
(
§§% &
)
§§& '
;
§§' (
}
•• 
}
¶¶ 
catch
ßß 
(
ßß 
IOException
ßß "
exceptIO
ßß# +
)
ßß+ ,
{
®® 
IO
©© 
.
©© 
Logger
©© 
.
©© 
Log
©© !
(
©©! "
NLog
©©" &
.
©©& '
LogLevel
©©' /
.
©©/ 0
Warn
©©0 4
,
©©4 5
exceptIO
©©6 >
,
©©> ?
$str
©©@ W
)
©©W X
;
©©X Y
}
™™ 
try
¨¨ 
{
≠≠ 
if
ÆÆ 
(
ÆÆ 
listener
ÆÆ  
!=
ÆÆ! #
null
ÆÆ$ (
)
ÆÆ( )
{
ØØ 
listener
∞∞  
.
∞∞  !
Stop
∞∞! %
(
∞∞% &
)
∞∞& '
;
∞∞' (
}
±± 
}
≤≤ 
catch
≥≥ 
(
≥≥ 
IOException
≥≥ "
exceptIO
≥≥# +
)
≥≥+ ,
{
¥¥ 
IO
µµ 
.
µµ 
Logger
µµ 
.
µµ 
Log
µµ !
(
µµ! "
NLog
µµ" &
.
µµ& '
LogLevel
µµ' /
.
µµ/ 0
Warn
µµ0 4
,
µµ4 5
exceptIO
µµ6 >
,
µµ> ?
$str
µµ@ W
)
µµW X
;
µµX Y
}
∂∂ 
}
∏∏ 
}
ππ 	
}
∫∫ 
private
ΩΩ 
void
ΩΩ 
Good2
ΩΩ 
(
ΩΩ 
)
ΩΩ 
{
ææ 
if
øø 

(
øø  
PrivateReturnsTrue
øø 
(
øø 
)
øø  
)
øø  !
{
¿¿ 	
TcpListener
¡¡ 
listener
¡¡  
=
¡¡! "
null
¡¡# '
;
¡¡' (
	TcpClient
¬¬ 
tcpConn
¬¬ 
=
¬¬ 
null
¬¬  $
;
¬¬$ %
Stream
√√ 
streamOutput
√√ 
=
√√  !
null
√√" &
;
√√& '
int
ƒƒ 
port
ƒƒ 
=
ƒƒ 
$num
ƒƒ 
;
ƒƒ 
try
≈≈ 
{
∆∆ 
listener
«« 
=
«« 
new
«« 
TcpListener
«« *
(
««* +
	IPAddress
««+ 4
.
««4 5
Parse
««5 :
(
««: ;
$str
««; G
)
««G H
,
««H I
port
««J N
)
««N O
;
««O P
listener
»» 
.
»» 
Start
»» 
(
»» 
)
»»  
;
»»  !
tcpConn
…… 
=
…… 
listener
…… "
.
……" #
AcceptTcpClient
……# 2
(
……2 3
)
……3 4
;
……4 5
streamOutput
   
=
   
tcpConn
   &
.
  & '
	GetStream
  ' 0
(
  0 1
)
  1 2
;
  2 3

IPEndPoint
ÀÀ 
endPoint
ÀÀ #
=
ÀÀ$ %
(
ÀÀ& '

IPEndPoint
ÀÀ' 1
)
ÀÀ1 2
tcpConn
ÀÀ2 9
.
ÀÀ9 :
Client
ÀÀ: @
.
ÀÀ@ A
RemoteEndPoint
ÀÀA O
;
ÀÀO P
	IPAddress
ÃÃ 
	ipAddress
ÃÃ #
=
ÃÃ$ %
endPoint
ÃÃ& .
.
ÃÃ. /
Address
ÃÃ/ 6
;
ÃÃ6 7
IPHostEntry
ÕÕ 
	hostEntry
ÕÕ %
=
ÕÕ& '
Dns
ÕÕ( +
.
ÕÕ+ ,
GetHostEntry
ÕÕ, 8
(
ÕÕ8 9
	ipAddress
ÕÕ9 B
)
ÕÕB C
;
ÕÕC D
streamOutput
œœ 
.
œœ 
Write
œœ "
(
œœ" #
Encoding
œœ# +
.
œœ+ ,
UTF8
œœ, 0
.
œœ0 1
GetBytes
œœ1 9
(
œœ9 :
(
œœ: ;
$str
œœ; F
+
œœG H
	hostEntry
œœI R
.
œœR S
ToString
œœS [
(
œœ[ \
)
œœ\ ]
)
œœ] ^
)
œœ^ _
,
œœ_ `
$num
œœa b
,
œœb c
(
œœd e
$str
œœe p
+
œœq r
	hostEntry
œœs |
.
œœ| }
ToStringœœ} Ö
(œœÖ Ü
)œœÜ á
)œœá à
.œœà â
Lengthœœâ è
)œœè ê
;œœê ë
}
–– 
catch
—— 
(
—— 
IOException
—— 
exceptIO
—— '
)
——' (
{
““ 
IO
”” 
.
”” 
Logger
”” 
.
”” 
Log
”” 
(
”” 
NLog
”” "
.
””" #
LogLevel
””# +
.
””+ ,
Warn
””, 0
,
””0 1
exceptIO
””2 :
,
””: ;
$str
””< X
+
””Y Z
port
””[ _
.
””_ `
ToString
””` h
(
””h i
)
””i j
)
””j k
;
””k l
}
‘‘ 
finally
’’ 
{
÷÷ 
try
◊◊ 
{
ÿÿ 
if
ŸŸ 
(
ŸŸ 
streamOutput
ŸŸ $
!=
ŸŸ% '
null
ŸŸ( ,
)
ŸŸ, -
{
⁄⁄ 
streamOutput
€€ $
.
€€$ %
Close
€€% *
(
€€* +
)
€€+ ,
;
€€, -
}
‹‹ 
}
›› 
catch
ﬁﬁ 
(
ﬁﬁ 
IOException
ﬁﬁ "
exceptIO
ﬁﬁ# +
)
ﬁﬁ+ ,
{
ﬂﬂ 
IO
‡‡ 
.
‡‡ 
Logger
‡‡ 
.
‡‡ 
Log
‡‡ !
(
‡‡! "
NLog
‡‡" &
.
‡‡& '
LogLevel
‡‡' /
.
‡‡/ 0
Warn
‡‡0 4
,
‡‡4 5
exceptIO
‡‡6 >
,
‡‡> ?
$str
‡‡@ W
)
‡‡W X
;
‡‡X Y
}
·· 
try
„„ 
{
‰‰ 
if
ÂÂ 
(
ÂÂ 
tcpConn
ÂÂ 
!=
ÂÂ  "
null
ÂÂ# '
)
ÂÂ' (
{
ÊÊ 
tcpConn
ÁÁ 
.
ÁÁ  
Close
ÁÁ  %
(
ÁÁ% &
)
ÁÁ& '
;
ÁÁ' (
}
ËË 
}
ÈÈ 
catch
ÍÍ 
(
ÍÍ 
IOException
ÍÍ "
exceptIO
ÍÍ# +
)
ÍÍ+ ,
{
ÎÎ 
IO
ÏÏ 
.
ÏÏ 
Logger
ÏÏ 
.
ÏÏ 
Log
ÏÏ !
(
ÏÏ! "
NLog
ÏÏ" &
.
ÏÏ& '
LogLevel
ÏÏ' /
.
ÏÏ/ 0
Warn
ÏÏ0 4
,
ÏÏ4 5
exceptIO
ÏÏ6 >
,
ÏÏ> ?
$str
ÏÏ@ W
)
ÏÏW X
;
ÏÏX Y
}
ÌÌ 
try
ÔÔ 
{
 
if
ÒÒ 
(
ÒÒ 
listener
ÒÒ  
!=
ÒÒ! #
null
ÒÒ$ (
)
ÒÒ( )
{
ÚÚ 
listener
ÛÛ  
.
ÛÛ  !
Stop
ÛÛ! %
(
ÛÛ% &
)
ÛÛ& '
;
ÛÛ' (
}
ÙÙ 
}
ıı 
catch
ˆˆ 
(
ˆˆ 
IOException
ˆˆ "
exceptIO
ˆˆ# +
)
ˆˆ+ ,
{
˜˜ 
IO
¯¯ 
.
¯¯ 
Logger
¯¯ 
.
¯¯ 
Log
¯¯ !
(
¯¯! "
NLog
¯¯" &
.
¯¯& '
LogLevel
¯¯' /
.
¯¯/ 0
Warn
¯¯0 4
,
¯¯4 5
exceptIO
¯¯6 >
,
¯¯> ?
$str
¯¯@ W
)
¯¯W X
;
¯¯X Y
}
˘˘ 
}
˚˚ 
}
¸¸ 	
}
˝˝ 
public
ˇˇ 

override
ˇˇ 
void
ˇˇ 
Good
ˇˇ 
(
ˇˇ 
)
ˇˇ 
{
ÄÄ 
Good1
ÅÅ 
(
ÅÅ 
)
ÅÅ 
;
ÅÅ 
Good2
ÇÇ 
(
ÇÇ 
)
ÇÇ 
;
ÇÇ 
}
ÉÉ 
}ÖÖ 
}ÜÜ ñä
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__ip_based_logic_09.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__ip_based_logic_09 (
:) *
AbstractTestCase+ ;
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
IO 
.  
STATIC_READONLY_TRUE #
)# $
{   	
TcpListener!! 
listener!!  
=!!! "
null!!# '
;!!' (
	TcpClient"" 
tcpConn"" 
="" 
null""  $
;""$ %
Stream## 
streamOutput## 
=##  !
null##" &
;##& '
int$$ 
port$$ 
=$$ 
$num$$ 
;$$ 
try%% 
{&& 
listener'' 
='' 
new'' 
TcpListener'' *
(''* +
	IPAddress''+ 4
.''4 5
Parse''5 :
('': ;
$str''; G
)''G H
,''H I
port''J N
)''N O
;''O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
tcpConn)) 
=)) 
listener)) "
.))" #
AcceptTcpClient))# 2
())2 3
)))3 4
;))4 5

IPEndPoint++ 
endPoint++ #
=++$ %
(++& '

IPEndPoint++' 1
)++1 2
tcpConn++2 9
.++9 :
Client++: @
.++@ A
RemoteEndPoint++A O
;++O P
	IPAddress,, 
	ipAddress,, #
=,,$ %
endPoint,,& .
.,,. /
Address,,/ 6
;,,6 7
IPHostEntry-- 
	hostEntry-- %
=--& '
Dns--( +
.--+ ,
GetHostEntry--, 8
(--8 9
	ipAddress--9 B
)--B C
;--C D
if.. 
(.. 
	hostEntry.. 
... 
Equals.. $
(..$ %
$str..% 5
)..5 6
)..6 7
{// 
streamOutput00  
=00! "
tcpConn00# *
.00* +
	GetStream00+ 4
(004 5
)005 6
;006 7
streamOutput11  
.11  !
Write11! &
(11& '
Encoding11' /
.11/ 0
UTF8110 4
.114 5
GetBytes115 =
(11= >
$str11> O
)11O P
,11P Q
$num11R S
,11S T
$str11U f
.11f g
Length11g m
)11m n
;11n o
}22 
else33 
{44 
streamOutput55  
=55! "
tcpConn55# *
.55* +
	GetStream55+ 4
(554 5
)555 6
;556 7
streamOutput66  
.66  !
Write66! &
(66& '
Encoding66' /
.66/ 0
UTF8660 4
.664 5
GetBytes665 =
(66= >
$str66> N
)66N O
,66O P
$num66Q R
,66R S
$str66T d
.66d e
Length66e k
)66k l
;66l m
}77 
}88 
catch99 
(99 
IOException99 
exceptIO99 '
)99' (
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; 
(;; 
NLog;; "
.;;" #
LogLevel;;# +
.;;+ ,
Warn;;, 0
,;;0 1
exceptIO;;2 :
,;;: ;
$str;;< X
+;;Y Z
port;;[ _
.;;_ `
ToString;;` h
(;;h i
);;i j
);;j k
;;;k l
}<< 
finally== 
{>> 
try?? 
{@@ 
ifAA 
(AA 
streamOutputAA $
!=AA% '
nullAA( ,
)AA, -
{BB 
streamOutputCC $
.CC$ %
CloseCC% *
(CC* +
)CC+ ,
;CC, -
}DD 
}EE 
catchFF 
(FF 
IOExceptionFF "
exceptIOFF# +
)FF+ ,
{GG 
IOHH 
.HH 
LoggerHH 
.HH 
LogHH !
(HH! "
NLogHH" &
.HH& '
LogLevelHH' /
.HH/ 0
WarnHH0 4
,HH4 5
exceptIOHH6 >
,HH> ?
$strHH@ W
)HHW X
;HHX Y
}II 
tryKK 
{LL 
ifMM 
(MM 
tcpConnMM 
!=MM  "
nullMM# '
)MM' (
{NN 
tcpConnOO 
.OO  
CloseOO  %
(OO% &
)OO& '
;OO' (
}PP 
}QQ 
catchRR 
(RR 
IOExceptionRR "
exceptIORR# +
)RR+ ,
{SS 
IOTT 
.TT 
LoggerTT 
.TT 
LogTT !
(TT! "
NLogTT" &
.TT& '
LogLevelTT' /
.TT/ 0
WarnTT0 4
,TT4 5
exceptIOTT6 >
,TT> ?
$strTT@ W
)TTW X
;TTX Y
}UU 
tryWW 
{XX 
ifYY 
(YY 
listenerYY  
!=YY! #
nullYY$ (
)YY( )
{ZZ 
listener[[  
.[[  !
Stop[[! %
([[% &
)[[& '
;[[' (
}\\ 
}]] 
catch^^ 
(^^ 
IOException^^ "
exceptIO^^# +
)^^+ ,
{__ 
IO`` 
.`` 
Logger`` 
.`` 
Log`` !
(``! "
NLog``" &
.``& '
LogLevel``' /
.``/ 0
Warn``0 4
,``4 5
exceptIO``6 >
,``> ?
$str``@ W
)``W X
;``X Y
}aa 
}bb 
}cc 	
}dd 
privatehh 
voidhh 
Good1hh 
(hh 
)hh 
{ii 
ifjj 

(jj 
IOjj 
.jj !
STATIC_READONLY_FALSEjj $
)jj$ %
{kk 	
IOmm 
.mm 
	WriteLinemm 
(mm 
$strmm /
)mm/ 0
;mm0 1
}nn 	
elseoo 
{pp 	
TcpListenerqq 
listenerqq  
=qq! "
nullqq# '
;qq' (
	TcpClientrr 
tcpConnrr 
=rr 
nullrr  $
;rr$ %
Streamss 
streamOutputss 
=ss  !
nullss" &
;ss& '
inttt 
porttt 
=tt 
$numtt 
;tt 
tryuu 
{vv 
listenerww 
=ww 
newww 
TcpListenerww *
(ww* +
	IPAddressww+ 4
.ww4 5
Parseww5 :
(ww: ;
$strww; G
)wwG H
,wwH I
portwwJ N
)wwN O
;wwO P
listenerxx 
.xx 
Startxx 
(xx 
)xx  
;xx  !
tcpConnyy 
=yy 
listeneryy "
.yy" #
AcceptTcpClientyy# 2
(yy2 3
)yy3 4
;yy4 5
streamOutputzz 
=zz 
tcpConnzz &
.zz& '
	GetStreamzz' 0
(zz0 1
)zz1 2
;zz2 3

IPEndPoint{{ 
endPoint{{ #
={{$ %
({{& '

IPEndPoint{{' 1
){{1 2
tcpConn{{2 9
.{{9 :
Client{{: @
.{{@ A
RemoteEndPoint{{A O
;{{O P
	IPAddress|| 
	ipAddress|| #
=||$ %
endPoint||& .
.||. /
Address||/ 6
;||6 7
IPHostEntry}} 
	hostEntry}} %
=}}& '
Dns}}( +
.}}+ ,
GetHostEntry}}, 8
(}}8 9
	ipAddress}}9 B
)}}B C
;}}C D
streamOutput 
. 
Write "
(" #
Encoding# +
.+ ,
UTF8, 0
.0 1
GetBytes1 9
(9 :
(: ;
$str; F
+G H
	hostEntryI R
.R S
ToStringS [
([ \
)\ ]
)] ^
)^ _
,_ `
$numa b
,b c
(d e
$stre p
+q r
	hostEntrys |
.| }
ToString	} Ö
(
Ö Ü
)
Ü á
)
á à
.
à â
Length
â è
)
è ê
;
ê ë
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
IOException
ÅÅ 
exceptIO
ÅÅ '
)
ÅÅ' (
{
ÇÇ 
IO
ÉÉ 
.
ÉÉ 
Logger
ÉÉ 
.
ÉÉ 
Log
ÉÉ 
(
ÉÉ 
NLog
ÉÉ "
.
ÉÉ" #
LogLevel
ÉÉ# +
.
ÉÉ+ ,
Warn
ÉÉ, 0
,
ÉÉ0 1
exceptIO
ÉÉ2 :
,
ÉÉ: ;
$str
ÉÉ< X
+
ÉÉY Z
port
ÉÉ[ _
.
ÉÉ_ `
ToString
ÉÉ` h
(
ÉÉh i
)
ÉÉi j
)
ÉÉj k
;
ÉÉk l
}
ÑÑ 
finally
ÖÖ 
{
ÜÜ 
try
áá 
{
àà 
if
ââ 
(
ââ 
streamOutput
ââ $
!=
ââ% '
null
ââ( ,
)
ââ, -
{
ää 
streamOutput
ãã $
.
ãã$ %
Close
ãã% *
(
ãã* +
)
ãã+ ,
;
ãã, -
}
åå 
}
çç 
catch
éé 
(
éé 
IOException
éé "
exceptIO
éé# +
)
éé+ ,
{
èè 
IO
êê 
.
êê 
Logger
êê 
.
êê 
Log
êê !
(
êê! "
NLog
êê" &
.
êê& '
LogLevel
êê' /
.
êê/ 0
Warn
êê0 4
,
êê4 5
exceptIO
êê6 >
,
êê> ?
$str
êê@ W
)
êêW X
;
êêX Y
}
ëë 
try
ìì 
{
îî 
if
ïï 
(
ïï 
tcpConn
ïï 
!=
ïï  "
null
ïï# '
)
ïï' (
{
ññ 
tcpConn
óó 
.
óó  
Close
óó  %
(
óó% &
)
óó& '
;
óó' (
}
òò 
}
ôô 
catch
öö 
(
öö 
IOException
öö "
exceptIO
öö# +
)
öö+ ,
{
õõ 
IO
úú 
.
úú 
Logger
úú 
.
úú 
Log
úú !
(
úú! "
NLog
úú" &
.
úú& '
LogLevel
úú' /
.
úú/ 0
Warn
úú0 4
,
úú4 5
exceptIO
úú6 >
,
úú> ?
$str
úú@ W
)
úúW X
;
úúX Y
}
ùù 
try
üü 
{
†† 
if
°° 
(
°° 
listener
°°  
!=
°°! #
null
°°$ (
)
°°( )
{
¢¢ 
listener
££  
.
££  !
Stop
££! %
(
££% &
)
££& '
;
££' (
}
§§ 
}
•• 
catch
¶¶ 
(
¶¶ 
IOException
¶¶ "
exceptIO
¶¶# +
)
¶¶+ ,
{
ßß 
IO
®® 
.
®® 
Logger
®® 
.
®® 
Log
®® !
(
®®! "
NLog
®®" &
.
®®& '
LogLevel
®®' /
.
®®/ 0
Warn
®®0 4
,
®®4 5
exceptIO
®®6 >
,
®®> ?
$str
®®@ W
)
®®W X
;
®®X Y
}
©© 
}
´´ 
}
¨¨ 	
}
≠≠ 
private
∞∞ 
void
∞∞ 
Good2
∞∞ 
(
∞∞ 
)
∞∞ 
{
±± 
if
≤≤ 

(
≤≤ 
IO
≤≤ 
.
≤≤ "
STATIC_READONLY_TRUE
≤≤ #
)
≤≤# $
{
≥≥ 	
TcpListener
¥¥ 
listener
¥¥  
=
¥¥! "
null
¥¥# '
;
¥¥' (
	TcpClient
µµ 
tcpConn
µµ 
=
µµ 
null
µµ  $
;
µµ$ %
Stream
∂∂ 
streamOutput
∂∂ 
=
∂∂  !
null
∂∂" &
;
∂∂& '
int
∑∑ 
port
∑∑ 
=
∑∑ 
$num
∑∑ 
;
∑∑ 
try
∏∏ 
{
ππ 
listener
∫∫ 
=
∫∫ 
new
∫∫ 
TcpListener
∫∫ *
(
∫∫* +
	IPAddress
∫∫+ 4
.
∫∫4 5
Parse
∫∫5 :
(
∫∫: ;
$str
∫∫; G
)
∫∫G H
,
∫∫H I
port
∫∫J N
)
∫∫N O
;
∫∫O P
listener
ªª 
.
ªª 
Start
ªª 
(
ªª 
)
ªª  
;
ªª  !
tcpConn
ºº 
=
ºº 
listener
ºº "
.
ºº" #
AcceptTcpClient
ºº# 2
(
ºº2 3
)
ºº3 4
;
ºº4 5
streamOutput
ΩΩ 
=
ΩΩ 
tcpConn
ΩΩ &
.
ΩΩ& '
	GetStream
ΩΩ' 0
(
ΩΩ0 1
)
ΩΩ1 2
;
ΩΩ2 3

IPEndPoint
ææ 
endPoint
ææ #
=
ææ$ %
(
ææ& '

IPEndPoint
ææ' 1
)
ææ1 2
tcpConn
ææ2 9
.
ææ9 :
Client
ææ: @
.
ææ@ A
RemoteEndPoint
ææA O
;
ææO P
	IPAddress
øø 
	ipAddress
øø #
=
øø$ %
endPoint
øø& .
.
øø. /
Address
øø/ 6
;
øø6 7
IPHostEntry
¿¿ 
	hostEntry
¿¿ %
=
¿¿& '
Dns
¿¿( +
.
¿¿+ ,
GetHostEntry
¿¿, 8
(
¿¿8 9
	ipAddress
¿¿9 B
)
¿¿B C
;
¿¿C D
streamOutput
¬¬ 
.
¬¬ 
Write
¬¬ "
(
¬¬" #
Encoding
¬¬# +
.
¬¬+ ,
UTF8
¬¬, 0
.
¬¬0 1
GetBytes
¬¬1 9
(
¬¬9 :
(
¬¬: ;
$str
¬¬; F
+
¬¬G H
	hostEntry
¬¬I R
.
¬¬R S
ToString
¬¬S [
(
¬¬[ \
)
¬¬\ ]
)
¬¬] ^
)
¬¬^ _
,
¬¬_ `
$num
¬¬a b
,
¬¬b c
(
¬¬d e
$str
¬¬e p
+
¬¬q r
	hostEntry
¬¬s |
.
¬¬| }
ToString¬¬} Ö
(¬¬Ö Ü
)¬¬Ü á
)¬¬á à
.¬¬à â
Length¬¬â è
)¬¬è ê
;¬¬ê ë
}
√√ 
catch
ƒƒ 
(
ƒƒ 
IOException
ƒƒ 
exceptIO
ƒƒ '
)
ƒƒ' (
{
≈≈ 
IO
∆∆ 
.
∆∆ 
Logger
∆∆ 
.
∆∆ 
Log
∆∆ 
(
∆∆ 
NLog
∆∆ "
.
∆∆" #
LogLevel
∆∆# +
.
∆∆+ ,
Warn
∆∆, 0
,
∆∆0 1
exceptIO
∆∆2 :
,
∆∆: ;
$str
∆∆< X
+
∆∆Y Z
port
∆∆[ _
.
∆∆_ `
ToString
∆∆` h
(
∆∆h i
)
∆∆i j
)
∆∆j k
;
∆∆k l
}
«« 
finally
»» 
{
…… 
try
   
{
ÀÀ 
if
ÃÃ 
(
ÃÃ 
streamOutput
ÃÃ $
!=
ÃÃ% '
null
ÃÃ( ,
)
ÃÃ, -
{
ÕÕ 
streamOutput
ŒŒ $
.
ŒŒ$ %
Close
ŒŒ% *
(
ŒŒ* +
)
ŒŒ+ ,
;
ŒŒ, -
}
œœ 
}
–– 
catch
—— 
(
—— 
IOException
—— "
exceptIO
——# +
)
——+ ,
{
““ 
IO
”” 
.
”” 
Logger
”” 
.
”” 
Log
”” !
(
””! "
NLog
””" &
.
””& '
LogLevel
””' /
.
””/ 0
Warn
””0 4
,
””4 5
exceptIO
””6 >
,
””> ?
$str
””@ W
)
””W X
;
””X Y
}
‘‘ 
try
÷÷ 
{
◊◊ 
if
ÿÿ 
(
ÿÿ 
tcpConn
ÿÿ 
!=
ÿÿ  "
null
ÿÿ# '
)
ÿÿ' (
{
ŸŸ 
tcpConn
⁄⁄ 
.
⁄⁄  
Close
⁄⁄  %
(
⁄⁄% &
)
⁄⁄& '
;
⁄⁄' (
}
€€ 
}
‹‹ 
catch
›› 
(
›› 
IOException
›› "
exceptIO
››# +
)
››+ ,
{
ﬁﬁ 
IO
ﬂﬂ 
.
ﬂﬂ 
Logger
ﬂﬂ 
.
ﬂﬂ 
Log
ﬂﬂ !
(
ﬂﬂ! "
NLog
ﬂﬂ" &
.
ﬂﬂ& '
LogLevel
ﬂﬂ' /
.
ﬂﬂ/ 0
Warn
ﬂﬂ0 4
,
ﬂﬂ4 5
exceptIO
ﬂﬂ6 >
,
ﬂﬂ> ?
$str
ﬂﬂ@ W
)
ﬂﬂW X
;
ﬂﬂX Y
}
‡‡ 
try
‚‚ 
{
„„ 
if
‰‰ 
(
‰‰ 
listener
‰‰  
!=
‰‰! #
null
‰‰$ (
)
‰‰( )
{
ÂÂ 
listener
ÊÊ  
.
ÊÊ  !
Stop
ÊÊ! %
(
ÊÊ% &
)
ÊÊ& '
;
ÊÊ' (
}
ÁÁ 
}
ËË 
catch
ÈÈ 
(
ÈÈ 
IOException
ÈÈ "
exceptIO
ÈÈ# +
)
ÈÈ+ ,
{
ÍÍ 
IO
ÎÎ 
.
ÎÎ 
Logger
ÎÎ 
.
ÎÎ 
Log
ÎÎ !
(
ÎÎ! "
NLog
ÎÎ" &
.
ÎÎ& '
LogLevel
ÎÎ' /
.
ÎÎ/ 0
Warn
ÎÎ0 4
,
ÎÎ4 5
exceptIO
ÎÎ6 >
,
ÎÎ> ?
$str
ÎÎ@ W
)
ÎÎW X
;
ÎÎX Y
}
ÏÏ 
}
ÓÓ 
}
ÔÔ 	
}
 
public
ÚÚ 

override
ÚÚ 
void
ÚÚ 
Good
ÚÚ 
(
ÚÚ 
)
ÚÚ 
{
ÛÛ 
Good1
ÙÙ 
(
ÙÙ 
)
ÙÙ 
;
ÙÙ 
Good2
ıı 
(
ıı 
)
ıı 
;
ıı 
}
ˆˆ 
}¯¯ 
}˘˘ ¯â
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__ip_based_logic_10.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__ip_based_logic_10 (
:) *
AbstractTestCase+ ;
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
IO 
. 

staticTrue 
) 
{   	
TcpListener!! 
listener!!  
=!!! "
null!!# '
;!!' (
	TcpClient"" 
tcpConn"" 
="" 
null""  $
;""$ %
Stream## 
streamOutput## 
=##  !
null##" &
;##& '
int$$ 
port$$ 
=$$ 
$num$$ 
;$$ 
try%% 
{&& 
listener'' 
='' 
new'' 
TcpListener'' *
(''* +
	IPAddress''+ 4
.''4 5
Parse''5 :
('': ;
$str''; G
)''G H
,''H I
port''J N
)''N O
;''O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
tcpConn)) 
=)) 
listener)) "
.))" #
AcceptTcpClient))# 2
())2 3
)))3 4
;))4 5

IPEndPoint++ 
endPoint++ #
=++$ %
(++& '

IPEndPoint++' 1
)++1 2
tcpConn++2 9
.++9 :
Client++: @
.++@ A
RemoteEndPoint++A O
;++O P
	IPAddress,, 
	ipAddress,, #
=,,$ %
endPoint,,& .
.,,. /
Address,,/ 6
;,,6 7
IPHostEntry-- 
	hostEntry-- %
=--& '
Dns--( +
.--+ ,
GetHostEntry--, 8
(--8 9
	ipAddress--9 B
)--B C
;--C D
if.. 
(.. 
	hostEntry.. 
... 
Equals.. $
(..$ %
$str..% 5
)..5 6
)..6 7
{// 
streamOutput00  
=00! "
tcpConn00# *
.00* +
	GetStream00+ 4
(004 5
)005 6
;006 7
streamOutput11  
.11  !
Write11! &
(11& '
Encoding11' /
.11/ 0
UTF8110 4
.114 5
GetBytes115 =
(11= >
$str11> O
)11O P
,11P Q
$num11R S
,11S T
$str11U f
.11f g
Length11g m
)11m n
;11n o
}22 
else33 
{44 
streamOutput55  
=55! "
tcpConn55# *
.55* +
	GetStream55+ 4
(554 5
)555 6
;556 7
streamOutput66  
.66  !
Write66! &
(66& '
Encoding66' /
.66/ 0
UTF8660 4
.664 5
GetBytes665 =
(66= >
$str66> N
)66N O
,66O P
$num66Q R
,66R S
$str66T d
.66d e
Length66e k
)66k l
;66l m
}77 
}88 
catch99 
(99 
IOException99 
exceptIO99 '
)99' (
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; 
(;; 
NLog;; "
.;;" #
LogLevel;;# +
.;;+ ,
Warn;;, 0
,;;0 1
exceptIO;;2 :
,;;: ;
$str;;< X
+;;Y Z
port;;[ _
.;;_ `
ToString;;` h
(;;h i
);;i j
);;j k
;;;k l
}<< 
finally== 
{>> 
try?? 
{@@ 
ifAA 
(AA 
streamOutputAA $
!=AA% '
nullAA( ,
)AA, -
{BB 
streamOutputCC $
.CC$ %
CloseCC% *
(CC* +
)CC+ ,
;CC, -
}DD 
}EE 
catchFF 
(FF 
IOExceptionFF "
exceptIOFF# +
)FF+ ,
{GG 
IOHH 
.HH 
LoggerHH 
.HH 
LogHH !
(HH! "
NLogHH" &
.HH& '
LogLevelHH' /
.HH/ 0
WarnHH0 4
,HH4 5
exceptIOHH6 >
,HH> ?
$strHH@ W
)HHW X
;HHX Y
}II 
tryKK 
{LL 
ifMM 
(MM 
tcpConnMM 
!=MM  "
nullMM# '
)MM' (
{NN 
tcpConnOO 
.OO  
CloseOO  %
(OO% &
)OO& '
;OO' (
}PP 
}QQ 
catchRR 
(RR 
IOExceptionRR "
exceptIORR# +
)RR+ ,
{SS 
IOTT 
.TT 
LoggerTT 
.TT 
LogTT !
(TT! "
NLogTT" &
.TT& '
LogLevelTT' /
.TT/ 0
WarnTT0 4
,TT4 5
exceptIOTT6 >
,TT> ?
$strTT@ W
)TTW X
;TTX Y
}UU 
tryWW 
{XX 
ifYY 
(YY 
listenerYY  
!=YY! #
nullYY$ (
)YY( )
{ZZ 
listener[[  
.[[  !
Stop[[! %
([[% &
)[[& '
;[[' (
}\\ 
}]] 
catch^^ 
(^^ 
IOException^^ "
exceptIO^^# +
)^^+ ,
{__ 
IO`` 
.`` 
Logger`` 
.`` 
Log`` !
(``! "
NLog``" &
.``& '
LogLevel``' /
.``/ 0
Warn``0 4
,``4 5
exceptIO``6 >
,``> ?
$str``@ W
)``W X
;``X Y
}aa 
}bb 
}cc 	
}dd 
privatehh 
voidhh 
Good1hh 
(hh 
)hh 
{ii 
ifjj 

(jj 
IOjj 
.jj 
staticFalsejj 
)jj 
{kk 	
IOmm 
.mm 
	WriteLinemm 
(mm 
$strmm /
)mm/ 0
;mm0 1
}nn 	
elseoo 
{pp 	
TcpListenerqq 
listenerqq  
=qq! "
nullqq# '
;qq' (
	TcpClientrr 
tcpConnrr 
=rr 
nullrr  $
;rr$ %
Streamss 
streamOutputss 
=ss  !
nullss" &
;ss& '
inttt 
porttt 
=tt 
$numtt 
;tt 
tryuu 
{vv 
listenerww 
=ww 
newww 
TcpListenerww *
(ww* +
	IPAddressww+ 4
.ww4 5
Parseww5 :
(ww: ;
$strww; G
)wwG H
,wwH I
portwwJ N
)wwN O
;wwO P
listenerxx 
.xx 
Startxx 
(xx 
)xx  
;xx  !
tcpConnyy 
=yy 
listeneryy "
.yy" #
AcceptTcpClientyy# 2
(yy2 3
)yy3 4
;yy4 5
streamOutputzz 
=zz 
tcpConnzz &
.zz& '
	GetStreamzz' 0
(zz0 1
)zz1 2
;zz2 3

IPEndPoint{{ 
endPoint{{ #
={{$ %
({{& '

IPEndPoint{{' 1
){{1 2
tcpConn{{2 9
.{{9 :
Client{{: @
.{{@ A
RemoteEndPoint{{A O
;{{O P
	IPAddress|| 
	ipAddress|| #
=||$ %
endPoint||& .
.||. /
Address||/ 6
;||6 7
IPHostEntry}} 
	hostEntry}} %
=}}& '
Dns}}( +
.}}+ ,
GetHostEntry}}, 8
(}}8 9
	ipAddress}}9 B
)}}B C
;}}C D
streamOutput 
. 
Write "
(" #
Encoding# +
.+ ,
UTF8, 0
.0 1
GetBytes1 9
(9 :
(: ;
$str; F
+G H
	hostEntryI R
.R S
ToStringS [
([ \
)\ ]
)] ^
)^ _
,_ `
$numa b
,b c
(d e
$stre p
+q r
	hostEntrys |
.| }
ToString	} Ö
(
Ö Ü
)
Ü á
)
á à
.
à â
Length
â è
)
è ê
;
ê ë
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
IOException
ÅÅ 
exceptIO
ÅÅ '
)
ÅÅ' (
{
ÇÇ 
IO
ÉÉ 
.
ÉÉ 
Logger
ÉÉ 
.
ÉÉ 
Log
ÉÉ 
(
ÉÉ 
NLog
ÉÉ "
.
ÉÉ" #
LogLevel
ÉÉ# +
.
ÉÉ+ ,
Warn
ÉÉ, 0
,
ÉÉ0 1
exceptIO
ÉÉ2 :
,
ÉÉ: ;
$str
ÉÉ< X
+
ÉÉY Z
port
ÉÉ[ _
.
ÉÉ_ `
ToString
ÉÉ` h
(
ÉÉh i
)
ÉÉi j
)
ÉÉj k
;
ÉÉk l
}
ÑÑ 
finally
ÖÖ 
{
ÜÜ 
try
áá 
{
àà 
if
ââ 
(
ââ 
streamOutput
ââ $
!=
ââ% '
null
ââ( ,
)
ââ, -
{
ää 
streamOutput
ãã $
.
ãã$ %
Close
ãã% *
(
ãã* +
)
ãã+ ,
;
ãã, -
}
åå 
}
çç 
catch
éé 
(
éé 
IOException
éé "
exceptIO
éé# +
)
éé+ ,
{
èè 
IO
êê 
.
êê 
Logger
êê 
.
êê 
Log
êê !
(
êê! "
NLog
êê" &
.
êê& '
LogLevel
êê' /
.
êê/ 0
Warn
êê0 4
,
êê4 5
exceptIO
êê6 >
,
êê> ?
$str
êê@ W
)
êêW X
;
êêX Y
}
ëë 
try
ìì 
{
îî 
if
ïï 
(
ïï 
tcpConn
ïï 
!=
ïï  "
null
ïï# '
)
ïï' (
{
ññ 
tcpConn
óó 
.
óó  
Close
óó  %
(
óó% &
)
óó& '
;
óó' (
}
òò 
}
ôô 
catch
öö 
(
öö 
IOException
öö "
exceptIO
öö# +
)
öö+ ,
{
õõ 
IO
úú 
.
úú 
Logger
úú 
.
úú 
Log
úú !
(
úú! "
NLog
úú" &
.
úú& '
LogLevel
úú' /
.
úú/ 0
Warn
úú0 4
,
úú4 5
exceptIO
úú6 >
,
úú> ?
$str
úú@ W
)
úúW X
;
úúX Y
}
ùù 
try
üü 
{
†† 
if
°° 
(
°° 
listener
°°  
!=
°°! #
null
°°$ (
)
°°( )
{
¢¢ 
listener
££  
.
££  !
Stop
££! %
(
££% &
)
££& '
;
££' (
}
§§ 
}
•• 
catch
¶¶ 
(
¶¶ 
IOException
¶¶ "
exceptIO
¶¶# +
)
¶¶+ ,
{
ßß 
IO
®® 
.
®® 
Logger
®® 
.
®® 
Log
®® !
(
®®! "
NLog
®®" &
.
®®& '
LogLevel
®®' /
.
®®/ 0
Warn
®®0 4
,
®®4 5
exceptIO
®®6 >
,
®®> ?
$str
®®@ W
)
®®W X
;
®®X Y
}
©© 
}
´´ 
}
¨¨ 	
}
≠≠ 
private
∞∞ 
void
∞∞ 
Good2
∞∞ 
(
∞∞ 
)
∞∞ 
{
±± 
if
≤≤ 

(
≤≤ 
IO
≤≤ 
.
≤≤ 

staticTrue
≤≤ 
)
≤≤ 
{
≥≥ 	
TcpListener
¥¥ 
listener
¥¥  
=
¥¥! "
null
¥¥# '
;
¥¥' (
	TcpClient
µµ 
tcpConn
µµ 
=
µµ 
null
µµ  $
;
µµ$ %
Stream
∂∂ 
streamOutput
∂∂ 
=
∂∂  !
null
∂∂" &
;
∂∂& '
int
∑∑ 
port
∑∑ 
=
∑∑ 
$num
∑∑ 
;
∑∑ 
try
∏∏ 
{
ππ 
listener
∫∫ 
=
∫∫ 
new
∫∫ 
TcpListener
∫∫ *
(
∫∫* +
	IPAddress
∫∫+ 4
.
∫∫4 5
Parse
∫∫5 :
(
∫∫: ;
$str
∫∫; G
)
∫∫G H
,
∫∫H I
port
∫∫J N
)
∫∫N O
;
∫∫O P
listener
ªª 
.
ªª 
Start
ªª 
(
ªª 
)
ªª  
;
ªª  !
tcpConn
ºº 
=
ºº 
listener
ºº "
.
ºº" #
AcceptTcpClient
ºº# 2
(
ºº2 3
)
ºº3 4
;
ºº4 5
streamOutput
ΩΩ 
=
ΩΩ 
tcpConn
ΩΩ &
.
ΩΩ& '
	GetStream
ΩΩ' 0
(
ΩΩ0 1
)
ΩΩ1 2
;
ΩΩ2 3

IPEndPoint
ææ 
endPoint
ææ #
=
ææ$ %
(
ææ& '

IPEndPoint
ææ' 1
)
ææ1 2
tcpConn
ææ2 9
.
ææ9 :
Client
ææ: @
.
ææ@ A
RemoteEndPoint
ææA O
;
ææO P
	IPAddress
øø 
	ipAddress
øø #
=
øø$ %
endPoint
øø& .
.
øø. /
Address
øø/ 6
;
øø6 7
IPHostEntry
¿¿ 
	hostEntry
¿¿ %
=
¿¿& '
Dns
¿¿( +
.
¿¿+ ,
GetHostEntry
¿¿, 8
(
¿¿8 9
	ipAddress
¿¿9 B
)
¿¿B C
;
¿¿C D
streamOutput
¬¬ 
.
¬¬ 
Write
¬¬ "
(
¬¬" #
Encoding
¬¬# +
.
¬¬+ ,
UTF8
¬¬, 0
.
¬¬0 1
GetBytes
¬¬1 9
(
¬¬9 :
(
¬¬: ;
$str
¬¬; F
+
¬¬G H
	hostEntry
¬¬I R
.
¬¬R S
ToString
¬¬S [
(
¬¬[ \
)
¬¬\ ]
)
¬¬] ^
)
¬¬^ _
,
¬¬_ `
$num
¬¬a b
,
¬¬b c
(
¬¬d e
$str
¬¬e p
+
¬¬q r
	hostEntry
¬¬s |
.
¬¬| }
ToString¬¬} Ö
(¬¬Ö Ü
)¬¬Ü á
)¬¬á à
.¬¬à â
Length¬¬â è
)¬¬è ê
;¬¬ê ë
}
√√ 
catch
ƒƒ 
(
ƒƒ 
IOException
ƒƒ 
exceptIO
ƒƒ '
)
ƒƒ' (
{
≈≈ 
IO
∆∆ 
.
∆∆ 
Logger
∆∆ 
.
∆∆ 
Log
∆∆ 
(
∆∆ 
NLog
∆∆ "
.
∆∆" #
LogLevel
∆∆# +
.
∆∆+ ,
Warn
∆∆, 0
,
∆∆0 1
exceptIO
∆∆2 :
,
∆∆: ;
$str
∆∆< X
+
∆∆Y Z
port
∆∆[ _
.
∆∆_ `
ToString
∆∆` h
(
∆∆h i
)
∆∆i j
)
∆∆j k
;
∆∆k l
}
«« 
finally
»» 
{
…… 
try
   
{
ÀÀ 
if
ÃÃ 
(
ÃÃ 
streamOutput
ÃÃ $
!=
ÃÃ% '
null
ÃÃ( ,
)
ÃÃ, -
{
ÕÕ 
streamOutput
ŒŒ $
.
ŒŒ$ %
Close
ŒŒ% *
(
ŒŒ* +
)
ŒŒ+ ,
;
ŒŒ, -
}
œœ 
}
–– 
catch
—— 
(
—— 
IOException
—— "
exceptIO
——# +
)
——+ ,
{
““ 
IO
”” 
.
”” 
Logger
”” 
.
”” 
Log
”” !
(
””! "
NLog
””" &
.
””& '
LogLevel
””' /
.
””/ 0
Warn
””0 4
,
””4 5
exceptIO
””6 >
,
””> ?
$str
””@ W
)
””W X
;
””X Y
}
‘‘ 
try
÷÷ 
{
◊◊ 
if
ÿÿ 
(
ÿÿ 
tcpConn
ÿÿ 
!=
ÿÿ  "
null
ÿÿ# '
)
ÿÿ' (
{
ŸŸ 
tcpConn
⁄⁄ 
.
⁄⁄  
Close
⁄⁄  %
(
⁄⁄% &
)
⁄⁄& '
;
⁄⁄' (
}
€€ 
}
‹‹ 
catch
›› 
(
›› 
IOException
›› "
exceptIO
››# +
)
››+ ,
{
ﬁﬁ 
IO
ﬂﬂ 
.
ﬂﬂ 
Logger
ﬂﬂ 
.
ﬂﬂ 
Log
ﬂﬂ !
(
ﬂﬂ! "
NLog
ﬂﬂ" &
.
ﬂﬂ& '
LogLevel
ﬂﬂ' /
.
ﬂﬂ/ 0
Warn
ﬂﬂ0 4
,
ﬂﬂ4 5
exceptIO
ﬂﬂ6 >
,
ﬂﬂ> ?
$str
ﬂﬂ@ W
)
ﬂﬂW X
;
ﬂﬂX Y
}
‡‡ 
try
‚‚ 
{
„„ 
if
‰‰ 
(
‰‰ 
listener
‰‰  
!=
‰‰! #
null
‰‰$ (
)
‰‰( )
{
ÂÂ 
listener
ÊÊ  
.
ÊÊ  !
Stop
ÊÊ! %
(
ÊÊ% &
)
ÊÊ& '
;
ÊÊ' (
}
ÁÁ 
}
ËË 
catch
ÈÈ 
(
ÈÈ 
IOException
ÈÈ "
exceptIO
ÈÈ# +
)
ÈÈ+ ,
{
ÍÍ 
IO
ÎÎ 
.
ÎÎ 
Logger
ÎÎ 
.
ÎÎ 
Log
ÎÎ !
(
ÎÎ! "
NLog
ÎÎ" &
.
ÎÎ& '
LogLevel
ÎÎ' /
.
ÎÎ/ 0
Warn
ÎÎ0 4
,
ÎÎ4 5
exceptIO
ÎÎ6 >
,
ÎÎ> ?
$str
ÎÎ@ W
)
ÎÎW X
;
ÎÎX Y
}
ÏÏ 
}
ÓÓ 
}
ÔÔ 	
}
 
public
ÚÚ 

override
ÚÚ 
void
ÚÚ 
Good
ÚÚ 
(
ÚÚ 
)
ÚÚ 
{
ÛÛ 
Good1
ÙÙ 
(
ÙÙ 
)
ÙÙ 
;
ÙÙ 
Good2
ıı 
(
ıı 
)
ıı 
;
ıı 
}
ˆˆ 
}¯¯ 
}˘˘ Îä
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__ip_based_logic_11.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__ip_based_logic_11 (
:) *
AbstractTestCase+ ;
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
IO 
. 
StaticReturnsTrue  
(  !
)! "
)" #
{   	
TcpListener!! 
listener!!  
=!!! "
null!!# '
;!!' (
	TcpClient"" 
tcpConn"" 
="" 
null""  $
;""$ %
Stream## 
streamOutput## 
=##  !
null##" &
;##& '
int$$ 
port$$ 
=$$ 
$num$$ 
;$$ 
try%% 
{&& 
listener'' 
='' 
new'' 
TcpListener'' *
(''* +
	IPAddress''+ 4
.''4 5
Parse''5 :
('': ;
$str''; G
)''G H
,''H I
port''J N
)''N O
;''O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
tcpConn)) 
=)) 
listener)) "
.))" #
AcceptTcpClient))# 2
())2 3
)))3 4
;))4 5

IPEndPoint++ 
endPoint++ #
=++$ %
(++& '

IPEndPoint++' 1
)++1 2
tcpConn++2 9
.++9 :
Client++: @
.++@ A
RemoteEndPoint++A O
;++O P
	IPAddress,, 
	ipAddress,, #
=,,$ %
endPoint,,& .
.,,. /
Address,,/ 6
;,,6 7
IPHostEntry-- 
	hostEntry-- %
=--& '
Dns--( +
.--+ ,
GetHostEntry--, 8
(--8 9
	ipAddress--9 B
)--B C
;--C D
if.. 
(.. 
	hostEntry.. 
... 
Equals.. $
(..$ %
$str..% 5
)..5 6
)..6 7
{// 
streamOutput00  
=00! "
tcpConn00# *
.00* +
	GetStream00+ 4
(004 5
)005 6
;006 7
streamOutput11  
.11  !
Write11! &
(11& '
Encoding11' /
.11/ 0
UTF8110 4
.114 5
GetBytes115 =
(11= >
$str11> O
)11O P
,11P Q
$num11R S
,11S T
$str11U f
.11f g
Length11g m
)11m n
;11n o
}22 
else33 
{44 
streamOutput55  
=55! "
tcpConn55# *
.55* +
	GetStream55+ 4
(554 5
)555 6
;556 7
streamOutput66  
.66  !
Write66! &
(66& '
Encoding66' /
.66/ 0
UTF8660 4
.664 5
GetBytes665 =
(66= >
$str66> N
)66N O
,66O P
$num66Q R
,66R S
$str66T d
.66d e
Length66e k
)66k l
;66l m
}77 
}88 
catch99 
(99 
IOException99 
exceptIO99 '
)99' (
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; 
(;; 
NLog;; "
.;;" #
LogLevel;;# +
.;;+ ,
Warn;;, 0
,;;0 1
exceptIO;;2 :
,;;: ;
$str;;< X
+;;Y Z
port;;[ _
.;;_ `
ToString;;` h
(;;h i
);;i j
);;j k
;;;k l
}<< 
finally== 
{>> 
try?? 
{@@ 
ifAA 
(AA 
streamOutputAA $
!=AA% '
nullAA( ,
)AA, -
{BB 
streamOutputCC $
.CC$ %
CloseCC% *
(CC* +
)CC+ ,
;CC, -
}DD 
}EE 
catchFF 
(FF 
IOExceptionFF "
exceptIOFF# +
)FF+ ,
{GG 
IOHH 
.HH 
LoggerHH 
.HH 
LogHH !
(HH! "
NLogHH" &
.HH& '
LogLevelHH' /
.HH/ 0
WarnHH0 4
,HH4 5
exceptIOHH6 >
,HH> ?
$strHH@ W
)HHW X
;HHX Y
}II 
tryKK 
{LL 
ifMM 
(MM 
tcpConnMM 
!=MM  "
nullMM# '
)MM' (
{NN 
tcpConnOO 
.OO  
CloseOO  %
(OO% &
)OO& '
;OO' (
}PP 
}QQ 
catchRR 
(RR 
IOExceptionRR "
exceptIORR# +
)RR+ ,
{SS 
IOTT 
.TT 
LoggerTT 
.TT 
LogTT !
(TT! "
NLogTT" &
.TT& '
LogLevelTT' /
.TT/ 0
WarnTT0 4
,TT4 5
exceptIOTT6 >
,TT> ?
$strTT@ W
)TTW X
;TTX Y
}UU 
tryWW 
{XX 
ifYY 
(YY 
listenerYY  
!=YY! #
nullYY$ (
)YY( )
{ZZ 
listener[[  
.[[  !
Stop[[! %
([[% &
)[[& '
;[[' (
}\\ 
}]] 
catch^^ 
(^^ 
IOException^^ "
exceptIO^^# +
)^^+ ,
{__ 
IO`` 
.`` 
Logger`` 
.`` 
Log`` !
(``! "
NLog``" &
.``& '
LogLevel``' /
.``/ 0
Warn``0 4
,``4 5
exceptIO``6 >
,``> ?
$str``@ W
)``W X
;``X Y
}aa 
}bb 
}cc 	
}dd 
privatehh 
voidhh 
Good1hh 
(hh 
)hh 
{ii 
ifjj 

(jj 
IOjj 
.jj 
StaticReturnsFalsejj !
(jj! "
)jj" #
)jj# $
{kk 	
IOmm 
.mm 
	WriteLinemm 
(mm 
$strmm /
)mm/ 0
;mm0 1
}nn 	
elseoo 
{pp 	
TcpListenerqq 
listenerqq  
=qq! "
nullqq# '
;qq' (
	TcpClientrr 
tcpConnrr 
=rr 
nullrr  $
;rr$ %
Streamss 
streamOutputss 
=ss  !
nullss" &
;ss& '
inttt 
porttt 
=tt 
$numtt 
;tt 
tryuu 
{vv 
listenerww 
=ww 
newww 
TcpListenerww *
(ww* +
	IPAddressww+ 4
.ww4 5
Parseww5 :
(ww: ;
$strww; G
)wwG H
,wwH I
portwwJ N
)wwN O
;wwO P
listenerxx 
.xx 
Startxx 
(xx 
)xx  
;xx  !
tcpConnyy 
=yy 
listeneryy "
.yy" #
AcceptTcpClientyy# 2
(yy2 3
)yy3 4
;yy4 5
streamOutputzz 
=zz 
tcpConnzz &
.zz& '
	GetStreamzz' 0
(zz0 1
)zz1 2
;zz2 3

IPEndPoint{{ 
endPoint{{ #
={{$ %
({{& '

IPEndPoint{{' 1
){{1 2
tcpConn{{2 9
.{{9 :
Client{{: @
.{{@ A
RemoteEndPoint{{A O
;{{O P
	IPAddress|| 
	ipAddress|| #
=||$ %
endPoint||& .
.||. /
Address||/ 6
;||6 7
IPHostEntry}} 
	hostEntry}} %
=}}& '
Dns}}( +
.}}+ ,
GetHostEntry}}, 8
(}}8 9
	ipAddress}}9 B
)}}B C
;}}C D
streamOutput 
. 
Write "
(" #
Encoding# +
.+ ,
UTF8, 0
.0 1
GetBytes1 9
(9 :
(: ;
$str; F
+G H
	hostEntryI R
.R S
ToStringS [
([ \
)\ ]
)] ^
)^ _
,_ `
$numa b
,b c
(d e
$stre p
+q r
	hostEntrys |
.| }
ToString	} Ö
(
Ö Ü
)
Ü á
)
á à
.
à â
Length
â è
)
è ê
;
ê ë
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
IOException
ÅÅ 
exceptIO
ÅÅ '
)
ÅÅ' (
{
ÇÇ 
IO
ÉÉ 
.
ÉÉ 
Logger
ÉÉ 
.
ÉÉ 
Log
ÉÉ 
(
ÉÉ 
NLog
ÉÉ "
.
ÉÉ" #
LogLevel
ÉÉ# +
.
ÉÉ+ ,
Warn
ÉÉ, 0
,
ÉÉ0 1
exceptIO
ÉÉ2 :
,
ÉÉ: ;
$str
ÉÉ< X
+
ÉÉY Z
port
ÉÉ[ _
.
ÉÉ_ `
ToString
ÉÉ` h
(
ÉÉh i
)
ÉÉi j
)
ÉÉj k
;
ÉÉk l
}
ÑÑ 
finally
ÖÖ 
{
ÜÜ 
try
áá 
{
àà 
if
ââ 
(
ââ 
streamOutput
ââ $
!=
ââ% '
null
ââ( ,
)
ââ, -
{
ää 
streamOutput
ãã $
.
ãã$ %
Close
ãã% *
(
ãã* +
)
ãã+ ,
;
ãã, -
}
åå 
}
çç 
catch
éé 
(
éé 
IOException
éé "
exceptIO
éé# +
)
éé+ ,
{
èè 
IO
êê 
.
êê 
Logger
êê 
.
êê 
Log
êê !
(
êê! "
NLog
êê" &
.
êê& '
LogLevel
êê' /
.
êê/ 0
Warn
êê0 4
,
êê4 5
exceptIO
êê6 >
,
êê> ?
$str
êê@ W
)
êêW X
;
êêX Y
}
ëë 
try
ìì 
{
îî 
if
ïï 
(
ïï 
tcpConn
ïï 
!=
ïï  "
null
ïï# '
)
ïï' (
{
ññ 
tcpConn
óó 
.
óó  
Close
óó  %
(
óó% &
)
óó& '
;
óó' (
}
òò 
}
ôô 
catch
öö 
(
öö 
IOException
öö "
exceptIO
öö# +
)
öö+ ,
{
õõ 
IO
úú 
.
úú 
Logger
úú 
.
úú 
Log
úú !
(
úú! "
NLog
úú" &
.
úú& '
LogLevel
úú' /
.
úú/ 0
Warn
úú0 4
,
úú4 5
exceptIO
úú6 >
,
úú> ?
$str
úú@ W
)
úúW X
;
úúX Y
}
ùù 
try
üü 
{
†† 
if
°° 
(
°° 
listener
°°  
!=
°°! #
null
°°$ (
)
°°( )
{
¢¢ 
listener
££  
.
££  !
Stop
££! %
(
££% &
)
££& '
;
££' (
}
§§ 
}
•• 
catch
¶¶ 
(
¶¶ 
IOException
¶¶ "
exceptIO
¶¶# +
)
¶¶+ ,
{
ßß 
IO
®® 
.
®® 
Logger
®® 
.
®® 
Log
®® !
(
®®! "
NLog
®®" &
.
®®& '
LogLevel
®®' /
.
®®/ 0
Warn
®®0 4
,
®®4 5
exceptIO
®®6 >
,
®®> ?
$str
®®@ W
)
®®W X
;
®®X Y
}
©© 
}
´´ 
}
¨¨ 	
}
≠≠ 
private
∞∞ 
void
∞∞ 
Good2
∞∞ 
(
∞∞ 
)
∞∞ 
{
±± 
if
≤≤ 

(
≤≤ 
IO
≤≤ 
.
≤≤ 
StaticReturnsTrue
≤≤  
(
≤≤  !
)
≤≤! "
)
≤≤" #
{
≥≥ 	
TcpListener
¥¥ 
listener
¥¥  
=
¥¥! "
null
¥¥# '
;
¥¥' (
	TcpClient
µµ 
tcpConn
µµ 
=
µµ 
null
µµ  $
;
µµ$ %
Stream
∂∂ 
streamOutput
∂∂ 
=
∂∂  !
null
∂∂" &
;
∂∂& '
int
∑∑ 
port
∑∑ 
=
∑∑ 
$num
∑∑ 
;
∑∑ 
try
∏∏ 
{
ππ 
listener
∫∫ 
=
∫∫ 
new
∫∫ 
TcpListener
∫∫ *
(
∫∫* +
	IPAddress
∫∫+ 4
.
∫∫4 5
Parse
∫∫5 :
(
∫∫: ;
$str
∫∫; G
)
∫∫G H
,
∫∫H I
port
∫∫J N
)
∫∫N O
;
∫∫O P
listener
ªª 
.
ªª 
Start
ªª 
(
ªª 
)
ªª  
;
ªª  !
tcpConn
ºº 
=
ºº 
listener
ºº "
.
ºº" #
AcceptTcpClient
ºº# 2
(
ºº2 3
)
ºº3 4
;
ºº4 5
streamOutput
ΩΩ 
=
ΩΩ 
tcpConn
ΩΩ &
.
ΩΩ& '
	GetStream
ΩΩ' 0
(
ΩΩ0 1
)
ΩΩ1 2
;
ΩΩ2 3

IPEndPoint
ææ 
endPoint
ææ #
=
ææ$ %
(
ææ& '

IPEndPoint
ææ' 1
)
ææ1 2
tcpConn
ææ2 9
.
ææ9 :
Client
ææ: @
.
ææ@ A
RemoteEndPoint
ææA O
;
ææO P
	IPAddress
øø 
	ipAddress
øø #
=
øø$ %
endPoint
øø& .
.
øø. /
Address
øø/ 6
;
øø6 7
IPHostEntry
¿¿ 
	hostEntry
¿¿ %
=
¿¿& '
Dns
¿¿( +
.
¿¿+ ,
GetHostEntry
¿¿, 8
(
¿¿8 9
	ipAddress
¿¿9 B
)
¿¿B C
;
¿¿C D
streamOutput
¬¬ 
.
¬¬ 
Write
¬¬ "
(
¬¬" #
Encoding
¬¬# +
.
¬¬+ ,
UTF8
¬¬, 0
.
¬¬0 1
GetBytes
¬¬1 9
(
¬¬9 :
(
¬¬: ;
$str
¬¬; F
+
¬¬G H
	hostEntry
¬¬I R
.
¬¬R S
ToString
¬¬S [
(
¬¬[ \
)
¬¬\ ]
)
¬¬] ^
)
¬¬^ _
,
¬¬_ `
$num
¬¬a b
,
¬¬b c
(
¬¬d e
$str
¬¬e p
+
¬¬q r
	hostEntry
¬¬s |
.
¬¬| }
ToString¬¬} Ö
(¬¬Ö Ü
)¬¬Ü á
)¬¬á à
.¬¬à â
Length¬¬â è
)¬¬è ê
;¬¬ê ë
}
√√ 
catch
ƒƒ 
(
ƒƒ 
IOException
ƒƒ 
exceptIO
ƒƒ '
)
ƒƒ' (
{
≈≈ 
IO
∆∆ 
.
∆∆ 
Logger
∆∆ 
.
∆∆ 
Log
∆∆ 
(
∆∆ 
NLog
∆∆ "
.
∆∆" #
LogLevel
∆∆# +
.
∆∆+ ,
Warn
∆∆, 0
,
∆∆0 1
exceptIO
∆∆2 :
,
∆∆: ;
$str
∆∆< X
+
∆∆Y Z
port
∆∆[ _
.
∆∆_ `
ToString
∆∆` h
(
∆∆h i
)
∆∆i j
)
∆∆j k
;
∆∆k l
}
«« 
finally
»» 
{
…… 
try
   
{
ÀÀ 
if
ÃÃ 
(
ÃÃ 
streamOutput
ÃÃ $
!=
ÃÃ% '
null
ÃÃ( ,
)
ÃÃ, -
{
ÕÕ 
streamOutput
ŒŒ $
.
ŒŒ$ %
Close
ŒŒ% *
(
ŒŒ* +
)
ŒŒ+ ,
;
ŒŒ, -
}
œœ 
}
–– 
catch
—— 
(
—— 
IOException
—— "
exceptIO
——# +
)
——+ ,
{
““ 
IO
”” 
.
”” 
Logger
”” 
.
”” 
Log
”” !
(
””! "
NLog
””" &
.
””& '
LogLevel
””' /
.
””/ 0
Warn
””0 4
,
””4 5
exceptIO
””6 >
,
””> ?
$str
””@ W
)
””W X
;
””X Y
}
‘‘ 
try
÷÷ 
{
◊◊ 
if
ÿÿ 
(
ÿÿ 
tcpConn
ÿÿ 
!=
ÿÿ  "
null
ÿÿ# '
)
ÿÿ' (
{
ŸŸ 
tcpConn
⁄⁄ 
.
⁄⁄  
Close
⁄⁄  %
(
⁄⁄% &
)
⁄⁄& '
;
⁄⁄' (
}
€€ 
}
‹‹ 
catch
›› 
(
›› 
IOException
›› "
exceptIO
››# +
)
››+ ,
{
ﬁﬁ 
IO
ﬂﬂ 
.
ﬂﬂ 
Logger
ﬂﬂ 
.
ﬂﬂ 
Log
ﬂﬂ !
(
ﬂﬂ! "
NLog
ﬂﬂ" &
.
ﬂﬂ& '
LogLevel
ﬂﬂ' /
.
ﬂﬂ/ 0
Warn
ﬂﬂ0 4
,
ﬂﬂ4 5
exceptIO
ﬂﬂ6 >
,
ﬂﬂ> ?
$str
ﬂﬂ@ W
)
ﬂﬂW X
;
ﬂﬂX Y
}
‡‡ 
try
‚‚ 
{
„„ 
if
‰‰ 
(
‰‰ 
listener
‰‰  
!=
‰‰! #
null
‰‰$ (
)
‰‰( )
{
ÂÂ 
listener
ÊÊ  
.
ÊÊ  !
Stop
ÊÊ! %
(
ÊÊ% &
)
ÊÊ& '
;
ÊÊ' (
}
ÁÁ 
}
ËË 
catch
ÈÈ 
(
ÈÈ 
IOException
ÈÈ "
exceptIO
ÈÈ# +
)
ÈÈ+ ,
{
ÍÍ 
IO
ÎÎ 
.
ÎÎ 
Logger
ÎÎ 
.
ÎÎ 
Log
ÎÎ !
(
ÎÎ! "
NLog
ÎÎ" &
.
ÎÎ& '
LogLevel
ÎÎ' /
.
ÎÎ/ 0
Warn
ÎÎ0 4
,
ÎÎ4 5
exceptIO
ÎÎ6 >
,
ÎÎ> ?
$str
ÎÎ@ W
)
ÎÎW X
;
ÎÎX Y
}
ÏÏ 
}
ÓÓ 
}
ÔÔ 	
}
 
public
ÚÚ 

override
ÚÚ 
void
ÚÚ 
Good
ÚÚ 
(
ÚÚ 
)
ÚÚ 
{
ÛÛ 
Good1
ÙÙ 
(
ÙÙ 
)
ÙÙ 
;
ÙÙ 
Good2
ıı 
(
ıı 
)
ıı 
;
ıı 
}
ˆˆ 
}¯¯ 
}˘˘ Œ±
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__ip_based_logic_12.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__ip_based_logic_12 (
:) *
AbstractTestCase+ ;
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
IO 
. $
StaticReturnsTrueOrFalse '
(' (
)( )
)) *
{   	
TcpListener!! 
listener!!  
=!!! "
null!!# '
;!!' (
	TcpClient"" 
tcpConn"" 
="" 
null""  $
;""$ %
Stream## 
streamOutput## 
=##  !
null##" &
;##& '
int$$ 
port$$ 
=$$ 
$num$$ 
;$$ 
try%% 
{&& 
listener'' 
='' 
new'' 
TcpListener'' *
(''* +
	IPAddress''+ 4
.''4 5
Parse''5 :
('': ;
$str''; G
)''G H
,''H I
port''J N
)''N O
;''O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
tcpConn)) 
=)) 
listener)) "
.))" #
AcceptTcpClient))# 2
())2 3
)))3 4
;))4 5

IPEndPoint++ 
endPoint++ #
=++$ %
(++& '

IPEndPoint++' 1
)++1 2
tcpConn++2 9
.++9 :
Client++: @
.++@ A
RemoteEndPoint++A O
;++O P
	IPAddress,, 
	ipAddress,, #
=,,$ %
endPoint,,& .
.,,. /
Address,,/ 6
;,,6 7
IPHostEntry-- 
	hostEntry-- %
=--& '
Dns--( +
.--+ ,
GetHostEntry--, 8
(--8 9
	ipAddress--9 B
)--B C
;--C D
if.. 
(.. 
	hostEntry.. 
... 
Equals.. $
(..$ %
$str..% 5
)..5 6
)..6 7
{// 
streamOutput00  
=00! "
tcpConn00# *
.00* +
	GetStream00+ 4
(004 5
)005 6
;006 7
streamOutput11  
.11  !
Write11! &
(11& '
Encoding11' /
.11/ 0
UTF8110 4
.114 5
GetBytes115 =
(11= >
$str11> O
)11O P
,11P Q
$num11R S
,11S T
$str11U f
.11f g
Length11g m
)11m n
;11n o
}22 
else33 
{44 
streamOutput55  
=55! "
tcpConn55# *
.55* +
	GetStream55+ 4
(554 5
)555 6
;556 7
streamOutput66  
.66  !
Write66! &
(66& '
Encoding66' /
.66/ 0
UTF8660 4
.664 5
GetBytes665 =
(66= >
$str66> N
)66N O
,66O P
$num66Q R
,66R S
$str66T d
.66d e
Length66e k
)66k l
;66l m
}77 
}88 
catch99 
(99 
IOException99 
exceptIO99 '
)99' (
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; 
(;; 
NLog;; "
.;;" #
LogLevel;;# +
.;;+ ,
Warn;;, 0
,;;0 1
exceptIO;;2 :
,;;: ;
$str;;< X
+;;Y Z
port;;[ _
.;;_ `
ToString;;` h
(;;h i
);;i j
);;j k
;;;k l
}<< 
finally== 
{>> 
try?? 
{@@ 
ifAA 
(AA 
streamOutputAA $
!=AA% '
nullAA( ,
)AA, -
{BB 
streamOutputCC $
.CC$ %
CloseCC% *
(CC* +
)CC+ ,
;CC, -
}DD 
}EE 
catchFF 
(FF 
IOExceptionFF "
exceptIOFF# +
)FF+ ,
{GG 
IOHH 
.HH 
LoggerHH 
.HH 
LogHH !
(HH! "
NLogHH" &
.HH& '
LogLevelHH' /
.HH/ 0
WarnHH0 4
,HH4 5
exceptIOHH6 >
,HH> ?
$strHH@ W
)HHW X
;HHX Y
}II 
tryKK 
{LL 
ifMM 
(MM 
tcpConnMM 
!=MM  "
nullMM# '
)MM' (
{NN 
tcpConnOO 
.OO  
CloseOO  %
(OO% &
)OO& '
;OO' (
}PP 
}QQ 
catchRR 
(RR 
IOExceptionRR "
exceptIORR# +
)RR+ ,
{SS 
IOTT 
.TT 
LoggerTT 
.TT 
LogTT !
(TT! "
NLogTT" &
.TT& '
LogLevelTT' /
.TT/ 0
WarnTT0 4
,TT4 5
exceptIOTT6 >
,TT> ?
$strTT@ W
)TTW X
;TTX Y
}UU 
tryWW 
{XX 
ifYY 
(YY 
listenerYY  
!=YY! #
nullYY$ (
)YY( )
{ZZ 
listener[[  
.[[  !
Stop[[! %
([[% &
)[[& '
;[[' (
}\\ 
}]] 
catch^^ 
(^^ 
IOException^^ "
exceptIO^^# +
)^^+ ,
{__ 
IO`` 
.`` 
Logger`` 
.`` 
Log`` !
(``! "
NLog``" &
.``& '
LogLevel``' /
.``/ 0
Warn``0 4
,``4 5
exceptIO``6 >
,``> ?
$str``@ W
)``W X
;``X Y
}aa 
}bb 
}cc 	
elsedd 
{ee 	
TcpListenerff 
listenerff  
=ff! "
nullff# '
;ff' (
	TcpClientgg 
tcpConngg 
=gg 
nullgg  $
;gg$ %
Streamhh 
streamOutputhh 
=hh  !
nullhh" &
;hh& '
intii 
portii 
=ii 
$numii 
;ii 
tryjj 
{kk 
listenerll 
=ll 
newll 
TcpListenerll *
(ll* +
	IPAddressll+ 4
.ll4 5
Parsell5 :
(ll: ;
$strll; G
)llG H
,llH I
portllJ N
)llN O
;llO P
listenermm 
.mm 
Startmm 
(mm 
)mm  
;mm  !
tcpConnnn 
=nn 
listenernn "
.nn" #
AcceptTcpClientnn# 2
(nn2 3
)nn3 4
;nn4 5
streamOutputoo 
=oo 
tcpConnoo &
.oo& '
	GetStreamoo' 0
(oo0 1
)oo1 2
;oo2 3

IPEndPointpp 
endPointpp #
=pp$ %
(pp& '

IPEndPointpp' 1
)pp1 2
tcpConnpp2 9
.pp9 :
Clientpp: @
.pp@ A
RemoteEndPointppA O
;ppO P
	IPAddressqq 
	ipAddressqq #
=qq$ %
endPointqq& .
.qq. /
Addressqq/ 6
;qq6 7
IPHostEntryrr 
	hostEntryrr %
=rr& '
Dnsrr( +
.rr+ ,
GetHostEntryrr, 8
(rr8 9
	ipAddressrr9 B
)rrB C
;rrC D
streamOutputtt 
.tt 
Writett "
(tt" #
Encodingtt# +
.tt+ ,
UTF8tt, 0
.tt0 1
GetBytestt1 9
(tt9 :
(tt: ;
$strtt; F
+ttG H
	hostEntryttI R
.ttR S
ToStringttS [
(tt[ \
)tt\ ]
)tt] ^
)tt^ _
,tt_ `
$numtta b
,ttb c
(ttd e
$strtte p
+ttq r
	hostEntrytts |
.tt| }
ToString	tt} Ö
(
ttÖ Ü
)
ttÜ á
)
ttá à
.
ttà â
Length
ttâ è
)
ttè ê
;
ttê ë
}uu 
catchvv 
(vv 
IOExceptionvv 
exceptIOvv '
)vv' (
{ww 
IOxx 
.xx 
Loggerxx 
.xx 
Logxx 
(xx 
NLogxx "
.xx" #
LogLevelxx# +
.xx+ ,
Warnxx, 0
,xx0 1
exceptIOxx2 :
,xx: ;
$strxx< X
+xxY Z
portxx[ _
.xx_ `
ToStringxx` h
(xxh i
)xxi j
)xxj k
;xxk l
}yy 
finallyzz 
{{{ 
try|| 
{}} 
if~~ 
(~~ 
streamOutput~~ $
!=~~% '
null~~( ,
)~~, -
{ 
streamOutput
ÄÄ $
.
ÄÄ$ %
Close
ÄÄ% *
(
ÄÄ* +
)
ÄÄ+ ,
;
ÄÄ, -
}
ÅÅ 
}
ÇÇ 
catch
ÉÉ 
(
ÉÉ 
IOException
ÉÉ "
exceptIO
ÉÉ# +
)
ÉÉ+ ,
{
ÑÑ 
IO
ÖÖ 
.
ÖÖ 
Logger
ÖÖ 
.
ÖÖ 
Log
ÖÖ !
(
ÖÖ! "
NLog
ÖÖ" &
.
ÖÖ& '
LogLevel
ÖÖ' /
.
ÖÖ/ 0
Warn
ÖÖ0 4
,
ÖÖ4 5
exceptIO
ÖÖ6 >
,
ÖÖ> ?
$str
ÖÖ@ W
)
ÖÖW X
;
ÖÖX Y
}
ÜÜ 
try
àà 
{
ââ 
if
ää 
(
ää 
tcpConn
ää 
!=
ää  "
null
ää# '
)
ää' (
{
ãã 
tcpConn
åå 
.
åå  
Close
åå  %
(
åå% &
)
åå& '
;
åå' (
}
çç 
}
éé 
catch
èè 
(
èè 
IOException
èè "
exceptIO
èè# +
)
èè+ ,
{
êê 
IO
ëë 
.
ëë 
Logger
ëë 
.
ëë 
Log
ëë !
(
ëë! "
NLog
ëë" &
.
ëë& '
LogLevel
ëë' /
.
ëë/ 0
Warn
ëë0 4
,
ëë4 5
exceptIO
ëë6 >
,
ëë> ?
$str
ëë@ W
)
ëëW X
;
ëëX Y
}
íí 
try
îî 
{
ïï 
if
ññ 
(
ññ 
listener
ññ  
!=
ññ! #
null
ññ$ (
)
ññ( )
{
óó 
listener
òò  
.
òò  !
Stop
òò! %
(
òò% &
)
òò& '
;
òò' (
}
ôô 
}
öö 
catch
õõ 
(
õõ 
IOException
õõ "
exceptIO
õõ# +
)
õõ+ ,
{
úú 
IO
ùù 
.
ùù 
Logger
ùù 
.
ùù 
Log
ùù !
(
ùù! "
NLog
ùù" &
.
ùù& '
LogLevel
ùù' /
.
ùù/ 0
Warn
ùù0 4
,
ùù4 5
exceptIO
ùù6 >
,
ùù> ?
$str
ùù@ W
)
ùùW X
;
ùùX Y
}
ûû 
}
†† 
}
°° 	
}
¢¢ 
private
¶¶ 
void
¶¶ 
Good1
¶¶ 
(
¶¶ 
)
¶¶ 
{
ßß 
if
®® 

(
®® 
IO
®® 
.
®® &
StaticReturnsTrueOrFalse
®® '
(
®®' (
)
®®( )
)
®®) *
{
©© 	
TcpListener
™™ 
listener
™™  
=
™™! "
null
™™# '
;
™™' (
	TcpClient
´´ 
tcpConn
´´ 
=
´´ 
null
´´  $
;
´´$ %
Stream
¨¨ 
streamOutput
¨¨ 
=
¨¨  !
null
¨¨" &
;
¨¨& '
int
≠≠ 
port
≠≠ 
=
≠≠ 
$num
≠≠ 
;
≠≠ 
try
ÆÆ 
{
ØØ 
listener
∞∞ 
=
∞∞ 
new
∞∞ 
TcpListener
∞∞ *
(
∞∞* +
	IPAddress
∞∞+ 4
.
∞∞4 5
Parse
∞∞5 :
(
∞∞: ;
$str
∞∞; G
)
∞∞G H
,
∞∞H I
port
∞∞J N
)
∞∞N O
;
∞∞O P
listener
±± 
.
±± 
Start
±± 
(
±± 
)
±±  
;
±±  !
tcpConn
≤≤ 
=
≤≤ 
listener
≤≤ "
.
≤≤" #
AcceptTcpClient
≤≤# 2
(
≤≤2 3
)
≤≤3 4
;
≤≤4 5
streamOutput
≥≥ 
=
≥≥ 
tcpConn
≥≥ &
.
≥≥& '
	GetStream
≥≥' 0
(
≥≥0 1
)
≥≥1 2
;
≥≥2 3

IPEndPoint
¥¥ 
endPoint
¥¥ #
=
¥¥$ %
(
¥¥& '

IPEndPoint
¥¥' 1
)
¥¥1 2
tcpConn
¥¥2 9
.
¥¥9 :
Client
¥¥: @
.
¥¥@ A
RemoteEndPoint
¥¥A O
;
¥¥O P
	IPAddress
µµ 
	ipAddress
µµ #
=
µµ$ %
endPoint
µµ& .
.
µµ. /
Address
µµ/ 6
;
µµ6 7
IPHostEntry
∂∂ 
	hostEntry
∂∂ %
=
∂∂& '
Dns
∂∂( +
.
∂∂+ ,
GetHostEntry
∂∂, 8
(
∂∂8 9
	ipAddress
∂∂9 B
)
∂∂B C
;
∂∂C D
streamOutput
∏∏ 
.
∏∏ 
Write
∏∏ "
(
∏∏" #
Encoding
∏∏# +
.
∏∏+ ,
UTF8
∏∏, 0
.
∏∏0 1
GetBytes
∏∏1 9
(
∏∏9 :
(
∏∏: ;
$str
∏∏; F
+
∏∏G H
	hostEntry
∏∏I R
.
∏∏R S
ToString
∏∏S [
(
∏∏[ \
)
∏∏\ ]
)
∏∏] ^
)
∏∏^ _
,
∏∏_ `
$num
∏∏a b
,
∏∏b c
(
∏∏d e
$str
∏∏e p
+
∏∏q r
	hostEntry
∏∏s |
.
∏∏| }
ToString∏∏} Ö
(∏∏Ö Ü
)∏∏Ü á
)∏∏á à
.∏∏à â
Length∏∏â è
)∏∏è ê
;∏∏ê ë
}
ππ 
catch
∫∫ 
(
∫∫ 
IOException
∫∫ 
exceptIO
∫∫ '
)
∫∫' (
{
ªª 
IO
ºº 
.
ºº 
Logger
ºº 
.
ºº 
Log
ºº 
(
ºº 
NLog
ºº "
.
ºº" #
LogLevel
ºº# +
.
ºº+ ,
Warn
ºº, 0
,
ºº0 1
exceptIO
ºº2 :
,
ºº: ;
$str
ºº< X
+
ººY Z
port
ºº[ _
.
ºº_ `
ToString
ºº` h
(
ººh i
)
ººi j
)
ººj k
;
ººk l
}
ΩΩ 
finally
ææ 
{
øø 
try
¿¿ 
{
¡¡ 
if
¬¬ 
(
¬¬ 
streamOutput
¬¬ $
!=
¬¬% '
null
¬¬( ,
)
¬¬, -
{
√√ 
streamOutput
ƒƒ $
.
ƒƒ$ %
Close
ƒƒ% *
(
ƒƒ* +
)
ƒƒ+ ,
;
ƒƒ, -
}
≈≈ 
}
∆∆ 
catch
«« 
(
«« 
IOException
«« "
exceptIO
««# +
)
««+ ,
{
»» 
IO
…… 
.
…… 
Logger
…… 
.
…… 
Log
…… !
(
……! "
NLog
……" &
.
……& '
LogLevel
……' /
.
……/ 0
Warn
……0 4
,
……4 5
exceptIO
……6 >
,
……> ?
$str
……@ W
)
……W X
;
……X Y
}
   
try
ÃÃ 
{
ÕÕ 
if
ŒŒ 
(
ŒŒ 
tcpConn
ŒŒ 
!=
ŒŒ  "
null
ŒŒ# '
)
ŒŒ' (
{
œœ 
tcpConn
–– 
.
––  
Close
––  %
(
––% &
)
––& '
;
––' (
}
—— 
}
““ 
catch
”” 
(
”” 
IOException
”” "
exceptIO
””# +
)
””+ ,
{
‘‘ 
IO
’’ 
.
’’ 
Logger
’’ 
.
’’ 
Log
’’ !
(
’’! "
NLog
’’" &
.
’’& '
LogLevel
’’' /
.
’’/ 0
Warn
’’0 4
,
’’4 5
exceptIO
’’6 >
,
’’> ?
$str
’’@ W
)
’’W X
;
’’X Y
}
÷÷ 
try
ÿÿ 
{
ŸŸ 
if
⁄⁄ 
(
⁄⁄ 
listener
⁄⁄  
!=
⁄⁄! #
null
⁄⁄$ (
)
⁄⁄( )
{
€€ 
listener
‹‹  
.
‹‹  !
Stop
‹‹! %
(
‹‹% &
)
‹‹& '
;
‹‹' (
}
›› 
}
ﬁﬁ 
catch
ﬂﬂ 
(
ﬂﬂ 
IOException
ﬂﬂ "
exceptIO
ﬂﬂ# +
)
ﬂﬂ+ ,
{
‡‡ 
IO
·· 
.
·· 
Logger
·· 
.
·· 
Log
·· !
(
··! "
NLog
··" &
.
··& '
LogLevel
··' /
.
··/ 0
Warn
··0 4
,
··4 5
exceptIO
··6 >
,
··> ?
$str
··@ W
)
··W X
;
··X Y
}
‚‚ 
}
‰‰ 
}
ÂÂ 	
else
ÊÊ 
{
ÁÁ 	
TcpListener
ËË 
listener
ËË  
=
ËË! "
null
ËË# '
;
ËË' (
	TcpClient
ÈÈ 
tcpConn
ÈÈ 
=
ÈÈ 
null
ÈÈ  $
;
ÈÈ$ %
Stream
ÍÍ 
streamOutput
ÍÍ 
=
ÍÍ  !
null
ÍÍ" &
;
ÍÍ& '
int
ÎÎ 
port
ÎÎ 
=
ÎÎ 
$num
ÎÎ 
;
ÎÎ 
try
ÏÏ 
{
ÌÌ 
listener
ÓÓ 
=
ÓÓ 
new
ÓÓ 
TcpListener
ÓÓ *
(
ÓÓ* +
	IPAddress
ÓÓ+ 4
.
ÓÓ4 5
Parse
ÓÓ5 :
(
ÓÓ: ;
$str
ÓÓ; G
)
ÓÓG H
,
ÓÓH I
port
ÓÓJ N
)
ÓÓN O
;
ÓÓO P
listener
ÔÔ 
.
ÔÔ 
Start
ÔÔ 
(
ÔÔ 
)
ÔÔ  
;
ÔÔ  !
tcpConn
 
=
 
listener
 "
.
" #
AcceptTcpClient
# 2
(
2 3
)
3 4
;
4 5
streamOutput
ÒÒ 
=
ÒÒ 
tcpConn
ÒÒ &
.
ÒÒ& '
	GetStream
ÒÒ' 0
(
ÒÒ0 1
)
ÒÒ1 2
;
ÒÒ2 3

IPEndPoint
ÚÚ 
endPoint
ÚÚ #
=
ÚÚ$ %
(
ÚÚ& '

IPEndPoint
ÚÚ' 1
)
ÚÚ1 2
tcpConn
ÚÚ2 9
.
ÚÚ9 :
Client
ÚÚ: @
.
ÚÚ@ A
RemoteEndPoint
ÚÚA O
;
ÚÚO P
	IPAddress
ÛÛ 
	ipAddress
ÛÛ #
=
ÛÛ$ %
endPoint
ÛÛ& .
.
ÛÛ. /
Address
ÛÛ/ 6
;
ÛÛ6 7
IPHostEntry
ÙÙ 
	hostEntry
ÙÙ %
=
ÙÙ& '
Dns
ÙÙ( +
.
ÙÙ+ ,
GetHostEntry
ÙÙ, 8
(
ÙÙ8 9
	ipAddress
ÙÙ9 B
)
ÙÙB C
;
ÙÙC D
streamOutput
ˆˆ 
.
ˆˆ 
Write
ˆˆ "
(
ˆˆ" #
Encoding
ˆˆ# +
.
ˆˆ+ ,
UTF8
ˆˆ, 0
.
ˆˆ0 1
GetBytes
ˆˆ1 9
(
ˆˆ9 :
(
ˆˆ: ;
$str
ˆˆ; F
+
ˆˆG H
	hostEntry
ˆˆI R
.
ˆˆR S
ToString
ˆˆS [
(
ˆˆ[ \
)
ˆˆ\ ]
)
ˆˆ] ^
)
ˆˆ^ _
,
ˆˆ_ `
$num
ˆˆa b
,
ˆˆb c
(
ˆˆd e
$str
ˆˆe p
+
ˆˆq r
	hostEntry
ˆˆs |
.
ˆˆ| }
ToStringˆˆ} Ö
(ˆˆÖ Ü
)ˆˆÜ á
)ˆˆá à
.ˆˆà â
Lengthˆˆâ è
)ˆˆè ê
;ˆˆê ë
}
˜˜ 
catch
¯¯ 
(
¯¯ 
IOException
¯¯ 
exceptIO
¯¯ '
)
¯¯' (
{
˘˘ 
IO
˙˙ 
.
˙˙ 
Logger
˙˙ 
.
˙˙ 
Log
˙˙ 
(
˙˙ 
NLog
˙˙ "
.
˙˙" #
LogLevel
˙˙# +
.
˙˙+ ,
Warn
˙˙, 0
,
˙˙0 1
exceptIO
˙˙2 :
,
˙˙: ;
$str
˙˙< X
+
˙˙Y Z
port
˙˙[ _
.
˙˙_ `
ToString
˙˙` h
(
˙˙h i
)
˙˙i j
)
˙˙j k
;
˙˙k l
}
˚˚ 
finally
¸¸ 
{
˝˝ 
try
˛˛ 
{
ˇˇ 
if
ÄÄ 
(
ÄÄ 
streamOutput
ÄÄ $
!=
ÄÄ% '
null
ÄÄ( ,
)
ÄÄ, -
{
ÅÅ 
streamOutput
ÇÇ $
.
ÇÇ$ %
Close
ÇÇ% *
(
ÇÇ* +
)
ÇÇ+ ,
;
ÇÇ, -
}
ÉÉ 
}
ÑÑ 
catch
ÖÖ 
(
ÖÖ 
IOException
ÖÖ "
exceptIO
ÖÖ# +
)
ÖÖ+ ,
{
ÜÜ 
IO
áá 
.
áá 
Logger
áá 
.
áá 
Log
áá !
(
áá! "
NLog
áá" &
.
áá& '
LogLevel
áá' /
.
áá/ 0
Warn
áá0 4
,
áá4 5
exceptIO
áá6 >
,
áá> ?
$str
áá@ W
)
ááW X
;
ááX Y
}
àà 
try
ää 
{
ãã 
if
åå 
(
åå 
tcpConn
åå 
!=
åå  "
null
åå# '
)
åå' (
{
çç 
tcpConn
éé 
.
éé  
Close
éé  %
(
éé% &
)
éé& '
;
éé' (
}
èè 
}
êê 
catch
ëë 
(
ëë 
IOException
ëë "
exceptIO
ëë# +
)
ëë+ ,
{
íí 
IO
ìì 
.
ìì 
Logger
ìì 
.
ìì 
Log
ìì !
(
ìì! "
NLog
ìì" &
.
ìì& '
LogLevel
ìì' /
.
ìì/ 0
Warn
ìì0 4
,
ìì4 5
exceptIO
ìì6 >
,
ìì> ?
$str
ìì@ W
)
ììW X
;
ììX Y
}
îî 
try
ññ 
{
óó 
if
òò 
(
òò 
listener
òò  
!=
òò! #
null
òò$ (
)
òò( )
{
ôô 
listener
öö  
.
öö  !
Stop
öö! %
(
öö% &
)
öö& '
;
öö' (
}
õõ 
}
úú 
catch
ùù 
(
ùù 
IOException
ùù "
exceptIO
ùù# +
)
ùù+ ,
{
ûû 
IO
üü 
.
üü 
Logger
üü 
.
üü 
Log
üü !
(
üü! "
NLog
üü" &
.
üü& '
LogLevel
üü' /
.
üü/ 0
Warn
üü0 4
,
üü4 5
exceptIO
üü6 >
,
üü> ?
$str
üü@ W
)
üüW X
;
üüX Y
}
†† 
}
¢¢ 
}
££ 	
}
§§ 
public
¶¶ 

override
¶¶ 
void
¶¶ 
Good
¶¶ 
(
¶¶ 
)
¶¶ 
{
ßß 
Good1
®® 
(
®® 
)
®® 
;
®® 
}
©© 
}´´ 
}¨¨ ˇä
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__ip_based_logic_13.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__ip_based_logic_13 (
:) *
AbstractTestCase+ ;
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
IO 
.  
STATIC_READONLY_FIVE #
==$ &
$num' (
)( )
{   	
TcpListener!! 
listener!!  
=!!! "
null!!# '
;!!' (
	TcpClient"" 
tcpConn"" 
="" 
null""  $
;""$ %
Stream## 
streamOutput## 
=##  !
null##" &
;##& '
int$$ 
port$$ 
=$$ 
$num$$ 
;$$ 
try%% 
{&& 
listener'' 
='' 
new'' 
TcpListener'' *
(''* +
	IPAddress''+ 4
.''4 5
Parse''5 :
('': ;
$str''; G
)''G H
,''H I
port''J N
)''N O
;''O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
tcpConn)) 
=)) 
listener)) "
.))" #
AcceptTcpClient))# 2
())2 3
)))3 4
;))4 5

IPEndPoint++ 
endPoint++ #
=++$ %
(++& '

IPEndPoint++' 1
)++1 2
tcpConn++2 9
.++9 :
Client++: @
.++@ A
RemoteEndPoint++A O
;++O P
	IPAddress,, 
	ipAddress,, #
=,,$ %
endPoint,,& .
.,,. /
Address,,/ 6
;,,6 7
IPHostEntry-- 
	hostEntry-- %
=--& '
Dns--( +
.--+ ,
GetHostEntry--, 8
(--8 9
	ipAddress--9 B
)--B C
;--C D
if.. 
(.. 
	hostEntry.. 
... 
Equals.. $
(..$ %
$str..% 5
)..5 6
)..6 7
{// 
streamOutput00  
=00! "
tcpConn00# *
.00* +
	GetStream00+ 4
(004 5
)005 6
;006 7
streamOutput11  
.11  !
Write11! &
(11& '
Encoding11' /
.11/ 0
UTF8110 4
.114 5
GetBytes115 =
(11= >
$str11> O
)11O P
,11P Q
$num11R S
,11S T
$str11U f
.11f g
Length11g m
)11m n
;11n o
}22 
else33 
{44 
streamOutput55  
=55! "
tcpConn55# *
.55* +
	GetStream55+ 4
(554 5
)555 6
;556 7
streamOutput66  
.66  !
Write66! &
(66& '
Encoding66' /
.66/ 0
UTF8660 4
.664 5
GetBytes665 =
(66= >
$str66> N
)66N O
,66O P
$num66Q R
,66R S
$str66T d
.66d e
Length66e k
)66k l
;66l m
}77 
}88 
catch99 
(99 
IOException99 
exceptIO99 '
)99' (
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; 
(;; 
NLog;; "
.;;" #
LogLevel;;# +
.;;+ ,
Warn;;, 0
,;;0 1
exceptIO;;2 :
,;;: ;
$str;;< X
+;;Y Z
port;;[ _
.;;_ `
ToString;;` h
(;;h i
);;i j
);;j k
;;;k l
}<< 
finally== 
{>> 
try?? 
{@@ 
ifAA 
(AA 
streamOutputAA $
!=AA% '
nullAA( ,
)AA, -
{BB 
streamOutputCC $
.CC$ %
CloseCC% *
(CC* +
)CC+ ,
;CC, -
}DD 
}EE 
catchFF 
(FF 
IOExceptionFF "
exceptIOFF# +
)FF+ ,
{GG 
IOHH 
.HH 
LoggerHH 
.HH 
LogHH !
(HH! "
NLogHH" &
.HH& '
LogLevelHH' /
.HH/ 0
WarnHH0 4
,HH4 5
exceptIOHH6 >
,HH> ?
$strHH@ W
)HHW X
;HHX Y
}II 
tryKK 
{LL 
ifMM 
(MM 
tcpConnMM 
!=MM  "
nullMM# '
)MM' (
{NN 
tcpConnOO 
.OO  
CloseOO  %
(OO% &
)OO& '
;OO' (
}PP 
}QQ 
catchRR 
(RR 
IOExceptionRR "
exceptIORR# +
)RR+ ,
{SS 
IOTT 
.TT 
LoggerTT 
.TT 
LogTT !
(TT! "
NLogTT" &
.TT& '
LogLevelTT' /
.TT/ 0
WarnTT0 4
,TT4 5
exceptIOTT6 >
,TT> ?
$strTT@ W
)TTW X
;TTX Y
}UU 
tryWW 
{XX 
ifYY 
(YY 
listenerYY  
!=YY! #
nullYY$ (
)YY( )
{ZZ 
listener[[  
.[[  !
Stop[[! %
([[% &
)[[& '
;[[' (
}\\ 
}]] 
catch^^ 
(^^ 
IOException^^ "
exceptIO^^# +
)^^+ ,
{__ 
IO`` 
.`` 
Logger`` 
.`` 
Log`` !
(``! "
NLog``" &
.``& '
LogLevel``' /
.``/ 0
Warn``0 4
,``4 5
exceptIO``6 >
,``> ?
$str``@ W
)``W X
;``X Y
}aa 
}bb 
}cc 	
}dd 
privatehh 
voidhh 
Good1hh 
(hh 
)hh 
{ii 
ifjj 

(jj 
IOjj 
.jj  
STATIC_READONLY_FIVEjj #
!=jj$ &
$numjj' (
)jj( )
{kk 	
IOmm 
.mm 
	WriteLinemm 
(mm 
$strmm /
)mm/ 0
;mm0 1
}nn 	
elseoo 
{pp 	
TcpListenerqq 
listenerqq  
=qq! "
nullqq# '
;qq' (
	TcpClientrr 
tcpConnrr 
=rr 
nullrr  $
;rr$ %
Streamss 
streamOutputss 
=ss  !
nullss" &
;ss& '
inttt 
porttt 
=tt 
$numtt 
;tt 
tryuu 
{vv 
listenerww 
=ww 
newww 
TcpListenerww *
(ww* +
	IPAddressww+ 4
.ww4 5
Parseww5 :
(ww: ;
$strww; G
)wwG H
,wwH I
portwwJ N
)wwN O
;wwO P
listenerxx 
.xx 
Startxx 
(xx 
)xx  
;xx  !
tcpConnyy 
=yy 
listeneryy "
.yy" #
AcceptTcpClientyy# 2
(yy2 3
)yy3 4
;yy4 5
streamOutputzz 
=zz 
tcpConnzz &
.zz& '
	GetStreamzz' 0
(zz0 1
)zz1 2
;zz2 3

IPEndPoint{{ 
endPoint{{ #
={{$ %
({{& '

IPEndPoint{{' 1
){{1 2
tcpConn{{2 9
.{{9 :
Client{{: @
.{{@ A
RemoteEndPoint{{A O
;{{O P
	IPAddress|| 
	ipAddress|| #
=||$ %
endPoint||& .
.||. /
Address||/ 6
;||6 7
IPHostEntry}} 
	hostEntry}} %
=}}& '
Dns}}( +
.}}+ ,
GetHostEntry}}, 8
(}}8 9
	ipAddress}}9 B
)}}B C
;}}C D
streamOutput 
. 
Write "
(" #
Encoding# +
.+ ,
UTF8, 0
.0 1
GetBytes1 9
(9 :
(: ;
$str; F
+G H
	hostEntryI R
.R S
ToStringS [
([ \
)\ ]
)] ^
)^ _
,_ `
$numa b
,b c
(d e
$stre p
+q r
	hostEntrys |
.| }
ToString	} Ö
(
Ö Ü
)
Ü á
)
á à
.
à â
Length
â è
)
è ê
;
ê ë
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
IOException
ÅÅ 
exceptIO
ÅÅ '
)
ÅÅ' (
{
ÇÇ 
IO
ÉÉ 
.
ÉÉ 
Logger
ÉÉ 
.
ÉÉ 
Log
ÉÉ 
(
ÉÉ 
NLog
ÉÉ "
.
ÉÉ" #
LogLevel
ÉÉ# +
.
ÉÉ+ ,
Warn
ÉÉ, 0
,
ÉÉ0 1
exceptIO
ÉÉ2 :
,
ÉÉ: ;
$str
ÉÉ< X
+
ÉÉY Z
port
ÉÉ[ _
.
ÉÉ_ `
ToString
ÉÉ` h
(
ÉÉh i
)
ÉÉi j
)
ÉÉj k
;
ÉÉk l
}
ÑÑ 
finally
ÖÖ 
{
ÜÜ 
try
áá 
{
àà 
if
ââ 
(
ââ 
streamOutput
ââ $
!=
ââ% '
null
ââ( ,
)
ââ, -
{
ää 
streamOutput
ãã $
.
ãã$ %
Close
ãã% *
(
ãã* +
)
ãã+ ,
;
ãã, -
}
åå 
}
çç 
catch
éé 
(
éé 
IOException
éé "
exceptIO
éé# +
)
éé+ ,
{
èè 
IO
êê 
.
êê 
Logger
êê 
.
êê 
Log
êê !
(
êê! "
NLog
êê" &
.
êê& '
LogLevel
êê' /
.
êê/ 0
Warn
êê0 4
,
êê4 5
exceptIO
êê6 >
,
êê> ?
$str
êê@ W
)
êêW X
;
êêX Y
}
ëë 
try
ìì 
{
îî 
if
ïï 
(
ïï 
tcpConn
ïï 
!=
ïï  "
null
ïï# '
)
ïï' (
{
ññ 
tcpConn
óó 
.
óó  
Close
óó  %
(
óó% &
)
óó& '
;
óó' (
}
òò 
}
ôô 
catch
öö 
(
öö 
IOException
öö "
exceptIO
öö# +
)
öö+ ,
{
õõ 
IO
úú 
.
úú 
Logger
úú 
.
úú 
Log
úú !
(
úú! "
NLog
úú" &
.
úú& '
LogLevel
úú' /
.
úú/ 0
Warn
úú0 4
,
úú4 5
exceptIO
úú6 >
,
úú> ?
$str
úú@ W
)
úúW X
;
úúX Y
}
ùù 
try
üü 
{
†† 
if
°° 
(
°° 
listener
°°  
!=
°°! #
null
°°$ (
)
°°( )
{
¢¢ 
listener
££  
.
££  !
Stop
££! %
(
££% &
)
££& '
;
££' (
}
§§ 
}
•• 
catch
¶¶ 
(
¶¶ 
IOException
¶¶ "
exceptIO
¶¶# +
)
¶¶+ ,
{
ßß 
IO
®® 
.
®® 
Logger
®® 
.
®® 
Log
®® !
(
®®! "
NLog
®®" &
.
®®& '
LogLevel
®®' /
.
®®/ 0
Warn
®®0 4
,
®®4 5
exceptIO
®®6 >
,
®®> ?
$str
®®@ W
)
®®W X
;
®®X Y
}
©© 
}
´´ 
}
¨¨ 	
}
≠≠ 
private
∞∞ 
void
∞∞ 
Good2
∞∞ 
(
∞∞ 
)
∞∞ 
{
±± 
if
≤≤ 

(
≤≤ 
IO
≤≤ 
.
≤≤ "
STATIC_READONLY_FIVE
≤≤ #
==
≤≤$ &
$num
≤≤' (
)
≤≤( )
{
≥≥ 	
TcpListener
¥¥ 
listener
¥¥  
=
¥¥! "
null
¥¥# '
;
¥¥' (
	TcpClient
µµ 
tcpConn
µµ 
=
µµ 
null
µµ  $
;
µµ$ %
Stream
∂∂ 
streamOutput
∂∂ 
=
∂∂  !
null
∂∂" &
;
∂∂& '
int
∑∑ 
port
∑∑ 
=
∑∑ 
$num
∑∑ 
;
∑∑ 
try
∏∏ 
{
ππ 
listener
∫∫ 
=
∫∫ 
new
∫∫ 
TcpListener
∫∫ *
(
∫∫* +
	IPAddress
∫∫+ 4
.
∫∫4 5
Parse
∫∫5 :
(
∫∫: ;
$str
∫∫; G
)
∫∫G H
,
∫∫H I
port
∫∫J N
)
∫∫N O
;
∫∫O P
listener
ªª 
.
ªª 
Start
ªª 
(
ªª 
)
ªª  
;
ªª  !
tcpConn
ºº 
=
ºº 
listener
ºº "
.
ºº" #
AcceptTcpClient
ºº# 2
(
ºº2 3
)
ºº3 4
;
ºº4 5
streamOutput
ΩΩ 
=
ΩΩ 
tcpConn
ΩΩ &
.
ΩΩ& '
	GetStream
ΩΩ' 0
(
ΩΩ0 1
)
ΩΩ1 2
;
ΩΩ2 3

IPEndPoint
ææ 
endPoint
ææ #
=
ææ$ %
(
ææ& '

IPEndPoint
ææ' 1
)
ææ1 2
tcpConn
ææ2 9
.
ææ9 :
Client
ææ: @
.
ææ@ A
RemoteEndPoint
ææA O
;
ææO P
	IPAddress
øø 
	ipAddress
øø #
=
øø$ %
endPoint
øø& .
.
øø. /
Address
øø/ 6
;
øø6 7
IPHostEntry
¿¿ 
	hostEntry
¿¿ %
=
¿¿& '
Dns
¿¿( +
.
¿¿+ ,
GetHostEntry
¿¿, 8
(
¿¿8 9
	ipAddress
¿¿9 B
)
¿¿B C
;
¿¿C D
streamOutput
¬¬ 
.
¬¬ 
Write
¬¬ "
(
¬¬" #
Encoding
¬¬# +
.
¬¬+ ,
UTF8
¬¬, 0
.
¬¬0 1
GetBytes
¬¬1 9
(
¬¬9 :
(
¬¬: ;
$str
¬¬; F
+
¬¬G H
	hostEntry
¬¬I R
.
¬¬R S
ToString
¬¬S [
(
¬¬[ \
)
¬¬\ ]
)
¬¬] ^
)
¬¬^ _
,
¬¬_ `
$num
¬¬a b
,
¬¬b c
(
¬¬d e
$str
¬¬e p
+
¬¬q r
	hostEntry
¬¬s |
.
¬¬| }
ToString¬¬} Ö
(¬¬Ö Ü
)¬¬Ü á
)¬¬á à
.¬¬à â
Length¬¬â è
)¬¬è ê
;¬¬ê ë
}
√√ 
catch
ƒƒ 
(
ƒƒ 
IOException
ƒƒ 
exceptIO
ƒƒ '
)
ƒƒ' (
{
≈≈ 
IO
∆∆ 
.
∆∆ 
Logger
∆∆ 
.
∆∆ 
Log
∆∆ 
(
∆∆ 
NLog
∆∆ "
.
∆∆" #
LogLevel
∆∆# +
.
∆∆+ ,
Warn
∆∆, 0
,
∆∆0 1
exceptIO
∆∆2 :
,
∆∆: ;
$str
∆∆< X
+
∆∆Y Z
port
∆∆[ _
.
∆∆_ `
ToString
∆∆` h
(
∆∆h i
)
∆∆i j
)
∆∆j k
;
∆∆k l
}
«« 
finally
»» 
{
…… 
try
   
{
ÀÀ 
if
ÃÃ 
(
ÃÃ 
streamOutput
ÃÃ $
!=
ÃÃ% '
null
ÃÃ( ,
)
ÃÃ, -
{
ÕÕ 
streamOutput
ŒŒ $
.
ŒŒ$ %
Close
ŒŒ% *
(
ŒŒ* +
)
ŒŒ+ ,
;
ŒŒ, -
}
œœ 
}
–– 
catch
—— 
(
—— 
IOException
—— "
exceptIO
——# +
)
——+ ,
{
““ 
IO
”” 
.
”” 
Logger
”” 
.
”” 
Log
”” !
(
””! "
NLog
””" &
.
””& '
LogLevel
””' /
.
””/ 0
Warn
””0 4
,
””4 5
exceptIO
””6 >
,
””> ?
$str
””@ W
)
””W X
;
””X Y
}
‘‘ 
try
÷÷ 
{
◊◊ 
if
ÿÿ 
(
ÿÿ 
tcpConn
ÿÿ 
!=
ÿÿ  "
null
ÿÿ# '
)
ÿÿ' (
{
ŸŸ 
tcpConn
⁄⁄ 
.
⁄⁄  
Close
⁄⁄  %
(
⁄⁄% &
)
⁄⁄& '
;
⁄⁄' (
}
€€ 
}
‹‹ 
catch
›› 
(
›› 
IOException
›› "
exceptIO
››# +
)
››+ ,
{
ﬁﬁ 
IO
ﬂﬂ 
.
ﬂﬂ 
Logger
ﬂﬂ 
.
ﬂﬂ 
Log
ﬂﬂ !
(
ﬂﬂ! "
NLog
ﬂﬂ" &
.
ﬂﬂ& '
LogLevel
ﬂﬂ' /
.
ﬂﬂ/ 0
Warn
ﬂﬂ0 4
,
ﬂﬂ4 5
exceptIO
ﬂﬂ6 >
,
ﬂﬂ> ?
$str
ﬂﬂ@ W
)
ﬂﬂW X
;
ﬂﬂX Y
}
‡‡ 
try
‚‚ 
{
„„ 
if
‰‰ 
(
‰‰ 
listener
‰‰  
!=
‰‰! #
null
‰‰$ (
)
‰‰( )
{
ÂÂ 
listener
ÊÊ  
.
ÊÊ  !
Stop
ÊÊ! %
(
ÊÊ% &
)
ÊÊ& '
;
ÊÊ' (
}
ÁÁ 
}
ËË 
catch
ÈÈ 
(
ÈÈ 
IOException
ÈÈ "
exceptIO
ÈÈ# +
)
ÈÈ+ ,
{
ÍÍ 
IO
ÎÎ 
.
ÎÎ 
Logger
ÎÎ 
.
ÎÎ 
Log
ÎÎ !
(
ÎÎ! "
NLog
ÎÎ" &
.
ÎÎ& '
LogLevel
ÎÎ' /
.
ÎÎ/ 0
Warn
ÎÎ0 4
,
ÎÎ4 5
exceptIO
ÎÎ6 >
,
ÎÎ> ?
$str
ÎÎ@ W
)
ÎÎW X
;
ÎÎX Y
}
ÏÏ 
}
ÓÓ 
}
ÔÔ 	
}
 
public
ÚÚ 

override
ÚÚ 
void
ÚÚ 
Good
ÚÚ 
(
ÚÚ 
)
ÚÚ 
{
ÛÛ 
Good1
ÙÙ 
(
ÙÙ 
)
ÙÙ 
;
ÙÙ 
Good2
ıı 
(
ıı 
)
ıı 
;
ıı 
}
ˆˆ 
}¯¯ 
}˘˘ ·ä
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__ip_based_logic_14.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__ip_based_logic_14 (
:) *
AbstractTestCase+ ;
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
IO 
. 

staticFive 
== 
$num 
) 
{   	
TcpListener!! 
listener!!  
=!!! "
null!!# '
;!!' (
	TcpClient"" 
tcpConn"" 
="" 
null""  $
;""$ %
Stream## 
streamOutput## 
=##  !
null##" &
;##& '
int$$ 
port$$ 
=$$ 
$num$$ 
;$$ 
try%% 
{&& 
listener'' 
='' 
new'' 
TcpListener'' *
(''* +
	IPAddress''+ 4
.''4 5
Parse''5 :
('': ;
$str''; G
)''G H
,''H I
port''J N
)''N O
;''O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
tcpConn)) 
=)) 
listener)) "
.))" #
AcceptTcpClient))# 2
())2 3
)))3 4
;))4 5

IPEndPoint++ 
endPoint++ #
=++$ %
(++& '

IPEndPoint++' 1
)++1 2
tcpConn++2 9
.++9 :
Client++: @
.++@ A
RemoteEndPoint++A O
;++O P
	IPAddress,, 
	ipAddress,, #
=,,$ %
endPoint,,& .
.,,. /
Address,,/ 6
;,,6 7
IPHostEntry-- 
	hostEntry-- %
=--& '
Dns--( +
.--+ ,
GetHostEntry--, 8
(--8 9
	ipAddress--9 B
)--B C
;--C D
if.. 
(.. 
	hostEntry.. 
... 
Equals.. $
(..$ %
$str..% 5
)..5 6
)..6 7
{// 
streamOutput00  
=00! "
tcpConn00# *
.00* +
	GetStream00+ 4
(004 5
)005 6
;006 7
streamOutput11  
.11  !
Write11! &
(11& '
Encoding11' /
.11/ 0
UTF8110 4
.114 5
GetBytes115 =
(11= >
$str11> O
)11O P
,11P Q
$num11R S
,11S T
$str11U f
.11f g
Length11g m
)11m n
;11n o
}22 
else33 
{44 
streamOutput55  
=55! "
tcpConn55# *
.55* +
	GetStream55+ 4
(554 5
)555 6
;556 7
streamOutput66  
.66  !
Write66! &
(66& '
Encoding66' /
.66/ 0
UTF8660 4
.664 5
GetBytes665 =
(66= >
$str66> N
)66N O
,66O P
$num66Q R
,66R S
$str66T d
.66d e
Length66e k
)66k l
;66l m
}77 
}88 
catch99 
(99 
IOException99 
exceptIO99 '
)99' (
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; 
(;; 
NLog;; "
.;;" #
LogLevel;;# +
.;;+ ,
Warn;;, 0
,;;0 1
exceptIO;;2 :
,;;: ;
$str;;< X
+;;Y Z
port;;[ _
.;;_ `
ToString;;` h
(;;h i
);;i j
);;j k
;;;k l
}<< 
finally== 
{>> 
try?? 
{@@ 
ifAA 
(AA 
streamOutputAA $
!=AA% '
nullAA( ,
)AA, -
{BB 
streamOutputCC $
.CC$ %
CloseCC% *
(CC* +
)CC+ ,
;CC, -
}DD 
}EE 
catchFF 
(FF 
IOExceptionFF "
exceptIOFF# +
)FF+ ,
{GG 
IOHH 
.HH 
LoggerHH 
.HH 
LogHH !
(HH! "
NLogHH" &
.HH& '
LogLevelHH' /
.HH/ 0
WarnHH0 4
,HH4 5
exceptIOHH6 >
,HH> ?
$strHH@ W
)HHW X
;HHX Y
}II 
tryKK 
{LL 
ifMM 
(MM 
tcpConnMM 
!=MM  "
nullMM# '
)MM' (
{NN 
tcpConnOO 
.OO  
CloseOO  %
(OO% &
)OO& '
;OO' (
}PP 
}QQ 
catchRR 
(RR 
IOExceptionRR "
exceptIORR# +
)RR+ ,
{SS 
IOTT 
.TT 
LoggerTT 
.TT 
LogTT !
(TT! "
NLogTT" &
.TT& '
LogLevelTT' /
.TT/ 0
WarnTT0 4
,TT4 5
exceptIOTT6 >
,TT> ?
$strTT@ W
)TTW X
;TTX Y
}UU 
tryWW 
{XX 
ifYY 
(YY 
listenerYY  
!=YY! #
nullYY$ (
)YY( )
{ZZ 
listener[[  
.[[  !
Stop[[! %
([[% &
)[[& '
;[[' (
}\\ 
}]] 
catch^^ 
(^^ 
IOException^^ "
exceptIO^^# +
)^^+ ,
{__ 
IO`` 
.`` 
Logger`` 
.`` 
Log`` !
(``! "
NLog``" &
.``& '
LogLevel``' /
.``/ 0
Warn``0 4
,``4 5
exceptIO``6 >
,``> ?
$str``@ W
)``W X
;``X Y
}aa 
}bb 
}cc 	
}dd 
privatehh 
voidhh 
Good1hh 
(hh 
)hh 
{ii 
ifjj 

(jj 
IOjj 
.jj 

staticFivejj 
!=jj 
$numjj 
)jj 
{kk 	
IOmm 
.mm 
	WriteLinemm 
(mm 
$strmm /
)mm/ 0
;mm0 1
}nn 	
elseoo 
{pp 	
TcpListenerqq 
listenerqq  
=qq! "
nullqq# '
;qq' (
	TcpClientrr 
tcpConnrr 
=rr 
nullrr  $
;rr$ %
Streamss 
streamOutputss 
=ss  !
nullss" &
;ss& '
inttt 
porttt 
=tt 
$numtt 
;tt 
tryuu 
{vv 
listenerww 
=ww 
newww 
TcpListenerww *
(ww* +
	IPAddressww+ 4
.ww4 5
Parseww5 :
(ww: ;
$strww; G
)wwG H
,wwH I
portwwJ N
)wwN O
;wwO P
listenerxx 
.xx 
Startxx 
(xx 
)xx  
;xx  !
tcpConnyy 
=yy 
listeneryy "
.yy" #
AcceptTcpClientyy# 2
(yy2 3
)yy3 4
;yy4 5
streamOutputzz 
=zz 
tcpConnzz &
.zz& '
	GetStreamzz' 0
(zz0 1
)zz1 2
;zz2 3

IPEndPoint{{ 
endPoint{{ #
={{$ %
({{& '

IPEndPoint{{' 1
){{1 2
tcpConn{{2 9
.{{9 :
Client{{: @
.{{@ A
RemoteEndPoint{{A O
;{{O P
	IPAddress|| 
	ipAddress|| #
=||$ %
endPoint||& .
.||. /
Address||/ 6
;||6 7
IPHostEntry}} 
	hostEntry}} %
=}}& '
Dns}}( +
.}}+ ,
GetHostEntry}}, 8
(}}8 9
	ipAddress}}9 B
)}}B C
;}}C D
streamOutput 
. 
Write "
(" #
Encoding# +
.+ ,
UTF8, 0
.0 1
GetBytes1 9
(9 :
(: ;
$str; F
+G H
	hostEntryI R
.R S
ToStringS [
([ \
)\ ]
)] ^
)^ _
,_ `
$numa b
,b c
(d e
$stre p
+q r
	hostEntrys |
.| }
ToString	} Ö
(
Ö Ü
)
Ü á
)
á à
.
à â
Length
â è
)
è ê
;
ê ë
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
IOException
ÅÅ 
exceptIO
ÅÅ '
)
ÅÅ' (
{
ÇÇ 
IO
ÉÉ 
.
ÉÉ 
Logger
ÉÉ 
.
ÉÉ 
Log
ÉÉ 
(
ÉÉ 
NLog
ÉÉ "
.
ÉÉ" #
LogLevel
ÉÉ# +
.
ÉÉ+ ,
Warn
ÉÉ, 0
,
ÉÉ0 1
exceptIO
ÉÉ2 :
,
ÉÉ: ;
$str
ÉÉ< X
+
ÉÉY Z
port
ÉÉ[ _
.
ÉÉ_ `
ToString
ÉÉ` h
(
ÉÉh i
)
ÉÉi j
)
ÉÉj k
;
ÉÉk l
}
ÑÑ 
finally
ÖÖ 
{
ÜÜ 
try
áá 
{
àà 
if
ââ 
(
ââ 
streamOutput
ââ $
!=
ââ% '
null
ââ( ,
)
ââ, -
{
ää 
streamOutput
ãã $
.
ãã$ %
Close
ãã% *
(
ãã* +
)
ãã+ ,
;
ãã, -
}
åå 
}
çç 
catch
éé 
(
éé 
IOException
éé "
exceptIO
éé# +
)
éé+ ,
{
èè 
IO
êê 
.
êê 
Logger
êê 
.
êê 
Log
êê !
(
êê! "
NLog
êê" &
.
êê& '
LogLevel
êê' /
.
êê/ 0
Warn
êê0 4
,
êê4 5
exceptIO
êê6 >
,
êê> ?
$str
êê@ W
)
êêW X
;
êêX Y
}
ëë 
try
ìì 
{
îî 
if
ïï 
(
ïï 
tcpConn
ïï 
!=
ïï  "
null
ïï# '
)
ïï' (
{
ññ 
tcpConn
óó 
.
óó  
Close
óó  %
(
óó% &
)
óó& '
;
óó' (
}
òò 
}
ôô 
catch
öö 
(
öö 
IOException
öö "
exceptIO
öö# +
)
öö+ ,
{
õõ 
IO
úú 
.
úú 
Logger
úú 
.
úú 
Log
úú !
(
úú! "
NLog
úú" &
.
úú& '
LogLevel
úú' /
.
úú/ 0
Warn
úú0 4
,
úú4 5
exceptIO
úú6 >
,
úú> ?
$str
úú@ W
)
úúW X
;
úúX Y
}
ùù 
try
üü 
{
†† 
if
°° 
(
°° 
listener
°°  
!=
°°! #
null
°°$ (
)
°°( )
{
¢¢ 
listener
££  
.
££  !
Stop
££! %
(
££% &
)
££& '
;
££' (
}
§§ 
}
•• 
catch
¶¶ 
(
¶¶ 
IOException
¶¶ "
exceptIO
¶¶# +
)
¶¶+ ,
{
ßß 
IO
®® 
.
®® 
Logger
®® 
.
®® 
Log
®® !
(
®®! "
NLog
®®" &
.
®®& '
LogLevel
®®' /
.
®®/ 0
Warn
®®0 4
,
®®4 5
exceptIO
®®6 >
,
®®> ?
$str
®®@ W
)
®®W X
;
®®X Y
}
©© 
}
´´ 
}
¨¨ 	
}
≠≠ 
private
∞∞ 
void
∞∞ 
Good2
∞∞ 
(
∞∞ 
)
∞∞ 
{
±± 
if
≤≤ 

(
≤≤ 
IO
≤≤ 
.
≤≤ 

staticFive
≤≤ 
==
≤≤ 
$num
≤≤ 
)
≤≤ 
{
≥≥ 	
TcpListener
¥¥ 
listener
¥¥  
=
¥¥! "
null
¥¥# '
;
¥¥' (
	TcpClient
µµ 
tcpConn
µµ 
=
µµ 
null
µµ  $
;
µµ$ %
Stream
∂∂ 
streamOutput
∂∂ 
=
∂∂  !
null
∂∂" &
;
∂∂& '
int
∑∑ 
port
∑∑ 
=
∑∑ 
$num
∑∑ 
;
∑∑ 
try
∏∏ 
{
ππ 
listener
∫∫ 
=
∫∫ 
new
∫∫ 
TcpListener
∫∫ *
(
∫∫* +
	IPAddress
∫∫+ 4
.
∫∫4 5
Parse
∫∫5 :
(
∫∫: ;
$str
∫∫; G
)
∫∫G H
,
∫∫H I
port
∫∫J N
)
∫∫N O
;
∫∫O P
listener
ªª 
.
ªª 
Start
ªª 
(
ªª 
)
ªª  
;
ªª  !
tcpConn
ºº 
=
ºº 
listener
ºº "
.
ºº" #
AcceptTcpClient
ºº# 2
(
ºº2 3
)
ºº3 4
;
ºº4 5
streamOutput
ΩΩ 
=
ΩΩ 
tcpConn
ΩΩ &
.
ΩΩ& '
	GetStream
ΩΩ' 0
(
ΩΩ0 1
)
ΩΩ1 2
;
ΩΩ2 3

IPEndPoint
ææ 
endPoint
ææ #
=
ææ$ %
(
ææ& '

IPEndPoint
ææ' 1
)
ææ1 2
tcpConn
ææ2 9
.
ææ9 :
Client
ææ: @
.
ææ@ A
RemoteEndPoint
ææA O
;
ææO P
	IPAddress
øø 
	ipAddress
øø #
=
øø$ %
endPoint
øø& .
.
øø. /
Address
øø/ 6
;
øø6 7
IPHostEntry
¿¿ 
	hostEntry
¿¿ %
=
¿¿& '
Dns
¿¿( +
.
¿¿+ ,
GetHostEntry
¿¿, 8
(
¿¿8 9
	ipAddress
¿¿9 B
)
¿¿B C
;
¿¿C D
streamOutput
¬¬ 
.
¬¬ 
Write
¬¬ "
(
¬¬" #
Encoding
¬¬# +
.
¬¬+ ,
UTF8
¬¬, 0
.
¬¬0 1
GetBytes
¬¬1 9
(
¬¬9 :
(
¬¬: ;
$str
¬¬; F
+
¬¬G H
	hostEntry
¬¬I R
.
¬¬R S
ToString
¬¬S [
(
¬¬[ \
)
¬¬\ ]
)
¬¬] ^
)
¬¬^ _
,
¬¬_ `
$num
¬¬a b
,
¬¬b c
(
¬¬d e
$str
¬¬e p
+
¬¬q r
	hostEntry
¬¬s |
.
¬¬| }
ToString¬¬} Ö
(¬¬Ö Ü
)¬¬Ü á
)¬¬á à
.¬¬à â
Length¬¬â è
)¬¬è ê
;¬¬ê ë
}
√√ 
catch
ƒƒ 
(
ƒƒ 
IOException
ƒƒ 
exceptIO
ƒƒ '
)
ƒƒ' (
{
≈≈ 
IO
∆∆ 
.
∆∆ 
Logger
∆∆ 
.
∆∆ 
Log
∆∆ 
(
∆∆ 
NLog
∆∆ "
.
∆∆" #
LogLevel
∆∆# +
.
∆∆+ ,
Warn
∆∆, 0
,
∆∆0 1
exceptIO
∆∆2 :
,
∆∆: ;
$str
∆∆< X
+
∆∆Y Z
port
∆∆[ _
.
∆∆_ `
ToString
∆∆` h
(
∆∆h i
)
∆∆i j
)
∆∆j k
;
∆∆k l
}
«« 
finally
»» 
{
…… 
try
   
{
ÀÀ 
if
ÃÃ 
(
ÃÃ 
streamOutput
ÃÃ $
!=
ÃÃ% '
null
ÃÃ( ,
)
ÃÃ, -
{
ÕÕ 
streamOutput
ŒŒ $
.
ŒŒ$ %
Close
ŒŒ% *
(
ŒŒ* +
)
ŒŒ+ ,
;
ŒŒ, -
}
œœ 
}
–– 
catch
—— 
(
—— 
IOException
—— "
exceptIO
——# +
)
——+ ,
{
““ 
IO
”” 
.
”” 
Logger
”” 
.
”” 
Log
”” !
(
””! "
NLog
””" &
.
””& '
LogLevel
””' /
.
””/ 0
Warn
””0 4
,
””4 5
exceptIO
””6 >
,
””> ?
$str
””@ W
)
””W X
;
””X Y
}
‘‘ 
try
÷÷ 
{
◊◊ 
if
ÿÿ 
(
ÿÿ 
tcpConn
ÿÿ 
!=
ÿÿ  "
null
ÿÿ# '
)
ÿÿ' (
{
ŸŸ 
tcpConn
⁄⁄ 
.
⁄⁄  
Close
⁄⁄  %
(
⁄⁄% &
)
⁄⁄& '
;
⁄⁄' (
}
€€ 
}
‹‹ 
catch
›› 
(
›› 
IOException
›› "
exceptIO
››# +
)
››+ ,
{
ﬁﬁ 
IO
ﬂﬂ 
.
ﬂﬂ 
Logger
ﬂﬂ 
.
ﬂﬂ 
Log
ﬂﬂ !
(
ﬂﬂ! "
NLog
ﬂﬂ" &
.
ﬂﬂ& '
LogLevel
ﬂﬂ' /
.
ﬂﬂ/ 0
Warn
ﬂﬂ0 4
,
ﬂﬂ4 5
exceptIO
ﬂﬂ6 >
,
ﬂﬂ> ?
$str
ﬂﬂ@ W
)
ﬂﬂW X
;
ﬂﬂX Y
}
‡‡ 
try
‚‚ 
{
„„ 
if
‰‰ 
(
‰‰ 
listener
‰‰  
!=
‰‰! #
null
‰‰$ (
)
‰‰( )
{
ÂÂ 
listener
ÊÊ  
.
ÊÊ  !
Stop
ÊÊ! %
(
ÊÊ% &
)
ÊÊ& '
;
ÊÊ' (
}
ÁÁ 
}
ËË 
catch
ÈÈ 
(
ÈÈ 
IOException
ÈÈ "
exceptIO
ÈÈ# +
)
ÈÈ+ ,
{
ÍÍ 
IO
ÎÎ 
.
ÎÎ 
Logger
ÎÎ 
.
ÎÎ 
Log
ÎÎ !
(
ÎÎ! "
NLog
ÎÎ" &
.
ÎÎ& '
LogLevel
ÎÎ' /
.
ÎÎ/ 0
Warn
ÎÎ0 4
,
ÎÎ4 5
exceptIO
ÎÎ6 >
,
ÎÎ> ?
$str
ÎÎ@ W
)
ÎÎW X
;
ÎÎX Y
}
ÏÏ 
}
ÓÓ 
}
ÔÔ 	
}
 
public
ÚÚ 

override
ÚÚ 
void
ÚÚ 
Good
ÚÚ 
(
ÚÚ 
)
ÚÚ 
{
ÛÛ 
Good1
ÙÙ 
(
ÙÙ 
)
ÙÙ 
;
ÙÙ 
Good2
ıı 
(
ıı 
)
ıı 
;
ıı 
}
ˆˆ 
}¯¯ 
}˘˘ —è
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__ip_based_logic_15.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__ip_based_logic_15 (
:) *
AbstractTestCase+ ;
{ 
public 

override 
void 
Bad 
( 
) 
{ 
switch 
( 
$num 
) 
{   	
case!! 
$num!! 
:!! 
TcpListener"" 
listener""  
=""! "
null""# '
;""' (
	TcpClient## 
tcpConn## 
=## 
null##  $
;##$ %
Stream$$ 
streamOutput$$ 
=$$  !
null$$" &
;$$& '
int%% 
port%% 
=%% 
$num%% 
;%% 
try&& 
{'' 
listener(( 
=(( 
new(( 
TcpListener(( *
(((* +
	IPAddress((+ 4
.((4 5
Parse((5 :
(((: ;
$str((; G
)((G H
,((H I
port((J N
)((N O
;((O P
listener)) 
.)) 
Start)) 
()) 
)))  
;))  !
tcpConn** 
=** 
listener** "
.**" #
AcceptTcpClient**# 2
(**2 3
)**3 4
;**4 5

IPEndPoint,, 
endPoint,, #
=,,$ %
(,,& '

IPEndPoint,,' 1
),,1 2
tcpConn,,2 9
.,,9 :
Client,,: @
.,,@ A
RemoteEndPoint,,A O
;,,O P
	IPAddress-- 
	ipAddress-- #
=--$ %
endPoint--& .
.--. /
Address--/ 6
;--6 7
IPHostEntry.. 
	hostEntry.. %
=..& '
Dns..( +
...+ ,
GetHostEntry.., 8
(..8 9
	ipAddress..9 B
)..B C
;..C D
if// 
(// 
	hostEntry// 
.// 
Equals// $
(//$ %
$str//% 5
)//5 6
)//6 7
{00 
streamOutput11  
=11! "
tcpConn11# *
.11* +
	GetStream11+ 4
(114 5
)115 6
;116 7
streamOutput22  
.22  !
Write22! &
(22& '
Encoding22' /
.22/ 0
UTF8220 4
.224 5
GetBytes225 =
(22= >
$str22> O
)22O P
,22P Q
$num22R S
,22S T
$str22U f
.22f g
Length22g m
)22m n
;22n o
}33 
else44 
{55 
streamOutput66  
=66! "
tcpConn66# *
.66* +
	GetStream66+ 4
(664 5
)665 6
;666 7
streamOutput77  
.77  !
Write77! &
(77& '
Encoding77' /
.77/ 0
UTF8770 4
.774 5
GetBytes775 =
(77= >
$str77> N
)77N O
,77O P
$num77Q R
,77R S
$str77T d
.77d e
Length77e k
)77k l
;77l m
}88 
}99 
catch:: 
(:: 
IOException:: 
exceptIO:: '
)::' (
{;; 
IO<< 
.<< 
Logger<< 
.<< 
Log<< 
(<< 
NLog<< "
.<<" #
LogLevel<<# +
.<<+ ,
Warn<<, 0
,<<0 1
exceptIO<<2 :
,<<: ;
$str<<< X
+<<Y Z
port<<[ _
.<<_ `
ToString<<` h
(<<h i
)<<i j
)<<j k
;<<k l
}== 
finally>> 
{?? 
try@@ 
{AA 
ifBB 
(BB 
streamOutputBB $
!=BB% '
nullBB( ,
)BB, -
{CC 
streamOutputDD $
.DD$ %
CloseDD% *
(DD* +
)DD+ ,
;DD, -
}EE 
}FF 
catchGG 
(GG 
IOExceptionGG "
exceptIOGG# +
)GG+ ,
{HH 
IOII 
.II 
LoggerII 
.II 
LogII !
(II! "
NLogII" &
.II& '
LogLevelII' /
.II/ 0
WarnII0 4
,II4 5
exceptIOII6 >
,II> ?
$strII@ W
)IIW X
;IIX Y
}JJ 
tryLL 
{MM 
ifNN 
(NN 
tcpConnNN 
!=NN  "
nullNN# '
)NN' (
{OO 
tcpConnPP 
.PP  
ClosePP  %
(PP% &
)PP& '
;PP' (
}QQ 
}RR 
catchSS 
(SS 
IOExceptionSS "
exceptIOSS# +
)SS+ ,
{TT 
IOUU 
.UU 
LoggerUU 
.UU 
LogUU !
(UU! "
NLogUU" &
.UU& '
LogLevelUU' /
.UU/ 0
WarnUU0 4
,UU4 5
exceptIOUU6 >
,UU> ?
$strUU@ W
)UUW X
;UUX Y
}VV 
tryXX 
{YY 
ifZZ 
(ZZ 
listenerZZ  
!=ZZ! #
nullZZ$ (
)ZZ( )
{[[ 
listener\\  
.\\  !
Stop\\! %
(\\% &
)\\& '
;\\' (
}]] 
}^^ 
catch__ 
(__ 
IOException__ "
exceptIO__# +
)__+ ,
{`` 
IOaa 
.aa 
Loggeraa 
.aa 
Logaa !
(aa! "
NLogaa" &
.aa& '
LogLevelaa' /
.aa/ 0
Warnaa0 4
,aa4 5
exceptIOaa6 >
,aa> ?
$straa@ W
)aaW X
;aaX Y
}bb 
}cc 
breakdd 
;dd 
defaultee 
:ee 
IOgg 
.gg 
	WriteLinegg 
(gg 
$strgg /
)gg/ 0
;gg0 1
breakhh 
;hh 
}ii 	
}jj 
privatenn 
voidnn 
Good1nn 
(nn 
)nn 
{oo 
switchpp 
(pp 
$numpp 
)pp 
{qq 	
caserr 
$numrr 
:rr 
IOtt 
.tt 
	WriteLinett 
(tt 
$strtt /
)tt/ 0
;tt0 1
breakuu 
;uu 
defaultvv 
:vv 
TcpListenerww 
listenerww  
=ww! "
nullww# '
;ww' (
	TcpClientxx 
tcpConnxx 
=xx 
nullxx  $
;xx$ %
Streamyy 
streamOutputyy 
=yy  !
nullyy" &
;yy& '
intzz 
portzz 
=zz 
$numzz 
;zz 
try{{ 
{|| 
listener}} 
=}} 
new}} 
TcpListener}} *
(}}* +
	IPAddress}}+ 4
.}}4 5
Parse}}5 :
(}}: ;
$str}}; G
)}}G H
,}}H I
port}}J N
)}}N O
;}}O P
listener~~ 
.~~ 
Start~~ 
(~~ 
)~~  
;~~  !
tcpConn 
= 
listener "
." #
AcceptTcpClient# 2
(2 3
)3 4
;4 5
streamOutput
ÄÄ 
=
ÄÄ 
tcpConn
ÄÄ &
.
ÄÄ& '
	GetStream
ÄÄ' 0
(
ÄÄ0 1
)
ÄÄ1 2
;
ÄÄ2 3

IPEndPoint
ÅÅ 
endPoint
ÅÅ #
=
ÅÅ$ %
(
ÅÅ& '

IPEndPoint
ÅÅ' 1
)
ÅÅ1 2
tcpConn
ÅÅ2 9
.
ÅÅ9 :
Client
ÅÅ: @
.
ÅÅ@ A
RemoteEndPoint
ÅÅA O
;
ÅÅO P
	IPAddress
ÇÇ 
	ipAddress
ÇÇ #
=
ÇÇ$ %
endPoint
ÇÇ& .
.
ÇÇ. /
Address
ÇÇ/ 6
;
ÇÇ6 7
IPHostEntry
ÉÉ 
	hostEntry
ÉÉ %
=
ÉÉ& '
Dns
ÉÉ( +
.
ÉÉ+ ,
GetHostEntry
ÉÉ, 8
(
ÉÉ8 9
	ipAddress
ÉÉ9 B
)
ÉÉB C
;
ÉÉC D
streamOutput
ÖÖ 
.
ÖÖ 
Write
ÖÖ "
(
ÖÖ" #
Encoding
ÖÖ# +
.
ÖÖ+ ,
UTF8
ÖÖ, 0
.
ÖÖ0 1
GetBytes
ÖÖ1 9
(
ÖÖ9 :
(
ÖÖ: ;
$str
ÖÖ; F
+
ÖÖG H
	hostEntry
ÖÖI R
.
ÖÖR S
ToString
ÖÖS [
(
ÖÖ[ \
)
ÖÖ\ ]
)
ÖÖ] ^
)
ÖÖ^ _
,
ÖÖ_ `
$num
ÖÖa b
,
ÖÖb c
(
ÖÖd e
$str
ÖÖe p
+
ÖÖq r
	hostEntry
ÖÖs |
.
ÖÖ| }
ToStringÖÖ} Ö
(ÖÖÖ Ü
)ÖÖÜ á
)ÖÖá à
.ÖÖà â
LengthÖÖâ è
)ÖÖè ê
;ÖÖê ë
}
ÜÜ 
catch
áá 
(
áá 
IOException
áá 
exceptIO
áá '
)
áá' (
{
àà 
IO
ââ 
.
ââ 
Logger
ââ 
.
ââ 
Log
ââ 
(
ââ 
NLog
ââ "
.
ââ" #
LogLevel
ââ# +
.
ââ+ ,
Warn
ââ, 0
,
ââ0 1
exceptIO
ââ2 :
,
ââ: ;
$str
ââ< X
+
ââY Z
port
ââ[ _
.
ââ_ `
ToString
ââ` h
(
ââh i
)
ââi j
)
ââj k
;
ââk l
}
ää 
finally
ãã 
{
åå 
try
çç 
{
éé 
if
èè 
(
èè 
streamOutput
èè $
!=
èè% '
null
èè( ,
)
èè, -
{
êê 
streamOutput
ëë $
.
ëë$ %
Close
ëë% *
(
ëë* +
)
ëë+ ,
;
ëë, -
}
íí 
}
ìì 
catch
îî 
(
îî 
IOException
îî "
exceptIO
îî# +
)
îî+ ,
{
ïï 
IO
ññ 
.
ññ 
Logger
ññ 
.
ññ 
Log
ññ !
(
ññ! "
NLog
ññ" &
.
ññ& '
LogLevel
ññ' /
.
ññ/ 0
Warn
ññ0 4
,
ññ4 5
exceptIO
ññ6 >
,
ññ> ?
$str
ññ@ W
)
ññW X
;
ññX Y
}
óó 
try
ôô 
{
öö 
if
õõ 
(
õõ 
tcpConn
õõ 
!=
õõ  "
null
õõ# '
)
õõ' (
{
úú 
tcpConn
ùù 
.
ùù  
Close
ùù  %
(
ùù% &
)
ùù& '
;
ùù' (
}
ûû 
}
üü 
catch
†† 
(
†† 
IOException
†† "
exceptIO
††# +
)
††+ ,
{
°° 
IO
¢¢ 
.
¢¢ 
Logger
¢¢ 
.
¢¢ 
Log
¢¢ !
(
¢¢! "
NLog
¢¢" &
.
¢¢& '
LogLevel
¢¢' /
.
¢¢/ 0
Warn
¢¢0 4
,
¢¢4 5
exceptIO
¢¢6 >
,
¢¢> ?
$str
¢¢@ W
)
¢¢W X
;
¢¢X Y
}
££ 
try
•• 
{
¶¶ 
if
ßß 
(
ßß 
listener
ßß  
!=
ßß! #
null
ßß$ (
)
ßß( )
{
®® 
listener
©©  
.
©©  !
Stop
©©! %
(
©©% &
)
©©& '
;
©©' (
}
™™ 
}
´´ 
catch
¨¨ 
(
¨¨ 
IOException
¨¨ "
exceptIO
¨¨# +
)
¨¨+ ,
{
≠≠ 
IO
ÆÆ 
.
ÆÆ 
Logger
ÆÆ 
.
ÆÆ 
Log
ÆÆ !
(
ÆÆ! "
NLog
ÆÆ" &
.
ÆÆ& '
LogLevel
ÆÆ' /
.
ÆÆ/ 0
Warn
ÆÆ0 4
,
ÆÆ4 5
exceptIO
ÆÆ6 >
,
ÆÆ> ?
$str
ÆÆ@ W
)
ÆÆW X
;
ÆÆX Y
}
ØØ 
}
±± 
break
≤≤ 
;
≤≤ 
}
≥≥ 	
}
¥¥ 
private
∑∑ 
void
∑∑ 
Good2
∑∑ 
(
∑∑ 
)
∑∑ 
{
∏∏ 
switch
ππ 
(
ππ 
$num
ππ 
)
ππ 
{
∫∫ 	
case
ªª 
$num
ªª 
:
ªª 
TcpListener
ºº 
listener
ºº  
=
ºº! "
null
ºº# '
;
ºº' (
	TcpClient
ΩΩ 
tcpConn
ΩΩ 
=
ΩΩ 
null
ΩΩ  $
;
ΩΩ$ %
Stream
ææ 
streamOutput
ææ 
=
ææ  !
null
ææ" &
;
ææ& '
int
øø 
port
øø 
=
øø 
$num
øø 
;
øø 
try
¿¿ 
{
¡¡ 
listener
¬¬ 
=
¬¬ 
new
¬¬ 
TcpListener
¬¬ *
(
¬¬* +
	IPAddress
¬¬+ 4
.
¬¬4 5
Parse
¬¬5 :
(
¬¬: ;
$str
¬¬; G
)
¬¬G H
,
¬¬H I
port
¬¬J N
)
¬¬N O
;
¬¬O P
listener
√√ 
.
√√ 
Start
√√ 
(
√√ 
)
√√  
;
√√  !
tcpConn
ƒƒ 
=
ƒƒ 
listener
ƒƒ "
.
ƒƒ" #
AcceptTcpClient
ƒƒ# 2
(
ƒƒ2 3
)
ƒƒ3 4
;
ƒƒ4 5
streamOutput
≈≈ 
=
≈≈ 
tcpConn
≈≈ &
.
≈≈& '
	GetStream
≈≈' 0
(
≈≈0 1
)
≈≈1 2
;
≈≈2 3

IPEndPoint
∆∆ 
endPoint
∆∆ #
=
∆∆$ %
(
∆∆& '

IPEndPoint
∆∆' 1
)
∆∆1 2
tcpConn
∆∆2 9
.
∆∆9 :
Client
∆∆: @
.
∆∆@ A
RemoteEndPoint
∆∆A O
;
∆∆O P
	IPAddress
«« 
	ipAddress
«« #
=
««$ %
endPoint
««& .
.
««. /
Address
««/ 6
;
««6 7
IPHostEntry
»» 
	hostEntry
»» %
=
»»& '
Dns
»»( +
.
»»+ ,
GetHostEntry
»», 8
(
»»8 9
	ipAddress
»»9 B
)
»»B C
;
»»C D
streamOutput
   
.
   
Write
   "
(
  " #
Encoding
  # +
.
  + ,
UTF8
  , 0
.
  0 1
GetBytes
  1 9
(
  9 :
(
  : ;
$str
  ; F
+
  G H
	hostEntry
  I R
.
  R S
ToString
  S [
(
  [ \
)
  \ ]
)
  ] ^
)
  ^ _
,
  _ `
$num
  a b
,
  b c
(
  d e
$str
  e p
+
  q r
	hostEntry
  s |
.
  | }
ToString  } Ö
(  Ö Ü
)  Ü á
)  á à
.  à â
Length  â è
)  è ê
;  ê ë
}
ÀÀ 
catch
ÃÃ 
(
ÃÃ 
IOException
ÃÃ 
exceptIO
ÃÃ '
)
ÃÃ' (
{
ÕÕ 
IO
ŒŒ 
.
ŒŒ 
Logger
ŒŒ 
.
ŒŒ 
Log
ŒŒ 
(
ŒŒ 
NLog
ŒŒ "
.
ŒŒ" #
LogLevel
ŒŒ# +
.
ŒŒ+ ,
Warn
ŒŒ, 0
,
ŒŒ0 1
exceptIO
ŒŒ2 :
,
ŒŒ: ;
$str
ŒŒ< X
+
ŒŒY Z
port
ŒŒ[ _
.
ŒŒ_ `
ToString
ŒŒ` h
(
ŒŒh i
)
ŒŒi j
)
ŒŒj k
;
ŒŒk l
}
œœ 
finally
–– 
{
—— 
try
““ 
{
”” 
if
‘‘ 
(
‘‘ 
streamOutput
‘‘ $
!=
‘‘% '
null
‘‘( ,
)
‘‘, -
{
’’ 
streamOutput
÷÷ $
.
÷÷$ %
Close
÷÷% *
(
÷÷* +
)
÷÷+ ,
;
÷÷, -
}
◊◊ 
}
ÿÿ 
catch
ŸŸ 
(
ŸŸ 
IOException
ŸŸ "
exceptIO
ŸŸ# +
)
ŸŸ+ ,
{
⁄⁄ 
IO
€€ 
.
€€ 
Logger
€€ 
.
€€ 
Log
€€ !
(
€€! "
NLog
€€" &
.
€€& '
LogLevel
€€' /
.
€€/ 0
Warn
€€0 4
,
€€4 5
exceptIO
€€6 >
,
€€> ?
$str
€€@ W
)
€€W X
;
€€X Y
}
‹‹ 
try
ﬁﬁ 
{
ﬂﬂ 
if
‡‡ 
(
‡‡ 
tcpConn
‡‡ 
!=
‡‡  "
null
‡‡# '
)
‡‡' (
{
·· 
tcpConn
‚‚ 
.
‚‚  
Close
‚‚  %
(
‚‚% &
)
‚‚& '
;
‚‚' (
}
„„ 
}
‰‰ 
catch
ÂÂ 
(
ÂÂ 
IOException
ÂÂ "
exceptIO
ÂÂ# +
)
ÂÂ+ ,
{
ÊÊ 
IO
ÁÁ 
.
ÁÁ 
Logger
ÁÁ 
.
ÁÁ 
Log
ÁÁ !
(
ÁÁ! "
NLog
ÁÁ" &
.
ÁÁ& '
LogLevel
ÁÁ' /
.
ÁÁ/ 0
Warn
ÁÁ0 4
,
ÁÁ4 5
exceptIO
ÁÁ6 >
,
ÁÁ> ?
$str
ÁÁ@ W
)
ÁÁW X
;
ÁÁX Y
}
ËË 
try
ÍÍ 
{
ÎÎ 
if
ÏÏ 
(
ÏÏ 
listener
ÏÏ  
!=
ÏÏ! #
null
ÏÏ$ (
)
ÏÏ( )
{
ÌÌ 
listener
ÓÓ  
.
ÓÓ  !
Stop
ÓÓ! %
(
ÓÓ% &
)
ÓÓ& '
;
ÓÓ' (
}
ÔÔ 
}
 
catch
ÒÒ 
(
ÒÒ 
IOException
ÒÒ "
exceptIO
ÒÒ# +
)
ÒÒ+ ,
{
ÚÚ 
IO
ÛÛ 
.
ÛÛ 
Logger
ÛÛ 
.
ÛÛ 
Log
ÛÛ !
(
ÛÛ! "
NLog
ÛÛ" &
.
ÛÛ& '
LogLevel
ÛÛ' /
.
ÛÛ/ 0
Warn
ÛÛ0 4
,
ÛÛ4 5
exceptIO
ÛÛ6 >
,
ÛÛ> ?
$str
ÛÛ@ W
)
ÛÛW X
;
ÛÛX Y
}
ÙÙ 
}
ˆˆ 
break
˜˜ 
;
˜˜ 
default
¯¯ 
:
¯¯ 
IO
˙˙ 
.
˙˙ 
	WriteLine
˙˙ 
(
˙˙ 
$str
˙˙ /
)
˙˙/ 0
;
˙˙0 1
break
˚˚ 
;
˚˚ 
}
¸¸ 	
}
˝˝ 
public
ˇˇ 

override
ˇˇ 
void
ˇˇ 
Good
ˇˇ 
(
ˇˇ 
)
ˇˇ 
{
ÄÄ 
Good1
ÅÅ 
(
ÅÅ 
)
ÅÅ 
;
ÅÅ 
Good2
ÇÇ 
(
ÇÇ 
)
ÇÇ 
;
ÇÇ 
}
ÉÉ 
}ÖÖ 
}ÜÜ ÏZ
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__ip_based_logic_16.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__ip_based_logic_16 (
:) *
AbstractTestCase+ ;
{ 
public 

override 
void 
Bad 
( 
) 
{ 
while 
( 
true 
) 
{   	
TcpListener!! 
listener!!  
=!!! "
null!!# '
;!!' (
	TcpClient"" 
tcpConn"" 
="" 
null""  $
;""$ %
Stream## 
streamOutput## 
=##  !
null##" &
;##& '
int$$ 
port$$ 
=$$ 
$num$$ 
;$$ 
try%% 
{&& 
listener'' 
='' 
new'' 
TcpListener'' *
(''* +
	IPAddress''+ 4
.''4 5
Parse''5 :
('': ;
$str''; G
)''G H
,''H I
port''J N
)''N O
;''O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
tcpConn)) 
=)) 
listener)) "
.))" #
AcceptTcpClient))# 2
())2 3
)))3 4
;))4 5

IPEndPoint++ 
endPoint++ #
=++$ %
(++& '

IPEndPoint++' 1
)++1 2
tcpConn++2 9
.++9 :
Client++: @
.++@ A
RemoteEndPoint++A O
;++O P
	IPAddress,, 
	ipAddress,, #
=,,$ %
endPoint,,& .
.,,. /
Address,,/ 6
;,,6 7
IPHostEntry-- 
	hostEntry-- %
=--& '
Dns--( +
.--+ ,
GetHostEntry--, 8
(--8 9
	ipAddress--9 B
)--B C
;--C D
if.. 
(.. 
	hostEntry.. 
... 
Equals.. $
(..$ %
$str..% 5
)..5 6
)..6 7
{// 
streamOutput00  
=00! "
tcpConn00# *
.00* +
	GetStream00+ 4
(004 5
)005 6
;006 7
streamOutput11  
.11  !
Write11! &
(11& '
Encoding11' /
.11/ 0
UTF8110 4
.114 5
GetBytes115 =
(11= >
$str11> O
)11O P
,11P Q
$num11R S
,11S T
$str11U f
.11f g
Length11g m
)11m n
;11n o
}22 
else33 
{44 
streamOutput55  
=55! "
tcpConn55# *
.55* +
	GetStream55+ 4
(554 5
)555 6
;556 7
streamOutput66  
.66  !
Write66! &
(66& '
Encoding66' /
.66/ 0
UTF8660 4
.664 5
GetBytes665 =
(66= >
$str66> N
)66N O
,66O P
$num66Q R
,66R S
$str66T d
.66d e
Length66e k
)66k l
;66l m
}77 
}88 
catch99 
(99 
IOException99 
exceptIO99 '
)99' (
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; 
(;; 
NLog;; "
.;;" #
LogLevel;;# +
.;;+ ,
Warn;;, 0
,;;0 1
exceptIO;;2 :
,;;: ;
$str;;< X
+;;Y Z
port;;[ _
.;;_ `
ToString;;` h
(;;h i
);;i j
);;j k
;;;k l
}<< 
finally== 
{>> 
try?? 
{@@ 
ifAA 
(AA 
streamOutputAA $
!=AA% '
nullAA( ,
)AA, -
{BB 
streamOutputCC $
.CC$ %
CloseCC% *
(CC* +
)CC+ ,
;CC, -
}DD 
}EE 
catchFF 
(FF 
IOExceptionFF "
exceptIOFF# +
)FF+ ,
{GG 
IOHH 
.HH 
LoggerHH 
.HH 
LogHH !
(HH! "
NLogHH" &
.HH& '
LogLevelHH' /
.HH/ 0
WarnHH0 4
,HH4 5
exceptIOHH6 >
,HH> ?
$strHH@ W
)HHW X
;HHX Y
}II 
tryKK 
{LL 
ifMM 
(MM 
tcpConnMM 
!=MM  "
nullMM# '
)MM' (
{NN 
tcpConnOO 
.OO  
CloseOO  %
(OO% &
)OO& '
;OO' (
}PP 
}QQ 
catchRR 
(RR 
IOExceptionRR "
exceptIORR# +
)RR+ ,
{SS 
IOTT 
.TT 
LoggerTT 
.TT 
LogTT !
(TT! "
NLogTT" &
.TT& '
LogLevelTT' /
.TT/ 0
WarnTT0 4
,TT4 5
exceptIOTT6 >
,TT> ?
$strTT@ W
)TTW X
;TTX Y
}UU 
tryWW 
{XX 
ifYY 
(YY 
listenerYY  
!=YY! #
nullYY$ (
)YY( )
{ZZ 
listener[[  
.[[  !
Stop[[! %
([[% &
)[[& '
;[[' (
}\\ 
}]] 
catch^^ 
(^^ 
IOException^^ "
exceptIO^^# +
)^^+ ,
{__ 
IO`` 
.`` 
Logger`` 
.`` 
Log`` !
(``! "
NLog``" &
.``& '
LogLevel``' /
.``/ 0
Warn``0 4
,``4 5
exceptIO``6 >
,``> ?
$str``@ W
)``W X
;``X Y
}aa 
}bb 
breakcc 
;cc 
}dd 	
}ee 
privateii 
voidii 
Good1ii 
(ii 
)ii 
{jj 
whilekk 
(kk 
truekk 
)kk 
{ll 	
TcpListenermm 
listenermm  
=mm! "
nullmm# '
;mm' (
	TcpClientnn 
tcpConnnn 
=nn 
nullnn  $
;nn$ %
Streamoo 
streamOutputoo 
=oo  !
nulloo" &
;oo& '
intpp 
portpp 
=pp 
$numpp 
;pp 
tryqq 
{rr 
listenerss 
=ss 
newss 
TcpListenerss *
(ss* +
	IPAddressss+ 4
.ss4 5
Parsess5 :
(ss: ;
$strss; G
)ssG H
,ssH I
portssJ N
)ssN O
;ssO P
listenertt 
.tt 
Starttt 
(tt 
)tt  
;tt  !
tcpConnuu 
=uu 
listeneruu "
.uu" #
AcceptTcpClientuu# 2
(uu2 3
)uu3 4
;uu4 5
streamOutputvv 
=vv 
tcpConnvv &
.vv& '
	GetStreamvv' 0
(vv0 1
)vv1 2
;vv2 3

IPEndPointww 
endPointww #
=ww$ %
(ww& '

IPEndPointww' 1
)ww1 2
tcpConnww2 9
.ww9 :
Clientww: @
.ww@ A
RemoteEndPointwwA O
;wwO P
	IPAddressxx 
	ipAddressxx #
=xx$ %
endPointxx& .
.xx. /
Addressxx/ 6
;xx6 7
IPHostEntryyy 
	hostEntryyy %
=yy& '
Dnsyy( +
.yy+ ,
GetHostEntryyy, 8
(yy8 9
	ipAddressyy9 B
)yyB C
;yyC D
streamOutput{{ 
.{{ 
Write{{ "
({{" #
Encoding{{# +
.{{+ ,
UTF8{{, 0
.{{0 1
GetBytes{{1 9
({{9 :
({{: ;
$str{{; F
+{{G H
	hostEntry{{I R
.{{R S
ToString{{S [
({{[ \
){{\ ]
){{] ^
){{^ _
,{{_ `
$num{{a b
,{{b c
({{d e
$str{{e p
+{{q r
	hostEntry{{s |
.{{| }
ToString	{{} Ö
(
{{Ö Ü
)
{{Ü á
)
{{á à
.
{{à â
Length
{{â è
)
{{è ê
;
{{ê ë
}|| 
catch}} 
(}} 
IOException}} 
exceptIO}} '
)}}' (
{~~ 
IO 
. 
Logger 
. 
Log 
( 
NLog "
." #
LogLevel# +
.+ ,
Warn, 0
,0 1
exceptIO2 :
,: ;
$str< X
+Y Z
port[ _
._ `
ToString` h
(h i
)i j
)j k
;k l
}
ÄÄ 
finally
ÅÅ 
{
ÇÇ 
try
ÉÉ 
{
ÑÑ 
if
ÖÖ 
(
ÖÖ 
streamOutput
ÖÖ $
!=
ÖÖ% '
null
ÖÖ( ,
)
ÖÖ, -
{
ÜÜ 
streamOutput
áá $
.
áá$ %
Close
áá% *
(
áá* +
)
áá+ ,
;
áá, -
}
àà 
}
ââ 
catch
ää 
(
ää 
IOException
ää "
exceptIO
ää# +
)
ää+ ,
{
ãã 
IO
åå 
.
åå 
Logger
åå 
.
åå 
Log
åå !
(
åå! "
NLog
åå" &
.
åå& '
LogLevel
åå' /
.
åå/ 0
Warn
åå0 4
,
åå4 5
exceptIO
åå6 >
,
åå> ?
$str
åå@ W
)
ååW X
;
ååX Y
}
çç 
try
èè 
{
êê 
if
ëë 
(
ëë 
tcpConn
ëë 
!=
ëë  "
null
ëë# '
)
ëë' (
{
íí 
tcpConn
ìì 
.
ìì  
Close
ìì  %
(
ìì% &
)
ìì& '
;
ìì' (
}
îî 
}
ïï 
catch
ññ 
(
ññ 
IOException
ññ "
exceptIO
ññ# +
)
ññ+ ,
{
óó 
IO
òò 
.
òò 
Logger
òò 
.
òò 
Log
òò !
(
òò! "
NLog
òò" &
.
òò& '
LogLevel
òò' /
.
òò/ 0
Warn
òò0 4
,
òò4 5
exceptIO
òò6 >
,
òò> ?
$str
òò@ W
)
òòW X
;
òòX Y
}
ôô 
try
õõ 
{
úú 
if
ùù 
(
ùù 
listener
ùù  
!=
ùù! #
null
ùù$ (
)
ùù( )
{
ûû 
listener
üü  
.
üü  !
Stop
üü! %
(
üü% &
)
üü& '
;
üü' (
}
†† 
}
°° 
catch
¢¢ 
(
¢¢ 
IOException
¢¢ "
exceptIO
¢¢# +
)
¢¢+ ,
{
££ 
IO
§§ 
.
§§ 
Logger
§§ 
.
§§ 
Log
§§ !
(
§§! "
NLog
§§" &
.
§§& '
LogLevel
§§' /
.
§§/ 0
Warn
§§0 4
,
§§4 5
exceptIO
§§6 >
,
§§> ?
$str
§§@ W
)
§§W X
;
§§X Y
}
•• 
}
ßß 
break
®® 
;
®® 
}
©© 	
}
™™ 
public
¨¨ 

override
¨¨ 
void
¨¨ 
Good
¨¨ 
(
¨¨ 
)
¨¨ 
{
≠≠ 
Good1
ÆÆ 
(
ÆÆ 
)
ÆÆ 
;
ÆÆ 
}
ØØ 
}±± 
}≤≤ ÷\
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__ip_based_logic_17.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__ip_based_logic_17 (
:) *
AbstractTestCase+ ;
{ 
public 

override 
void 
Bad 
( 
) 
{ 
for 
( 
int 
j 
= 
$num 
; 
j 
< 
$num 
; 
j 
++ !
)! "
{   	
TcpListener!! 
listener!!  
=!!! "
null!!# '
;!!' (
	TcpClient"" 
tcpConn"" 
="" 
null""  $
;""$ %
Stream## 
streamOutput## 
=##  !
null##" &
;##& '
int$$ 
port$$ 
=$$ 
$num$$ 
;$$ 
try%% 
{&& 
listener'' 
='' 
new'' 
TcpListener'' *
(''* +
	IPAddress''+ 4
.''4 5
Parse''5 :
('': ;
$str''; G
)''G H
,''H I
port''J N
)''N O
;''O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
tcpConn)) 
=)) 
listener)) "
.))" #
AcceptTcpClient))# 2
())2 3
)))3 4
;))4 5

IPEndPoint++ 
endPoint++ #
=++$ %
(++& '

IPEndPoint++' 1
)++1 2
tcpConn++2 9
.++9 :
Client++: @
.++@ A
RemoteEndPoint++A O
;++O P
	IPAddress,, 
	ipAddress,, #
=,,$ %
endPoint,,& .
.,,. /
Address,,/ 6
;,,6 7
IPHostEntry-- 
	hostEntry-- %
=--& '
Dns--( +
.--+ ,
GetHostEntry--, 8
(--8 9
	ipAddress--9 B
)--B C
;--C D
if.. 
(.. 
	hostEntry.. 
... 
Equals.. $
(..$ %
$str..% 5
)..5 6
)..6 7
{// 
streamOutput00  
=00! "
tcpConn00# *
.00* +
	GetStream00+ 4
(004 5
)005 6
;006 7
streamOutput11  
.11  !
Write11! &
(11& '
Encoding11' /
.11/ 0
UTF8110 4
.114 5
GetBytes115 =
(11= >
$str11> O
)11O P
,11P Q
$num11R S
,11S T
$str11U f
.11f g
Length11g m
)11m n
;11n o
}22 
else33 
{44 
streamOutput55  
=55! "
tcpConn55# *
.55* +
	GetStream55+ 4
(554 5
)555 6
;556 7
streamOutput66  
.66  !
Write66! &
(66& '
Encoding66' /
.66/ 0
UTF8660 4
.664 5
GetBytes665 =
(66= >
$str66> N
)66N O
,66O P
$num66Q R
,66R S
$str66T d
.66d e
Length66e k
)66k l
;66l m
}77 
}88 
catch99 
(99 
IOException99 
exceptIO99 '
)99' (
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; 
(;; 
NLog;; "
.;;" #
LogLevel;;# +
.;;+ ,
Warn;;, 0
,;;0 1
exceptIO;;2 :
,;;: ;
$str;;< X
+;;Y Z
port;;[ _
.;;_ `
ToString;;` h
(;;h i
);;i j
);;j k
;;;k l
}<< 
finally== 
{>> 
try?? 
{@@ 
ifAA 
(AA 
streamOutputAA $
!=AA% '
nullAA( ,
)AA, -
{BB 
streamOutputCC $
.CC$ %
CloseCC% *
(CC* +
)CC+ ,
;CC, -
}DD 
}EE 
catchFF 
(FF 
IOExceptionFF "
exceptIOFF# +
)FF+ ,
{GG 
IOHH 
.HH 
LoggerHH 
.HH 
LogHH !
(HH! "
NLogHH" &
.HH& '
LogLevelHH' /
.HH/ 0
WarnHH0 4
,HH4 5
exceptIOHH6 >
,HH> ?
$strHH@ W
)HHW X
;HHX Y
}II 
tryKK 
{LL 
ifMM 
(MM 
tcpConnMM 
!=MM  "
nullMM# '
)MM' (
{NN 
tcpConnOO 
.OO  
CloseOO  %
(OO% &
)OO& '
;OO' (
}PP 
}QQ 
catchRR 
(RR 
IOExceptionRR "
exceptIORR# +
)RR+ ,
{SS 
IOTT 
.TT 
LoggerTT 
.TT 
LogTT !
(TT! "
NLogTT" &
.TT& '
LogLevelTT' /
.TT/ 0
WarnTT0 4
,TT4 5
exceptIOTT6 >
,TT> ?
$strTT@ W
)TTW X
;TTX Y
}UU 
tryWW 
{XX 
ifYY 
(YY 
listenerYY  
!=YY! #
nullYY$ (
)YY( )
{ZZ 
listener[[  
.[[  !
Stop[[! %
([[% &
)[[& '
;[[' (
}\\ 
}]] 
catch^^ 
(^^ 
IOException^^ "
exceptIO^^# +
)^^+ ,
{__ 
IO`` 
.`` 
Logger`` 
.`` 
Log`` !
(``! "
NLog``" &
.``& '
LogLevel``' /
.``/ 0
Warn``0 4
,``4 5
exceptIO``6 >
,``> ?
$str``@ W
)``W X
;``X Y
}aa 
}bb 
}cc 	
}dd 
privatehh 
voidhh 
Good1hh 
(hh 
)hh 
{ii 
forjj 
(jj 
intjj 
kjj 
=jj 
$numjj 
;jj 
kjj 
<jj 
$numjj 
;jj 
kjj 
++jj !
)jj! "
{kk 	
TcpListenerll 
listenerll  
=ll! "
nullll# '
;ll' (
	TcpClientmm 
tcpConnmm 
=mm 
nullmm  $
;mm$ %
Streamnn 
streamOutputnn 
=nn  !
nullnn" &
;nn& '
intoo 
portoo 
=oo 
$numoo 
;oo 
trypp 
{qq 
listenerrr 
=rr 
newrr 
TcpListenerrr *
(rr* +
	IPAddressrr+ 4
.rr4 5
Parserr5 :
(rr: ;
$strrr; G
)rrG H
,rrH I
portrrJ N
)rrN O
;rrO P
listenerss 
.ss 
Startss 
(ss 
)ss  
;ss  !
tcpConntt 
=tt 
listenertt "
.tt" #
AcceptTcpClienttt# 2
(tt2 3
)tt3 4
;tt4 5
streamOutputuu 
=uu 
tcpConnuu &
.uu& '
	GetStreamuu' 0
(uu0 1
)uu1 2
;uu2 3

IPEndPointvv 
endPointvv #
=vv$ %
(vv& '

IPEndPointvv' 1
)vv1 2
tcpConnvv2 9
.vv9 :
Clientvv: @
.vv@ A
RemoteEndPointvvA O
;vvO P
	IPAddressww 
	ipAddressww #
=ww$ %
endPointww& .
.ww. /
Addressww/ 6
;ww6 7
IPHostEntryxx 
	hostEntryxx %
=xx& '
Dnsxx( +
.xx+ ,
GetHostEntryxx, 8
(xx8 9
	ipAddressxx9 B
)xxB C
;xxC D
streamOutputzz 
.zz 
Writezz "
(zz" #
Encodingzz# +
.zz+ ,
UTF8zz, 0
.zz0 1
GetByteszz1 9
(zz9 :
(zz: ;
$strzz; F
+zzG H
	hostEntryzzI R
.zzR S
ToStringzzS [
(zz[ \
)zz\ ]
)zz] ^
)zz^ _
,zz_ `
$numzza b
,zzb c
(zzd e
$strzze p
+zzq r
	hostEntryzzs |
.zz| }
ToString	zz} Ö
(
zzÖ Ü
)
zzÜ á
)
zzá à
.
zzà â
Length
zzâ è
)
zzè ê
;
zzê ë
}{{ 
catch|| 
(|| 
IOException|| 
exceptIO|| '
)||' (
{}} 
IO~~ 
.~~ 
Logger~~ 
.~~ 
Log~~ 
(~~ 
NLog~~ "
.~~" #
LogLevel~~# +
.~~+ ,
Warn~~, 0
,~~0 1
exceptIO~~2 :
,~~: ;
$str~~< X
+~~Y Z
port~~[ _
.~~_ `
ToString~~` h
(~~h i
)~~i j
)~~j k
;~~k l
} 
finally
ÄÄ 
{
ÅÅ 
try
ÇÇ 
{
ÉÉ 
if
ÑÑ 
(
ÑÑ 
streamOutput
ÑÑ $
!=
ÑÑ% '
null
ÑÑ( ,
)
ÑÑ, -
{
ÖÖ 
streamOutput
ÜÜ $
.
ÜÜ$ %
Close
ÜÜ% *
(
ÜÜ* +
)
ÜÜ+ ,
;
ÜÜ, -
}
áá 
}
àà 
catch
ââ 
(
ââ 
IOException
ââ "
exceptIO
ââ# +
)
ââ+ ,
{
ää 
IO
ãã 
.
ãã 
Logger
ãã 
.
ãã 
Log
ãã !
(
ãã! "
NLog
ãã" &
.
ãã& '
LogLevel
ãã' /
.
ãã/ 0
Warn
ãã0 4
,
ãã4 5
exceptIO
ãã6 >
,
ãã> ?
$str
ãã@ W
)
ããW X
;
ããX Y
}
åå 
try
éé 
{
èè 
if
êê 
(
êê 
tcpConn
êê 
!=
êê  "
null
êê# '
)
êê' (
{
ëë 
tcpConn
íí 
.
íí  
Close
íí  %
(
íí% &
)
íí& '
;
íí' (
}
ìì 
}
îî 
catch
ïï 
(
ïï 
IOException
ïï "
exceptIO
ïï# +
)
ïï+ ,
{
ññ 
IO
óó 
.
óó 
Logger
óó 
.
óó 
Log
óó !
(
óó! "
NLog
óó" &
.
óó& '
LogLevel
óó' /
.
óó/ 0
Warn
óó0 4
,
óó4 5
exceptIO
óó6 >
,
óó> ?
$str
óó@ W
)
óóW X
;
óóX Y
}
òò 
try
öö 
{
õõ 
if
úú 
(
úú 
listener
úú  
!=
úú! #
null
úú$ (
)
úú( )
{
ùù 
listener
ûû  
.
ûû  !
Stop
ûû! %
(
ûû% &
)
ûû& '
;
ûû' (
}
üü 
}
†† 
catch
°° 
(
°° 
IOException
°° "
exceptIO
°°# +
)
°°+ ,
{
¢¢ 
IO
££ 
.
££ 
Logger
££ 
.
££ 
Log
££ !
(
££! "
NLog
££" &
.
££& '
LogLevel
££' /
.
££/ 0
Warn
££0 4
,
££4 5
exceptIO
££6 >
,
££> ?
$str
££@ W
)
££W X
;
££X Y
}
§§ 
}
¶¶ 
}
ßß 	
}
®® 
public
™™ 

override
™™ 
void
™™ 
Good
™™ 
(
™™ 
)
™™ 
{
´´ 
Good1
¨¨ 
(
¨¨ 
)
¨¨ 
;
¨¨ 
}
≠≠ 
}ØØ 
}∞∞ ò
îC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_connection_01.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 2
&CWE510_Trapdoor__network_connection_01 ,
:- .#
AbstractTestCaseBadOnly/ F
{ 
public 

override 
void 
Bad 
( 
) 
{ 
Stream 
streamInput 
= 
null !
;! "
try 
{ 	
Uri!! 
url!! 
=!! 
new!! 
Uri!! 
(!! 
$str!! 9
)!!9 :
;!!: ;

WebRequest"" 
request"" 
=""  

WebRequest""! +
.""+ ,
Create"", 2
(""2 3
url""3 6
)""6 7
;""7 8
streamInput## 
=## 
request## !
.##! "
GetRequestStream##" 2
(##2 3
)##3 4
;##4 5
}$$ 	
catch%% 
(%% 
IOException%% 
exceptIO%% #
)%%# $
{&& 	
IO'' 
.'' 
Logger'' 
.'' 
Log'' 
('' 
NLog'' 
.'' 
LogLevel'' '
.''' (
Warn''( ,
,'', -
exceptIO''. 6
,''6 7
$str''8 L
)''L M
;''M N
}(( 	
finally)) 
{** 	
try++ 
{,, 
if-- 
(-- 
streamInput-- 
!=--  "
null--# '
)--' (
{.. 
streamInput// 
.//  
Close//  %
(//% &
)//& '
;//' (
}00 
}11 
catch22 
(22 
IOException22 
exceptIO22 '
)22' (
{33 
IO44 
.44 
Logger44 
.44 
Log44 
(44 
NLog44 "
.44" #
LogLevel44# +
.44+ ,
Warn44, 0
,440 1
exceptIO442 :
,44: ;
$str44< P
)44P Q
;44Q R
}55 
}66 	
}77 
}99 
}:: ˆ
îC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_connection_02.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 2
&CWE510_Trapdoor__network_connection_02 ,
:- .#
AbstractTestCaseBadOnly/ F
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
true 
) 
{ 	
Stream 
streamInput 
=  
null! %
;% &
try   
{!! 
Uri## 
url## 
=## 
new## 
Uri## !
(##! "
$str##" =
)##= >
;##> ?

WebRequest$$ 
request$$ "
=$$# $

WebRequest$$% /
.$$/ 0
Create$$0 6
($$6 7
url$$7 :
)$$: ;
;$$; <
streamInput%% 
=%% 
request%% %
.%%% &
GetRequestStream%%& 6
(%%6 7
)%%7 8
;%%8 9
}&& 
catch'' 
('' 
IOException'' 
exceptIO'' '
)''' (
{(( 
IO)) 
.)) 
Logger)) 
.)) 
Log)) 
()) 
NLog)) "
.))" #
LogLevel))# +
.))+ ,
Warn)), 0
,))0 1
exceptIO))2 :
,)): ;
$str))< P
)))P Q
;))Q R
}** 
finally++ 
{,, 
try-- 
{.. 
if// 
(// 
streamInput// #
!=//$ &
null//' +
)//+ ,
{00 
streamInput11 #
.11# $
Close11$ )
(11) *
)11* +
;11+ ,
}22 
}33 
catch44 
(44 
IOException44 "
exceptIO44# +
)44+ ,
{55 
IO66 
.66 
Logger66 
.66 
Log66 !
(66! "
NLog66" &
.66& '
LogLevel66' /
.66/ 0
Warn660 4
,664 5
exceptIO666 >
,66> ?
$str66@ T
)66T U
;66U V
}77 
}88 
}99 	
}:: 
}<< 
}== ò
îC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_connection_03.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 2
&CWE510_Trapdoor__network_connection_03 ,
:- .#
AbstractTestCaseBadOnly/ F
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
$num 
== 
$num 
) 
{ 	
Stream 
streamInput 
=  
null! %
;% &
try   
{!! 
Uri## 
url## 
=## 
new## 
Uri## !
(##! "
$str##" =
)##= >
;##> ?

WebRequest$$ 
request$$ "
=$$# $

WebRequest$$% /
.$$/ 0
Create$$0 6
($$6 7
url$$7 :
)$$: ;
;$$; <
streamInput%% 
=%% 
request%% %
.%%% &
GetRequestStream%%& 6
(%%6 7
)%%7 8
;%%8 9
}&& 
catch'' 
('' 
IOException'' 
exceptIO'' '
)''' (
{(( 
IO)) 
.)) 
Logger)) 
.)) 
Log)) 
()) 
NLog)) "
.))" #
LogLevel))# +
.))+ ,
Warn)), 0
,))0 1
exceptIO))2 :
,)): ;
$str))< P
)))P Q
;))Q R
}** 
finally++ 
{,, 
try-- 
{.. 
if// 
(// 
streamInput// #
!=//$ &
null//' +
)//+ ,
{00 
streamInput11 #
.11# $
Close11$ )
(11) *
)11* +
;11+ ,
}22 
}33 
catch44 
(44 
IOException44 "
exceptIO44# +
)44+ ,
{55 
IO66 
.66 
Logger66 
.66 
Log66 !
(66! "
NLog66" &
.66& '
LogLevel66' /
.66/ 0
Warn660 4
,664 5
exceptIO666 >
,66> ?
$str66@ T
)66T U
;66U V
}77 
}88 
}99 	
}:: 
}<< 
}== é
îC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_connection_04.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 2
&CWE510_Trapdoor__network_connection_04 ,
:- .#
AbstractTestCaseBadOnly/ F
{ 
private 
const 
bool 
PRIVATE_CONST_TRUE )
=* +
true, 0
;0 1
public   

override   
void   
Bad   
(   
)   
{!! 
if"" 

("" 
PRIVATE_CONST_TRUE"" 
)"" 
{## 	
Stream$$ 
streamInput$$ 
=$$  
null$$! %
;$$% &
try%% 
{&& 
Uri(( 
url(( 
=(( 
new(( 
Uri(( !
(((! "
$str((" =
)((= >
;((> ?

WebRequest)) 
request)) "
=))# $

WebRequest))% /
.))/ 0
Create))0 6
())6 7
url))7 :
))): ;
;)); <
streamInput** 
=** 
request** %
.**% &
GetRequestStream**& 6
(**6 7
)**7 8
;**8 9
}++ 
catch,, 
(,, 
IOException,, 
exceptIO,, '
),,' (
{-- 
IO.. 
... 
Logger.. 
... 
Log.. 
(.. 
NLog.. "
..." #
LogLevel..# +
...+ ,
Warn.., 0
,..0 1
exceptIO..2 :
,..: ;
$str..< P
)..P Q
;..Q R
}// 
finally00 
{11 
try22 
{33 
if44 
(44 
streamInput44 #
!=44$ &
null44' +
)44+ ,
{55 
streamInput66 #
.66# $
Close66$ )
(66) *
)66* +
;66+ ,
}77 
}88 
catch99 
(99 
IOException99 "
exceptIO99# +
)99+ ,
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; !
(;;! "
NLog;;" &
.;;& '
LogLevel;;' /
.;;/ 0
Warn;;0 4
,;;4 5
exceptIO;;6 >
,;;> ?
$str;;@ T
);;T U
;;;U V
}<< 
}== 
}>> 	
}?? 
}AA 
}BB Ì
îC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_connection_05.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 2
&CWE510_Trapdoor__network_connection_05 ,
:- .#
AbstractTestCaseBadOnly/ F
{ 
private 
bool 
privateTrue 
= 
true #
;# $
public   

override   
void   
Bad   
(   
)   
{!! 
if"" 

("" 
privateTrue"" 
)"" 
{## 	
Stream$$ 
streamInput$$ 
=$$  
null$$! %
;$$% &
try%% 
{&& 
Uri(( 
url(( 
=(( 
new(( 
Uri(( !
(((! "
$str((" =
)((= >
;((> ?

WebRequest)) 
request)) "
=))# $

WebRequest))% /
.))/ 0
Create))0 6
())6 7
url))7 :
))): ;
;)); <
streamInput** 
=** 
request** %
.**% &
GetRequestStream**& 6
(**6 7
)**7 8
;**8 9
}++ 
catch,, 
(,, 
IOException,, 
exceptIO,, '
),,' (
{-- 
IO.. 
... 
Logger.. 
... 
Log.. 
(.. 
NLog.. "
..." #
LogLevel..# +
...+ ,
Warn.., 0
,..0 1
exceptIO..2 :
,..: ;
$str..< P
)..P Q
;..Q R
}// 
finally00 
{11 
try22 
{33 
if44 
(44 
streamInput44 #
!=44$ &
null44' +
)44+ ,
{55 
streamInput66 #
.66# $
Close66$ )
(66) *
)66* +
;66+ ,
}77 
}88 
catch99 
(99 
IOException99 "
exceptIO99# +
)99+ ,
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; !
(;;! "
NLog;;" &
.;;& '
LogLevel;;' /
.;;/ 0
Warn;;0 4
,;;4 5
exceptIO;;6 >
,;;> ?
$str;;@ T
);;T U
;;;U V
}<< 
}== 
}>> 	
}?? 
}AA 
}BB Ø
îC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_connection_06.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 2
&CWE510_Trapdoor__network_connection_06 ,
:- .#
AbstractTestCaseBadOnly/ F
{ 
private 
const 
int 
PRIVATE_CONST_FIVE (
=) *
$num+ ,
;, -
public   

override   
void   
Bad   
(   
)   
{!! 
if"" 

("" 
PRIVATE_CONST_FIVE"" 
=="" !
$num""" #
)""# $
{## 	
Stream$$ 
streamInput$$ 
=$$  
null$$! %
;$$% &
try%% 
{&& 
Uri(( 
url(( 
=(( 
new(( 
Uri(( !
(((! "
$str((" =
)((= >
;((> ?

WebRequest)) 
request)) "
=))# $

WebRequest))% /
.))/ 0
Create))0 6
())6 7
url))7 :
))): ;
;)); <
streamInput** 
=** 
request** %
.**% &
GetRequestStream**& 6
(**6 7
)**7 8
;**8 9
}++ 
catch,, 
(,, 
IOException,, 
exceptIO,, '
),,' (
{-- 
IO.. 
... 
Logger.. 
... 
Log.. 
(.. 
NLog.. "
..." #
LogLevel..# +
...+ ,
Warn.., 0
,..0 1
exceptIO..2 :
,..: ;
$str..< P
)..P Q
;..Q R
}// 
finally00 
{11 
try22 
{33 
if44 
(44 
streamInput44 #
!=44$ &
null44' +
)44+ ,
{55 
streamInput66 #
.66# $
Close66$ )
(66) *
)66* +
;66+ ,
}77 
}88 
catch99 
(99 
IOException99 "
exceptIO99# +
)99+ ,
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; !
(;;! "
NLog;;" &
.;;& '
LogLevel;;' /
.;;/ 0
Warn;;0 4
,;;4 5
exceptIO;;6 >
,;;> ?
$str;;@ T
);;T U
;;;U V
}<< 
}== 
}>> 	
}?? 
}AA 
}BB é
îC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_connection_07.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 2
&CWE510_Trapdoor__network_connection_07 ,
:- .#
AbstractTestCaseBadOnly/ F
{ 
private 
int 
privateFive 
= 
$num 
;  
public   

override   
void   
Bad   
(   
)   
{!! 
if"" 

("" 
privateFive"" 
=="" 
$num"" 
)"" 
{## 	
Stream$$ 
streamInput$$ 
=$$  
null$$! %
;$$% &
try%% 
{&& 
Uri(( 
url(( 
=(( 
new(( 
Uri(( !
(((! "
$str((" =
)((= >
;((> ?

WebRequest)) 
request)) "
=))# $

WebRequest))% /
.))/ 0
Create))0 6
())6 7
url))7 :
))): ;
;)); <
streamInput** 
=** 
request** %
.**% &
GetRequestStream**& 6
(**6 7
)**7 8
;**8 9
}++ 
catch,, 
(,, 
IOException,, 
exceptIO,, '
),,' (
{-- 
IO.. 
... 
Logger.. 
... 
Log.. 
(.. 
NLog.. "
..." #
LogLevel..# +
...+ ,
Warn.., 0
,..0 1
exceptIO..2 :
,..: ;
$str..< P
)..P Q
;..Q R
}// 
finally00 
{11 
try22 
{33 
if44 
(44 
streamInput44 #
!=44$ &
null44' +
)44+ ,
{55 
streamInput66 #
.66# $
Close66$ )
(66) *
)66* +
;66+ ,
}77 
}88 
catch99 
(99 
IOException99 "
exceptIO99# +
)99+ ,
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; !
(;;! "
NLog;;" &
.;;& '
LogLevel;;' /
.;;/ 0
Warn;;0 4
,;;4 5
exceptIO;;6 >
,;;> ?
$str;;@ T
);;T U
;;;U V
}<< 
}== 
}>> 	
}?? 
}AA 
}BB Ó
îC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_connection_08.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 2
&CWE510_Trapdoor__network_connection_08 ,
:- .#
AbstractTestCaseBadOnly/ F
{ 
private 
static 
bool 
PrivateReturnsTrue *
(* +
)+ ,
{ 
return   
true   
;   
}!! 
public## 

override## 
void## 
Bad## 
(## 
)## 
{$$ 
if%% 

(%% 
PrivateReturnsTrue%% 
(%% 
)%%  
)%%  !
{&& 	
Stream'' 
streamInput'' 
=''  
null''! %
;''% &
try(( 
{)) 
Uri++ 
url++ 
=++ 
new++ 
Uri++ !
(++! "
$str++" =
)++= >
;++> ?

WebRequest,, 
request,, "
=,,# $

WebRequest,,% /
.,,/ 0
Create,,0 6
(,,6 7
url,,7 :
),,: ;
;,,; <
streamInput-- 
=-- 
request-- %
.--% &
GetRequestStream--& 6
(--6 7
)--7 8
;--8 9
}.. 
catch// 
(// 
IOException// 
exceptIO// '
)//' (
{00 
IO11 
.11 
Logger11 
.11 
Log11 
(11 
NLog11 "
.11" #
LogLevel11# +
.11+ ,
Warn11, 0
,110 1
exceptIO112 :
,11: ;
$str11< P
)11P Q
;11Q R
}22 
finally33 
{44 
try55 
{66 
if77 
(77 
streamInput77 #
!=77$ &
null77' +
)77+ ,
{88 
streamInput99 #
.99# $
Close99$ )
(99) *
)99* +
;99+ ,
}:: 
};; 
catch<< 
(<< 
IOException<< "
exceptIO<<# +
)<<+ ,
{== 
IO>> 
.>> 
Logger>> 
.>> 
Log>> !
(>>! "
NLog>>" &
.>>& '
LogLevel>>' /
.>>/ 0
Warn>>0 4
,>>4 5
exceptIO>>6 >
,>>> ?
$str>>@ T
)>>T U
;>>U V
}?? 
}@@ 
}AA 	
}BB 
}DD 
}EE •
îC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_connection_09.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 2
&CWE510_Trapdoor__network_connection_09 ,
:- .#
AbstractTestCaseBadOnly/ F
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
IO 
.  
STATIC_READONLY_TRUE #
)# $
{ 	
Stream 
streamInput 
=  
null! %
;% &
try   
{!! 
Uri## 
url## 
=## 
new## 
Uri## !
(##! "
$str##" =
)##= >
;##> ?

WebRequest$$ 
request$$ "
=$$# $

WebRequest$$% /
.$$/ 0
Create$$0 6
($$6 7
url$$7 :
)$$: ;
;$$; <
streamInput%% 
=%% 
request%% %
.%%% &
GetRequestStream%%& 6
(%%6 7
)%%7 8
;%%8 9
}&& 
catch'' 
('' 
IOException'' 
exceptIO'' '
)''' (
{(( 
IO)) 
.)) 
Logger)) 
.)) 
Log)) 
()) 
NLog)) "
.))" #
LogLevel))# +
.))+ ,
Warn)), 0
,))0 1
exceptIO))2 :
,)): ;
$str))< P
)))P Q
;))Q R
}** 
finally++ 
{,, 
try-- 
{.. 
if// 
(// 
streamInput// #
!=//$ &
null//' +
)//+ ,
{00 
streamInput11 #
.11# $
Close11$ )
(11) *
)11* +
;11+ ,
}22 
}33 
catch44 
(44 
IOException44 "
exceptIO44# +
)44+ ,
{55 
IO66 
.66 
Logger66 
.66 
Log66 !
(66! "
NLog66" &
.66& '
LogLevel66' /
.66/ 0
Warn660 4
,664 5
exceptIO666 >
,66> ?
$str66@ T
)66T U
;66U V
}77 
}88 
}99 	
}:: 
}<< 
}== õ
îC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_connection_10.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 2
&CWE510_Trapdoor__network_connection_10 ,
:- .#
AbstractTestCaseBadOnly/ F
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
IO 
. 

staticTrue 
) 
{ 	
Stream 
streamInput 
=  
null! %
;% &
try   
{!! 
Uri## 
url## 
=## 
new## 
Uri## !
(##! "
$str##" =
)##= >
;##> ?

WebRequest$$ 
request$$ "
=$$# $

WebRequest$$% /
.$$/ 0
Create$$0 6
($$6 7
url$$7 :
)$$: ;
;$$; <
streamInput%% 
=%% 
request%% %
.%%% &
GetRequestStream%%& 6
(%%6 7
)%%7 8
;%%8 9
}&& 
catch'' 
('' 
IOException'' 
exceptIO'' '
)''' (
{(( 
IO)) 
.)) 
Logger)) 
.)) 
Log)) 
()) 
NLog)) "
.))" #
LogLevel))# +
.))+ ,
Warn)), 0
,))0 1
exceptIO))2 :
,)): ;
$str))< P
)))P Q
;))Q R
}** 
finally++ 
{,, 
try-- 
{.. 
if// 
(// 
streamInput// #
!=//$ &
null//' +
)//+ ,
{00 
streamInput11 #
.11# $
Close11$ )
(11) *
)11* +
;11+ ,
}22 
}33 
catch44 
(44 
IOException44 "
exceptIO44# +
)44+ ,
{55 
IO66 
.66 
Logger66 
.66 
Log66 !
(66! "
NLog66" &
.66& '
LogLevel66' /
.66/ 0
Warn660 4
,664 5
exceptIO666 >
,66> ?
$str66@ T
)66T U
;66U V
}77 
}88 
}99 	
}:: 
}<< 
}== ¿
îC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_connection_11.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 2
&CWE510_Trapdoor__network_connection_11 ,
:- .#
AbstractTestCaseBadOnly/ F
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
IO 
. 
StaticReturnsTrue  
(  !
)! "
)" #
{ 	
Stream 
streamInput 
=  
null! %
;% &
try   
{!! 
Uri## 
url## 
=## 
new## 
Uri## !
(##! "
$str##" =
)##= >
;##> ?

WebRequest$$ 
request$$ "
=$$# $

WebRequest$$% /
.$$/ 0
Create$$0 6
($$6 7
url$$7 :
)$$: ;
;$$; <
streamInput%% 
=%% 
request%% %
.%%% &
GetRequestStream%%& 6
(%%6 7
)%%7 8
;%%8 9
}&& 
catch'' 
('' 
IOException'' 
exceptIO'' '
)''' (
{(( 
IO)) 
.)) 
Logger)) 
.)) 
Log)) 
()) 
NLog)) "
.))" #
LogLevel))# +
.))+ ,
Warn)), 0
,))0 1
exceptIO))2 :
,)): ;
$str))< P
)))P Q
;))Q R
}** 
finally++ 
{,, 
try-- 
{.. 
if// 
(// 
streamInput// #
!=//$ &
null//' +
)//+ ,
{00 
streamInput11 #
.11# $
Close11$ )
(11) *
)11* +
;11+ ,
}22 
}33 
catch44 
(44 
IOException44 "
exceptIO44# +
)44+ ,
{55 
IO66 
.66 
Logger66 
.66 
Log66 !
(66! "
NLog66" &
.66& '
LogLevel66' /
.66/ 0
Warn660 4
,664 5
exceptIO666 >
,66> ?
$str66@ T
)66T U
;66U V
}77 
}88 
}99 	
}:: 
}<< 
}== «
îC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_connection_13.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 2
&CWE510_Trapdoor__network_connection_13 ,
:- .#
AbstractTestCaseBadOnly/ F
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
IO 
.  
STATIC_READONLY_FIVE #
==$ &
$num' (
)( )
{ 	
Stream 
streamInput 
=  
null! %
;% &
try   
{!! 
Uri## 
url## 
=## 
new## 
Uri## !
(##! "
$str##" =
)##= >
;##> ?

WebRequest$$ 
request$$ "
=$$# $

WebRequest$$% /
.$$/ 0
Create$$0 6
($$6 7
url$$7 :
)$$: ;
;$$; <
streamInput%% 
=%% 
request%% %
.%%% &
GetRequestStream%%& 6
(%%6 7
)%%7 8
;%%8 9
}&& 
catch'' 
('' 
IOException'' 
exceptIO'' '
)''' (
{(( 
IO)) 
.)) 
Logger)) 
.)) 
Log)) 
()) 
NLog)) "
.))" #
LogLevel))# +
.))+ ,
Warn)), 0
,))0 1
exceptIO))2 :
,)): ;
$str))< P
)))P Q
;))Q R
}** 
finally++ 
{,, 
try-- 
{.. 
if// 
(// 
streamInput// #
!=//$ &
null//' +
)//+ ,
{00 
streamInput11 #
.11# $
Close11$ )
(11) *
)11* +
;11+ ,
}22 
}33 
catch44 
(44 
IOException44 "
exceptIO44# +
)44+ ,
{55 
IO66 
.66 
Logger66 
.66 
Log66 !
(66! "
NLog66" &
.66& '
LogLevel66' /
.66/ 0
Warn660 4
,664 5
exceptIO666 >
,66> ?
$str66@ T
)66T U
;66U V
}77 
}88 
}99 	
}:: 
}<< 
}== Ω
îC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_connection_14.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 2
&CWE510_Trapdoor__network_connection_14 ,
:- .#
AbstractTestCaseBadOnly/ F
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
IO 
. 

staticFive 
== 
$num 
) 
{ 	
Stream 
streamInput 
=  
null! %
;% &
try   
{!! 
Uri## 
url## 
=## 
new## 
Uri## !
(##! "
$str##" =
)##= >
;##> ?

WebRequest$$ 
request$$ "
=$$# $

WebRequest$$% /
.$$/ 0
Create$$0 6
($$6 7
url$$7 :
)$$: ;
;$$; <
streamInput%% 
=%% 
request%% %
.%%% &
GetRequestStream%%& 6
(%%6 7
)%%7 8
;%%8 9
}&& 
catch'' 
('' 
IOException'' 
exceptIO'' '
)''' (
{(( 
IO)) 
.)) 
Logger)) 
.)) 
Log)) 
()) 
NLog)) "
.))" #
LogLevel))# +
.))+ ,
Warn)), 0
,))0 1
exceptIO))2 :
,)): ;
$str))< P
)))P Q
;))Q R
}** 
finally++ 
{,, 
try-- 
{.. 
if// 
(// 
streamInput// #
!=//$ &
null//' +
)//+ ,
{00 
streamInput11 #
.11# $
Close11$ )
(11) *
)11* +
;11+ ,
}22 
}33 
catch44 
(44 
IOException44 "
exceptIO44# +
)44+ ,
{55 
IO66 
.66 
Logger66 
.66 
Log66 !
(66! "
NLog66" &
.66& '
LogLevel66' /
.66/ 0
Warn660 4
,664 5
exceptIO666 >
,66> ?
$str66@ T
)66T U
;66U V
}77 
}88 
}99 	
}:: 
}<< 
}== ä
îC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_connection_15.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 2
&CWE510_Trapdoor__network_connection_15 ,
:- .#
AbstractTestCaseBadOnly/ F
{ 
public 

override 
void 
Bad 
( 
) 
{ 
switch 
( 
$num 
) 
{ 	
case 
$num 
: 
Stream   
streamInput   
=    
null  ! %
;  % &
try!! 
{"" 
Uri$$ 
url$$ 
=$$ 
new$$ 
Uri$$ !
($$! "
$str$$" =
)$$= >
;$$> ?

WebRequest%% 
request%% "
=%%# $

WebRequest%%% /
.%%/ 0
Create%%0 6
(%%6 7
url%%7 :
)%%: ;
;%%; <
streamInput&& 
=&& 
request&& %
.&&% &
GetRequestStream&&& 6
(&&6 7
)&&7 8
;&&8 9
}'' 
catch(( 
((( 
IOException(( 
exceptIO(( '
)((' (
{)) 
IO** 
.** 
Logger** 
.** 
Log** 
(** 
NLog** "
.**" #
LogLevel**# +
.**+ ,
Warn**, 0
,**0 1
exceptIO**2 :
,**: ;
$str**< P
)**P Q
;**Q R
}++ 
finally,, 
{-- 
try.. 
{// 
if00 
(00 
streamInput00 #
!=00$ &
null00' +
)00+ ,
{11 
streamInput22 #
.22# $
Close22$ )
(22) *
)22* +
;22+ ,
}33 
}44 
catch55 
(55 
IOException55 "
exceptIO55# +
)55+ ,
{66 
IO77 
.77 
Logger77 
.77 
Log77 !
(77! "
NLog77" &
.77& '
LogLevel77' /
.77/ 0
Warn770 4
,774 5
exceptIO776 >
,77> ?
$str77@ T
)77T U
;77U V
}88 
}99 
break:: 
;:: 
default;; 
:;; 
IO== 
.== 
	WriteLine== 
(== 
$str== /
)==/ 0
;==0 1
break>> 
;>> 
}?? 	
}@@ 
}BB 
}CC õ
îC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_connection_16.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 2
&CWE510_Trapdoor__network_connection_16 ,
:- .#
AbstractTestCaseBadOnly/ F
{ 
public 

override 
void 
Bad 
( 
) 
{ 
while 
( 
true 
) 
{ 	
Stream 
streamInput 
=  
null! %
;% &
try   
{!! 
Uri## 
url## 
=## 
new## 
Uri## !
(##! "
$str##" =
)##= >
;##> ?

WebRequest$$ 
request$$ "
=$$# $

WebRequest$$% /
.$$/ 0
Create$$0 6
($$6 7
url$$7 :
)$$: ;
;$$; <
streamInput%% 
=%% 
request%% %
.%%% &
GetRequestStream%%& 6
(%%6 7
)%%7 8
;%%8 9
}&& 
catch'' 
('' 
IOException'' 
exceptIO'' '
)''' (
{(( 
IO)) 
.)) 
Logger)) 
.)) 
Log)) 
()) 
NLog)) "
.))" #
LogLevel))# +
.))+ ,
Warn)), 0
,))0 1
exceptIO))2 :
,)): ;
$str))< P
)))P Q
;))Q R
}** 
finally++ 
{,, 
try-- 
{.. 
if// 
(// 
streamInput// #
!=//$ &
null//' +
)//+ ,
{00 
streamInput11 #
.11# $
Close11$ )
(11) *
)11* +
;11+ ,
}22 
}33 
catch44 
(44 
IOException44 "
exceptIO44# +
)44+ ,
{55 
IO66 
.66 
Logger66 
.66 
Log66 !
(66! "
NLog66" &
.66& '
LogLevel66' /
.66/ 0
Warn660 4
,664 5
exceptIO666 >
,66> ?
$str66@ T
)66T U
;66U V
}77 
}88 
break99 
;99 
}:: 	
};; 
}== 
}>> ì
îC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_connection_17.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class 2
&CWE510_Trapdoor__network_connection_17 ,
:- .#
AbstractTestCaseBadOnly/ F
{ 
public 

override 
void 
Bad 
( 
) 
{ 
for 
( 
int 
j 
= 
$num 
; 
j 
< 
$num 
; 
j  
++  "
)" #
{ 	
Stream 
streamInput 
=  
null! %
;% &
try   
{!! 
Uri## 
url## 
=## 
new## 
Uri## !
(##! "
$str##" =
)##= >
;##> ?

WebRequest$$ 
request$$ "
=$$# $

WebRequest$$% /
.$$/ 0
Create$$0 6
($$6 7
url$$7 :
)$$: ;
;$$; <
streamInput%% 
=%% 
request%% %
.%%% &
GetRequestStream%%& 6
(%%6 7
)%%7 8
;%%8 9
}&& 
catch'' 
('' 
IOException'' 
exceptIO'' '
)''' (
{(( 
IO)) 
.)) 
Logger)) 
.)) 
Log)) 
()) 
NLog)) "
.))" #
LogLevel))# +
.))+ ,
Warn)), 0
,))0 1
exceptIO))2 :
,)): ;
$str))< P
)))P Q
;))Q R
}** 
finally++ 
{,, 
try-- 
{.. 
if// 
(// 
streamInput// #
!=//$ &
null//' +
)//+ ,
{00 
streamInput11 #
.11# $
Close11$ )
(11) *
)11* +
;11+ ,
}22 
}33 
catch44 
(44 
IOException44 "
exceptIO44# +
)44+ ,
{55 
IO66 
.66 
Logger66 
.66 
Log66 !
(66! "
NLog66" &
.66& '
LogLevel66' /
.66/ 0
Warn660 4
,664 5
exceptIO666 >
,66> ?
$str66@ T
)66T U
;66U V
}77 
}88 
}99 	
}:: 
}<< 
}== Ï
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_listen_01.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__network_listen_01 (
:) *#
AbstractTestCaseBadOnly+ B
{ 
public 

override 
void 
Bad 
( 
) 
{ 
TcpListener 
listener 
= 
null #
;# $
	TcpClient 
socket 
= 
null 
;  
int   
port   
=   
$num   
;   
try!! 
{"" 	
listener## 
=## 
new## 
TcpListener## &
(##& '
	IPAddress##' 0
.##0 1
Parse##1 6
(##6 7
$str##7 C
)##C D
,##D E
port##F J
)##J K
;##K L
listener&& 
.&& 
Start&& 
(&& 
)&& 
;&& 
socket'' 
='' 
listener'' 
.'' 
AcceptTcpClient'' -
(''- .
)''. /
;''/ 0
})) 	
catch** 
(** 
IOException** 
exceptIO** #
)**# $
{++ 	
IO,, 
.,, 
Logger,, 
.,, 
Log,, 
(,, 
NLog,, 
.,, 
LogLevel,, '
.,,' (
Warn,,( ,
,,,, -
exceptIO,,. 6
,,,6 7
$str,,8 S
+,,T U
port,,V Z
.,,Z [
ToString,,[ c
(,,c d
),,d e
),,e f
;,,f g
}-- 	
finally.. 
{// 	
try00 
{11 
if22 
(22 
socket22 
!=22 
null22 "
)22" #
{33 
socket44 
.44 
Close44  
(44  !
)44! "
;44" #
}55 
}66 
catch77 
(77 
IOException77 
exceptIO77 '
)77' (
{88 
IO99 
.99 
Logger99 
.99 
Log99 
(99 
NLog99 "
.99" #
LogLevel99# +
.99+ ,
Warn99, 0
,990 1
exceptIO992 :
,99: ;
$str99< S
)99S T
;99T U
}:: 
try<< 
{== 
if>> 
(>> 
listener>> 
!=>> 
null>>  $
)>>$ %
{?? 
listener@@ 
.@@ 
Stop@@ !
(@@! "
)@@" #
;@@# $
}AA 
}BB 
catchCC 
(CC 
IOExceptionCC 
exceptIOCC '
)CC' (
{DD 
IOEE 
.EE 
LoggerEE 
.EE 
LogEE 
(EE 
NLogEE "
.EE" #
LogLevelEE# +
.EE+ ,
WarnEE, 0
,EE0 1
exceptIOEE2 :
,EE: ;
$strEE< S
)EES T
;EET U
}FF 
}GG 	
}HH 
}JJ 
}KK  
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_listen_02.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__network_listen_02 (
:) *#
AbstractTestCaseBadOnly+ B
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
true 
) 
{ 	
TcpListener   
listener    
=  ! "
null  # '
;  ' (
	TcpClient!! 
socket!! 
=!! 
null!! #
;!!# $
int"" 
port"" 
="" 
$num"" 
;"" 
try## 
{$$ 
listener%% 
=%% 
new%% 
TcpListener%% *
(%%* +
	IPAddress%%+ 4
.%%4 5
Parse%%5 :
(%%: ;
$str%%; G
)%%G H
,%%H I
port%%J N
)%%N O
;%%O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
socket)) 
=)) 
listener)) !
.))! "
AcceptTcpClient))" 1
())1 2
)))2 3
;))3 4
}++ 
catch,, 
(,, 
IOException,, 
exceptIO,, '
),,' (
{-- 
IO.. 
... 
Logger.. 
... 
Log.. 
(.. 
NLog.. "
..." #
LogLevel..# +
...+ ,
Warn.., 0
,..0 1
exceptIO..2 :
,..: ;
$str..< W
+..X Y
port..Z ^
...^ _
ToString.._ g
(..g h
)..h i
)..i j
;..j k
}// 
finally00 
{11 
try22 
{33 
if44 
(44 
socket44 
!=44 !
null44" &
)44& '
{55 
socket66 
.66 
Close66 $
(66$ %
)66% &
;66& '
}77 
}88 
catch99 
(99 
IOException99 "
exceptIO99# +
)99+ ,
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; !
(;;! "
NLog;;" &
.;;& '
LogLevel;;' /
.;;/ 0
Warn;;0 4
,;;4 5
exceptIO;;6 >
,;;> ?
$str;;@ W
);;W X
;;;X Y
}<< 
try>> 
{?? 
if@@ 
(@@ 
listener@@  
!=@@! #
null@@$ (
)@@( )
{AA 
listenerBB  
.BB  !
StopBB! %
(BB% &
)BB& '
;BB' (
}CC 
}DD 
catchEE 
(EE 
IOExceptionEE "
exceptIOEE# +
)EE+ ,
{FF 
IOGG 
.GG 
LoggerGG 
.GG 
LogGG !
(GG! "
NLogGG" &
.GG& '
LogLevelGG' /
.GG/ 0
WarnGG0 4
,GG4 5
exceptIOGG6 >
,GG> ?
$strGG@ W
)GGW X
;GGX Y
}HH 
}II 
}JJ 	
}KK 
}MM 
}NN Ï
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_listen_03.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__network_listen_03 (
:) *#
AbstractTestCaseBadOnly+ B
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
$num 
== 
$num 
) 
{ 	
TcpListener   
listener    
=  ! "
null  # '
;  ' (
	TcpClient!! 
socket!! 
=!! 
null!! #
;!!# $
int"" 
port"" 
="" 
$num"" 
;"" 
try## 
{$$ 
listener%% 
=%% 
new%% 
TcpListener%% *
(%%* +
	IPAddress%%+ 4
.%%4 5
Parse%%5 :
(%%: ;
$str%%; G
)%%G H
,%%H I
port%%J N
)%%N O
;%%O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
socket)) 
=)) 
listener)) !
.))! "
AcceptTcpClient))" 1
())1 2
)))2 3
;))3 4
}++ 
catch,, 
(,, 
IOException,, 
exceptIO,, '
),,' (
{-- 
IO.. 
... 
Logger.. 
... 
Log.. 
(.. 
NLog.. "
..." #
LogLevel..# +
...+ ,
Warn.., 0
,..0 1
exceptIO..2 :
,..: ;
$str..< W
+..X Y
port..Z ^
...^ _
ToString.._ g
(..g h
)..h i
)..i j
;..j k
}// 
finally00 
{11 
try22 
{33 
if44 
(44 
socket44 
!=44 !
null44" &
)44& '
{55 
socket66 
.66 
Close66 $
(66$ %
)66% &
;66& '
}77 
}88 
catch99 
(99 
IOException99 "
exceptIO99# +
)99+ ,
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; !
(;;! "
NLog;;" &
.;;& '
LogLevel;;' /
.;;/ 0
Warn;;0 4
,;;4 5
exceptIO;;6 >
,;;> ?
$str;;@ W
);;W X
;;;X Y
}<< 
try>> 
{?? 
if@@ 
(@@ 
listener@@  
!=@@! #
null@@$ (
)@@( )
{AA 
listenerBB  
.BB  !
StopBB! %
(BB% &
)BB& '
;BB' (
}CC 
}DD 
catchEE 
(EE 
IOExceptionEE "
exceptIOEE# +
)EE+ ,
{FF 
IOGG 
.GG 
LoggerGG 
.GG 
LogGG !
(GG! "
NLogGG" &
.GG& '
LogLevelGG' /
.GG/ 0
WarnGG0 4
,GG4 5
exceptIOGG6 >
,GG> ?
$strGG@ W
)GGW X
;GGX Y
}HH 
}II 
}JJ 	
}KK 
}MM 
}NN ‚
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_listen_04.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__network_listen_04 (
:) *#
AbstractTestCaseBadOnly+ B
{ 
private 
const 
bool 
PRIVATE_CONST_TRUE )
=* +
true, 0
;0 1
public!! 

override!! 
void!! 
Bad!! 
(!! 
)!! 
{"" 
if## 

(## 
PRIVATE_CONST_TRUE## 
)## 
{$$ 	
TcpListener%% 
listener%%  
=%%! "
null%%# '
;%%' (
	TcpClient&& 
socket&& 
=&& 
null&& #
;&&# $
int'' 
port'' 
='' 
$num'' 
;'' 
try(( 
{)) 
listener** 
=** 
new** 
TcpListener** *
(*** +
	IPAddress**+ 4
.**4 5
Parse**5 :
(**: ;
$str**; G
)**G H
,**H I
port**J N
)**N O
;**O P
listener-- 
.-- 
Start-- 
(-- 
)--  
;--  !
socket.. 
=.. 
listener.. !
...! "
AcceptTcpClient.." 1
(..1 2
)..2 3
;..3 4
}00 
catch11 
(11 
IOException11 
exceptIO11 '
)11' (
{22 
IO33 
.33 
Logger33 
.33 
Log33 
(33 
NLog33 "
.33" #
LogLevel33# +
.33+ ,
Warn33, 0
,330 1
exceptIO332 :
,33: ;
$str33< W
+33X Y
port33Z ^
.33^ _
ToString33_ g
(33g h
)33h i
)33i j
;33j k
}44 
finally55 
{66 
try77 
{88 
if99 
(99 
socket99 
!=99 !
null99" &
)99& '
{:: 
socket;; 
.;; 
Close;; $
(;;$ %
);;% &
;;;& '
}<< 
}== 
catch>> 
(>> 
IOException>> "
exceptIO>># +
)>>+ ,
{?? 
IO@@ 
.@@ 
Logger@@ 
.@@ 
Log@@ !
(@@! "
NLog@@" &
.@@& '
LogLevel@@' /
.@@/ 0
Warn@@0 4
,@@4 5
exceptIO@@6 >
,@@> ?
$str@@@ W
)@@W X
;@@X Y
}AA 
tryCC 
{DD 
ifEE 
(EE 
listenerEE  
!=EE! #
nullEE$ (
)EE( )
{FF 
listenerGG  
.GG  !
StopGG! %
(GG% &
)GG& '
;GG' (
}HH 
}II 
catchJJ 
(JJ 
IOExceptionJJ "
exceptIOJJ# +
)JJ+ ,
{KK 
IOLL 
.LL 
LoggerLL 
.LL 
LogLL !
(LL! "
NLogLL" &
.LL& '
LogLevelLL' /
.LL/ 0
WarnLL0 4
,LL4 5
exceptIOLL6 >
,LL> ?
$strLL@ W
)LLW X
;LLX Y
}MM 
}NN 
}OO 	
}PP 
}RR 
}SS ¡
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_listen_05.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__network_listen_05 (
:) *#
AbstractTestCaseBadOnly+ B
{ 
private 
bool 
privateTrue 
= 
true #
;# $
public!! 

override!! 
void!! 
Bad!! 
(!! 
)!! 
{"" 
if## 

(## 
privateTrue## 
)## 
{$$ 	
TcpListener%% 
listener%%  
=%%! "
null%%# '
;%%' (
	TcpClient&& 
socket&& 
=&& 
null&& #
;&&# $
int'' 
port'' 
='' 
$num'' 
;'' 
try(( 
{)) 
listener** 
=** 
new** 
TcpListener** *
(*** +
	IPAddress**+ 4
.**4 5
Parse**5 :
(**: ;
$str**; G
)**G H
,**H I
port**J N
)**N O
;**O P
listener-- 
.-- 
Start-- 
(-- 
)--  
;--  !
socket.. 
=.. 
listener.. !
...! "
AcceptTcpClient.." 1
(..1 2
)..2 3
;..3 4
}00 
catch11 
(11 
IOException11 
exceptIO11 '
)11' (
{22 
IO33 
.33 
Logger33 
.33 
Log33 
(33 
NLog33 "
.33" #
LogLevel33# +
.33+ ,
Warn33, 0
,330 1
exceptIO332 :
,33: ;
$str33< W
+33X Y
port33Z ^
.33^ _
ToString33_ g
(33g h
)33h i
)33i j
;33j k
}44 
finally55 
{66 
try77 
{88 
if99 
(99 
socket99 
!=99 !
null99" &
)99& '
{:: 
socket;; 
.;; 
Close;; $
(;;$ %
);;% &
;;;& '
}<< 
}== 
catch>> 
(>> 
IOException>> "
exceptIO>># +
)>>+ ,
{?? 
IO@@ 
.@@ 
Logger@@ 
.@@ 
Log@@ !
(@@! "
NLog@@" &
.@@& '
LogLevel@@' /
.@@/ 0
Warn@@0 4
,@@4 5
exceptIO@@6 >
,@@> ?
$str@@@ W
)@@W X
;@@X Y
}AA 
tryCC 
{DD 
ifEE 
(EE 
listenerEE  
!=EE! #
nullEE$ (
)EE( )
{FF 
listenerGG  
.GG  !
StopGG! %
(GG% &
)GG& '
;GG' (
}HH 
}II 
catchJJ 
(JJ 
IOExceptionJJ "
exceptIOJJ# +
)JJ+ ,
{KK 
IOLL 
.LL 
LoggerLL 
.LL 
LogLL !
(LL! "
NLogLL" &
.LL& '
LogLevelLL' /
.LL/ 0
WarnLL0 4
,LL4 5
exceptIOLL6 >
,LL> ?
$strLL@ W
)LLW X
;LLX Y
}MM 
}NN 
}OO 	
}PP 
}RR 
}SS É
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_listen_06.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__network_listen_06 (
:) *#
AbstractTestCaseBadOnly+ B
{ 
private 
const 
int 
PRIVATE_CONST_FIVE (
=) *
$num+ ,
;, -
public!! 

override!! 
void!! 
Bad!! 
(!! 
)!! 
{"" 
if## 

(## 
PRIVATE_CONST_FIVE## 
==## !
$num##" #
)### $
{$$ 	
TcpListener%% 
listener%%  
=%%! "
null%%# '
;%%' (
	TcpClient&& 
socket&& 
=&& 
null&& #
;&&# $
int'' 
port'' 
='' 
$num'' 
;'' 
try(( 
{)) 
listener** 
=** 
new** 
TcpListener** *
(*** +
	IPAddress**+ 4
.**4 5
Parse**5 :
(**: ;
$str**; G
)**G H
,**H I
port**J N
)**N O
;**O P
listener-- 
.-- 
Start-- 
(-- 
)--  
;--  !
socket.. 
=.. 
listener.. !
...! "
AcceptTcpClient.." 1
(..1 2
)..2 3
;..3 4
}00 
catch11 
(11 
IOException11 
exceptIO11 '
)11' (
{22 
IO33 
.33 
Logger33 
.33 
Log33 
(33 
NLog33 "
.33" #
LogLevel33# +
.33+ ,
Warn33, 0
,330 1
exceptIO332 :
,33: ;
$str33< W
+33X Y
port33Z ^
.33^ _
ToString33_ g
(33g h
)33h i
)33i j
;33j k
}44 
finally55 
{66 
try77 
{88 
if99 
(99 
socket99 
!=99 !
null99" &
)99& '
{:: 
socket;; 
.;; 
Close;; $
(;;$ %
);;% &
;;;& '
}<< 
}== 
catch>> 
(>> 
IOException>> "
exceptIO>># +
)>>+ ,
{?? 
IO@@ 
.@@ 
Logger@@ 
.@@ 
Log@@ !
(@@! "
NLog@@" &
.@@& '
LogLevel@@' /
.@@/ 0
Warn@@0 4
,@@4 5
exceptIO@@6 >
,@@> ?
$str@@@ W
)@@W X
;@@X Y
}AA 
tryCC 
{DD 
ifEE 
(EE 
listenerEE  
!=EE! #
nullEE$ (
)EE( )
{FF 
listenerGG  
.GG  !
StopGG! %
(GG% &
)GG& '
;GG' (
}HH 
}II 
catchJJ 
(JJ 
IOExceptionJJ "
exceptIOJJ# +
)JJ+ ,
{KK 
IOLL 
.LL 
LoggerLL 
.LL 
LogLL !
(LL! "
NLogLL" &
.LL& '
LogLevelLL' /
.LL/ 0
WarnLL0 4
,LL4 5
exceptIOLL6 >
,LL> ?
$strLL@ W
)LLW X
;LLX Y
}MM 
}NN 
}OO 	
}PP 
}RR 
}SS ‚
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_listen_07.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__network_listen_07 (
:) *#
AbstractTestCaseBadOnly+ B
{ 
private 
int 
privateFive 
= 
$num 
;  
public!! 

override!! 
void!! 
Bad!! 
(!! 
)!! 
{"" 
if## 

(## 
privateFive## 
==## 
$num## 
)## 
{$$ 	
TcpListener%% 
listener%%  
=%%! "
null%%# '
;%%' (
	TcpClient&& 
socket&& 
=&& 
null&& #
;&&# $
int'' 
port'' 
='' 
$num'' 
;'' 
try(( 
{)) 
listener** 
=** 
new** 
TcpListener** *
(*** +
	IPAddress**+ 4
.**4 5
Parse**5 :
(**: ;
$str**; G
)**G H
,**H I
port**J N
)**N O
;**O P
listener-- 
.-- 
Start-- 
(-- 
)--  
;--  !
socket.. 
=.. 
listener.. !
...! "
AcceptTcpClient.." 1
(..1 2
)..2 3
;..3 4
}00 
catch11 
(11 
IOException11 
exceptIO11 '
)11' (
{22 
IO33 
.33 
Logger33 
.33 
Log33 
(33 
NLog33 "
.33" #
LogLevel33# +
.33+ ,
Warn33, 0
,330 1
exceptIO332 :
,33: ;
$str33< W
+33X Y
port33Z ^
.33^ _
ToString33_ g
(33g h
)33h i
)33i j
;33j k
}44 
finally55 
{66 
try77 
{88 
if99 
(99 
socket99 
!=99 !
null99" &
)99& '
{:: 
socket;; 
.;; 
Close;; $
(;;$ %
);;% &
;;;& '
}<< 
}== 
catch>> 
(>> 
IOException>> "
exceptIO>># +
)>>+ ,
{?? 
IO@@ 
.@@ 
Logger@@ 
.@@ 
Log@@ !
(@@! "
NLog@@" &
.@@& '
LogLevel@@' /
.@@/ 0
Warn@@0 4
,@@4 5
exceptIO@@6 >
,@@> ?
$str@@@ W
)@@W X
;@@X Y
}AA 
tryCC 
{DD 
ifEE 
(EE 
listenerEE  
!=EE! #
nullEE$ (
)EE( )
{FF 
listenerGG  
.GG  !
StopGG! %
(GG% &
)GG& '
;GG' (
}HH 
}II 
catchJJ 
(JJ 
IOExceptionJJ "
exceptIOJJ# +
)JJ+ ,
{KK 
IOLL 
.LL 
LoggerLL 
.LL 
LogLL !
(LL! "
NLogLL" &
.LL& '
LogLevelLL' /
.LL/ 0
WarnLL0 4
,LL4 5
exceptIOLL6 >
,LL> ?
$strLL@ W
)LLW X
;LLX Y
}MM 
}NN 
}OO 	
}PP 
}RR 
}SS ¬
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_listen_08.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__network_listen_08 (
:) *#
AbstractTestCaseBadOnly+ B
{ 
private 
static 
bool 
PrivateReturnsTrue *
(* +
)+ ,
{   
return!! 
true!! 
;!! 
}"" 
public$$ 

override$$ 
void$$ 
Bad$$ 
($$ 
)$$ 
{%% 
if&& 

(&& 
PrivateReturnsTrue&& 
(&& 
)&&  
)&&  !
{'' 	
TcpListener(( 
listener((  
=((! "
null((# '
;((' (
	TcpClient)) 
socket)) 
=)) 
null)) #
;))# $
int** 
port** 
=** 
$num** 
;** 
try++ 
{,, 
listener-- 
=-- 
new-- 
TcpListener-- *
(--* +
	IPAddress--+ 4
.--4 5
Parse--5 :
(--: ;
$str--; G
)--G H
,--H I
port--J N
)--N O
;--O P
listener00 
.00 
Start00 
(00 
)00  
;00  !
socket11 
=11 
listener11 !
.11! "
AcceptTcpClient11" 1
(111 2
)112 3
;113 4
}33 
catch44 
(44 
IOException44 
exceptIO44 '
)44' (
{55 
IO66 
.66 
Logger66 
.66 
Log66 
(66 
NLog66 "
.66" #
LogLevel66# +
.66+ ,
Warn66, 0
,660 1
exceptIO662 :
,66: ;
$str66< W
+66X Y
port66Z ^
.66^ _
ToString66_ g
(66g h
)66h i
)66i j
;66j k
}77 
finally88 
{99 
try:: 
{;; 
if<< 
(<< 
socket<< 
!=<< !
null<<" &
)<<& '
{== 
socket>> 
.>> 
Close>> $
(>>$ %
)>>% &
;>>& '
}?? 
}@@ 
catchAA 
(AA 
IOExceptionAA "
exceptIOAA# +
)AA+ ,
{BB 
IOCC 
.CC 
LoggerCC 
.CC 
LogCC !
(CC! "
NLogCC" &
.CC& '
LogLevelCC' /
.CC/ 0
WarnCC0 4
,CC4 5
exceptIOCC6 >
,CC> ?
$strCC@ W
)CCW X
;CCX Y
}DD 
tryFF 
{GG 
ifHH 
(HH 
listenerHH  
!=HH! #
nullHH$ (
)HH( )
{II 
listenerJJ  
.JJ  !
StopJJ! %
(JJ% &
)JJ& '
;JJ' (
}KK 
}LL 
catchMM 
(MM 
IOExceptionMM "
exceptIOMM# +
)MM+ ,
{NN 
IOOO 
.OO 
LoggerOO 
.OO 
LogOO !
(OO! "
NLogOO" &
.OO& '
LogLevelOO' /
.OO/ 0
WarnOO0 4
,OO4 5
exceptIOOO6 >
,OO> ?
$strOO@ W
)OOW X
;OOX Y
}PP 
}QQ 
}RR 	
}SS 
}UU 
}VV ˘
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_listen_09.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__network_listen_09 (
:) *#
AbstractTestCaseBadOnly+ B
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
IO 
.  
STATIC_READONLY_TRUE #
)# $
{ 	
TcpListener   
listener    
=  ! "
null  # '
;  ' (
	TcpClient!! 
socket!! 
=!! 
null!! #
;!!# $
int"" 
port"" 
="" 
$num"" 
;"" 
try## 
{$$ 
listener%% 
=%% 
new%% 
TcpListener%% *
(%%* +
	IPAddress%%+ 4
.%%4 5
Parse%%5 :
(%%: ;
$str%%; G
)%%G H
,%%H I
port%%J N
)%%N O
;%%O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
socket)) 
=)) 
listener)) !
.))! "
AcceptTcpClient))" 1
())1 2
)))2 3
;))3 4
}++ 
catch,, 
(,, 
IOException,, 
exceptIO,, '
),,' (
{-- 
IO.. 
... 
Logger.. 
... 
Log.. 
(.. 
NLog.. "
..." #
LogLevel..# +
...+ ,
Warn.., 0
,..0 1
exceptIO..2 :
,..: ;
$str..< W
+..X Y
port..Z ^
...^ _
ToString.._ g
(..g h
)..h i
)..i j
;..j k
}// 
finally00 
{11 
try22 
{33 
if44 
(44 
socket44 
!=44 !
null44" &
)44& '
{55 
socket66 
.66 
Close66 $
(66$ %
)66% &
;66& '
}77 
}88 
catch99 
(99 
IOException99 "
exceptIO99# +
)99+ ,
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; !
(;;! "
NLog;;" &
.;;& '
LogLevel;;' /
.;;/ 0
Warn;;0 4
,;;4 5
exceptIO;;6 >
,;;> ?
$str;;@ W
);;W X
;;;X Y
}<< 
try>> 
{?? 
if@@ 
(@@ 
listener@@  
!=@@! #
null@@$ (
)@@( )
{AA 
listenerBB  
.BB  !
StopBB! %
(BB% &
)BB& '
;BB' (
}CC 
}DD 
catchEE 
(EE 
IOExceptionEE "
exceptIOEE# +
)EE+ ,
{FF 
IOGG 
.GG 
LoggerGG 
.GG 
LogGG !
(GG! "
NLogGG" &
.GG& '
LogLevelGG' /
.GG/ 0
WarnGG0 4
,GG4 5
exceptIOGG6 >
,GG> ?
$strGG@ W
)GGW X
;GGX Y
}HH 
}II 
}JJ 	
}KK 
}MM 
}NN Ô
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_listen_10.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__network_listen_10 (
:) *#
AbstractTestCaseBadOnly+ B
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
IO 
. 

staticTrue 
) 
{ 	
TcpListener   
listener    
=  ! "
null  # '
;  ' (
	TcpClient!! 
socket!! 
=!! 
null!! #
;!!# $
int"" 
port"" 
="" 
$num"" 
;"" 
try## 
{$$ 
listener%% 
=%% 
new%% 
TcpListener%% *
(%%* +
	IPAddress%%+ 4
.%%4 5
Parse%%5 :
(%%: ;
$str%%; G
)%%G H
,%%H I
port%%J N
)%%N O
;%%O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
socket)) 
=)) 
listener)) !
.))! "
AcceptTcpClient))" 1
())1 2
)))2 3
;))3 4
}++ 
catch,, 
(,, 
IOException,, 
exceptIO,, '
),,' (
{-- 
IO.. 
... 
Logger.. 
... 
Log.. 
(.. 
NLog.. "
..." #
LogLevel..# +
...+ ,
Warn.., 0
,..0 1
exceptIO..2 :
,..: ;
$str..< W
+..X Y
port..Z ^
...^ _
ToString.._ g
(..g h
)..h i
)..i j
;..j k
}// 
finally00 
{11 
try22 
{33 
if44 
(44 
socket44 
!=44 !
null44" &
)44& '
{55 
socket66 
.66 
Close66 $
(66$ %
)66% &
;66& '
}77 
}88 
catch99 
(99 
IOException99 "
exceptIO99# +
)99+ ,
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; !
(;;! "
NLog;;" &
.;;& '
LogLevel;;' /
.;;/ 0
Warn;;0 4
,;;4 5
exceptIO;;6 >
,;;> ?
$str;;@ W
);;W X
;;;X Y
}<< 
try>> 
{?? 
if@@ 
(@@ 
listener@@  
!=@@! #
null@@$ (
)@@( )
{AA 
listenerBB  
.BB  !
StopBB! %
(BB% &
)BB& '
;BB' (
}CC 
}DD 
catchEE 
(EE 
IOExceptionEE "
exceptIOEE# +
)EE+ ,
{FF 
IOGG 
.GG 
LoggerGG 
.GG 
LogGG !
(GG! "
NLogGG" &
.GG& '
LogLevelGG' /
.GG/ 0
WarnGG0 4
,GG4 5
exceptIOGG6 >
,GG> ?
$strGG@ W
)GGW X
;GGX Y
}HH 
}II 
}JJ 	
}KK 
}MM 
}NN î
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_listen_11.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__network_listen_11 (
:) *#
AbstractTestCaseBadOnly+ B
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
IO 
. 
StaticReturnsTrue  
(  !
)! "
)" #
{ 	
TcpListener   
listener    
=  ! "
null  # '
;  ' (
	TcpClient!! 
socket!! 
=!! 
null!! #
;!!# $
int"" 
port"" 
="" 
$num"" 
;"" 
try## 
{$$ 
listener%% 
=%% 
new%% 
TcpListener%% *
(%%* +
	IPAddress%%+ 4
.%%4 5
Parse%%5 :
(%%: ;
$str%%; G
)%%G H
,%%H I
port%%J N
)%%N O
;%%O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
socket)) 
=)) 
listener)) !
.))! "
AcceptTcpClient))" 1
())1 2
)))2 3
;))3 4
}++ 
catch,, 
(,, 
IOException,, 
exceptIO,, '
),,' (
{-- 
IO.. 
... 
Logger.. 
... 
Log.. 
(.. 
NLog.. "
..." #
LogLevel..# +
...+ ,
Warn.., 0
,..0 1
exceptIO..2 :
,..: ;
$str..< W
+..X Y
port..Z ^
...^ _
ToString.._ g
(..g h
)..h i
)..i j
;..j k
}// 
finally00 
{11 
try22 
{33 
if44 
(44 
socket44 
!=44 !
null44" &
)44& '
{55 
socket66 
.66 
Close66 $
(66$ %
)66% &
;66& '
}77 
}88 
catch99 
(99 
IOException99 "
exceptIO99# +
)99+ ,
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; !
(;;! "
NLog;;" &
.;;& '
LogLevel;;' /
.;;/ 0
Warn;;0 4
,;;4 5
exceptIO;;6 >
,;;> ?
$str;;@ W
);;W X
;;;X Y
}<< 
try>> 
{?? 
if@@ 
(@@ 
listener@@  
!=@@! #
null@@$ (
)@@( )
{AA 
listenerBB  
.BB  !
StopBB! %
(BB% &
)BB& '
;BB' (
}CC 
}DD 
catchEE 
(EE 
IOExceptionEE "
exceptIOEE# +
)EE+ ,
{FF 
IOGG 
.GG 
LoggerGG 
.GG 
LogGG !
(GG! "
NLogGG" &
.GG& '
LogLevelGG' /
.GG/ 0
WarnGG0 4
,GG4 5
exceptIOGG6 >
,GG> ?
$strGG@ W
)GGW X
;GGX Y
}HH 
}II 
}JJ 	
}KK 
}MM 
}NN õ
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_listen_13.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__network_listen_13 (
:) *#
AbstractTestCaseBadOnly+ B
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
IO 
.  
STATIC_READONLY_FIVE #
==$ &
$num' (
)( )
{ 	
TcpListener   
listener    
=  ! "
null  # '
;  ' (
	TcpClient!! 
socket!! 
=!! 
null!! #
;!!# $
int"" 
port"" 
="" 
$num"" 
;"" 
try## 
{$$ 
listener%% 
=%% 
new%% 
TcpListener%% *
(%%* +
	IPAddress%%+ 4
.%%4 5
Parse%%5 :
(%%: ;
$str%%; G
)%%G H
,%%H I
port%%J N
)%%N O
;%%O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
socket)) 
=)) 
listener)) !
.))! "
AcceptTcpClient))" 1
())1 2
)))2 3
;))3 4
}++ 
catch,, 
(,, 
IOException,, 
exceptIO,, '
),,' (
{-- 
IO.. 
... 
Logger.. 
... 
Log.. 
(.. 
NLog.. "
..." #
LogLevel..# +
...+ ,
Warn.., 0
,..0 1
exceptIO..2 :
,..: ;
$str..< W
+..X Y
port..Z ^
...^ _
ToString.._ g
(..g h
)..h i
)..i j
;..j k
}// 
finally00 
{11 
try22 
{33 
if44 
(44 
socket44 
!=44 !
null44" &
)44& '
{55 
socket66 
.66 
Close66 $
(66$ %
)66% &
;66& '
}77 
}88 
catch99 
(99 
IOException99 "
exceptIO99# +
)99+ ,
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; !
(;;! "
NLog;;" &
.;;& '
LogLevel;;' /
.;;/ 0
Warn;;0 4
,;;4 5
exceptIO;;6 >
,;;> ?
$str;;@ W
);;W X
;;;X Y
}<< 
try>> 
{?? 
if@@ 
(@@ 
listener@@  
!=@@! #
null@@$ (
)@@( )
{AA 
listenerBB  
.BB  !
StopBB! %
(BB% &
)BB& '
;BB' (
}CC 
}DD 
catchEE 
(EE 
IOExceptionEE "
exceptIOEE# +
)EE+ ,
{FF 
IOGG 
.GG 
LoggerGG 
.GG 
LogGG !
(GG! "
NLogGG" &
.GG& '
LogLevelGG' /
.GG/ 0
WarnGG0 4
,GG4 5
exceptIOGG6 >
,GG> ?
$strGG@ W
)GGW X
;GGX Y
}HH 
}II 
}JJ 	
}KK 
}MM 
}NN ë
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_listen_14.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__network_listen_14 (
:) *#
AbstractTestCaseBadOnly+ B
{ 
public 

override 
void 
Bad 
( 
) 
{ 
if 

( 
IO 
. 

staticFive 
== 
$num 
) 
{ 	
TcpListener   
listener    
=  ! "
null  # '
;  ' (
	TcpClient!! 
socket!! 
=!! 
null!! #
;!!# $
int"" 
port"" 
="" 
$num"" 
;"" 
try## 
{$$ 
listener%% 
=%% 
new%% 
TcpListener%% *
(%%* +
	IPAddress%%+ 4
.%%4 5
Parse%%5 :
(%%: ;
$str%%; G
)%%G H
,%%H I
port%%J N
)%%N O
;%%O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
socket)) 
=)) 
listener)) !
.))! "
AcceptTcpClient))" 1
())1 2
)))2 3
;))3 4
}++ 
catch,, 
(,, 
IOException,, 
exceptIO,, '
),,' (
{-- 
IO.. 
... 
Logger.. 
... 
Log.. 
(.. 
NLog.. "
..." #
LogLevel..# +
...+ ,
Warn.., 0
,..0 1
exceptIO..2 :
,..: ;
$str..< W
+..X Y
port..Z ^
...^ _
ToString.._ g
(..g h
)..h i
)..i j
;..j k
}// 
finally00 
{11 
try22 
{33 
if44 
(44 
socket44 
!=44 !
null44" &
)44& '
{55 
socket66 
.66 
Close66 $
(66$ %
)66% &
;66& '
}77 
}88 
catch99 
(99 
IOException99 "
exceptIO99# +
)99+ ,
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; !
(;;! "
NLog;;" &
.;;& '
LogLevel;;' /
.;;/ 0
Warn;;0 4
,;;4 5
exceptIO;;6 >
,;;> ?
$str;;@ W
);;W X
;;;X Y
}<< 
try>> 
{?? 
if@@ 
(@@ 
listener@@  
!=@@! #
null@@$ (
)@@( )
{AA 
listenerBB  
.BB  !
StopBB! %
(BB% &
)BB& '
;BB' (
}CC 
}DD 
catchEE 
(EE 
IOExceptionEE "
exceptIOEE# +
)EE+ ,
{FF 
IOGG 
.GG 
LoggerGG 
.GG 
LogGG !
(GG! "
NLogGG" &
.GG& '
LogLevelGG' /
.GG/ 0
WarnGG0 4
,GG4 5
exceptIOGG6 >
,GG> ?
$strGG@ W
)GGW X
;GGX Y
}HH 
}II 
}JJ 	
}KK 
}MM 
}NN ﬁ
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_listen_15.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__network_listen_15 (
:) *#
AbstractTestCaseBadOnly+ B
{ 
public 

override 
void 
Bad 
( 
) 
{ 
switch 
( 
$num 
) 
{ 	
case   
$num   
:   
TcpListener!! 
listener!!  
=!!! "
null!!# '
;!!' (
	TcpClient"" 
socket"" 
="" 
null"" #
;""# $
int## 
port## 
=## 
$num## 
;## 
try$$ 
{%% 
listener&& 
=&& 
new&& 
TcpListener&& *
(&&* +
	IPAddress&&+ 4
.&&4 5
Parse&&5 :
(&&: ;
$str&&; G
)&&G H
,&&H I
port&&J N
)&&N O
;&&O P
listener)) 
.)) 
Start)) 
()) 
)))  
;))  !
socket** 
=** 
listener** !
.**! "
AcceptTcpClient**" 1
(**1 2
)**2 3
;**3 4
},, 
catch-- 
(-- 
IOException-- 
exceptIO-- '
)--' (
{.. 
IO// 
.// 
Logger// 
.// 
Log// 
(// 
NLog// "
.//" #
LogLevel//# +
.//+ ,
Warn//, 0
,//0 1
exceptIO//2 :
,//: ;
$str//< W
+//X Y
port//Z ^
.//^ _
ToString//_ g
(//g h
)//h i
)//i j
;//j k
}00 
finally11 
{22 
try33 
{44 
if55 
(55 
socket55 
!=55 !
null55" &
)55& '
{66 
socket77 
.77 
Close77 $
(77$ %
)77% &
;77& '
}88 
}99 
catch:: 
(:: 
IOException:: "
exceptIO::# +
)::+ ,
{;; 
IO<< 
.<< 
Logger<< 
.<< 
Log<< !
(<<! "
NLog<<" &
.<<& '
LogLevel<<' /
.<</ 0
Warn<<0 4
,<<4 5
exceptIO<<6 >
,<<> ?
$str<<@ W
)<<W X
;<<X Y
}== 
try?? 
{@@ 
ifAA 
(AA 
listenerAA  
!=AA! #
nullAA$ (
)AA( )
{BB 
listenerCC  
.CC  !
StopCC! %
(CC% &
)CC& '
;CC' (
}DD 
}EE 
catchFF 
(FF 
IOExceptionFF "
exceptIOFF# +
)FF+ ,
{GG 
IOHH 
.HH 
LoggerHH 
.HH 
LogHH !
(HH! "
NLogHH" &
.HH& '
LogLevelHH' /
.HH/ 0
WarnHH0 4
,HH4 5
exceptIOHH6 >
,HH> ?
$strHH@ W
)HHW X
;HHX Y
}II 
}JJ 
breakKK 
;KK 
defaultLL 
:LL 
IONN 
.NN 
	WriteLineNN 
(NN 
$strNN /
)NN/ 0
;NN0 1
breakOO 
;OO 
}PP 	
}QQ 
}SS 
}TT Ô
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_listen_16.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__network_listen_16 (
:) *#
AbstractTestCaseBadOnly+ B
{ 
public 

override 
void 
Bad 
( 
) 
{ 
while 
( 
true 
) 
{ 	
TcpListener   
listener    
=  ! "
null  # '
;  ' (
	TcpClient!! 
socket!! 
=!! 
null!! #
;!!# $
int"" 
port"" 
="" 
$num"" 
;"" 
try## 
{$$ 
listener%% 
=%% 
new%% 
TcpListener%% *
(%%* +
	IPAddress%%+ 4
.%%4 5
Parse%%5 :
(%%: ;
$str%%; G
)%%G H
,%%H I
port%%J N
)%%N O
;%%O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
socket)) 
=)) 
listener)) !
.))! "
AcceptTcpClient))" 1
())1 2
)))2 3
;))3 4
}++ 
catch,, 
(,, 
IOException,, 
exceptIO,, '
),,' (
{-- 
IO.. 
... 
Logger.. 
... 
Log.. 
(.. 
NLog.. "
..." #
LogLevel..# +
...+ ,
Warn.., 0
,..0 1
exceptIO..2 :
,..: ;
$str..< W
+..X Y
port..Z ^
...^ _
ToString.._ g
(..g h
)..h i
)..i j
;..j k
}// 
finally00 
{11 
try22 
{33 
if44 
(44 
socket44 
!=44 !
null44" &
)44& '
{55 
socket66 
.66 
Close66 $
(66$ %
)66% &
;66& '
}77 
}88 
catch99 
(99 
IOException99 "
exceptIO99# +
)99+ ,
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; !
(;;! "
NLog;;" &
.;;& '
LogLevel;;' /
.;;/ 0
Warn;;0 4
,;;4 5
exceptIO;;6 >
,;;> ?
$str;;@ W
);;W X
;;;X Y
}<< 
try>> 
{?? 
if@@ 
(@@ 
listener@@  
!=@@! #
null@@$ (
)@@( )
{AA 
listenerBB  
.BB  !
StopBB! %
(BB% &
)BB& '
;BB' (
}CC 
}DD 
catchEE 
(EE 
IOExceptionEE "
exceptIOEE# +
)EE+ ,
{FF 
IOGG 
.GG 
LoggerGG 
.GG 
LogGG !
(GG! "
NLogGG" &
.GG& '
LogLevelGG' /
.GG/ 0
WarnGG0 4
,GG4 5
exceptIOGG6 >
,GG> ?
$strGG@ W
)GGW X
;GGX Y
}HH 
}II 
breakJJ 
;JJ 
}KK 	
}LL 
}NN 
}OO Á
êC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\CWE510_Trapdoor__network_listen_17.cs
	namespace 	
	testcases
 
. 
CWE510_Trapdoor #
{ 
class .
"CWE510_Trapdoor__network_listen_17 (
:) *#
AbstractTestCaseBadOnly+ B
{ 
public 

override 
void 
Bad 
( 
) 
{ 
for 
( 
int 
j 
= 
$num 
; 
j 
< 
$num 
; 
j  
++  "
)" #
{ 	
TcpListener   
listener    
=  ! "
null  # '
;  ' (
	TcpClient!! 
socket!! 
=!! 
null!! #
;!!# $
int"" 
port"" 
="" 
$num"" 
;"" 
try## 
{$$ 
listener%% 
=%% 
new%% 
TcpListener%% *
(%%* +
	IPAddress%%+ 4
.%%4 5
Parse%%5 :
(%%: ;
$str%%; G
)%%G H
,%%H I
port%%J N
)%%N O
;%%O P
listener(( 
.(( 
Start(( 
((( 
)((  
;((  !
socket)) 
=)) 
listener)) !
.))! "
AcceptTcpClient))" 1
())1 2
)))2 3
;))3 4
}++ 
catch,, 
(,, 
IOException,, 
exceptIO,, '
),,' (
{-- 
IO.. 
... 
Logger.. 
... 
Log.. 
(.. 
NLog.. "
..." #
LogLevel..# +
...+ ,
Warn.., 0
,..0 1
exceptIO..2 :
,..: ;
$str..< W
+..X Y
port..Z ^
...^ _
ToString.._ g
(..g h
)..h i
)..i j
;..j k
}// 
finally00 
{11 
try22 
{33 
if44 
(44 
socket44 
!=44 !
null44" &
)44& '
{55 
socket66 
.66 
Close66 $
(66$ %
)66% &
;66& '
}77 
}88 
catch99 
(99 
IOException99 "
exceptIO99# +
)99+ ,
{:: 
IO;; 
.;; 
Logger;; 
.;; 
Log;; !
(;;! "
NLog;;" &
.;;& '
LogLevel;;' /
.;;/ 0
Warn;;0 4
,;;4 5
exceptIO;;6 >
,;;> ?
$str;;@ W
);;W X
;;;X Y
}<< 
try>> 
{?? 
if@@ 
(@@ 
listener@@  
!=@@! #
null@@$ (
)@@( )
{AA 
listenerBB  
.BB  !
StopBB! %
(BB% &
)BB& '
;BB' (
}CC 
}DD 
catchEE 
(EE 
IOExceptionEE "
exceptIOEE# +
)EE+ ,
{FF 
IOGG 
.GG 
LoggerGG 
.GG 
LogGG !
(GG! "
NLogGG" &
.GG& '
LogLevelGG' /
.GG/ 0
WarnGG0 4
,GG4 5
exceptIOGG6 >
,GG> ?
$strGG@ W
)GGW X
;GGX Y
}HH 
}II 
}JJ 	
}KK 
}MM 
}NN ˝•
uC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\Program.cs
	namespace		 	
	testcases		
 
.		 
CWE510_Trapdoor		 #
{

 
class 
Program 
{ 
static 
void	 
Main 
( 
string 
[ 
] 
args  
)  !
{" #
if 
( 
args 

.
 
Any 
( 
) 
) 
{ 
if 
( 
args 
[ 
$num 
] 
. 
Equals 
( 
$str 
, 
StringComparison ,
., -
OrdinalIgnoreCase- >
)> ?
||@ B
args 
[ 
$num 
] 
. 
Equals !
(! "
$str" *
,* +
StringComparison, <
.< =
OrdinalIgnoreCase= N
)N O
)O P
{Q R
Console 
. 
	WriteLine 
( 
$str R
+S T
$str b
)b c
;c d
System 
. 
Environment 
. 
Exit 
( 
$num 
) 
;  
} 
foreach"" 
("" 
string"" 
	className"" 
in""  
args""! %
)""% &
{""' (
try$$ 
{$$	 

Type** 

myClass** 
=** 
Type** 
.** 
GetType** !
(**! "
	className**" +
)**+ ,
;**, -
object++ 
myObject++ 
=++ 
	Activator++ !
.++! "
CreateInstance++" 0
(++0 1
myClass++1 8
)++8 9
;++9 :
myClass,, 
.,, 
InvokeMember,, 
(,, 
$str,, $
,,,$ %
BindingFlags-- 
.-- 
InvokeMethod--  
|--! "
BindingFlags--# /
.--/ 0
Instance--0 8
|--9 :
BindingFlags--; G
.--G H
Public--H N
,--N O
null.. 
,.. 
myObject// 
,// 
new00 

object00 
[00 
]00 
{00 
	className00 
}00  !
)00! "
;00" #
}22 
catch22 
(22 
	Exception22 
ex22 
)22 
{22 
Console44 
.44 
	WriteLine44 
(44 
$str44 7
+448 9
	className44: C
)44C D
;44D E
Console55 
.55 
	WriteLine55 
(55 
ex55 
.55 

StackTrace55 %
)55% &
;55& '
}77 
Console99 
.99 
	WriteLine99 
(99 
$str99 
)99 
;99 
};; 
}== 
else== 	
{==
 
RunTestCWE1CC 
(CC 
)CC 
;CC 
RunTestCWE2DD 
(DD 
)DD 
;DD 
RunTestCWE3EE 
(EE 
)EE 
;EE 
RunTestCWE4FF 
(FF 
)FF 
;FF 
RunTestCWE5GG 
(GG 
)GG 
;GG 
RunTestCWE6HH 
(HH 
)HH 
;HH 
RunTestCWE7II 
(II 
)II 
;II 
RunTestCWE8JJ 
(JJ 
)JJ 
;JJ 
RunTestCWE9KK 
(KK 
)KK 
;KK 
}LL 
}MM 
privateOO 
staticOO	 
voidOO 
RunTestCWE1OO  
(OO  !
)OO! "
{OO# $
}SS 
privateUU 
staticUU	 
voidUU 
RunTestCWE2UU  
(UU  !
)UU! "
{UU# $
}YY 
private[[ 
static[[	 
void[[ 
RunTestCWE3[[  
([[  !
)[[! "
{[[# $
}__ 
privateaa 
staticaa	 
voidaa 
RunTestCWE4aa  
(aa  !
)aa! "
{aa# $
}ee 
privategg 
staticgg	 
voidgg 
RunTestCWE5gg  
(gg  !
)gg! "
{gg# $
(ii 
newii 4
(CWE510_Trapdoor__hostname_based_logic_01ii 0
(ii0 1
)ii1 2
)ii2 3
.ii3 4
RunTestii4 ;
(ii; <
$strii< f
)iif g
;iig h
(jj 
newjj 4
(CWE510_Trapdoor__hostname_based_logic_02jj 0
(jj0 1
)jj1 2
)jj2 3
.jj3 4
RunTestjj4 ;
(jj; <
$strjj< f
)jjf g
;jjg h
(kk 
newkk 4
(CWE510_Trapdoor__hostname_based_logic_03kk 0
(kk0 1
)kk1 2
)kk2 3
.kk3 4
RunTestkk4 ;
(kk; <
$strkk< f
)kkf g
;kkg h
(ll 
newll 4
(CWE510_Trapdoor__hostname_based_logic_04ll 0
(ll0 1
)ll1 2
)ll2 3
.ll3 4
RunTestll4 ;
(ll; <
$strll< f
)llf g
;llg h
(mm 
newmm 4
(CWE510_Trapdoor__hostname_based_logic_05mm 0
(mm0 1
)mm1 2
)mm2 3
.mm3 4
RunTestmm4 ;
(mm; <
$strmm< f
)mmf g
;mmg h
(nn 
newnn 4
(CWE510_Trapdoor__hostname_based_logic_06nn 0
(nn0 1
)nn1 2
)nn2 3
.nn3 4
RunTestnn4 ;
(nn; <
$strnn< f
)nnf g
;nng h
(oo 
newoo 4
(CWE510_Trapdoor__hostname_based_logic_07oo 0
(oo0 1
)oo1 2
)oo2 3
.oo3 4
RunTestoo4 ;
(oo; <
$stroo< f
)oof g
;oog h
(pp 
newpp 4
(CWE510_Trapdoor__hostname_based_logic_08pp 0
(pp0 1
)pp1 2
)pp2 3
.pp3 4
RunTestpp4 ;
(pp; <
$strpp< f
)ppf g
;ppg h
(qq 
newqq 4
(CWE510_Trapdoor__hostname_based_logic_09qq 0
(qq0 1
)qq1 2
)qq2 3
.qq3 4
RunTestqq4 ;
(qq; <
$strqq< f
)qqf g
;qqg h
(rr 
newrr 4
(CWE510_Trapdoor__hostname_based_logic_10rr 0
(rr0 1
)rr1 2
)rr2 3
.rr3 4
RunTestrr4 ;
(rr; <
$strrr< f
)rrf g
;rrg h
(ss 
newss 4
(CWE510_Trapdoor__hostname_based_logic_11ss 0
(ss0 1
)ss1 2
)ss2 3
.ss3 4
RunTestss4 ;
(ss; <
$strss< f
)ssf g
;ssg h
(tt 
newtt 4
(CWE510_Trapdoor__hostname_based_logic_12tt 0
(tt0 1
)tt1 2
)tt2 3
.tt3 4
RunTesttt4 ;
(tt; <
$strtt< f
)ttf g
;ttg h
(uu 
newuu 4
(CWE510_Trapdoor__hostname_based_logic_13uu 0
(uu0 1
)uu1 2
)uu2 3
.uu3 4
RunTestuu4 ;
(uu; <
$struu< f
)uuf g
;uug h
(vv 
newvv 4
(CWE510_Trapdoor__hostname_based_logic_14vv 0
(vv0 1
)vv1 2
)vv2 3
.vv3 4
RunTestvv4 ;
(vv; <
$strvv< f
)vvf g
;vvg h
(ww 
newww 4
(CWE510_Trapdoor__hostname_based_logic_15ww 0
(ww0 1
)ww1 2
)ww2 3
.ww3 4
RunTestww4 ;
(ww; <
$strww< f
)wwf g
;wwg h
(xx 
newxx 4
(CWE510_Trapdoor__hostname_based_logic_16xx 0
(xx0 1
)xx1 2
)xx2 3
.xx3 4
RunTestxx4 ;
(xx; <
$strxx< f
)xxf g
;xxg h
(yy 
newyy 4
(CWE510_Trapdoor__hostname_based_logic_17yy 0
(yy0 1
)yy1 2
)yy2 3
.yy3 4
RunTestyy4 ;
(yy; <
$stryy< f
)yyf g
;yyg h
(zz 
newzz .
"CWE510_Trapdoor__ip_based_logic_01zz *
(zz* +
)zz+ ,
)zz, -
.zz- .
RunTestzz. 5
(zz5 6
$strzz6 Z
)zzZ [
;zz[ \
({{ 
new{{ .
"CWE510_Trapdoor__ip_based_logic_02{{ *
({{* +
){{+ ,
){{, -
.{{- .
RunTest{{. 5
({{5 6
$str{{6 Z
){{Z [
;{{[ \
(|| 
new|| .
"CWE510_Trapdoor__ip_based_logic_03|| *
(||* +
)||+ ,
)||, -
.||- .
RunTest||. 5
(||5 6
$str||6 Z
)||Z [
;||[ \
(}} 
new}} .
"CWE510_Trapdoor__ip_based_logic_04}} *
(}}* +
)}}+ ,
)}}, -
.}}- .
RunTest}}. 5
(}}5 6
$str}}6 Z
)}}Z [
;}}[ \
(~~ 
new~~ .
"CWE510_Trapdoor__ip_based_logic_05~~ *
(~~* +
)~~+ ,
)~~, -
.~~- .
RunTest~~. 5
(~~5 6
$str~~6 Z
)~~Z [
;~~[ \
( 
new .
"CWE510_Trapdoor__ip_based_logic_06 *
(* +
)+ ,
), -
.- .
RunTest. 5
(5 6
$str6 Z
)Z [
;[ \
(
ÄÄ 
new
ÄÄ 0
"CWE510_Trapdoor__ip_based_logic_07
ÄÄ *
(
ÄÄ* +
)
ÄÄ+ ,
)
ÄÄ, -
.
ÄÄ- .
RunTest
ÄÄ. 5
(
ÄÄ5 6
$str
ÄÄ6 Z
)
ÄÄZ [
;
ÄÄ[ \
(
ÅÅ 
new
ÅÅ 0
"CWE510_Trapdoor__ip_based_logic_08
ÅÅ *
(
ÅÅ* +
)
ÅÅ+ ,
)
ÅÅ, -
.
ÅÅ- .
RunTest
ÅÅ. 5
(
ÅÅ5 6
$str
ÅÅ6 Z
)
ÅÅZ [
;
ÅÅ[ \
(
ÇÇ 
new
ÇÇ 0
"CWE510_Trapdoor__ip_based_logic_09
ÇÇ *
(
ÇÇ* +
)
ÇÇ+ ,
)
ÇÇ, -
.
ÇÇ- .
RunTest
ÇÇ. 5
(
ÇÇ5 6
$str
ÇÇ6 Z
)
ÇÇZ [
;
ÇÇ[ \
(
ÉÉ 
new
ÉÉ 0
"CWE510_Trapdoor__ip_based_logic_10
ÉÉ *
(
ÉÉ* +
)
ÉÉ+ ,
)
ÉÉ, -
.
ÉÉ- .
RunTest
ÉÉ. 5
(
ÉÉ5 6
$str
ÉÉ6 Z
)
ÉÉZ [
;
ÉÉ[ \
(
ÑÑ 
new
ÑÑ 0
"CWE510_Trapdoor__ip_based_logic_11
ÑÑ *
(
ÑÑ* +
)
ÑÑ+ ,
)
ÑÑ, -
.
ÑÑ- .
RunTest
ÑÑ. 5
(
ÑÑ5 6
$str
ÑÑ6 Z
)
ÑÑZ [
;
ÑÑ[ \
(
ÖÖ 
new
ÖÖ 0
"CWE510_Trapdoor__ip_based_logic_12
ÖÖ *
(
ÖÖ* +
)
ÖÖ+ ,
)
ÖÖ, -
.
ÖÖ- .
RunTest
ÖÖ. 5
(
ÖÖ5 6
$str
ÖÖ6 Z
)
ÖÖZ [
;
ÖÖ[ \
(
ÜÜ 
new
ÜÜ 0
"CWE510_Trapdoor__ip_based_logic_13
ÜÜ *
(
ÜÜ* +
)
ÜÜ+ ,
)
ÜÜ, -
.
ÜÜ- .
RunTest
ÜÜ. 5
(
ÜÜ5 6
$str
ÜÜ6 Z
)
ÜÜZ [
;
ÜÜ[ \
(
áá 
new
áá 0
"CWE510_Trapdoor__ip_based_logic_14
áá *
(
áá* +
)
áá+ ,
)
áá, -
.
áá- .
RunTest
áá. 5
(
áá5 6
$str
áá6 Z
)
ááZ [
;
áá[ \
(
àà 
new
àà 0
"CWE510_Trapdoor__ip_based_logic_15
àà *
(
àà* +
)
àà+ ,
)
àà, -
.
àà- .
RunTest
àà. 5
(
àà5 6
$str
àà6 Z
)
ààZ [
;
àà[ \
(
ââ 
new
ââ 0
"CWE510_Trapdoor__ip_based_logic_16
ââ *
(
ââ* +
)
ââ+ ,
)
ââ, -
.
ââ- .
RunTest
ââ. 5
(
ââ5 6
$str
ââ6 Z
)
ââZ [
;
ââ[ \
(
ää 
new
ää 0
"CWE510_Trapdoor__ip_based_logic_17
ää *
(
ää* +
)
ää+ ,
)
ää, -
.
ää- .
RunTest
ää. 5
(
ää5 6
$str
ää6 Z
)
ääZ [
;
ää[ \
(
ãã 
new
ãã 4
&CWE510_Trapdoor__network_connection_01
ãã .
(
ãã. /
)
ãã/ 0
)
ãã0 1
.
ãã1 2
RunTest
ãã2 9
(
ãã9 :
$str
ãã: b
)
ããb c
;
ããc d
(
åå 
new
åå 4
&CWE510_Trapdoor__network_connection_02
åå .
(
åå. /
)
åå/ 0
)
åå0 1
.
åå1 2
RunTest
åå2 9
(
åå9 :
$str
åå: b
)
ååb c
;
ååc d
(
çç 
new
çç 4
&CWE510_Trapdoor__network_connection_03
çç .
(
çç. /
)
çç/ 0
)
çç0 1
.
çç1 2
RunTest
çç2 9
(
çç9 :
$str
çç: b
)
ççb c
;
ççc d
(
éé 
new
éé 4
&CWE510_Trapdoor__network_connection_04
éé .
(
éé. /
)
éé/ 0
)
éé0 1
.
éé1 2
RunTest
éé2 9
(
éé9 :
$str
éé: b
)
ééb c
;
ééc d
(
èè 
new
èè 4
&CWE510_Trapdoor__network_connection_05
èè .
(
èè. /
)
èè/ 0
)
èè0 1
.
èè1 2
RunTest
èè2 9
(
èè9 :
$str
èè: b
)
èèb c
;
èèc d
(
êê 
new
êê 4
&CWE510_Trapdoor__network_connection_06
êê .
(
êê. /
)
êê/ 0
)
êê0 1
.
êê1 2
RunTest
êê2 9
(
êê9 :
$str
êê: b
)
êêb c
;
êêc d
(
ëë 
new
ëë 4
&CWE510_Trapdoor__network_connection_07
ëë .
(
ëë. /
)
ëë/ 0
)
ëë0 1
.
ëë1 2
RunTest
ëë2 9
(
ëë9 :
$str
ëë: b
)
ëëb c
;
ëëc d
(
íí 
new
íí 4
&CWE510_Trapdoor__network_connection_08
íí .
(
íí. /
)
íí/ 0
)
íí0 1
.
íí1 2
RunTest
íí2 9
(
íí9 :
$str
íí: b
)
ííb c
;
ííc d
(
ìì 
new
ìì 4
&CWE510_Trapdoor__network_connection_09
ìì .
(
ìì. /
)
ìì/ 0
)
ìì0 1
.
ìì1 2
RunTest
ìì2 9
(
ìì9 :
$str
ìì: b
)
ììb c
;
ììc d
(
îî 
new
îî 4
&CWE510_Trapdoor__network_connection_10
îî .
(
îî. /
)
îî/ 0
)
îî0 1
.
îî1 2
RunTest
îî2 9
(
îî9 :
$str
îî: b
)
îîb c
;
îîc d
(
ïï 
new
ïï 4
&CWE510_Trapdoor__network_connection_11
ïï .
(
ïï. /
)
ïï/ 0
)
ïï0 1
.
ïï1 2
RunTest
ïï2 9
(
ïï9 :
$str
ïï: b
)
ïïb c
;
ïïc d
(
ññ 
new
ññ 4
&CWE510_Trapdoor__network_connection_13
ññ .
(
ññ. /
)
ññ/ 0
)
ññ0 1
.
ññ1 2
RunTest
ññ2 9
(
ññ9 :
$str
ññ: b
)
ññb c
;
ññc d
(
óó 
new
óó 4
&CWE510_Trapdoor__network_connection_14
óó .
(
óó. /
)
óó/ 0
)
óó0 1
.
óó1 2
RunTest
óó2 9
(
óó9 :
$str
óó: b
)
óób c
;
óóc d
(
òò 
new
òò 4
&CWE510_Trapdoor__network_connection_15
òò .
(
òò. /
)
òò/ 0
)
òò0 1
.
òò1 2
RunTest
òò2 9
(
òò9 :
$str
òò: b
)
òòb c
;
òòc d
(
ôô 
new
ôô 4
&CWE510_Trapdoor__network_connection_16
ôô .
(
ôô. /
)
ôô/ 0
)
ôô0 1
.
ôô1 2
RunTest
ôô2 9
(
ôô9 :
$str
ôô: b
)
ôôb c
;
ôôc d
(
öö 
new
öö 4
&CWE510_Trapdoor__network_connection_17
öö .
(
öö. /
)
öö/ 0
)
öö0 1
.
öö1 2
RunTest
öö2 9
(
öö9 :
$str
öö: b
)
ööb c
;
ööc d
(
õõ 
new
õõ 0
"CWE510_Trapdoor__network_listen_01
õõ *
(
õõ* +
)
õõ+ ,
)
õõ, -
.
õõ- .
RunTest
õõ. 5
(
õõ5 6
$str
õõ6 Z
)
õõZ [
;
õõ[ \
(
úú 
new
úú 0
"CWE510_Trapdoor__network_listen_02
úú *
(
úú* +
)
úú+ ,
)
úú, -
.
úú- .
RunTest
úú. 5
(
úú5 6
$str
úú6 Z
)
úúZ [
;
úú[ \
(
ùù 
new
ùù 0
"CWE510_Trapdoor__network_listen_03
ùù *
(
ùù* +
)
ùù+ ,
)
ùù, -
.
ùù- .
RunTest
ùù. 5
(
ùù5 6
$str
ùù6 Z
)
ùùZ [
;
ùù[ \
(
ûû 
new
ûû 0
"CWE510_Trapdoor__network_listen_04
ûû *
(
ûû* +
)
ûû+ ,
)
ûû, -
.
ûû- .
RunTest
ûû. 5
(
ûû5 6
$str
ûû6 Z
)
ûûZ [
;
ûû[ \
(
üü 
new
üü 0
"CWE510_Trapdoor__network_listen_05
üü *
(
üü* +
)
üü+ ,
)
üü, -
.
üü- .
RunTest
üü. 5
(
üü5 6
$str
üü6 Z
)
üüZ [
;
üü[ \
(
†† 
new
†† 0
"CWE510_Trapdoor__network_listen_06
†† *
(
††* +
)
††+ ,
)
††, -
.
††- .
RunTest
††. 5
(
††5 6
$str
††6 Z
)
††Z [
;
††[ \
(
°° 
new
°° 0
"CWE510_Trapdoor__network_listen_07
°° *
(
°°* +
)
°°+ ,
)
°°, -
.
°°- .
RunTest
°°. 5
(
°°5 6
$str
°°6 Z
)
°°Z [
;
°°[ \
(
¢¢ 
new
¢¢ 0
"CWE510_Trapdoor__network_listen_08
¢¢ *
(
¢¢* +
)
¢¢+ ,
)
¢¢, -
.
¢¢- .
RunTest
¢¢. 5
(
¢¢5 6
$str
¢¢6 Z
)
¢¢Z [
;
¢¢[ \
(
££ 
new
££ 0
"CWE510_Trapdoor__network_listen_09
££ *
(
££* +
)
££+ ,
)
££, -
.
££- .
RunTest
££. 5
(
££5 6
$str
££6 Z
)
££Z [
;
££[ \
(
§§ 
new
§§ 0
"CWE510_Trapdoor__network_listen_10
§§ *
(
§§* +
)
§§+ ,
)
§§, -
.
§§- .
RunTest
§§. 5
(
§§5 6
$str
§§6 Z
)
§§Z [
;
§§[ \
(
•• 
new
•• 0
"CWE510_Trapdoor__network_listen_11
•• *
(
••* +
)
••+ ,
)
••, -
.
••- .
RunTest
••. 5
(
••5 6
$str
••6 Z
)
••Z [
;
••[ \
(
¶¶ 
new
¶¶ 0
"CWE510_Trapdoor__network_listen_13
¶¶ *
(
¶¶* +
)
¶¶+ ,
)
¶¶, -
.
¶¶- .
RunTest
¶¶. 5
(
¶¶5 6
$str
¶¶6 Z
)
¶¶Z [
;
¶¶[ \
(
ßß 
new
ßß 0
"CWE510_Trapdoor__network_listen_14
ßß *
(
ßß* +
)
ßß+ ,
)
ßß, -
.
ßß- .
RunTest
ßß. 5
(
ßß5 6
$str
ßß6 Z
)
ßßZ [
;
ßß[ \
(
®® 
new
®® 0
"CWE510_Trapdoor__network_listen_15
®® *
(
®®* +
)
®®+ ,
)
®®, -
.
®®- .
RunTest
®®. 5
(
®®5 6
$str
®®6 Z
)
®®Z [
;
®®[ \
(
©© 
new
©© 0
"CWE510_Trapdoor__network_listen_16
©© *
(
©©* +
)
©©+ ,
)
©©, -
.
©©- .
RunTest
©©. 5
(
©©5 6
$str
©©6 Z
)
©©Z [
;
©©[ \
(
™™ 
new
™™ 0
"CWE510_Trapdoor__network_listen_17
™™ *
(
™™* +
)
™™+ ,
)
™™, -
.
™™- .
RunTest
™™. 5
(
™™5 6
$str
™™6 Z
)
™™Z [
;
™™[ \
}
¨¨ 
private
ÆÆ 
static
ÆÆ	 
void
ÆÆ 
RunTestCWE6
ÆÆ  
(
ÆÆ  !
)
ÆÆ! "
{
ÆÆ# $
}
≤≤ 
private
¥¥ 
static
¥¥	 
void
¥¥ 
RunTestCWE7
¥¥  
(
¥¥  !
)
¥¥! "
{
¥¥# $
}
∏∏ 
private
∫∫ 
static
∫∫	 
void
∫∫ 
RunTestCWE8
∫∫  
(
∫∫  !
)
∫∫! "
{
∫∫# $
}
ææ 
private
¿¿ 
static
¿¿	 
void
¿¿ 
RunTestCWE9
¿¿  
(
¿¿  !
)
¿¿! "
{
¿¿# $
}
ƒƒ 
}≈≈ 
}∆∆ ±
ÖC:\Users\CyberDiver\Documents\SAST Benchmarking\juliet_test_suite_1.3-csharp\src\testcases\CWE510_Trapdoor\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str *
)* +
]+ ,
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str ,
), -
]- .
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *